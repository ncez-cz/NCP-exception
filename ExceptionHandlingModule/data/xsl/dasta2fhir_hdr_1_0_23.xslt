<?xml version="1.0" encoding="UTF-8"?>
<!--
This file was generated by Altova MapForce 2024r2sp1

YOU SHOULD NOT MODIFY THIS FILE, BECAUSE IT WILL BE
OVERWRITTEN WHEN YOU RE-RUN CODE GENERATION.

Refer to the Altova MapForce Documentation for further details.
http://www.altova.com/mapforce
-->
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns0="http://hl7.org/fhir" xmlns:provisio="http://www.altova.com/MapForce/UDF/provisio" xmlns:tbf="http://www.altova.com/MapForce/UDF/tbf" xmlns:vmf="http://www.altova.com/MapForce/UDF/vmf" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:xml="http://www.w3.org/XML/1998/namespace" xmlns:ns1="urn:cz-mzcr:ns:dasta:ds4:ds_dasta" xmlns:ns2="urn:cz-mzcr:ns:dasta:ds4:ds_ip" exclude-result-prefixes="ns0 provisio tbf vmf xs fn ns1 ns2">
	<xsl:template name="provisio:ku_z_propz_sprij">
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_sprijType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var26_prij_pracovnik" as="node()*" select="$ku_z_propz_sprijType/ns2:prij_pracovnik"/>
		<xsl:variable name="var27_guid" as="node()?" select="$ku_z_propz_sprijType/@guid"/>
		<xsl:variable name="var25_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var24_create_dat_prov_of_dat_prov" as="node()*">
			<xsl:for-each select="$dat_prov">
				<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</dat_prov>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var27_guid">
				<xsl:for-each select="$var27_guid">
					<xsl:variable name="var1_resultof_FullURL_Encounter" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Encounter">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Encounter">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Encounter>
					<meta>
						<xsl:for-each select="$ku_z_propz_sprijType/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'67852-4'"/>
							</code>
						</tag>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'in-progress'"/>
					</status>
					<class>
						<system>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-ActCode'))"/>
						</system>
						<code>
							<xsl:attribute name="value" namespace="" select="'IMP'"/>
						</code>
						<display>
							<xsl:attribute name="value" namespace="" select="'inpatient encounter'"/>
						</display>
					</class>
					<subject>
						<xsl:sequence select="$var25_let"/>
					</subject>
					<xsl:for-each select="$var26_prij_pracovnik">
						<xsl:variable name="var9_cur" as="node()" select="."/>
						<xsl:variable name="var8_guid" as="node()?" select="@guid"/>
						<participant>
							<individual>
								<reference>
									<xsl:for-each select="$var8_guid">
										<xsl:variable name="var4_vguid" as="node()?" select="$var9_cur/@vguid"/>
										<xsl:for-each select="$var4_vguid">
											<xsl:for-each select="$var8_guid">
												<xsl:variable name="var3_cur" as="node()" select="."/>
												<xsl:for-each select="$var4_vguid">
													<xsl:variable name="var2_resultof_Reference_Practitioner" as="xs:string?">
														<xsl:call-template name="provisio:Reference_Practitioner">
															<xsl:with-param name="GUID" select="fn:string($var3_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var2_resultof_Reference_Practitioner">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:for-each select="ns2:titul_pred">
										<xsl:variable name="var7_cur" as="node()" select="."/>
										<xsl:for-each select="$var9_cur/ns2:jmeno">
											<xsl:variable name="var6_cur" as="node()" select="."/>
											<xsl:for-each select="$var9_cur/ns2:prijmeni">
												<xsl:variable name="var5_cur" as="node()" select="."/>
												<xsl:for-each select="$var9_cur/ns2:titul_za">
													<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat(fn:concat(fn:concat(fn:concat(fn:string($var7_cur), ' '), fn:string($var6_cur)), ' '), fn:string($var5_cur)), ' '), fn:string(.))"/>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</display>
							</individual>
						</participant>
					</xsl:for-each>
					<period>
						<start>
							<xsl:for-each select="$ku_z_propz_sprijType/ns2:dat_vys_prij">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</start>
					</period>
				</Encounter>
			</resource>
		</entry>
		<xsl:variable name="var10_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$var26_prij_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var10_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_a_text">
			<xsl:variable name="var11_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'8716-3'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var11_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:h">
			<xsl:variable name="var12_resultof_ku_z_propz_sprij_h" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_sprij_h">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="hType" as="node()">
						<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</hType>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" select="$var24_create_dat_prov_of_dat_prov" as="node()*"/>
					<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
					<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var12_resultof_ku_z_propz_sprij_h">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_a_param/ns2:vys_v_snomed">
			<xsl:variable name="var13_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var13_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var14_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_a_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var14_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_f_text">
			<xsl:variable name="var15_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'8716-3'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var15_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var16_resultof_ku_z_propz_sprij_fyznal" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_sprij_fyznal">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var25_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="fyznalType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:fyznal">
						<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</fyznalType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var24_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var16_resultof_ku_z_propz_sprij_fyznal">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_f_param/ns2:vys_v_snomed">
			<xsl:variable name="var17_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var17_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var18_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_f_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var18_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_s_text">
			<xsl:variable name="var19_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'55286-9'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var19_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var20_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_s_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var20_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_fs_text">
			<xsl:variable name="var21_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var21_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var22_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_fs_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var22_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_fs_form">
			<xsl:variable name="var23_resultof_ku_z_propz_sprXX___vys_fs_form" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_sprXX_-_vys_fs_form">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="vys_fs_form" as="node()">
						<vys_fs_form xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_fs_form>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var23_resultof_ku_z_propz_sprXX___vys_fs_form">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_prob">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_probType" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_probType">
			<xsl:variable name="var5_cur" as="node()" select="."/>
			<xsl:variable name="var3_prob_kod" as="node()*" select="ns2:prob_kod"/>
			<xsl:variable name="var4_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var4_guid">
					<xsl:for-each select="$var4_guid">
						<xsl:variable name="var1_resultof_FullURL_Condition" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Condition">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Condition">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Condition>
						<xsl:for-each select="$var4_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<xsl:for-each select="$dat_prov">
								<lastUpdated>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(.)))"/>
								</lastUpdated>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-condition-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'11450-4'"/>
								</code>
							</tag>
						</meta>
						<clinicalStatus>
							<xsl:for-each select="ns2:prob_klin">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-clinical'))"/>
									</system>
									<xsl:variable name="var2_resultof_vmf__inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf1_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var2_resultof_vmf__inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
								</coding>
							</xsl:for-each>
						</clinicalStatus>
						<verificationStatus>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-ver-status'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'confirmed'"/>
								</code>
							</coding>
						</verificationStatus>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'encounter-diagnosis'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Encounter Diagnosis'"/>
								</display>
							</coding>
						</category>
						<xsl:for-each select="ns2:prob_zav_text">
							<severity>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</severity>
						</xsl:for-each>
						<code>
							<xsl:for-each select="$var3_prob_kod">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
									</system>
									<code>
										<xsl:for-each select="ns2:kod_syst">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="ns2:kod">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</xsl:for-each>
							<text>
								<xsl:for-each select="$var3_prob_kod/ns2:kod_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_dat_od">
							<onsetPeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var5_cur/ns2:prob_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</onsetPeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<recorder>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</recorder>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_stad_kod">
							<stage>
								<summary>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
										</system>
										<code>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
									<text>
										<xsl:for-each select="ns2:kod_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</text>
								</summary>
							</stage>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_stad_text">
							<stage>
								<type>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</type>
							</stage>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_popis">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_okol">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Condition>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_abj">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_abj" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_abj">
			<xsl:variable name="var1_abj_kod" as="node()*" select="ns2:abj_kod"/>
			<xsl:variable name="var2_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var2_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var2_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
								</system>
								<version>
									<xsl:for-each select="$var1_abj_kod/ns2:kod_syst">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</version>
								<code>
									<xsl:for-each select="$var1_abj_kod/ns2:kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="$var1_abj_kod/ns2:kod_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:abj_text">
							<valueCodeableConcept>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</valueCodeableConcept>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_abd">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_abd" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_abd">
			<xsl:variable name="var4_current" as="node()" select="."/>
			<xsl:variable name="var3_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var3_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWG.htm'))"/>
								</system>
								<xsl:for-each select="ns2:abd_stav_kod">
									<xsl:variable name="var1_resultof_vmf__inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf2_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var1_resultof_vmf__inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
								</xsl:for-each>
								<xsl:for-each select="ns2:abd_stav_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWH.htm'))"/>
								</system>
								<xsl:for-each select="ns2:abd_lattyp_kod">
									<xsl:variable name="var2_resultof_vmf__inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf3_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var2_resultof_vmf__inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
								</xsl:for-each>
								<xsl:for-each select="ns2:abd_lattyp_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBSE.htm'))"/>
								</system>
								<code>
									<xsl:for-each select="ns2:abd_latzp_kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="ns2:abd_latzp_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:abd_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var4_current/ns2:abd_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:abd_mnoz_text">
							<valueCodeableConcept>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</valueCodeableConcept>
						</xsl:for-each>
						<xsl:for-each select="ns2:abd_koment">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_abk">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_abk" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_abk">
			<xsl:variable name="var2_current" as="node()" select="."/>
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
								</system>
								<xsl:for-each select="ns2:abk_stav_kod">
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
								</xsl:for-each>
								<xsl:for-each select="ns2:abk_stav_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:abk_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var2_current/ns2:abk_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:abk_mnoz_text">
							<valueCodeableConcept>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</valueCodeableConcept>
						</xsl:for-each>
						<xsl:for-each select="ns2:abk_koment">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_aba">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_aba" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_aba">
			<xsl:variable name="var2_current" as="node()" select="."/>
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
								</system>
								<xsl:for-each select="ns2:aba_stav_kod">
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
								</xsl:for-each>
								<xsl:for-each select="ns2:aba_stav_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:aba_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var2_current/ns2:aba_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:aba_mnoz_text">
							<valueCodeableConcept>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</valueCodeableConcept>
						</xsl:for-each>
						<xsl:for-each select="ns2:aba_koment">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_sa">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_sa" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_sa">
			<xsl:variable name="var10_current" as="node()" select="."/>
			<xsl:variable name="var9_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var9_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var9_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<text>
								<xsl:attribute name="value" namespace="" select="'Sociální anamnéza'"/>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:sau_prac">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Pracovní zapojení'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sau_zajmy">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Koníčky'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sau_soc">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Sociální síť'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sav_vzdel">
							<xsl:variable name="var2_cur_as_string" as="xs:string" select="fn:string(.)"/>
							<component>
								<code>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-EducationLevel'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="$var2_cur_as_string"/>
										</code>
										<xsl:variable name="var1_resultof_vmf__inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf4_inputtoresult">
												<xsl:with-param name="input" select="$var2_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<display>
											<xsl:for-each select="$var1_resultof_vmf__inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</display>
									</coding>
								</code>
								<valueString>
									<xsl:for-each select="$var10_current/ns2:sav_koment">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sab_zpbydl_text">
							<component>
								<code>
									<xsl:for-each select="$var10_current/ns2:sab_zpbydl_kod">
										<xsl:variable name="var4_cur_as_string" as="xs:string" select="fn:string(.)"/>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWB.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="$var4_cur_as_string"/>
											</code>
											<xsl:variable name="var3_resultof_vmf__inputtoresult" as="xs:string?">
												<xsl:call-template name="vmf:vmf5_inputtoresult">
													<xsl:with-param name="input" select="$var4_cur_as_string" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<display>
												<xsl:for-each select="$var3_resultof_vmf__inputtoresult">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</display>
										</coding>
									</xsl:for-each>
									<text>
										<xsl:attribute name="value" namespace="" select="'Způsob bydlení'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sab_prizp_text">
							<component>
								<code>
									<xsl:for-each select="$var10_current/ns2:sab_prizp_kod">
										<xsl:variable name="var6_cur_as_string" as="xs:string" select="fn:string(.)"/>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWC.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="$var6_cur_as_string"/>
											</code>
											<xsl:variable name="var5_resultof_vmf__inputtoresult" as="xs:string?">
												<xsl:call-template name="vmf:vmf6_inputtoresult">
													<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<display>
												<xsl:for-each select="$var5_resultof_vmf__inputtoresult">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</display>
										</coding>
									</xsl:for-each>
									<text>
										<xsl:attribute name="value" namespace="" select="'Přizpůsobení domácnosti'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sab_bariery_text">
							<component>
								<code>
									<xsl:for-each select="$var10_current/ns2:sab_bariery_kod">
										<xsl:variable name="var8_cur_as_string" as="xs:string" select="fn:string(.)"/>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWD.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="$var8_cur_as_string"/>
											</code>
											<xsl:variable name="var7_resultof_vmf__inputtoresult" as="xs:string?">
												<xsl:call-template name="vmf:vmf7_inputtoresult">
													<xsl:with-param name="input" select="$var8_cur_as_string" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<display>
												<xsl:for-each select="$var7_resultof_vmf__inputtoresult">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</display>
										</coding>
									</xsl:for-each>
									<text>
										<xsl:attribute name="value" namespace="" select="'Bariéry'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_koment">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Rodinná situace'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_slozrod_text">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Složení rodiny'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_rodstav_text">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Rodinný stav'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_pocdet">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Počet dětí'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_pocdetd">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Počet dětí ve společné domácnosti'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_dite">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Podrobnosti o dítěti'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_pecezc">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Pečuje o závislého člena'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_FamilyMemberHistory">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_rao">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_rao" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_rao">
			<xsl:variable name="var4_current" as="node()" select="."/>
			<xsl:variable name="var3_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid">
					<xsl:for-each select="$var3_guid">
						<xsl:variable name="var1_resultof_FullURL_FamilyMemberHistory" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_FamilyMemberHistory">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_FamilyMemberHistory">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<FamilyMemberHistory>
						<xsl:for-each select="$var3_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<xsl:for-each select="$dat_prov">
								<lastUpdated>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(.)))"/>
								</lastUpdated>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/czh-familyMemberHistory-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'10157-6'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'completed'"/>
						</status>
						<xsl:for-each select="$patientReference">
							<patient>
								<xsl:sequence select="(./@node(), ./node())"/>
							</patient>
						</xsl:for-each>
						<xsl:for-each select="ns2:rao_vztah_kod">
							<relationship>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/ValueSet/v3-FamilyMember'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<xsl:for-each select="$var4_current/ns2:rao_vztah_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</relationship>
						</xsl:for-each>
						<xsl:for-each select="ns2:rao_dat_nar">
							<bornDate>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</bornDate>
						</xsl:for-each>
						<xsl:for-each select="ns2:rao_dat_um">
							<deceasedDate>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</deceasedDate>
						</xsl:for-each>
						<note>
							<xsl:for-each select="$practitionerReference">
								<authorReference>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</authorReference>
							</xsl:for-each>
						</note>
						<xsl:for-each select="ns2:rao_zdrprob_kod">
							<xsl:variable name="var2_https___dastacr_cz_dasta_hyper_as_string" as="xs:string" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
							<condition>
								<code>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="$var2_https___dastacr_cz_dasta_hyper_as_string"/>
										</system>
										<version>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</version>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</code>
								<xsl:for-each select="$var4_current/ns2:rao_duvum_kod">
									<outcome>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="$var2_https___dastacr_cz_dasta_hyper_as_string"/>
											</system>
											<version>
												<xsl:for-each select="ns2:kod_syst">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</version>
											<code>
												<xsl:for-each select="ns2:kod">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</code>
											<display>
												<xsl:for-each select="ns2:kod_text">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</display>
										</coding>
									</outcome>
								</xsl:for-each>
							</condition>
						</xsl:for-each>
					</FamilyMemberHistory>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_infc">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_infcType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_infcType">
			<xsl:variable name="var2_cur" as="node()" select="."/>
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-travel-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'82753-5'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:infc_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var2_cur/ns2:infc_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:infc_stat_kod">
							<valueCodeableConcept>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/valueset-iso3166-1-2.html'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<display>
										<xsl:for-each select="$var2_cur/ns2:infc_stat_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
								<xsl:for-each select="$var2_cur/ns2:infc_koment">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</valueCodeableConcept>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_inf">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_infType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_infType">
			<xsl:variable name="var2_cur" as="node()" select="."/>
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-infectious-contact-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-ParticipationType'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'EXPAGNT'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:inf_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var2_cur/ns2:inf_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:inf_stat_kod">
							<valueCodeableConcept>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/valueset-iso3166-1-2.html'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<display>
										<xsl:for-each select="$var2_cur/ns2:inf_stat_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</valueCodeableConcept>
						</xsl:for-each>
						<xsl:for-each select="ns2:inf_koment">
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Immunization">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_oc">
		<xsl:param name="Reference" select="()"/>
		<xsl:param name="anam_oc" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_oc">
			<xsl:variable name="var11_current" as="node()" select="."/>
			<xsl:for-each select="ns2:ocz">
				<xsl:variable name="var10_cur" as="node()" select="."/>
				<xsl:variable name="var8_guid" as="node()?" select="@guid"/>
				<xsl:variable name="var9_davka" as="node()*" select="ns2:davka"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var8_guid">
						<xsl:for-each select="$var8_guid">
							<xsl:variable name="var1_resultof_FullURL_Immunization" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_Immunization">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_FullURL_Immunization">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Immunization>
							<xsl:for-each select="$var8_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-immunization-hdr'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'11369-6'"/>
									</code>
								</tag>
							</meta>
							<xsl:for-each select="@id_ockovani">
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'ID očkování'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSALA.htm'))"/>
									</system>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="@id_ockovani_isin">
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'ID očkování dle ISIN'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.uzis.cz/'))"/>
									</system>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/@id_davka">
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'ID dávky očkování'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSALA.htm'))"/>
									</system>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/@id_davka_isin">
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'ID dávky dle ISIN'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.uzis.cz/'))"/>
									</system>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<status>
								<xsl:attribute name="value" namespace="" select="'completed'"/>
							</status>
							<vaccineCode>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSAHW.htm'))"/>
									</system>
									<xsl:for-each select="@typ_oc_kod">
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
									</xsl:for-each>
									<xsl:for-each select="@typ_oc_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
								<xsl:for-each select="$var9_davka">
									<xsl:variable name="var2_cur" as="node()" select="."/>
									<xsl:for-each select="@kod_ol">
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://www.sukl.cz'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<xsl:for-each select="$var2_cur/@nazev_ol">
												<display>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</display>
											</xsl:for-each>
										</coding>
									</xsl:for-each>
								</xsl:for-each>
								<xsl:for-each select="ns2:agens">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSAKM.htm'))"/>
										</system>
										<code>
											<xsl:for-each select="@agens_klic">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<xsl:for-each select="@agens_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
								<xsl:for-each select="$var9_davka/@pozn">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</vaccineCode>
							<xsl:for-each select="$Reference">
								<patient>
									<xsl:sequence select="(./@node(), ./node())"/>
								</patient>
							</xsl:for-each>
							<xsl:variable name="var3_test_resultof_any" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists(($var9_davka)[fn:exists(ns2:dat_du)])">
										<xsl:for-each select="$var9_davka/ns2:dat_du">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var3_test_resultof_any">
								<occurrenceDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</occurrenceDateTime>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/@nazev_vyrobce">
								<manufacturer>
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</manufacturer>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/@cis_sarze">
								<lotNumber>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</lotNumber>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/ns2:dat_expirace">
								<expirationDate>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</expirationDate>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka">
								<xsl:variable name="var4_cur" as="node()" select="."/>
								<xsl:for-each select="@misto_apl_klic">
									<site>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUU.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<xsl:for-each select="$var4_cur/@misto_apl_text">
												<display>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</display>
											</xsl:for-each>
										</coding>
									</site>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka">
								<xsl:variable name="var5_cur" as="node()" select="."/>
								<xsl:for-each select="@apl_cesta_klic">
									<route>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUT.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<xsl:for-each select="$var5_cur/@apl_cesta_text">
												<display>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</display>
											</xsl:for-each>
										</coding>
									</route>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<actor>
										<reference>
											<xsl:attribute name="value" namespace="" select="."/>
										</reference>
									</actor>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var11_current/ns2:oc_souhrn_text">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
							<xsl:for-each select="ns2:indikace">
								<reasonCode>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.uzis.cz/'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<xsl:for-each select="$var10_cur/@indikace_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</reasonCode>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/ns2:reakce">
								<xsl:variable name="var7_typ" as="node()?" select="@typ"/>
								<reaction>
									<date>
										<xsl:for-each select="ns2:dat_or">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</date>
									<detail>
										<type>
											<xsl:for-each select="$var7_typ">
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
											</xsl:for-each>
										</type>
										<display>
											<xsl:for-each select="$var7_typ">
												<xsl:variable name="var6_resultof_vmf__inputtoresult" as="xs:string?">
													<xsl:call-template name="vmf:vmf8_inputtoresult">
														<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:for-each select="$var6_resultof_vmf__inputtoresult">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</xsl:for-each>
										</display>
									</detail>
								</reaction>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka">
								<protocolApplied>
									<doseNumberPositiveInt>
										<xsl:for-each select="@cis_davky">
											<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
										</xsl:for-each>
									</doseNumberPositiveInt>
									<xsl:for-each select="@poc_davek">
										<seriesDosesString>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
										</seriesDosesString>
									</xsl:for-each>
								</protocolApplied>
							</xsl:for-each>
						</Immunization>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam">
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_anamType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var13_create_Reference_of_patientReference" as="node()*">
			<xsl:for-each select="$patientReference">
				<Reference xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</Reference>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var14_create_dat_prov_of_dat_prov" as="node()*">
			<xsl:for-each select="$dat_prov">
				<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</dat_prov>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1_resultof_ku_z_propz_anam_anam_prob" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_prob">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_probType" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_prob">
						<anam_probType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_probType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_ku_z_propz_anam_anam_prob">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var2_resultof_ku_z_propz_anam_anam_zpi" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_zpi">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_zpi" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_zpi">
						<anam_zpi xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_zpi>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var2_resultof_ku_z_propz_anam_anam_zpi">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var3_resultof_ku_z_propz_anam_anam_vyk" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_vyk">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_vyk" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_vyk">
						<anam_vyk xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_vyk>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var3_resultof_ku_z_propz_anam_anam_vyk">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var4_resultof_ku_z_propz_anam_anam_oc" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_oc">
				<xsl:with-param name="Reference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_oc" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_oc">
						<anam_oc xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_oc>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var4_resultof_ku_z_propz_anam_anam_oc">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var5_resultof_ku_z_propz_anam_anam_inf" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_inf">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_infType" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_inf">
						<anam_infType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_infType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var5_resultof_ku_z_propz_anam_anam_inf">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var6_resultof_ku_z_propz_anam_anam_infc" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_infc">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_infcType" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_infc">
						<anam_infcType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_infcType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var6_resultof_ku_z_propz_anam_anam_infc">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var7_resultof_ku_z_propz_anam_anam_rao" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_rao">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_rao" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_rao">
						<anam_rao xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_rao>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var7_resultof_ku_z_propz_anam_anam_rao">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var8_resultof_ku_z_propz_anam_anam_sa" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_sa">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_sa" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_sa">
						<anam_sa xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_sa>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var8_resultof_ku_z_propz_anam_anam_sa">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var9_resultof_ku_z_propz_anam_anam_aba" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_aba">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_aba" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_aba">
						<anam_aba xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_aba>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var9_resultof_ku_z_propz_anam_anam_aba">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var10_resultof_ku_z_propz_anam_anam_abk" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_abk">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_abk" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_abk">
						<anam_abk xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abk>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var10_resultof_ku_z_propz_anam_anam_abk">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var11_resultof_ku_z_propz_anam_anam_abd" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_abd">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_abd" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_abd">
						<anam_abd xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abd>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var11_resultof_ku_z_propz_anam_anam_abd">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var12_resultof_ku_z_propz_anam_anam_abj" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_abj">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_abj" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_abj">
						<anam_abj xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abj>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var12_resultof_ku_z_propz_anam_anam_abj">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Condition">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh_p">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubh_pType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$ku_z_propz_prubh_pType">
			<xsl:variable name="var9_cur" as="node()" select="."/>
			<xsl:variable name="var6_http___snomed_info_sct_as_string" as="xs:string" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
			<xsl:variable name="var7_prob_zav_kod" as="node()*" select="ns2:prob_zav_kod"/>
			<xsl:variable name="var8_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var8_guid">
					<xsl:for-each select="$var8_guid">
						<xsl:variable name="var1_resultof_FullURL_Condition" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Condition">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Condition">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Condition>
						<xsl:for-each select="$var8_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-condition-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'11450-4'"/>
								</code>
							</tag>
						</meta>
						<clinicalStatus>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-clinical'))"/>
								</system>
								<code>
									<xsl:for-each select="ns2:prob_klin">
										<xsl:variable name="var2_resultof_vmf__inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf9_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var2_resultof_vmf__inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</code>
							</coding>
						</clinicalStatus>
						<verificationStatus>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-ver-status'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'confirmed'"/>
								</code>
							</coding>
						</verificationStatus>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var6_http___snomed_info_sct_as_string"/>
								</system>
								<code>
									<xsl:for-each select="ns2:prob_kat_kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="ns2:prob_kat_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</category>
						<severity>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var6_http___snomed_info_sct_as_string"/>
								</system>
								<code>
									<xsl:for-each select="$var7_prob_zav_kod">
										<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf10_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="$var7_prob_zav_kod">
										<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf11_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</display>
							</coding>
						</severity>
						<xsl:for-each select="ns2:prob_kod">
							<xsl:variable name="var5_cur" as="node()" select="."/>
							<xsl:for-each select="ns2:kod_syst">
								<code>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
										</system>
										<code>
											<xsl:for-each select="$var5_cur/ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="$var5_cur/ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</code>
							</xsl:for-each>
						</xsl:for-each>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_dat_od">
							<onsetDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</onsetDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_dat_do">
							<abatementDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</abatementDateTime>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<recordedDate>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</recordedDate>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<recorder>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</recorder>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_stad_kod">
							<stage>
								<summary>
									<coding>
										<system>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
											</xsl:for-each>
										</system>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
									<xsl:for-each select="$var9_cur/ns2:prob_stad_text">
										<text>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</text>
									</xsl:for-each>
								</summary>
							</stage>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_popis">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_okol">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Condition>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_Observation">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('urn:uuid:', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh_v">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubh_vType" select="()"/>
		<xsl:for-each select="$ku_z_propz_prubh_vType">
			<xsl:variable name="var23_guid" as="node()?" select="@guid"/>
			<xsl:variable name="var22_create_value_of_nazev" as="node()*">
				<xsl:for-each select="ns2:nazev">
					<xsl:attribute name="value" select="fn:string(.)"/>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var21_let" as="node()+">
				<system xmlns="http://hl7.org/fhir">
					<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/WWAUI'))"/>
				</system>
				<code xmlns="http://hl7.org/fhir">
					<xsl:for-each select="ns2:typku">
						<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
					</xsl:for-each>
				</code>
			</xsl:variable>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var23_guid">
					<xsl:for-each select="$var23_guid">
						<xsl:variable name="var1_resultof_FullURL_Composition" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Composition">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Composition">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Composition>
						<meta>
							<versionId>
								<xsl:for-each select="@vguid">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</versionId>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
							</tag>
						</meta>
						<identifier>
							<value>
								<xsl:for-each select="ns2:idku">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</value>
						</identifier>
						<xsl:for-each select="ns2:vys_stav">
							<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf12_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<status>
								<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</status>
						</xsl:for-each>
						<type>
							<coding>
								<xsl:sequence select="$var21_let"/>
							</coding>
						</type>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<date>
							<xsl:for-each select="ns2:dat_vys">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</date>
						<author>
							<reference>
								<xsl:for-each select="ns2:pracovnik">
									<xsl:variable name="var4_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var3_cur" as="node()" select="."/>
										<xsl:for-each select="$var4_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('urn:uuid:', fn:string($var3_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
						</author>
						<title>
							<xsl:sequence select="$var22_create_value_of_nazev"/>
						</title>
						<custodian>
							<reference>
								<xsl:for-each select="ns2:pracoviste">
									<xsl:variable name="var8_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var7_cur" as="node()" select="."/>
										<xsl:variable name="var6_vguid" as="node()?" select="$var8_cur/@vguid"/>
										<xsl:for-each select="$var6_vguid">
											<xsl:for-each select="$var6_vguid">
												<xsl:variable name="var5_resultof_Reference_Organization" as="xs:string?">
													<xsl:call-template name="provisio:Reference_Organization">
														<xsl:with-param name="GUID" select="fn:string($var7_cur)" as="xs:string"/>
														<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:for-each select="$var5_resultof_Reference_Organization">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
						</custodian>
						<section>
							<title>
								<xsl:sequence select="$var22_create_value_of_nazev"/>
							</title>
							<code>
								<coding>
									<xsl:sequence select="$var21_let"/>
								</coding>
							</code>
							<entry>
								<reference>
									<xsl:for-each select="ns2:vys_v_snomed">
										<xsl:variable name="var12_cur" as="node()" select="."/>
										<xsl:for-each select="@guid">
											<xsl:variable name="var11_cur" as="node()" select="."/>
											<xsl:variable name="var10_vguid" as="node()?" select="$var12_cur/@vguid"/>
											<xsl:for-each select="$var10_vguid">
												<xsl:for-each select="$var10_vguid">
													<xsl:variable name="var9_resultof_Reference_Observation" as="xs:string?">
														<xsl:call-template name="provisio:Reference_Observation">
															<xsl:with-param name="GUID" select="fn:string($var11_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var9_resultof_Reference_Observation">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</entry>
							<entry>
								<reference>
									<xsl:for-each select="ns2:text_puvod">
										<xsl:variable name="var16_cur" as="node()" select="."/>
										<xsl:for-each select="@guid">
											<xsl:variable name="var15_cur" as="node()" select="."/>
											<xsl:variable name="var14_vguid" as="node()?" select="$var16_cur/@vguid"/>
											<xsl:for-each select="$var14_vguid">
												<xsl:for-each select="$var14_vguid">
													<xsl:variable name="var13_resultof_Reference_DocumentReference" as="xs:string?">
														<xsl:call-template name="provisio:Reference_DocumentReference">
															<xsl:with-param name="GUID" select="fn:string($var15_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var13_resultof_Reference_DocumentReference">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</entry>
							<entry>
								<reference>
									<xsl:for-each select="ns2:text_uprav">
										<xsl:variable name="var20_cur" as="node()" select="."/>
										<xsl:for-each select="@guid">
											<xsl:variable name="var19_cur" as="node()" select="."/>
											<xsl:variable name="var18_vguid" as="node()?" select="$var20_cur/@vguid"/>
											<xsl:for-each select="$var18_vguid">
												<xsl:for-each select="$var18_vguid">
													<xsl:variable name="var17_resultof_Reference_DocumentReference" as="xs:string?">
														<xsl:call-template name="provisio:Reference_DocumentReference">
															<xsl:with-param name="GUID" select="fn:string($var19_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var17_resultof_Reference_DocumentReference">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</entry>
						</section>
					</Composition>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var25_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:text_puvod">
				<xsl:variable name="var24_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var25_cur/@node(), $var25_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'30954-2'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var24_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var27_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:text_uprav">
				<xsl:variable name="var26_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var27_cur/@node(), $var27_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'30954-2'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var26_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:vys_v_snomed">
			<xsl:variable name="var28_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var28_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var29_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var29_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh_s">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubh_sType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$ku_z_propz_prubh_sType/ns2:ks_popis">
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/R4/observation.html'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_prubh_sType/ns2:ks_duv_prub_h">
			<xsl:variable name="var3_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid">
					<xsl:for-each select="$var3_guid">
						<xsl:variable name="var2_resultof_FullURL_DiagnosticReport" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_DiagnosticReport">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var2_resultof_FullURL_DiagnosticReport">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<DiagnosticReport>
						<xsl:for-each select="$var3_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/R4/diagnosticreport.html'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
					</DiagnosticReport>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_prubh_sType/ns2:ks_klin_uvaha">
			<xsl:variable name="var5_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var5_guid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var4_resultof_FullURL_DiagnosticReport" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_DiagnosticReport">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var4_resultof_FullURL_DiagnosticReport">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<DiagnosticReport>
						<xsl:for-each select="$var5_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/R4/diagnosticreport.html'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
					</DiagnosticReport>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh_d">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubh_dType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$ku_z_propz_prubh_dType">
			<xsl:variable name="var5_cur" as="node()" select="."/>
			<xsl:variable name="var3_dat_prov_vykd" as="node()*" select="ns2:dat_prov_vykd"/>
			<xsl:variable name="var4_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var4_guid">
					<xsl:for-each select="$var4_guid">
						<xsl:variable name="var1_resultof_FullURL_Procedure" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Procedure">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Procedure">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Procedure>
						<xsl:for-each select="$var4_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-procedure-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'10185-7'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'completed'"/>
						</status>
						<code>
							<coding>
								<code>
									<xsl:attribute name="value" namespace="" select="'442083009'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Anatomical or acquired body structure'"/>
								</display>
							</coding>
							<text>
								<xsl:for-each select="ns2:vykd_lokal">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:variable name="var2_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($var3_dat_prov_vykd)">
									<xsl:for-each select="$var3_dat_prov_vykd">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var2_test_resultof_exists">
							<performedDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</performedDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<actor>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</actor>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:vykd_duv_kod">
							<reasonCode>
								<coding>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<display>
										<xsl:for-each select="$var5_cur/ns2:vykd_duv_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</reasonCode>
						</xsl:for-each>
						<note>
							<text>
								<xsl:for-each select="ns2:vykd_popis">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
						</note>
					</Procedure>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Device">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_DeviceUseStatement">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_zpi">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_zpi" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_zpi">
			<xsl:variable name="var7_current" as="node()" select="."/>
			<xsl:for-each select="ns2:uniz">
				<xsl:variable name="var6_cur" as="node()" select="."/>
				<xsl:variable name="var4_dat_ab" as="node()?" select="@dat_ab"/>
				<xsl:variable name="var5_guid" as="node()?" select="@guid"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var5_guid">
						<xsl:for-each select="$var5_guid">
							<xsl:variable name="var1_resultof_FullURL_DeviceUseStatement" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_DeviceUseStatement">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_FullURL_DeviceUseStatement">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<DeviceUseStatement>
							<xsl:for-each select="$var5_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<xsl:variable name="var2_test_resultof_exists" as="xs:string*">
									<xsl:choose>
										<xsl:when test="fn:exists($var4_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var4_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$dat_prov">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<xsl:for-each select="$var2_test_resultof_exists">
									<lastUpdated>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(.))"/>
									</lastUpdated>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.eu/fhir/hdr/StructureDefinition/deviceUseStatement-eu-hdr'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'46264-8'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:for-each select="@typ">
									<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf13_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</status>
							<xsl:for-each select="$patientReference">
								<subject>
									<xsl:sequence select="(./@node(), ./node())"/>
								</subject>
							</xsl:for-each>
							<xsl:for-each select="ns2:dat_du">
								<timingPeriod>
									<start>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</start>
									<xsl:for-each select="$var6_cur/ns2:dat_up">
										<end>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</end>
									</xsl:for-each>
								</timingPeriod>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<source>
									<display>
										<xsl:attribute name="value" namespace="" select="."/>
									</display>
								</source>
							</xsl:for-each>
							<device>
								<reference>
									<xsl:for-each select="ns2:unizf/@guid">
										<xsl:attribute name="value" namespace="" select="fn:concat('Device/', fn:string(.))"/>
									</xsl:for-each>
								</reference>
							</device>
							<xsl:for-each select="ns2:duvod_text">
								<reasonCode>
									<xsl:for-each select="$var6_cur/ns2:duvod_kod">
										<coding>
											<system>
												<xsl:for-each select="ns2:kod_syst">
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</xsl:for-each>
											</system>
											<code>
												<xsl:for-each select="ns2:kod">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</code>
											<display>
												<xsl:for-each select="ns2:kod_text">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</display>
										</coding>
									</xsl:for-each>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</reasonCode>
							</xsl:for-each>
							<xsl:for-each select="ns2:u_niz">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
							<xsl:for-each select="$var7_current/ns2:zpi_souhrn_text">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
						</DeviceUseStatement>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$anam_zpi/ns2:uniz">
			<xsl:variable name="var13_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:unizf">
				<xsl:variable name="var11_guid" as="node()?" select="@guid"/>
				<xsl:variable name="var12_dat_ab" as="node()?" select="$var13_cur/@dat_ab"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var11_guid">
						<xsl:for-each select="$var11_guid">
							<xsl:variable name="var8_resultof_FullURL_Device" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_Device">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var8_resultof_FullURL_Device">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Device>
							<xsl:for-each select="$var11_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<xsl:variable name="var9_test_resultof_exists" as="xs:string*">
									<xsl:choose>
										<xsl:when test="fn:exists($var12_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var12_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$dat_prov">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<xsl:for-each select="$var9_test_resultof_exists">
									<lastUpdated>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(.))"/>
									</lastUpdated>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/core/StructureDefinition/cz-medical-device'))"/>
								</profile>
							</meta>
							<status>
								<xsl:for-each select="$var13_cur/@typ">
									<xsl:variable name="var10_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf13_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var10_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</status>
							<xsl:for-each select="@niz_ident">
								<modelNumber>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</modelNumber>
							</xsl:for-each>
							<type>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
									</system>
									<code>
										<xsl:for-each select="@niz_klic">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="@niz_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
								<xsl:for-each select="@info_text">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</type>
						</Device>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Procedure">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_vyk">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_vyk" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_vyk">
			<xsl:variable name="var10_current" as="node()" select="."/>
			<xsl:for-each select="ns2:chv">
				<xsl:variable name="var9_cur" as="node()" select="."/>
				<xsl:variable name="var7_dat_vyk" as="node()*" select="ns2:dat_vyk"/>
				<xsl:variable name="var8_guid" as="node()?" select="@guid"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var8_guid">
						<xsl:for-each select="$var8_guid">
							<xsl:variable name="var1_resultof_FullURL_Procedure" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_Procedure">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_FullURL_Procedure">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Procedure>
							<xsl:for-each select="$var8_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-procedure-hdr'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'47519-4'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'completed'"/>
							</status>
							<code>
								<xsl:for-each select="@chvps_klic">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<xsl:for-each select="$var9_cur/@chvps_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
								<xsl:for-each select="ns2:alv_text">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</code>
							<xsl:for-each select="$patientReference">
								<subject>
									<xsl:sequence select="(./@node(), ./node())"/>
								</subject>
							</xsl:for-each>
							<xsl:variable name="var3_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($var7_dat_vyk)">
										<xsl:for-each select="$var7_dat_vyk">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var2_dat_ab" as="node()?" select="@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var2_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var2_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$dat_prov">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var3_test_resultof_exists">
								<performedDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</performedDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<actor>
										<reference>
											<xsl:attribute name="value" namespace="" select="."/>
										</reference>
									</actor>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="ns2:duvod_kod">
								<reasonCode>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/sid/icd-10'))"/>
										</system>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
									<xsl:for-each select="$var9_cur/ns2:duvod_text">
										<text>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</text>
									</xsl:for-each>
								</reasonCode>
							</xsl:for-each>
							<xsl:for-each select="ns2:alv_form">
								<bodySite>
									<xsl:for-each select="ns2:ptext">
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
											</system>
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</coding>
									</xsl:for-each>
								</bodySite>
							</xsl:for-each>
							<xsl:for-each select="ns2:vysledek">
								<xsl:variable name="var6_cur_as_string" as="xs:string" select="fn:string(.)"/>
								<outcome>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
										</system>
										<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf14_inputtoresult">
												<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<code>
											<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</code>
										<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf15_inputtoresult">
												<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<display>
											<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</display>
									</coding>
								</outcome>
							</xsl:for-each>
							<xsl:for-each select="ns2:komplikace">
								<complication>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/sid/icd-10'))"/>
										</system>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</complication>
							</xsl:for-each>
							<note>
								<xsl:for-each select="$var10_current/ns2:vyk_souhrn_text">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</note>
						</Procedure>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh">
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubhType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var8_create_Reference_of_patientReference" as="node()*">
			<xsl:for-each select="$patientReference">
				<Reference xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</Reference>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var9_create_dat_prov_of_dat_prov" as="node()*">
			<xsl:for-each select="$dat_prov">
				<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</dat_prov>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1_resultof_ku_z_propz_prubh_p" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_p">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="ku_z_propz_prubh_pType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:ku_z_propz_prubh_p">
						<ku_z_propz_prubh_pType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_prubh_pType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_ku_z_propz_prubh_p">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var2_resultof_ku_z_propz_anam_anam_vyk" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_vyk">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_vyk" as="node()">
					<anam_vyk xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:for-each select="$ku_z_propz_prubhType/ns2:chv">
							<chv>
								<xsl:sequence select="(./@node(), ./node())"/>
							</chv>
						</xsl:for-each>
					</anam_vyk>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var2_resultof_ku_z_propz_anam_anam_vyk">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var3_resultof_ku_z_propz_anam_anam_zpi" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_zpi">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_zpi" as="node()">
					<anam_zpi xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:for-each select="$ku_z_propz_prubhType/ns2:uniz">
							<uniz>
								<xsl:sequence select="(./@node(), ./node())"/>
							</uniz>
						</xsl:for-each>
					</anam_zpi>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var3_resultof_ku_z_propz_anam_anam_zpi">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var4_resultof_ku_z_propz_prubh_d" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_d">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="ku_z_propz_prubh_dType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:ku_z_propz_prubh_d">
						<ku_z_propz_prubh_dType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_prubh_dType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var4_resultof_ku_z_propz_prubh_d">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var5_resultof_ku_z_propz_prubh_le" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_le">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="leType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:le">
						<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</leType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var5_resultof_ku_z_propz_prubh_le">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var6_resultof_ku_z_propz_prubh_v" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_v">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="ku_z_propz_prubh_vType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:ku_z_propz_prubh_v">
						<ku_z_propz_prubh_vType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_prubh_vType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var6_resultof_ku_z_propz_prubh_v">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var7_resultof_ku_z_propz_prubh_s" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_s">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="ku_z_propz_prubh_sType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:ku_z_propz_prubh_s">
						<ku_z_propz_prubh_sType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_prubh_sType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var7_resultof_ku_z_propz_prubh_s">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_sprij_h">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="hType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:for-each select="$hType/@vyska">
			<xsl:variable name="var3_guid_vyska" as="node()?" select="$hType/@guid_vyska"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid_vyska">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var3_guid_vyska">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_vyska">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-height-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8302-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Body height'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var2_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var1_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var1_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var1_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var2_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
						<xsl:for-each select="$hType/ns2:pozn">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@hmotnost">
			<xsl:variable name="var6_guid_hmotnost" as="node()?" select="$hType/@guid_hmotnost"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var6_guid_hmotnost">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var6_guid_hmotnost">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_hmotnost">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-weight-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'29463-7'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Body weight'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var5_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var4_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var4_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var4_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var5_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:decimal(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'kg'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'kg'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@bmi">
			<xsl:variable name="var9_guid_bmi" as="node()?" select="$hType/@guid_bmi"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var9_guid_bmi">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var9_guid_bmi">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_bmi">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-BMI-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'39156-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Body mass index (BMI) [Ratio]'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var8_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var7_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var7_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var7_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var8_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:decimal(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'kg/m2'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'kg/m2'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@o_hlava">
			<xsl:variable name="var12_guid_o_hlava" as="node()?" select="$hType/@guid_o_hlava"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var12_guid_o_hlava">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var12_guid_o_hlava">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_o_hlava">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-headCircumference-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8287-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Head Occipital-frontal circumference by Tape measure'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var11_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var10_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var10_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var10_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var11_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@o_hrudnik">
			<xsl:variable name="var15_guid_o_hrudnik" as="node()?" select="$hType/@guid_o_hrudnik"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var15_guid_o_hrudnik">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var15_guid_o_hrudnik">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_o_hrudnik">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-chestCircumference-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8280-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Waist Circumference at umbilicus by Tape measure'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var14_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var13_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var13_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var13_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var14_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@o_pas">
			<xsl:variable name="var18_guid_o_pas" as="node()?" select="$hType/@guid_o_pas"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var18_guid_o_pas">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var18_guid_o_pas">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_o_pas">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-observation-abdominalCircumference-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'56086-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Adult Waist Circumference Protocol'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var17_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var16_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var16_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var16_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var17_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_sprij_fyznal">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="fyznalType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var5_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var3_http___loinc_org_as_string" as="xs:string" select="xs:string(xs:anyURI('http://loinc.org'))"/>
				<xsl:variable name="var4_guid_tk" as="node()?" select="$var5_cur/@guid_tk"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var4_guid_tk">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var4_guid_tk">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var5_cur/@vguid_tk">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/bp'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="$var3_http___loinc_org_as_string"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'85354-9'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Blood pressure panel with all children optional'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var2_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var1_dat_ab" as="node()?" select="$var5_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var1_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var1_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var5_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var2_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var5_cur/ns2:pozn">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
							<xsl:for-each select="$var5_cur/ns2:tk_syst">
								<component>
									<code>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="$var3_http___loinc_org_as_string"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="'8480-6'"/>
											</code>
											<display>
												<xsl:attribute name="value" namespace="" select="'Systolic blood pressure'"/>
											</display>
										</coding>
									</code>
									<valueQuantity>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</value>
										<unit>
											<xsl:attribute name="value" namespace="" select="'mmHg'"/>
										</unit>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="'mm[Hg]'"/>
										</code>
									</valueQuantity>
								</component>
							</xsl:for-each>
							<xsl:for-each select="$var5_cur/ns2:tk_diast">
								<component>
									<code>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="$var3_http___loinc_org_as_string"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="'8462-4'"/>
											</code>
											<display>
												<xsl:attribute name="value" namespace="" select="'Diastolic blood pressure'"/>
											</display>
										</coding>
									</code>
									<valueQuantity>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</value>
										<unit>
											<xsl:attribute name="value" namespace="" select="'mmHg'"/>
										</unit>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="'mm[Hg]'"/>
										</code>
									</valueQuantity>
								</component>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var9_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var8_guid_pulz" as="node()?" select="$var9_cur/@guid_pulz"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var8_guid_pulz">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var8_guid_pulz">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var9_cur/@vguid_pulz">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/heartrate'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'8867-4'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Heart rate'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var7_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var6_dat_ab" as="node()?" select="$var9_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var6_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var6_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var9_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var7_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var9_cur/ns2:pulz">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var13_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var12_guid_o_sat" as="node()?" select="$var13_cur/@guid_o2sat"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var12_guid_o_sat">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var12_guid_o_sat">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var13_cur/@vguid_o2sat">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/oxygensat'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'2708-6'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Oxygen saturation in Arterial blood'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var11_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var10_dat_ab" as="node()?" select="$var13_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var10_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var10_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var13_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var11_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var13_cur/ns2:o2sat">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'%'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'%'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var17_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var16_guid_dech" as="node()?" select="$var17_cur/@guid_dech"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var16_guid_dech">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var16_guid_dech">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var17_cur/@vguid_dech">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/resprate'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'9279-1'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Respiratory rate'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var15_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var14_dat_ab" as="node()?" select="$var17_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var14_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var14_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var17_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var15_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var17_cur/ns2:dech">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var21_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var20_guid_teplota" as="node()?" select="$var21_cur/@guid_teplota"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var20_guid_teplota">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var20_guid_teplota">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var21_cur/@vguid_teplota">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/bodytemp'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'8310-5'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Body temperature'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var19_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var18_dat_ab" as="node()?" select="$var21_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var18_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var18_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var21_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var19_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var21_cur/ns2:teplota">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'°C'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'Cel'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_sprXX_-_vys_fs_form">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="vys_fs_form" select="()"/>
		<xsl:for-each select="$vys_fs_form/ns2:vys_fo_text">
			<xsl:variable name="var1_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$vys_fs_form/ns2:vys_fo_popis">
			<xsl:variable name="var2_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var2_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$vys_fs_form/ns2:vys_fo_form">
			<xsl:variable name="var3_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var3_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:vys_v_snomed">
		<xsl:param name="vys_v_snomed" select="()"/>
		<xsl:variable name="var13_vysl_pracovnik" as="node()*" select="$vys_v_snomed/ns2:vysl_pracovnik"/>
		<xsl:variable name="var14_vysl_typ" as="node()*" select="$vys_v_snomed/ns2:vysl_typ"/>
		<xsl:variable name="var15_guid" as="node()?" select="$vys_v_snomed/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var15_guid">
				<fullUrl>
					<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('urn:uuid:', fn:string(.))))"/>
				</fullUrl>
			</xsl:for-each>
			<resource>
				<Observation>
					<id>
						<xsl:for-each select="$var15_guid">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</id>
					<xsl:for-each select="$vys_v_snomed/@vguid">
						<meta>
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
					</xsl:for-each>
					<status>
						<xsl:for-each select="$vys_v_snomed/ns2:stav">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</status>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
							</system>
							<code>
								<xsl:for-each select="$vys_v_snomed/ns2:kod">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
						</coding>
					</code>
					<effectiveDateTime>
						<xsl:for-each select="$vys_v_snomed/ns2:dat_vysetreni">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</effectiveDateTime>
					<xsl:for-each select="$vys_v_snomed/ns2:dat_vydani">
						<issued>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(.)))"/>
						</issued>
					</xsl:for-each>
					<xsl:for-each select="$var13_vysl_pracovnik">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="ns2:prijmeni">
							<performer>
								<reference>
									<xsl:for-each select="$var2_cur/@guid">
										<xsl:variable name="var1_cur" as="node()" select="."/>
										<xsl:for-each select="$var2_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('urn:uuid:', fn:string($var1_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</performer>
						</xsl:for-each>
					</xsl:for-each>
					<xsl:variable name="var4_resultof_filter" as="node()*">
						<xsl:for-each select="$var14_vysl_typ">
							<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:boolean">
								<xsl:call-template name="vmf:vmf16_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:if test="$var3_resultof_vmf___inputtoresult">
								<xsl:sequence select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:variable>
					<xsl:for-each select="($var4_resultof_filter)[fn:exists($vys_v_snomed/ns2:vysl_hodnota)]">
						<valueQuantity>
							<xsl:variable name="var5_cur_of_vysl_hodnota" as="xs:string*">
								<xsl:for-each select="$vys_v_snomed/ns2:vysl_hodnota">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:variable>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(fn:string-join(for $x in $var5_cur_of_vysl_hodnota return xs:string($x), ' '))"/>
							</value>
							<xsl:for-each select="$vys_v_snomed/ns2:vysl_jednotka">
								<unit>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</unit>
							</xsl:for-each>
						</valueQuantity>
					</xsl:for-each>
					<xsl:variable name="var7_resultof_filter" as="node()*">
						<xsl:for-each select="$var14_vysl_typ">
							<xsl:variable name="var6_resultof_vmf___inputtoresult" as="xs:boolean">
								<xsl:call-template name="vmf:vmf17_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:if test="$var6_resultof_vmf___inputtoresult">
								<xsl:sequence select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:variable>
					<xsl:for-each select="($var7_resultof_filter)[fn:exists($vys_v_snomed/ns2:vysl_hodnota)]">
						<xsl:variable name="var8_cur_of_vysl_hodnota" as="xs:string*">
							<xsl:for-each select="$vys_v_snomed/ns2:vysl_hodnota">
								<xsl:sequence select="fn:string(.)"/>
							</xsl:for-each>
						</xsl:variable>
						<valueCodeableConcept>
							<coding>
								<code>
									<xsl:attribute name="value" namespace="" select="xs:string(fn:string-join(for $x in $var8_cur_of_vysl_hodnota return xs:string($x), ' '))"/>
								</code>
							</coding>
						</valueCodeableConcept>
					</xsl:for-each>
					<xsl:variable name="var10_resultof_filter" as="node()*">
						<xsl:for-each select="$var14_vysl_typ">
							<xsl:variable name="var9_resultof_vmf___inputtoresult" as="xs:boolean">
								<xsl:call-template name="vmf:vmf18_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:if test="$var9_resultof_vmf___inputtoresult">
								<xsl:sequence select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:variable>
					<xsl:for-each select="($var10_resultof_filter)[fn:exists($vys_v_snomed/ns2:vysl_hodnota)]">
						<xsl:variable name="var11_cur_of_vysl_hodnota" as="xs:string*">
							<xsl:for-each select="$vys_v_snomed/ns2:vysl_hodnota">
								<xsl:sequence select="fn:string(.)"/>
							</xsl:for-each>
						</xsl:variable>
						<valueString>
							<xsl:attribute name="value" namespace="" select="xs:string(fn:string-join(for $x in $var11_cur_of_vysl_hodnota return xs:string($x), ' '))"/>
						</valueString>
					</xsl:for-each>
					<xsl:for-each select="$vys_v_snomed/ns2:vysl_pozn">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
					<xsl:for-each select="$vys_v_snomed/ns2:vysl_interpret">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
					<xsl:for-each select="$vys_v_snomed/ns2:vysl_rm_d">
						<referenceRange>
							<low>
								<value>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</value>
							</low>
							<xsl:for-each select="$vys_v_snomed/ns2:vysl_rm_h">
								<high>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</high>
							</xsl:for-each>
						</referenceRange>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
		<xsl:variable name="var12_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$var13_vysl_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()*">
					<xsl:for-each select="$vys_v_snomed/ns2:vysl_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var12_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_sprop">
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_spropType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$ku_z_propz_spropType/@guid">
				<xsl:variable name="var1_resultof_FullURL_Encounter" as="xs:string?">
					<xsl:call-template name="provisio:FullURL_Encounter">
						<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var1_resultof_FullURL_Encounter">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
					</fullUrl>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Encounter>
					<id>
						<xsl:for-each select="$ku_z_propz_spropType/@guid">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</id>
					<meta>
						<versionId>
							<xsl:for-each select="$ku_z_propz_spropType/@vguid">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</versionId>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'67852-4'"/>
							</code>
						</tag>
					</meta>
					<xsl:for-each select="$ku_z_propz_spropType/ns2:poznamka">
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'additional'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
								<xsl:sequence select="fn:string(.)"/>
							</xhtml:div>
						</text>
					</xsl:for-each>
					<status>
						<xsl:attribute name="value" namespace="" select="'in-progress'"/>
					</status>
					<class>
						<system>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-ActCode'))"/>
						</system>
						<code>
							<xsl:attribute name="value" namespace="" select="'IMP'"/>
						</code>
						<display>
							<xsl:attribute name="value" namespace="" select="'inpatient encounter'"/>
						</display>
					</class>
					<xsl:for-each select="$patientReference">
						<subject>
							<xsl:sequence select="(./@node(), ./node())"/>
						</subject>
					</xsl:for-each>
					<xsl:for-each select="$ku_z_propz_spropType/ns2:prij_pracovnik">
						<xsl:variable name="var9_cur" as="node()" select="."/>
						<xsl:variable name="var8_guid" as="node()?" select="@guid"/>
						<participant>
							<individual>
								<reference>
									<xsl:for-each select="$var8_guid">
										<xsl:variable name="var4_vguid" as="node()?" select="$var9_cur/@vguid"/>
										<xsl:for-each select="$var4_vguid">
											<xsl:for-each select="$var8_guid">
												<xsl:variable name="var3_cur" as="node()" select="."/>
												<xsl:for-each select="$var4_vguid">
													<xsl:variable name="var2_resultof_Reference_Practitioner" as="xs:string?">
														<xsl:call-template name="provisio:Reference_Practitioner">
															<xsl:with-param name="GUID" select="fn:string($var3_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var2_resultof_Reference_Practitioner">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:for-each select="ns2:titul_pred">
										<xsl:variable name="var7_cur" as="node()" select="."/>
										<xsl:for-each select="$var9_cur/ns2:jmeno">
											<xsl:variable name="var6_cur" as="node()" select="."/>
											<xsl:for-each select="$var9_cur/ns2:prijmeni">
												<xsl:variable name="var5_cur" as="node()" select="."/>
												<xsl:for-each select="$var9_cur/ns2:titul_za">
													<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat(fn:concat(fn:concat(fn:concat(fn:string($var7_cur), ' '), fn:string($var6_cur)), ' '), fn:string($var5_cur)), ' '), fn:string(.))"/>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</display>
							</individual>
						</participant>
					</xsl:for-each>
					<period>
						<start>
							<xsl:for-each select="$ku_z_propz_spropType/ns2:dat_vys_prij">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</start>
					</period>
				</Encounter>
			</resource>
		</entry>
		<xsl:variable name="var10_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:prij_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var10_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var12_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_a_text">
				<xsl:variable name="var11_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var12_cur/@node(), $var12_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'8716-3'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var11_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var14_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:h">
				<xsl:variable name="var13_resultof_ku_z_propz_sprij_h" as="node()*">
					<xsl:call-template name="provisio:ku_z_propz_sprij_h">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var14_cur/@node(), $var14_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="hType" as="node()">
							<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</hType>
						</xsl:with-param>
						<xsl:with-param name="dat_prov" as="node()*">
							<xsl:for-each select="$dat_prov">
								<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</dat_prov>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
						<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var13_resultof_ku_z_propz_sprij_h">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_a_param/ns2:vys_v_snomed">
			<xsl:variable name="var15_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var15_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var16_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_a_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var16_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var18_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_f_text">
				<xsl:variable name="var17_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var18_cur/@node(), $var18_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'8716-3'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var17_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var19_resultof_ku_z_propz_sprij_fyznal" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_sprij_fyznal">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="(./@node(), ./node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="fyznalType" as="node()*">
						<xsl:for-each select="$ku_z_propz_spropType/ns2:fyznal">
							<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</fyznalType>
						</xsl:for-each>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" as="node()*">
						<xsl:for-each select="$dat_prov">
							<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</dat_prov>
						</xsl:for-each>
					</xsl:with-param>
					<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
					<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var19_resultof_ku_z_propz_sprij_fyznal">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_f_param/ns2:vys_v_snomed">
			<xsl:variable name="var20_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var20_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var21_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_f_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var21_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var23_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_s_text">
				<xsl:variable name="var22_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var23_cur/@node(), $var23_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'55286-9'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var22_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var24_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_s_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var24_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var26_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_fs_text">
				<xsl:variable name="var25_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var26_cur/@node(), $var26_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var25_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var27_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_fs_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var27_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var29_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_fs_form">
				<xsl:variable name="var28_resultof_ku_z_propz_sprXX___vys_fs_form" as="node()*">
					<xsl:call-template name="provisio:ku_z_propz_sprXX_-_vys_fs_form">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var29_cur/@node(), $var29_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="vys_fs_form" as="node()">
							<vys_fs_form xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</vys_fs_form>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var28_resultof_ku_z_propz_sprXX___vys_fs_form">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_CarePlan">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_MedicationAdministration">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh_le">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="leType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$leType">
			<xsl:variable name="var13_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:lez">
				<xsl:variable name="var12_cur" as="node()" select="."/>
				<xsl:variable name="var9_dat_ab" as="node()?" select="$var13_cur/@dat_ab"/>
				<xsl:variable name="var10_kod_atc" as="node()?" select="@kod_atc"/>
				<xsl:variable name="var11_guid" as="node()?" select="@guid"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var11_guid">
						<xsl:for-each select="$var11_guid">
							<xsl:variable name="var1_resultof_FullURL_MedicationAdministration" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_MedicationAdministration">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_FullURL_MedicationAdministration">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<MedicationAdministration>
							<xsl:for-each select="$var11_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'10160-0'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:for-each select="@ind_oprav_sd">
									<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf19_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</status>
							<xsl:for-each select="ns2:zmena_m_kod">
								<statusReason>
									<coding>
										<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf20_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<code>
											<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="$var12_cur/ns2:zmena_m_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</statusReason>
							</xsl:for-each>
							<category>
								<xsl:for-each select="@typ_med">
									<xsl:variable name="var6_cur_as_string" as="xs:string" select="fn:string(.)"/>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/medication-admin-category'))"/>
										</system>
										<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf21_inputtoresult">
												<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<code>
											<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</code>
										<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf22_inputtoresult">
												<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<display>
											<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</display>
									</coding>
								</xsl:for-each>
							</category>
							<medicationCodeableConcept>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://www.snomed.org/'))"/>
									</system>
									<code>
										<xsl:for-each select="@kod_lek">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="@nazev_lek">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
								<xsl:variable name="var7_test_resultof_exists" as="xs:string*">
									<xsl:choose>
										<xsl:when test="fn:exists($var10_kod_atc)">
											<xsl:sequence select="fn:string($var10_kod_atc)"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="ns2:aktivni_latka/@kod_atc">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<xsl:for-each select="$var7_test_resultof_exists">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://www.whocc.no/atc/'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="."/>
										</code>
										<xsl:for-each select="$var12_cur/ns2:aktivni_latka/@nazev">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
								<xsl:for-each select="@gene_lek">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</medicationCodeableConcept>
							<xsl:for-each select="$patientReference">
								<subject>
									<xsl:sequence select="(./@node(), ./node())"/>
								</subject>
							</xsl:for-each>
							<xsl:variable name="var8_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($var9_dat_ab)">
										<xsl:sequence select="xs:string(xs:dateTime(fn:string($var9_dat_ab)))"/>
									</xsl:when>
									<xsl:otherwise>
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var8_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="ns2:dat_od">
								<effectivePeriod>
									<start>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</start>
									<xsl:for-each select="$var12_cur/ns2:dat_do">
										<end>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</end>
									</xsl:for-each>
								</effectivePeriod>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<actor>
										<reference>
											<xsl:attribute name="value" namespace="" select="."/>
										</reference>
									</actor>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="ns2:ind_m_kod">
								<reasonCode>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
										</system>
										<version>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</version>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
									<xsl:for-each select="$var12_cur/ns2:ind_m_text">
										<text>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</text>
									</xsl:for-each>
								</reasonCode>
							</xsl:for-each>
							<xsl:for-each select="ns2:pozn">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
							<xsl:for-each select="ns2:rozpis_v">
								<dosage>
									<xsl:for-each select="$var12_cur/@misto_apl_klic">
										<site>
											<coding>
												<system>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUU.htm'))"/>
												</system>
												<code>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</code>
												<display>
													<xsl:for-each select="$var12_cur/@misto_apl_text">
														<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
													</xsl:for-each>
												</display>
											</coding>
										</site>
									</xsl:for-each>
									<xsl:for-each select="$var12_cur/@apl_cesta_klic">
										<route>
											<coding>
												<system>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUT.htm'))"/>
												</system>
												<code>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</code>
												<display>
													<xsl:for-each select="$var12_cur/@apl_cesta_text">
														<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
													</xsl:for-each>
												</display>
											</coding>
										</route>
									</xsl:for-each>
									<xsl:for-each select="$var12_cur/@forma_klic">
										<method>
											<coding>
												<system>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBRW.htm'))"/>
												</system>
												<code>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</code>
												<display>
													<xsl:for-each select="$var12_cur/@forma_text">
														<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
													</xsl:for-each>
												</display>
											</coding>
										</method>
									</xsl:for-each>
									<dose>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</value>
									</dose>
								</dosage>
							</xsl:for-each>
						</MedicationAdministration>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_dopor">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="ku_z_propz_doporType" select="()"/>
		<xsl:for-each select="$ku_z_propz_doporType">
			<xsl:variable name="var4_cur" as="node()" select="."/>
			<xsl:variable name="var2_pp_aktivita" as="node()*" select="ns2:pp_aktivita"/>
			<xsl:variable name="var3_pp_nemstav" as="node()*" select="ns2:pp_nemstav"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_pp_nemstav/@guid">
					<xsl:variable name="var1_resultof_FullURL_CarePlan" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_CarePlan">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_CarePlan">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<CarePlan>
						<id>
							<xsl:for-each select="$var3_pp_nemstav/@guid">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</id>
						<meta>
							<xsl:for-each select="$var3_pp_nemstav/@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-carePlan-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'18776-5'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'completed'"/>
						</status>
						<intent>
							<xsl:attribute name="value" namespace="" select="'plan'"/>
						</intent>
						<xsl:for-each select="$var3_pp_nemstav">
							<category>
								<coding>
									<system>
										<xsl:for-each select="ns2:kod_syst">
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
										</xsl:for-each>
									</system>
									<code>
										<xsl:for-each select="ns2:kod">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="ns2:kod_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</category>
						</xsl:for-each>
						<xsl:for-each select="ns2:pp_nazev">
							<title>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</title>
						</xsl:for-each>
						<xsl:for-each select="ns2:popis_dopor">
							<description>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</description>
						</xsl:for-each>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="ns2:ppo_dat_od">
							<period>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var4_cur/ns2:ppo_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</period>
						</xsl:for-each>
						<created>
							<xsl:for-each select="$dat_prov">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</created>
						<xsl:for-each select="$practitionerReference">
							<author>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</author>
						</xsl:for-each>
						<activity>
							<detail>
								<kind>
									<xsl:for-each select="$var2_pp_aktivita/ns2:aktivita_typ/ns2:ptext">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</kind>
								<status>
									<xsl:attribute name="value" namespace="" select="'completed'"/>
								</status>
								<xsl:for-each select="$var2_pp_aktivita/ns2:aktivita_popis">
									<description>
										<xsl:attribute name="value" namespace="" select="()"/>
									</description>
								</xsl:for-each>
							</detail>
						</activity>
						<xsl:for-each select="ns2:pp_podrob">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</CarePlan>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var5_resultof_ku_z_propz_prubh_le" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_le">
				<xsl:with-param name="patientReference" as="node()*">
					<xsl:for-each select="$patientReference">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="(./@node(), ./node())"/>
						</Reference>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="leType" as="node()*">
					<xsl:for-each select="$ku_z_propz_doporType/ns2:medikace">
						<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</leType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" as="node()*">
					<xsl:for-each select="$dat_prov">
						<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</dat_prov>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var5_resultof_ku_z_propz_prubh_le">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Encounter">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_hosp">
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_hospType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var22_dop_pracoviste" as="node()*" select="$ku_z_propz_hospType/ns2:dop_pracoviste"/>
		<xsl:variable name="var23_dop_pracovnik" as="node()*" select="$ku_z_propz_hospType/ns2:dop_pracovnik"/>
		<xsl:variable name="var24_duv_prij_kod" as="node()*" select="$ku_z_propz_hospType/ns2:duv_prij_kod"/>
		<xsl:variable name="var25_zdroj_prij" as="node()*" select="$ku_z_propz_hospType/ns2:zdroj_prij"/>
		<xsl:variable name="var26_guid" as="node()?" select="$ku_z_propz_hospType/@guid"/>
		<xsl:variable name="var27_prop_pracoviste" as="node()*" select="$ku_z_propz_hospType/ns2:prop_pracoviste"/>
		<xsl:variable name="var28_prij_pracovnik" as="node()*" select="$ku_z_propz_hospType/ns2:prij_pracovnik"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var26_guid">
				<xsl:for-each select="$var26_guid">
					<xsl:variable name="var1_resultof_FullURL_Encounter" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Encounter">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Encounter">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Encounter>
					<meta>
						<xsl:for-each select="$ku_z_propz_hospType/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'46240-8'"/>
							</code>
						</tag>
					</meta>
					<xsl:for-each select="$ku_z_propz_hospType/ns2:hospital_text">
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'additional'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
								<xsl:sequence select="fn:string(.)"/>
							</xhtml:div>
						</text>
					</xsl:for-each>
					<status>
						<xsl:attribute name="value" namespace="" select="'in-progress'"/>
					</status>
					<class>
						<code>
							<xsl:for-each select="$ku_z_propz_hospType/ns2:typ_kontaktu">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</code>
					</class>
					<xsl:for-each select="$ku_z_propz_hospType/ns2:urg_prij">
						<xsl:variable name="var3_cur_as_string" as="xs:string" select="fn:string(.)"/>
						<priority>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/UZIScis_PrijetiPacientaKHospitalizaci'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="$var3_cur_as_string"/>
								</code>
								<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf23_inputtoresult">
										<xsl:with-param name="input" select="$var3_cur_as_string" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<display>
									<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</display>
							</coding>
						</priority>
					</xsl:for-each>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<participant>
						<individual>
							<reference>
								<xsl:for-each select="$var28_prij_pracovnik">
									<xsl:variable name="var5_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var4_cur" as="node()" select="."/>
										<xsl:for-each select="$var5_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('urn:uuid:', fn:string($var4_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
							<display>
								<xsl:for-each select="$var28_prij_pracovnik/ns2:prijmeni">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</individual>
					</participant>
					<participant>
						<type>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-ParticipationType'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'REF'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'referrer'"/>
								</display>
							</coding>
						</type>
						<individual>
							<reference>
								<xsl:for-each select="$var23_dop_pracovnik">
									<xsl:variable name="var7_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var6_cur" as="node()" select="."/>
										<xsl:for-each select="$var7_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('urn:uuid:', fn:string($var6_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
							<display>
								<xsl:for-each select="$var23_dop_pracovnik/ns2:prijmeni">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</individual>
					</participant>
					<period>
						<start>
							<xsl:for-each select="$ku_z_propz_hospType/ns2:dat_prij">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</start>
						<end>
							<xsl:for-each select="$ku_z_propz_hospType/ns2:dat_prop">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</end>
					</period>
					<reasonCode>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/DoporuceniHospitalizace'))"/>
							</system>
							<code>
								<xsl:for-each select="$var25_zdroj_prij">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$var25_zdroj_prij">
									<xsl:variable name="var8_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf24_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var8_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</display>
						</coding>
						<coding>
							<system>
								<xsl:for-each select="$var24_duv_prij_kod/ns2:kod_syst">
									<xsl:variable name="var9_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf25_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var9_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</xsl:for-each>
								</xsl:for-each>
							</system>
							<code>
								<xsl:for-each select="$var24_duv_prij_kod/ns2:kod">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$var24_duv_prij_kod/ns2:kod_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</coding>
						<xsl:for-each select="$ku_z_propz_hospType/ns2:duv_prij_text">
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</xsl:for-each>
					</reasonCode>
					<xsl:for-each select="$ku_z_propz_hospType/ns2:po_prij_kod">
						<hospitalization>
							<specialCourtesy>
								<coding>
									<xsl:variable name="var10_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf26_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var10_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
									<xsl:for-each select="$ku_z_propz_hospType/ns2:po_prij_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</specialCourtesy>
							<destination>
								<reference>
									<xsl:for-each select="$var27_prop_pracoviste">
										<xsl:variable name="var14_cur" as="node()" select="."/>
										<xsl:for-each select="@guid">
											<xsl:variable name="var13_cur" as="node()" select="."/>
											<xsl:variable name="var12_vguid" as="node()?" select="$var14_cur/@vguid"/>
											<xsl:for-each select="$var12_vguid">
												<xsl:for-each select="$var12_vguid">
													<xsl:variable name="var11_resultof_Reference_Organization" as="xs:string?">
														<xsl:call-template name="provisio:Reference_Organization">
															<xsl:with-param name="GUID" select="fn:string($var13_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var11_resultof_Reference_Organization">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:for-each select="$var27_prop_pracoviste/ns2:nazev">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</destination>
							<xsl:for-each select="$ku_z_propz_hospType/ns2:cil_prop">
								<dischargeDisposition>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</dischargeDisposition>
							</xsl:for-each>
						</hospitalization>
					</xsl:for-each>
					<serviceProvider>
						<reference>
							<xsl:for-each select="$var22_dop_pracoviste">
								<xsl:variable name="var18_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var17_cur" as="node()" select="."/>
									<xsl:variable name="var16_vguid" as="node()?" select="$var18_cur/@vguid"/>
									<xsl:for-each select="$var16_vguid">
										<xsl:for-each select="$var16_vguid">
											<xsl:variable name="var15_resultof_Reference_Organization" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Organization">
													<xsl:with-param name="GUID" select="fn:string($var17_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var15_resultof_Reference_Organization">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
					</serviceProvider>
				</Encounter>
			</resource>
		</entry>
		<xsl:variable name="var19_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$var28_prij_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var19_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var20_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$var23_dop_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()*">
					<xsl:for-each select="$var22_dop_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var20_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var21_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()">
					<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovnikType>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()*">
					<xsl:for-each select="$var27_prop_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var21_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Flag">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_urg_v">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_urg_vType" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:for-each select="$ku_z_propz_urg_vType">
			<xsl:variable name="var4_cur" as="node()" select="."/>
			<xsl:variable name="var2_var_stav" as="node()*" select="ns2:var_stav"/>
			<xsl:variable name="var3_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid">
					<xsl:for-each select="$var3_guid">
						<xsl:variable name="var1_resultof_FullURL_Flag" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Flag">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Flag">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Flag>
						<xsl:for-each select="$var3_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-flag-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'75310-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'active'"/>
						</status>
						<code>
							<coding>
								<system>
									<xsl:for-each select="$var2_var_stav/ns2:kod_syst">
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
									</xsl:for-each>
								</system>
								<code>
									<xsl:for-each select="$var2_var_stav/ns2:kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="$var2_var_stav/ns2:kod_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
							<text>
								<xsl:for-each select="ns2:var_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:for-each select="ns2:var_dat_od">
							<period>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var4_cur/ns2:var_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</period>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<author>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</author>
						</xsl:for-each>
					</Flag>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var5_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_urg_vType/ns2:sp_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var5_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_AllergyIntolerance">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_urg_alerg_int">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="uaType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:for-each select="$uaType">
			<xsl:variable name="var13_cur" as="node()" select="."/>
			<xsl:variable name="var11_uaf" as="node()*" select="ns2:uaf"/>
			<xsl:variable name="var12_dat_ab" as="node()?" select="@dat_ab"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var11_uaf/@guid">
					<xsl:variable name="var1_resultof_FullURL_AllergyIntolerance" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_AllergyIntolerance">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_AllergyIntolerance">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<AllergyIntolerance>
						<xsl:for-each select="$var11_uaf/@guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var11_uaf/@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-allergyIntolerance-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'48765-2'"/>
								</code>
							</tag>
						</meta>
						<clinicalStatus>
							<xsl:for-each select="ns2:stav">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical'))"/>
									</system>
									<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf27_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
								</coding>
							</xsl:for-each>
						</clinicalStatus>
						<verificationStatus>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/allergyintolerance-verification'))"/>
								</system>
								<code>
									<xsl:for-each select="@typ">
										<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf28_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</code>
							</coding>
						</verificationStatus>
						<xsl:for-each select="$var11_uaf/@typ_reakce">
							<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf29_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<type>
								<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</type>
						</xsl:for-each>
						<xsl:for-each select="$var11_uaf/@typ_agens">
							<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf30_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<category>
								<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</category>
						</xsl:for-each>
						<criticality>
							<xsl:for-each select="$var11_uaf/@szp_klic">
								<xsl:variable name="var6_resultof_vmf___inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf31_inputtoresult">
										<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var6_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</xsl:for-each>
						</criticality>
						<code>
							<xsl:for-each select="$var11_uaf">
								<xsl:variable name="var7_cur" as="node()" select="."/>
								<xsl:for-each select="ns2:alerg_lek_klic">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<xsl:for-each select="$var7_cur/ns2:alerg_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var11_uaf">
								<xsl:variable name="var8_cur" as="node()" select="."/>
								<xsl:for-each select="ns2:alerg_nelek_klic">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<xsl:for-each select="$var8_cur/ns2:alerg_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="ns2:u_al">
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</xsl:for-each>
						</code>
						<xsl:for-each select="$patientReference">
							<patient>
								<xsl:sequence select="(./@node(), ./node())"/>
							</patient>
						</xsl:for-each>
						<xsl:for-each select="ns2:dat_du">
							<onsetPeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var13_cur/ns2:dat_up">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</onsetPeriod>
						</xsl:for-each>
						<xsl:variable name="var9_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($var12_dat_ab)">
									<xsl:sequence select="xs:string(xs:dateTime(fn:string($var12_dat_ab)))"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var9_test_resultof_exists">
							<recordedDate>
								<xsl:attribute name="value" namespace="" select="."/>
							</recordedDate>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<recorder>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</recorder>
						</xsl:for-each>
						<xsl:for-each select="$var11_uaf">
							<xsl:variable name="var10_cur" as="node()" select="."/>
							<xsl:for-each select="@ar_klic">
								<reaction>
									<manifestation>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<display>
												<xsl:for-each select="$var10_cur/@ar_text">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</display>
										</coding>
									</manifestation>
								</reaction>
							</xsl:for-each>
						</xsl:for-each>
					</AllergyIntolerance>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_urg">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="ku_z_propz_urg" select="()"/>
		<xsl:variable name="var3_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var1_resultof_ku_z_propz_urg_alerg_int" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_urg_alerg_int">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var3_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="uaType" as="node()*">
					<xsl:for-each select="$ku_z_propz_urg/ns2:alerg_int">
						<uaType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</uaType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" as="node()*">
					<xsl:for-each select="$dat_prov">
						<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</dat_prov>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_ku_z_propz_urg_alerg_int">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var2_resultof_ku_z_propz_urg_v" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_urg_v">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var3_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="ku_z_propz_urg_vType" as="node()*">
					<xsl:for-each select="$ku_z_propz_urg/ns2:ku_z_propz_urg_v">
						<ku_z_propz_urg_vType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_urg_vType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var2_resultof_ku_z_propz_urg_v">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_DiagnosticReport">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_DocumentReference">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:text_autor_ptext_ktext_priloha">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="text" select="()"/>
		<xsl:param name="tag" select="()"/>
		<xsl:variable name="var14_guid" as="node()?" select="$text/@guid"/>
		<xsl:variable name="var15_priloha" as="node()*" select="$text/ns2:priloha"/>
		<xsl:variable name="var12_test_resultof_exists" as="node()?">
			<xsl:if test="fn:exists($tag)">
				<xsl:attribute name="value" select="$tag"/>
			</xsl:if>
		</xsl:variable>
		<xsl:variable name="var13_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var10_let" as="node()+">
			<system xmlns="http://hl7.org/fhir">
				<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
			</system>
			<code xmlns="http://hl7.org/fhir">
				<xsl:attribute name="value" namespace="" select="'11503-0'"/>
			</code>
			<display xmlns="http://hl7.org/fhir">
				<xsl:attribute name="value" namespace="" select="'Medical records'"/>
			</display>
		</xsl:variable>
		<xsl:variable name="var11_create_value_of_ptext" as="node()*">
			<xsl:for-each select="$text/ns2:ptext">
				<xsl:attribute name="value" select="fn:normalize-space(fn:string(.))"/>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var14_guid">
				<xsl:for-each select="$var14_guid">
					<xsl:variable name="var1_resultof_FullURL_DiagnosticReport" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_DiagnosticReport">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_DiagnosticReport">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<DiagnosticReport>
					<meta>
						<versionId>
							<xsl:for-each select="$text/@vguid">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</versionId>
						<tag>
							<code>
								<xsl:sequence select="$var12_test_resultof_exists"/>
							</code>
						</tag>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<code>
						<coding>
							<xsl:sequence select="$var10_let"/>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="$var13_let"/>
					</subject>
					<xsl:for-each select="$var15_priloha">
						<xsl:variable name="var6_cur" as="node()" select="."/>
						<xsl:variable name="var5_guid" as="node()?" select="@guid"/>
						<media>
							<link>
								<reference>
									<xsl:for-each select="$var5_guid">
										<xsl:variable name="var4_vguid" as="node()?" select="$var6_cur/@vguid"/>
										<xsl:for-each select="$var4_vguid">
											<xsl:for-each select="$var5_guid">
												<xsl:variable name="var3_cur" as="node()" select="."/>
												<xsl:for-each select="$var4_vguid">
													<xsl:variable name="var2_resultof_Reference_DocumentReference" as="xs:string?">
														<xsl:call-template name="provisio:Reference_DocumentReference">
															<xsl:with-param name="GUID" select="fn:string($var3_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var2_resultof_Reference_DocumentReference">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</link>
						</media>
					</xsl:for-each>
					<conclusion>
						<xsl:sequence select="$var11_create_value_of_ptext"/>
					</conclusion>
					<xsl:for-each select="$text/ns2:ktext">
						<presentedForm>
							<contentType>
								<xsl:for-each select="@typ">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</contentType>
							<data>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:base64Binary(fn:string(.)))"/>
							</data>
						</presentedForm>
					</xsl:for-each>
				</DiagnosticReport>
			</resource>
		</entry>
		<xsl:for-each select="$var15_priloha">
			<xsl:variable name="var9_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var9_guid">
					<xsl:for-each select="$var9_guid">
						<xsl:variable name="var7_resultof_FullURL_DocumentReference" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_DocumentReference">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var7_resultof_FullURL_DocumentReference">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<xsl:variable name="var8_create_DocumentReference" as="node()">
					<DocumentReference>
						<xsl:for-each select="$var9_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<xsl:for-each select="@vguid">
							<meta>
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
								<tag>
									<code>
										<xsl:sequence select="$var12_test_resultof_exists"/>
									</code>
								</tag>
							</meta>
						</xsl:for-each>
						<status>
							<xsl:attribute name="value" namespace="" select="'current'"/>
						</status>
						<type>
							<coding>
								<xsl:sequence select="$var10_let"/>
							</coding>
						</type>
						<subject>
							<xsl:sequence select="$var13_let"/>
						</subject>
						<description>
							<xsl:sequence select="$var11_create_value_of_ptext"/>
						</description>
						<content>
							<attachment>
								<contentType>
									<xsl:for-each select="@typ">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</contentType>
							</attachment>
						</content>
					</DocumentReference>
				</xsl:variable>
				<resource>
					<DocumentReference>
						<xsl:sequence select="($var8_create_DocumentReference/@node(), $var8_create_DocumentReference/node())"/>
					</DocumentReference>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_DocumentReference">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('urn:uuid:', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Consent">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_dvp">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_dvpType" select="()"/>
		<xsl:variable name="var8_dvp_dokum" as="node()*" select="$ku_z_propz_dvpType/ns2:dvp_dokum"/>
		<xsl:variable name="var9_guid" as="node()?" select="$ku_z_propz_dvpType/@guid"/>
		<xsl:variable name="var7_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var9_guid">
				<xsl:for-each select="$var9_guid">
					<xsl:variable name="var1_resultof_FullURL_Consent" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Consent">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Consent">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Consent>
					<xsl:for-each select="$var9_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$ku_z_propz_dvpType/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'42348-3'"/>
							</code>
						</tag>
					</meta>
					<xsl:for-each select="$ku_z_propz_dvpType/ns2:dvp_koment">
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
								<xsl:sequence select="fn:string(.)"/>
							</xhtml:div>
						</text>
					</xsl:for-each>
					<status>
						<xsl:attribute name="value" namespace="" select="'active'"/>
					</status>
					<scope>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/consentscope'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'adr'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Advanced Care Directive'"/>
							</display>
						</coding>
					</scope>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/WWBVY.htm'))"/>
							</system>
							<code>
								<xsl:for-each select="$ku_z_propz_dvpType/ns2:dvp_typ">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
						</coding>
					</category>
					<patient>
						<xsl:sequence select="$var7_let"/>
					</patient>
					<dateTime>
						<xsl:for-each select="$ku_z_propz_dvpType/ns2:dat_dvp">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</dateTime>
					<sourceReference>
						<reference>
							<xsl:for-each select="$var8_dvp_dokum">
								<xsl:variable name="var5_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var4_cur" as="node()" select="."/>
									<xsl:variable name="var3_vguid" as="node()?" select="$var5_cur/@vguid"/>
									<xsl:for-each select="$var3_vguid">
										<xsl:for-each select="$var3_vguid">
											<xsl:variable name="var2_resultof_Reference_DocumentReference" as="xs:string?">
												<xsl:call-template name="provisio:Reference_DocumentReference">
													<xsl:with-param name="GUID" select="fn:string($var4_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var2_resultof_Reference_DocumentReference">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
					</sourceReference>
					<provision>
						<xsl:for-each select="$ku_z_propz_dvpType/ns2:dvp_dotstav">
							<provision>
								<code>
									<coding>
										<system>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
											</xsl:for-each>
										</system>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<xsl:for-each select="ns2:kod_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</code>
							</provision>
						</xsl:for-each>
					</provision>
				</Consent>
			</resource>
		</entry>
		<xsl:for-each select="$var8_dvp_dokum">
			<xsl:variable name="var6_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var7_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:call-template name="tbf:tbf1_textType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'42348-3'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var6_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:admu_a_prac">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="a_pracovnik" select="()"/>
		<xsl:param name="a_pracoviste" select="()"/>
		<xsl:variable name="var1_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()">
					<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="($a_pracovnik/@node(), $a_pracovnik/node())"/>
					</pracovnikType>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="($a_pracoviste/@node(), $a_pracoviste/node())"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:admu_p_prac">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="p_pracovnik" select="()"/>
		<xsl:param name="p_pracoviste" select="()"/>
		<xsl:variable name="var1_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()?">
					<xsl:for-each select="$p_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()?">
					<xsl:for-each select="$p_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Composition">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:admu_z_prac">
		<xsl:param name="z_pracovnik" select="()"/>
		<xsl:param name="z_pracoviste" select="()"/>
		<xsl:variable name="var1_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()?">
					<xsl:for-each select="$z_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()?">
					<xsl:for-each select="$z_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:adresa_spojeni">
		<xsl:param name="as" select="()"/>
		<xsl:for-each select="$as">
			<xsl:variable name="var3_typ" as="node()?" select="@typ"/>
			<ContactPoint xmlns="http://hl7.org/fhir">
				<system>
					<xsl:for-each select="$var3_typ">
						<xsl:variable name="var1_resultof_vmf___inputtoresult" as="xs:string?">
							<xsl:call-template name="vmf:vmf32_inputtoresult">
								<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_vmf___inputtoresult">
							<xsl:attribute name="value" namespace="" select="."/>
						</xsl:for-each>
					</xsl:for-each>
				</system>
				<xsl:for-each select="ns1:obsah">
					<value>
						<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
					</value>
				</xsl:for-each>
				<xsl:for-each select="$var3_typ">
					<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
						<xsl:call-template name="vmf:vmf33_inputtoresult">
							<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
						<use>
							<xsl:attribute name="value" namespace="" select="."/>
						</use>
					</xsl:for-each>
				</xsl:for-each>
				<xsl:for-each select="@poradi">
					<rank>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
					</rank>
				</xsl:for-each>
			</ContactPoint>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:adresa">
		<xsl:param name="a" select="()"/>
		<xsl:variable name="var5_typ" as="node()?" select="$a/@typ"/>
		<Address xmlns="http://hl7.org/fhir">
			<use>
				<xsl:for-each select="$var5_typ">
					<xsl:variable name="var1_resultof_vmf___inputtoresult" as="xs:string?">
						<xsl:call-template name="vmf:vmf34_inputtoresult">
							<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_vmf___inputtoresult">
						<xsl:attribute name="value" namespace="" select="."/>
					</xsl:for-each>
				</xsl:for-each>
			</use>
			<xsl:for-each select="$a/@ind_kont">
				<xsl:variable name="var4_cur" as="node()" select="."/>
				<type>
					<xsl:for-each select="$var5_typ">
						<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:boolean">
							<xsl:call-template name="vmf:vmf35_inputtoresult">
								<xsl:with-param name="input" select="fn:string($var4_cur)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:boolean">
							<xsl:call-template name="vmf:vmf36_inputtoresult">
								<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:attribute name="value" namespace="">
							<xsl:choose>
								<xsl:when test="($var2_resultof_vmf___inputtoresult and $var3_resultof_vmf___inputtoresult)">
									<xsl:sequence select="'postal'"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:sequence select="'physical'"/>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:attribute>
					</xsl:for-each>
				</type>
			</xsl:for-each>
			<line>
				<xsl:for-each select="$a/ns1:jmeno">
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</xsl:for-each>
			</line>
			<xsl:for-each select="$a/ns1:adr">
				<line>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</line>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:dop1">
				<line>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</line>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:dop2">
				<line>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</line>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:mesto">
				<city>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</city>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:psc">
				<postalCode>
					<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
				</postalCode>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:stat">
				<country>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</country>
			</xsl:for-each>
			<period>
				<xsl:for-each select="$a/ns1:dat_od">
					<start>
						<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
					</start>
				</xsl:for-each>
				<xsl:for-each select="$a/ns1:dat_do">
					<end>
						<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
					</end>
				</xsl:for-each>
			</period>
		</Address>
	</xsl:template>
	<xsl:template name="provisio:pracovnik_a_pracovi_t_">
		<xsl:param name="pracovnikType" select="()"/>
		<xsl:param name="pracovisteType" select="()"/>
		<xsl:for-each select="$pracovnikType">
			<xsl:variable name="var7_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:prijmeni">
				<xsl:variable name="var5_a" as="node()*" select="$var7_cur/ns1:a"/>
				<xsl:variable name="var6_guid" as="node()?" select="$var7_cur/@guid"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var6_guid">
						<xsl:for-each select="$var6_guid">
							<xsl:variable name="var1_resultof_FullURL_Practitioner" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_Practitioner">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_FullURL_Practitioner">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Practitioner>
							<xsl:for-each select="$var6_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var7_cur/@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
							</meta>
							<xsl:for-each select="$var7_cur/@id_zp">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var7_cur/@icl">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var7_cur/@id_pracovnik">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var7_cur/@id_clk">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<name>
								<family>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</family>
								<xsl:for-each select="$var7_cur/ns2:jmeno">
									<given>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</given>
								</xsl:for-each>
								<xsl:for-each select="$var7_cur/ns2:titul_pred">
									<prefix>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</prefix>
								</xsl:for-each>
								<xsl:for-each select="$var7_cur/ns2:titul_za">
									<suffix>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</suffix>
								</xsl:for-each>
							</name>
							<xsl:variable name="var2_map_of_a" as="node()*">
								<xsl:for-each select="$var5_a/ns1:as">
									<as xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
										<xsl:sequence select="(./@node(), ./node())"/>
									</as>
								</xsl:for-each>
							</xsl:variable>
							<xsl:variable name="var3_resultof_adresa_spojeni" as="node()?">
								<xsl:call-template name="provisio:adresa_spojeni">
									<xsl:with-param name="as" select="($var2_map_of_a)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var3_resultof_adresa_spojeni">
								<telecom>
									<xsl:sequence select="(./@node(), ./node())"/>
								</telecom>
							</xsl:for-each>
							<xsl:for-each select="$var5_a">
								<xsl:variable name="var4_resultof_adresa" as="node()?">
									<xsl:call-template name="provisio:adresa">
										<xsl:with-param name="a" as="node()">
											<a xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
												<xsl:sequence select="(./@node(), ./node())"/>
											</a>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var4_resultof_adresa">
									<address>
										<xsl:sequence select="(./@node(), ./node())"/>
									</address>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var7_cur/@odbornost">
								<qualification>
									<code>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/UZABB.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
										</coding>
									</code>
								</qualification>
							</xsl:for-each>
						</Practitioner>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$pracovnikType">
			<xsl:variable name="var18_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:prijmeni">
				<xsl:variable name="var15_vguid" as="node()?" select="$var18_cur/@vguid"/>
				<xsl:variable name="var16_guid" as="node()?" select="$var18_cur/@guid"/>
				<xsl:variable name="var17_guid_role" as="node()?" select="$var18_cur/@guid_role"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var17_guid_role">
						<xsl:for-each select="$var17_guid_role">
							<xsl:variable name="var8_resultof_FullURL_PractitionerRole" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_PractitionerRole">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var8_resultof_FullURL_PractitionerRole">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<PractitionerRole>
							<xsl:for-each select="$var15_vguid">
								<meta>
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</meta>
							</xsl:for-each>
							<practitioner>
								<reference>
									<xsl:for-each select="$var16_guid">
										<xsl:for-each select="$var15_vguid">
											<xsl:for-each select="$var16_guid">
												<xsl:variable name="var10_cur" as="node()" select="."/>
												<xsl:for-each select="$var15_vguid">
													<xsl:variable name="var9_resultof_Reference_Practitioner" as="xs:string?">
														<xsl:call-template name="provisio:Reference_Practitioner">
															<xsl:with-param name="GUID" select="fn:string($var10_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var9_resultof_Reference_Practitioner">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</practitioner>
							<xsl:for-each select="$pracovisteType">
								<xsl:variable name="var14_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var13_cur" as="node()" select="."/>
									<xsl:variable name="var12_vguid" as="node()?" select="$var14_cur/@vguid"/>
									<xsl:for-each select="$var12_vguid">
										<xsl:for-each select="$var12_vguid">
											<xsl:variable name="var11_resultof_Reference_Organization" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Organization">
													<xsl:with-param name="GUID" select="fn:string($var13_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var11_resultof_Reference_Organization">
												<organization>
													<reference>
														<xsl:attribute name="value" namespace="" select="."/>
													</reference>
												</organization>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var18_cur/@role_klic">
								<code>
									<coding>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<display>
											<xsl:for-each select="$var18_cur/@role_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</code>
							</xsl:for-each>
						</PractitionerRole>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$pracovisteType">
			<xsl:variable name="var23_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:nazev">
				<xsl:variable name="var22_a" as="node()*" select="$var23_cur/ns1:a"/>
				<entry xmlns="http://hl7.org/fhir">
					<resource>
						<Organization>
							<id>
								<xsl:for-each select="$var23_cur/@guid">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</id>
							<meta>
								<xsl:for-each select="$var23_cur/@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
							</meta>
							<text>
								<status>
									<xsl:attribute name="value" namespace="" select="'generated'"/>
								</status>
								<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
									<xsl:for-each select="$var23_cur/ns2:pozn">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xhtml:div>
							</text>
							<xsl:for-each select="$var23_cur/@kod_lok">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var23_cur/@ico">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var23_cur/@icz">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var23_cur/@icp">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var23_cur/@ns">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var23_cur/@oddel">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var23_cur/@pcz">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<type>
								<coding>
									<display>
										<xsl:for-each select="$var23_cur/@odb">
											<xsl:attribute name="value" namespace="" select="fn:concat('Odbornost: ', fn:string(.))"/>
										</xsl:for-each>
									</display>
								</coding>
							</type>
							<name>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</name>
							<xsl:variable name="var19_map_of_a" as="node()*">
								<xsl:for-each select="$var22_a/ns1:as">
									<as xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
										<xsl:sequence select="(./@node(), ./node())"/>
									</as>
								</xsl:for-each>
							</xsl:variable>
							<xsl:variable name="var20_resultof_adresa_spojeni" as="node()?">
								<xsl:call-template name="provisio:adresa_spojeni">
									<xsl:with-param name="as" select="($var19_map_of_a)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var20_resultof_adresa_spojeni">
								<telecom>
									<xsl:sequence select="(./@node(), ./node())"/>
								</telecom>
							</xsl:for-each>
							<xsl:for-each select="$var22_a">
								<xsl:variable name="var21_resultof_adresa" as="node()?">
									<xsl:call-template name="provisio:adresa">
										<xsl:with-param name="a" as="node()">
											<a xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
												<xsl:sequence select="(./@node(), ./node())"/>
											</a>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var21_resultof_adresa">
									<address>
										<xsl:sequence select="(./@node(), ./node())"/>
									</address>
								</xsl:for-each>
							</xsl:for-each>
						</Organization>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:admu_o_prac">
		<xsl:param name="o_pracovnik" select="()"/>
		<xsl:param name="o_pracoviste" select="()"/>
		<xsl:variable name="var1_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()?">
					<xsl:for-each select="$o_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()?">
					<xsl:for-each select="$o_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_admu">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_admuType" select="()"/>
		<xsl:variable name="var27_guid" as="node()?" select="$ku_z_propz_admuType/@guid"/>
		<xsl:variable name="var28_z_pracovnik" as="node()*" select="$ku_z_propz_admuType/ns2:z_pracovnik"/>
		<xsl:variable name="var29_o_pracovnik" as="node()*" select="$ku_z_propz_admuType/ns2:o_pracovnik"/>
		<xsl:variable name="var30_a_pracovnik" as="node()*" select="$ku_z_propz_admuType/ns2:a_pracovnik"/>
		<xsl:variable name="var31_http___loinc_org_as_string" as="xs:string" select="xs:string(xs:anyURI('http://loinc.org'))"/>
		<xsl:variable name="var32_a_pracoviste" as="node()*" select="$ku_z_propz_admuType/ns2:a_pracoviste"/>
		<xsl:variable name="var26_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var27_guid">
				<xsl:for-each select="$var27_guid">
					<xsl:variable name="var1_resultof_FullURL_Composition" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Composition">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Composition">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Composition>
					<xsl:for-each select="$var27_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$ku_z_propz_admuType/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'8650-4'"/>
							</code>
						</tag>
					</meta>
					<text>
						<status>
							<xsl:attribute name="value" namespace="" select="'generated'"/>
						</status>
						<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
							<xsl:for-each select="$ku_z_propz_admuType/ns2:spr_dokum">
								<xsl:sequence select="fn:string(.)"/>
							</xsl:for-each>
						</xhtml:div>
					</text>
					<status>
						<xsl:for-each select="$ku_z_propz_admuType/ns2:stav_dokum">
							<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf37_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
								<xsl:attribute name="value" namespace="" select="."/>
							</xsl:for-each>
						</xsl:for-each>
					</status>
					<type>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="$var31_http___loinc_org_as_string"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'18842-5'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Hospital discharge summary'"/>
							</display>
						</coding>
					</type>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="$var31_http___loinc_org_as_string"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'34105-7'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Summary of episode note'"/>
							</display>
						</coding>
					</category>
					<date>
						<xsl:for-each select="$ku_z_propz_admuType/ns2:dat_a_mod">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</date>
					<author>
						<reference>
							<xsl:for-each select="$var30_a_pracovnik">
								<xsl:variable name="var6_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var5_cur" as="node()" select="."/>
									<xsl:variable name="var4_vguid" as="node()?" select="$var6_cur/@vguid"/>
									<xsl:for-each select="$var4_vguid">
										<xsl:for-each select="$var4_vguid">
											<xsl:variable name="var3_resultof_Reference_Practitioner" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Practitioner">
													<xsl:with-param name="GUID" select="fn:string($var5_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var3_resultof_Reference_Practitioner">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
						<display>
							<xsl:for-each select="$var30_a_pracovnik/ns2:prijmeni">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</display>
					</author>
					<title>
						<xsl:attribute name="value" namespace="" select="'Hospital discharge summary'"/>
					</title>
					<xsl:for-each select="$var29_o_pracovnik">
						<xsl:variable name="var8_cur" as="node()" select="."/>
						<attester>
							<mode>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</mode>
							<time>
								<xsl:for-each select="$ku_z_propz_admuType/ns2:dat_overeni">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</time>
							<party>
								<reference>
									<xsl:for-each select="@guid">
										<xsl:variable name="var7_cur" as="node()" select="."/>
										<xsl:for-each select="$var8_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('urn:uuid:', fn:string($var7_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:for-each select="ns2:prijmeni">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</party>
						</attester>
					</xsl:for-each>
					<xsl:for-each select="$var28_z_pracovnik">
						<xsl:variable name="var10_cur" as="node()" select="."/>
						<attester>
							<mode>
								<xsl:attribute name="value" namespace="" select="'legal'"/>
							</mode>
							<time>
								<xsl:for-each select="$ku_z_propz_admuType/ns2:dat_autorizace">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</time>
							<party>
								<reference>
									<xsl:for-each select="@guid">
										<xsl:variable name="var9_cur" as="node()" select="."/>
										<xsl:for-each select="$var10_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('urn:uuid:', fn:string($var9_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:for-each select="ns2:prijmeni">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</party>
						</attester>
					</xsl:for-each>
					<custodian>
						<reference>
							<xsl:for-each select="$var32_a_pracoviste">
								<xsl:variable name="var14_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var13_cur" as="node()" select="."/>
									<xsl:variable name="var12_vguid" as="node()?" select="$var14_cur/@vguid"/>
									<xsl:for-each select="$var12_vguid">
										<xsl:for-each select="$var12_vguid">
											<xsl:variable name="var11_resultof_Reference_Organization" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Organization">
													<xsl:with-param name="GUID" select="fn:string($var13_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var11_resultof_Reference_Organization">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
						<display>
							<xsl:for-each select="$var32_a_pracoviste/ns2:nazev">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</display>
					</custodian>
				</Composition>
			</resource>
		</entry>
		<xsl:variable name="var15_create_p_pracovnik_of_p_pracovnik" as="node()*">
			<xsl:for-each select="$ku_z_propz_admuType/ns2:p_pracovnik">
				<p_pracovnik xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</p_pracovnik>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var16_create_p_pracoviste_of_p_pracoviste" as="node()*">
			<xsl:for-each select="$ku_z_propz_admuType/ns2:p_pracoviste">
				<p_pracoviste xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</p_pracoviste>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var17_resultof_admu_p_prac" as="node()*">
			<xsl:call-template name="provisio:admu_p_prac">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var26_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="p_pracovnik" select="($var15_create_p_pracovnik_of_p_pracovnik)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				<xsl:with-param name="p_pracoviste" select="($var16_create_p_pracoviste_of_p_pracoviste)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var17_resultof_admu_p_prac">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$var30_a_pracovnik">
			<xsl:variable name="var19_cur" as="node()" select="."/>
			<xsl:for-each select="$var32_a_pracoviste">
				<xsl:variable name="var18_resultof_admu_a_prac" as="node()*">
					<xsl:call-template name="provisio:admu_a_prac">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="$var26_let"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="a_pracovnik" as="node()">
							<a_pracovnik xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="($var19_cur/@node(), $var19_cur/node())"/>
							</a_pracovnik>
						</xsl:with-param>
						<xsl:with-param name="a_pracoviste" as="node()">
							<a_pracoviste xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</a_pracoviste>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var18_resultof_admu_a_prac">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var20_create_o_pracovnik_of_o_pracovnik" as="node()*">
			<xsl:for-each select="$var29_o_pracovnik">
				<o_pracovnik xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</o_pracovnik>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var21_create_o_pracoviste_of_o_pracoviste" as="node()*">
			<xsl:for-each select="$ku_z_propz_admuType/ns2:o_pracoviste">
				<o_pracoviste xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</o_pracoviste>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var22_resultof_admu_o_prac" as="node()*">
			<xsl:call-template name="provisio:admu_o_prac">
				<xsl:with-param name="o_pracovnik" select="($var20_create_o_pracovnik_of_o_pracovnik)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				<xsl:with-param name="o_pracoviste" select="($var21_create_o_pracoviste_of_o_pracoviste)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var22_resultof_admu_o_prac">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var23_create_z_pracovnik_of_z_pracovnik" as="node()*">
			<xsl:for-each select="$var28_z_pracovnik">
				<z_pracovnik xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</z_pracovnik>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var24_create_z_pracoviste_of_z_pracoviste" as="node()*">
			<xsl:for-each select="$ku_z_propz_admuType/ns2:z_pracoviste">
				<z_pracoviste xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</z_pracoviste>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var25_resultof_admu_z_prac" as="node()*">
			<xsl:call-template name="provisio:admu_z_prac">
				<xsl:with-param name="z_pracovnik" select="($var23_create_z_pracovnik_of_z_pracovnik)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				<xsl:with-param name="z_pracoviste" select="($var24_create_z_pracoviste_of_z_pracoviste)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var25_resultof_admu_z_prac">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="GUID____ku_z" select="()"/>
		<xsl:param name="ku_z_propzType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:variable name="var2002_ku_z_propz_sprij" as="node()*" select="$ku_z_propzType/ns2:ku_z_propz_sprij"/>
		<xsl:variable name="var2003_http___loinc_org_as_string" as="xs:string" select="xs:string(xs:anyURI('http://loinc.org'))"/>
		<xsl:variable name="var2004_ku_z_propz_dvp" as="node()*" select="$ku_z_propzType/ns2:ku_z_propz_dvp"/>
		<xsl:variable name="var2005_ku_z_propz_admu" as="node()*" select="$ku_z_propzType/ns2:ku_z_propz_admu"/>
		<xsl:variable name="var2006_ku_z_propz_hosp" as="node()*" select="$ku_z_propzType/ns2:ku_z_propz_hosp"/>
		<xsl:variable name="var2001_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_dopor">
				<ku_z_propz_doporType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_doporType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_sprop">
				<ku_z_propz_spropType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_spropType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_urg">
				<ku_z_propz_urgType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_urgType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_prubh">
				<ku_z_propz_prubhType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_prubhType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_anam">
				<ku_z_propz_anamType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_anamType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1995_create_dat_prov_of_dat_prov" as="node()*">
			<xsl:for-each select="$dat_prov">
				<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</dat_prov>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:variable name="var1_resultof_FullURL_Composition" as="xs:string?">
				<xsl:call-template name="provisio:FullURL_Composition">
					<xsl:with-param name="GUID" select="$GUID____ku_z" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1_resultof_FullURL_Composition">
				<fullUrl>
					<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
				</fullUrl>
			</xsl:for-each>
			<resource>
				<Composition>
					<meta>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/hdr/StructureDefinition/cz-composition-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<type>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'34105-7'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Hospital Discharge summary'"/>
							</display>
						</coding>
					</type>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/ValueSet/document-classcodes'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'18842-5'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Discharge summary'"/>
							</display>
						</coding>
					</category>
					<date>
						<xsl:for-each select="$dat_prov">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</date>
					<author>
						<reference>
							<xsl:for-each select="$practitionerReference">
								<xsl:attribute name="value" namespace="" select="."/>
							</xsl:for-each>
						</reference>
					</author>
					<title>
						<xsl:attribute name="value" namespace="" select="'Propouštěcí zpráva'"/>
					</title>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAdmissionEvaluation'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'67852-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital Admission evaluation note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital Admission evaluation note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionAdmissionEvaluation</xhtml:div>
						</text>
						<xsl:variable name="var65_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var56_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var56_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var57_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var57_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var58_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var58_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var59_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var59_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var60_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var60_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var61_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var61_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var62_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var62_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var63_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var63_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var64_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var64_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var65_let">
							<xsl:variable name="var55_current" as="node()" select="."/>
							<xsl:variable name="var51_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var50_resource" as="node()*" select="$var55_current/ns0:resource"/>
									<xsl:variable name="var3_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var2_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var50_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var2_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var49_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var3_test_resultof_any">
											<xsl:variable name="var48_cur" as="xs:string" select="."/>
											<xsl:variable name="var5_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var4_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var50_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var4_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var5_test_resultof_any">
												<xsl:variable name="var47_cur" as="xs:string" select="."/>
												<xsl:variable name="var7_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var6_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var50_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var6_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var7_test_resultof_any">
													<xsl:variable name="var46_cur" as="xs:string" select="."/>
													<xsl:variable name="var9_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var8_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var50_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var8_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var9_test_resultof_any">
														<xsl:variable name="var45_cur" as="xs:string" select="."/>
														<xsl:variable name="var11_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var10_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var50_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var10_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var11_test_resultof_any">
															<xsl:variable name="var44_cur" as="xs:string" select="."/>
															<xsl:variable name="var13_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var12_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var50_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var12_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var13_test_resultof_any">
																<xsl:variable name="var43_cur" as="xs:string" select="."/>
																<xsl:variable name="var15_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var14_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var50_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var14_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var15_test_resultof_any">
																	<xsl:variable name="var42_cur" as="xs:string" select="."/>
																	<xsl:variable name="var17_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var16_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var50_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var16_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var17_test_resultof_any">
																		<xsl:variable name="var41_cur" as="xs:string" select="."/>
																		<xsl:variable name="var19_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var18_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var50_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var18_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var19_test_resultof_any">
																			<xsl:variable name="var40_cur" as="xs:string" select="."/>
																			<xsl:variable name="var21_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var20_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var50_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var20_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var21_test_resultof_any">
																				<xsl:variable name="var39_cur" as="xs:string" select="."/>
																				<xsl:variable name="var23_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var22_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var50_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var22_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var23_test_resultof_any">
																					<xsl:variable name="var38_cur" as="xs:string" select="."/>
																					<xsl:variable name="var25_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var24_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var50_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var24_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var25_test_resultof_any">
																						<xsl:variable name="var37_cur" as="xs:string" select="."/>
																						<xsl:variable name="var27_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var26_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var50_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var26_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var27_test_resultof_any">
																							<xsl:variable name="var36_cur" as="xs:string" select="."/>
																							<xsl:variable name="var29_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var28_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var50_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var28_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var29_test_resultof_any">
																								<xsl:variable name="var35_cur" as="xs:string" select="."/>
																								<xsl:variable name="var31_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var30_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var50_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var30_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var31_test_resultof_any">
																									<xsl:variable name="var34_cur" as="xs:string" select="."/>
																									<xsl:variable name="var33_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var50_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var32_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var50_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var32_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var33_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('67852-4' = $var48_cur), ('67852-4' = $var47_cur), ('67852-4' = $var46_cur), ('67852-4' = $var45_cur), ('67852-4' = $var44_cur), ('67852-4' = $var43_cur), ('67852-4' = $var42_cur), ('67852-4' = $var41_cur), ('67852-4' = $var40_cur), ('67852-4' = $var39_cur), ('67852-4' = $var38_cur), ('67852-4' = $var37_cur), ('67852-4' = $var36_cur), ('67852-4' = $var35_cur), ('67852-4' = $var34_cur), ('67852-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var49_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var51_resultof_filter">
								<xsl:variable name="var54_cur" as="node()" select="."/>
								<xsl:variable name="var53_resource" as="node()*" select="$var55_current/ns0:resource"/>
								<xsl:variable name="var52_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var53_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var53_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var53_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var53_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var53_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var53_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var53_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var53_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var53_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var53_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var53_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var53_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var53_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var53_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var53_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var53_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var53_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var52_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var54_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPatientHx'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11329-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History general Narrative - Reported'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History general Narrative - Reported'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionPatientHx</xhtml:div>
						</text>
						<xsl:variable name="var129_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var120_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var120_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var121_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var121_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var122_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var122_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var123_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var123_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var124_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var124_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var125_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var125_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var126_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var126_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var127_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var127_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var128_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var128_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var129_let">
							<xsl:variable name="var119_current" as="node()" select="."/>
							<xsl:variable name="var115_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var114_resource" as="node()*" select="$var119_current/ns0:resource"/>
									<xsl:variable name="var67_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var66_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var114_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var66_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var113_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var67_test_resultof_any">
											<xsl:variable name="var112_cur" as="xs:string" select="."/>
											<xsl:variable name="var69_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var68_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var114_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var68_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var69_test_resultof_any">
												<xsl:variable name="var111_cur" as="xs:string" select="."/>
												<xsl:variable name="var71_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var70_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var114_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var70_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var71_test_resultof_any">
													<xsl:variable name="var110_cur" as="xs:string" select="."/>
													<xsl:variable name="var73_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var72_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var114_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var72_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var73_test_resultof_any">
														<xsl:variable name="var109_cur" as="xs:string" select="."/>
														<xsl:variable name="var75_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var74_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var114_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var74_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var75_test_resultof_any">
															<xsl:variable name="var108_cur" as="xs:string" select="."/>
															<xsl:variable name="var77_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var76_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var114_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var76_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var77_test_resultof_any">
																<xsl:variable name="var107_cur" as="xs:string" select="."/>
																<xsl:variable name="var79_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var78_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var114_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var78_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var79_test_resultof_any">
																	<xsl:variable name="var106_cur" as="xs:string" select="."/>
																	<xsl:variable name="var81_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var80_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var114_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var80_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var81_test_resultof_any">
																		<xsl:variable name="var105_cur" as="xs:string" select="."/>
																		<xsl:variable name="var83_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var82_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var114_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var82_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var83_test_resultof_any">
																			<xsl:variable name="var104_cur" as="xs:string" select="."/>
																			<xsl:variable name="var85_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var84_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var114_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var84_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var85_test_resultof_any">
																				<xsl:variable name="var103_cur" as="xs:string" select="."/>
																				<xsl:variable name="var87_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var86_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var114_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var86_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var87_test_resultof_any">
																					<xsl:variable name="var102_cur" as="xs:string" select="."/>
																					<xsl:variable name="var89_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var88_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var114_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var88_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var89_test_resultof_any">
																						<xsl:variable name="var101_cur" as="xs:string" select="."/>
																						<xsl:variable name="var91_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var90_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var114_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var90_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var91_test_resultof_any">
																							<xsl:variable name="var100_cur" as="xs:string" select="."/>
																							<xsl:variable name="var93_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var92_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var114_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var92_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var93_test_resultof_any">
																								<xsl:variable name="var99_cur" as="xs:string" select="."/>
																								<xsl:variable name="var95_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var94_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var114_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var94_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var95_test_resultof_any">
																									<xsl:variable name="var98_cur" as="xs:string" select="."/>
																									<xsl:variable name="var97_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var114_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var96_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var114_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var96_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var97_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('11329-0' = $var112_cur), ('11329-0' = $var111_cur), ('11329-0' = $var110_cur), ('11329-0' = $var109_cur), ('11329-0' = $var108_cur), ('11329-0' = $var107_cur), ('11329-0' = $var106_cur), ('11329-0' = $var105_cur), ('11329-0' = $var104_cur), ('11329-0' = $var103_cur), ('11329-0' = $var102_cur), ('11329-0' = $var101_cur), ('11329-0' = $var100_cur), ('11329-0' = $var99_cur), ('11329-0' = $var98_cur), ('11329-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var113_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var115_resultof_filter">
								<xsl:variable name="var118_cur" as="node()" select="."/>
								<xsl:variable name="var117_resource" as="node()*" select="$var119_current/ns0:resource"/>
								<xsl:variable name="var116_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var117_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var117_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var117_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var117_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var117_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var117_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var117_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var117_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var117_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var117_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var117_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var117_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var117_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var117_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var117_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var117_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var117_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var116_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var118_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPhysicalFindings'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'29545-1'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Physical findings note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Physical findings note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionPhysicalFindings</xhtml:div>
						</text>
						<xsl:variable name="var193_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var184_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var184_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var185_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var185_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var186_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var186_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var187_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var187_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var188_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var188_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var189_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var189_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var190_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var190_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var191_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var191_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var192_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var192_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var193_let">
							<xsl:variable name="var183_current" as="node()" select="."/>
							<xsl:variable name="var179_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var178_resource" as="node()*" select="$var183_current/ns0:resource"/>
									<xsl:variable name="var131_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var130_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var178_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var130_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var177_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var131_test_resultof_any">
											<xsl:variable name="var176_cur" as="xs:string" select="."/>
											<xsl:variable name="var133_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var132_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var178_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var132_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var133_test_resultof_any">
												<xsl:variable name="var175_cur" as="xs:string" select="."/>
												<xsl:variable name="var135_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var134_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var178_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var134_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var135_test_resultof_any">
													<xsl:variable name="var174_cur" as="xs:string" select="."/>
													<xsl:variable name="var137_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var136_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var178_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var136_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var137_test_resultof_any">
														<xsl:variable name="var173_cur" as="xs:string" select="."/>
														<xsl:variable name="var139_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var138_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var178_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var138_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var139_test_resultof_any">
															<xsl:variable name="var172_cur" as="xs:string" select="."/>
															<xsl:variable name="var141_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var140_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var178_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var140_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var141_test_resultof_any">
																<xsl:variable name="var171_cur" as="xs:string" select="."/>
																<xsl:variable name="var143_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var142_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var178_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var142_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var143_test_resultof_any">
																	<xsl:variable name="var170_cur" as="xs:string" select="."/>
																	<xsl:variable name="var145_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var144_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var178_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var144_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var145_test_resultof_any">
																		<xsl:variable name="var169_cur" as="xs:string" select="."/>
																		<xsl:variable name="var147_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var146_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var178_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var146_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var147_test_resultof_any">
																			<xsl:variable name="var168_cur" as="xs:string" select="."/>
																			<xsl:variable name="var149_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var148_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var178_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var148_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var149_test_resultof_any">
																				<xsl:variable name="var167_cur" as="xs:string" select="."/>
																				<xsl:variable name="var151_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var150_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var178_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var150_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var151_test_resultof_any">
																					<xsl:variable name="var166_cur" as="xs:string" select="."/>
																					<xsl:variable name="var153_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var152_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var178_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var152_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var153_test_resultof_any">
																						<xsl:variable name="var165_cur" as="xs:string" select="."/>
																						<xsl:variable name="var155_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var154_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var178_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var154_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var155_test_resultof_any">
																							<xsl:variable name="var164_cur" as="xs:string" select="."/>
																							<xsl:variable name="var157_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var156_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var178_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var156_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var157_test_resultof_any">
																								<xsl:variable name="var163_cur" as="xs:string" select="."/>
																								<xsl:variable name="var159_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var158_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var178_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var158_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var159_test_resultof_any">
																									<xsl:variable name="var162_cur" as="xs:string" select="."/>
																									<xsl:variable name="var161_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var178_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var160_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var178_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var160_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var161_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('29545-1' = $var176_cur), ('29545-1' = $var175_cur), ('29545-1' = $var174_cur), ('29545-1' = $var173_cur), ('29545-1' = $var172_cur), ('29545-1' = $var171_cur), ('29545-1' = $var170_cur), ('29545-1' = $var169_cur), ('29545-1' = $var168_cur), ('29545-1' = $var167_cur), ('29545-1' = $var166_cur), ('29545-1' = $var165_cur), ('29545-1' = $var164_cur), ('29545-1' = $var163_cur), ('29545-1' = $var162_cur), ('29545-1' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var177_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var179_resultof_filter">
								<xsl:variable name="var182_cur" as="node()" select="."/>
								<xsl:variable name="var181_resource" as="node()*" select="$var183_current/ns0:resource"/>
								<xsl:variable name="var180_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var181_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var181_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var181_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var181_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var181_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var181_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var181_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var181_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var181_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var181_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var181_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var181_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var181_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var181_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var181_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var181_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var181_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var180_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var182_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPhysicalExamination'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'55286-9'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Physical exam by body areas'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Physical exam by body areas'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionPhysicalExamination</xhtml:div>
						</text>
						<xsl:variable name="var257_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var248_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var248_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var249_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var249_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var250_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var250_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var251_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var251_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var252_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var252_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var253_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var253_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var254_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var254_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var255_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var255_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var256_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var256_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var257_let">
							<xsl:variable name="var247_current" as="node()" select="."/>
							<xsl:variable name="var243_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var242_resource" as="node()*" select="$var247_current/ns0:resource"/>
									<xsl:variable name="var195_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var194_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var242_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var194_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var241_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var195_test_resultof_any">
											<xsl:variable name="var240_cur" as="xs:string" select="."/>
											<xsl:variable name="var197_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var196_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var242_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var196_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var197_test_resultof_any">
												<xsl:variable name="var239_cur" as="xs:string" select="."/>
												<xsl:variable name="var199_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var198_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var242_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var198_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var199_test_resultof_any">
													<xsl:variable name="var238_cur" as="xs:string" select="."/>
													<xsl:variable name="var201_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var200_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var242_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var200_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var201_test_resultof_any">
														<xsl:variable name="var237_cur" as="xs:string" select="."/>
														<xsl:variable name="var203_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var202_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var242_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var202_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var203_test_resultof_any">
															<xsl:variable name="var236_cur" as="xs:string" select="."/>
															<xsl:variable name="var205_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var204_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var242_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var204_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var205_test_resultof_any">
																<xsl:variable name="var235_cur" as="xs:string" select="."/>
																<xsl:variable name="var207_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var206_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var242_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var206_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var207_test_resultof_any">
																	<xsl:variable name="var234_cur" as="xs:string" select="."/>
																	<xsl:variable name="var209_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var208_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var242_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var208_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var209_test_resultof_any">
																		<xsl:variable name="var233_cur" as="xs:string" select="."/>
																		<xsl:variable name="var211_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var210_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var242_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var210_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var211_test_resultof_any">
																			<xsl:variable name="var232_cur" as="xs:string" select="."/>
																			<xsl:variable name="var213_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var212_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var242_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var212_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var213_test_resultof_any">
																				<xsl:variable name="var231_cur" as="xs:string" select="."/>
																				<xsl:variable name="var215_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var214_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var242_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var214_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var215_test_resultof_any">
																					<xsl:variable name="var230_cur" as="xs:string" select="."/>
																					<xsl:variable name="var217_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var216_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var242_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var216_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var217_test_resultof_any">
																						<xsl:variable name="var229_cur" as="xs:string" select="."/>
																						<xsl:variable name="var219_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var218_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var242_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var218_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var219_test_resultof_any">
																							<xsl:variable name="var228_cur" as="xs:string" select="."/>
																							<xsl:variable name="var221_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var220_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var242_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var220_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var221_test_resultof_any">
																								<xsl:variable name="var227_cur" as="xs:string" select="."/>
																								<xsl:variable name="var223_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var222_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var242_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var222_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var223_test_resultof_any">
																									<xsl:variable name="var226_cur" as="xs:string" select="."/>
																									<xsl:variable name="var225_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var242_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var224_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var242_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var224_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var225_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('55286-9' = $var240_cur), ('55286-9' = $var239_cur), ('55286-9' = $var238_cur), ('55286-9' = $var237_cur), ('55286-9' = $var236_cur), ('55286-9' = $var235_cur), ('55286-9' = $var234_cur), ('55286-9' = $var233_cur), ('55286-9' = $var232_cur), ('55286-9' = $var231_cur), ('55286-9' = $var230_cur), ('55286-9' = $var229_cur), ('55286-9' = $var228_cur), ('55286-9' = $var227_cur), ('55286-9' = $var226_cur), ('55286-9' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var241_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var243_resultof_filter">
								<xsl:variable name="var246_cur" as="node()" select="."/>
								<xsl:variable name="var245_resource" as="node()*" select="$var247_current/ns0:resource"/>
								<xsl:variable name="var244_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var245_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var245_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var245_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var245_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var245_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var245_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var245_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var245_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var245_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var245_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var245_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var245_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var245_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var245_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var245_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var245_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var245_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var244_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var246_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionVitalSigns'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital signs note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Vital signs note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionVitalSigns</xhtml:div>
						</text>
						<xsl:variable name="var321_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var312_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var312_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var313_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var313_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var314_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var314_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var315_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var315_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var316_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var316_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var317_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var317_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var318_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var318_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var319_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var319_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var320_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var320_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var321_let">
							<xsl:variable name="var311_current" as="node()" select="."/>
							<xsl:variable name="var307_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var306_resource" as="node()*" select="$var311_current/ns0:resource"/>
									<xsl:variable name="var259_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var258_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var306_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var258_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var305_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var259_test_resultof_any">
											<xsl:variable name="var304_cur" as="xs:string" select="."/>
											<xsl:variable name="var261_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var260_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var306_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var260_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var261_test_resultof_any">
												<xsl:variable name="var303_cur" as="xs:string" select="."/>
												<xsl:variable name="var263_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var262_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var306_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var262_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var263_test_resultof_any">
													<xsl:variable name="var302_cur" as="xs:string" select="."/>
													<xsl:variable name="var265_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var264_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var306_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var264_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var265_test_resultof_any">
														<xsl:variable name="var301_cur" as="xs:string" select="."/>
														<xsl:variable name="var267_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var266_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var306_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var266_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var267_test_resultof_any">
															<xsl:variable name="var300_cur" as="xs:string" select="."/>
															<xsl:variable name="var269_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var268_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var306_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var268_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var269_test_resultof_any">
																<xsl:variable name="var299_cur" as="xs:string" select="."/>
																<xsl:variable name="var271_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var270_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var306_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var270_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var271_test_resultof_any">
																	<xsl:variable name="var298_cur" as="xs:string" select="."/>
																	<xsl:variable name="var273_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var272_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var306_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var272_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var273_test_resultof_any">
																		<xsl:variable name="var297_cur" as="xs:string" select="."/>
																		<xsl:variable name="var275_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var274_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var306_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var274_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var275_test_resultof_any">
																			<xsl:variable name="var296_cur" as="xs:string" select="."/>
																			<xsl:variable name="var277_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var276_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var306_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var276_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var277_test_resultof_any">
																				<xsl:variable name="var295_cur" as="xs:string" select="."/>
																				<xsl:variable name="var279_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var278_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var306_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var278_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var279_test_resultof_any">
																					<xsl:variable name="var294_cur" as="xs:string" select="."/>
																					<xsl:variable name="var281_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var280_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var306_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var280_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var281_test_resultof_any">
																						<xsl:variable name="var293_cur" as="xs:string" select="."/>
																						<xsl:variable name="var283_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var282_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var306_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var282_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var283_test_resultof_any">
																							<xsl:variable name="var292_cur" as="xs:string" select="."/>
																							<xsl:variable name="var285_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var284_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var306_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var284_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var285_test_resultof_any">
																								<xsl:variable name="var291_cur" as="xs:string" select="."/>
																								<xsl:variable name="var287_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var286_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var306_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var286_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var287_test_resultof_any">
																									<xsl:variable name="var290_cur" as="xs:string" select="."/>
																									<xsl:variable name="var289_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var306_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var288_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var306_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var288_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var289_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('8716-3' = $var304_cur), ('8716-3' = $var303_cur), ('8716-3' = $var302_cur), ('8716-3' = $var301_cur), ('8716-3' = $var300_cur), ('8716-3' = $var299_cur), ('8716-3' = $var298_cur), ('8716-3' = $var297_cur), ('8716-3' = $var296_cur), ('8716-3' = $var295_cur), ('8716-3' = $var294_cur), ('8716-3' = $var293_cur), ('8716-3' = $var292_cur), ('8716-3' = $var291_cur), ('8716-3' = $var290_cur), ('8716-3' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var305_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var307_resultof_filter">
								<xsl:variable name="var310_cur" as="node()" select="."/>
								<xsl:variable name="var309_resource" as="node()*" select="$var311_current/ns0:resource"/>
								<xsl:variable name="var308_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var309_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var309_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var309_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var309_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var309_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var309_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var309_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var309_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var309_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var309_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var309_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var309_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var309_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var309_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var309_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var309_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var309_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var308_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var310_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionFunctionalStatus'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'47420-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Functional status assessment note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Functional status assessment note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionFunctionalStatus</xhtml:div>
						</text>
						<xsl:variable name="var385_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var376_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var376_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var377_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var377_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var378_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var378_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var379_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var379_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var380_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var380_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var381_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var381_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var382_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var382_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var383_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var383_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var384_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var384_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var385_let">
							<xsl:variable name="var375_current" as="node()" select="."/>
							<xsl:variable name="var371_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var370_resource" as="node()*" select="$var375_current/ns0:resource"/>
									<xsl:variable name="var323_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var322_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var370_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var322_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var369_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var323_test_resultof_any">
											<xsl:variable name="var368_cur" as="xs:string" select="."/>
											<xsl:variable name="var325_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var324_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var370_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var324_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var325_test_resultof_any">
												<xsl:variable name="var367_cur" as="xs:string" select="."/>
												<xsl:variable name="var327_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var326_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var370_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var326_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var327_test_resultof_any">
													<xsl:variable name="var366_cur" as="xs:string" select="."/>
													<xsl:variable name="var329_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var328_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var370_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var328_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var329_test_resultof_any">
														<xsl:variable name="var365_cur" as="xs:string" select="."/>
														<xsl:variable name="var331_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var330_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var370_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var330_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var331_test_resultof_any">
															<xsl:variable name="var364_cur" as="xs:string" select="."/>
															<xsl:variable name="var333_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var332_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var370_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var332_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var333_test_resultof_any">
																<xsl:variable name="var363_cur" as="xs:string" select="."/>
																<xsl:variable name="var335_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var334_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var370_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var334_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var335_test_resultof_any">
																	<xsl:variable name="var362_cur" as="xs:string" select="."/>
																	<xsl:variable name="var337_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var336_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var370_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var336_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var337_test_resultof_any">
																		<xsl:variable name="var361_cur" as="xs:string" select="."/>
																		<xsl:variable name="var339_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var338_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var370_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var338_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var339_test_resultof_any">
																			<xsl:variable name="var360_cur" as="xs:string" select="."/>
																			<xsl:variable name="var341_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var340_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var370_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var340_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var341_test_resultof_any">
																				<xsl:variable name="var359_cur" as="xs:string" select="."/>
																				<xsl:variable name="var343_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var342_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var370_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var342_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var343_test_resultof_any">
																					<xsl:variable name="var358_cur" as="xs:string" select="."/>
																					<xsl:variable name="var345_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var344_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var370_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var344_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var345_test_resultof_any">
																						<xsl:variable name="var357_cur" as="xs:string" select="."/>
																						<xsl:variable name="var347_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var346_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var370_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var346_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var347_test_resultof_any">
																							<xsl:variable name="var356_cur" as="xs:string" select="."/>
																							<xsl:variable name="var349_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var348_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var370_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var348_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var349_test_resultof_any">
																								<xsl:variable name="var355_cur" as="xs:string" select="."/>
																								<xsl:variable name="var351_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var350_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var370_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var350_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var351_test_resultof_any">
																									<xsl:variable name="var354_cur" as="xs:string" select="."/>
																									<xsl:variable name="var353_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var370_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var352_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var370_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var352_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var353_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('47420-5' = $var368_cur), ('47420-5' = $var367_cur), ('47420-5' = $var366_cur), ('47420-5' = $var365_cur), ('47420-5' = $var364_cur), ('47420-5' = $var363_cur), ('47420-5' = $var362_cur), ('47420-5' = $var361_cur), ('47420-5' = $var360_cur), ('47420-5' = $var359_cur), ('47420-5' = $var358_cur), ('47420-5' = $var357_cur), ('47420-5' = $var356_cur), ('47420-5' = $var355_cur), ('47420-5' = $var354_cur), ('47420-5' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var369_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var371_resultof_filter">
								<xsl:variable name="var374_cur" as="node()" select="."/>
								<xsl:variable name="var373_resource" as="node()*" select="$var375_current/ns0:resource"/>
								<xsl:variable name="var372_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var373_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var373_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var373_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var373_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var373_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var373_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var373_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var373_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var373_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var373_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var373_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var373_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var373_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var373_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var373_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var373_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var373_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var372_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var374_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAllergies'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'48765-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Allergies and adverse reactions Document'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Allergies and adverse reactions Document'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionAllergies</xhtml:div>
						</text>
						<xsl:variable name="var449_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var440_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var440_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var441_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var441_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var442_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var442_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var443_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var443_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var444_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var444_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var445_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var445_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var446_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var446_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var447_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var447_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var448_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var448_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var449_let">
							<xsl:variable name="var439_current" as="node()" select="."/>
							<xsl:variable name="var435_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var434_resource" as="node()*" select="$var439_current/ns0:resource"/>
									<xsl:variable name="var387_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var386_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var434_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var386_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var433_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var387_test_resultof_any">
											<xsl:variable name="var432_cur" as="xs:string" select="."/>
											<xsl:variable name="var389_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var388_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var434_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var388_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var389_test_resultof_any">
												<xsl:variable name="var431_cur" as="xs:string" select="."/>
												<xsl:variable name="var391_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var390_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var434_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var390_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var391_test_resultof_any">
													<xsl:variable name="var430_cur" as="xs:string" select="."/>
													<xsl:variable name="var393_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var392_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var434_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var392_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var393_test_resultof_any">
														<xsl:variable name="var429_cur" as="xs:string" select="."/>
														<xsl:variable name="var395_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var394_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var434_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var394_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var395_test_resultof_any">
															<xsl:variable name="var428_cur" as="xs:string" select="."/>
															<xsl:variable name="var397_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var396_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var434_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var396_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var397_test_resultof_any">
																<xsl:variable name="var427_cur" as="xs:string" select="."/>
																<xsl:variable name="var399_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var398_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var434_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var398_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var399_test_resultof_any">
																	<xsl:variable name="var426_cur" as="xs:string" select="."/>
																	<xsl:variable name="var401_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var400_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var434_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var400_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var401_test_resultof_any">
																		<xsl:variable name="var425_cur" as="xs:string" select="."/>
																		<xsl:variable name="var403_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var402_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var434_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var402_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var403_test_resultof_any">
																			<xsl:variable name="var424_cur" as="xs:string" select="."/>
																			<xsl:variable name="var405_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var404_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var434_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var404_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var405_test_resultof_any">
																				<xsl:variable name="var423_cur" as="xs:string" select="."/>
																				<xsl:variable name="var407_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var406_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var434_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var406_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var407_test_resultof_any">
																					<xsl:variable name="var422_cur" as="xs:string" select="."/>
																					<xsl:variable name="var409_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var408_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var434_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var408_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var409_test_resultof_any">
																						<xsl:variable name="var421_cur" as="xs:string" select="."/>
																						<xsl:variable name="var411_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var410_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var434_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var410_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var411_test_resultof_any">
																							<xsl:variable name="var420_cur" as="xs:string" select="."/>
																							<xsl:variable name="var413_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var412_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var434_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var412_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var413_test_resultof_any">
																								<xsl:variable name="var419_cur" as="xs:string" select="."/>
																								<xsl:variable name="var415_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var414_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var434_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var414_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var415_test_resultof_any">
																									<xsl:variable name="var418_cur" as="xs:string" select="."/>
																									<xsl:variable name="var417_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var434_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var416_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var434_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var416_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var417_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('48765-2' = $var432_cur), ('48765-2' = $var431_cur), ('48765-2' = $var430_cur), ('48765-2' = $var429_cur), ('48765-2' = $var428_cur), ('48765-2' = $var427_cur), ('48765-2' = $var426_cur), ('48765-2' = $var425_cur), ('48765-2' = $var424_cur), ('48765-2' = $var423_cur), ('48765-2' = $var422_cur), ('48765-2' = $var421_cur), ('48765-2' = $var420_cur), ('48765-2' = $var419_cur), ('48765-2' = $var418_cur), ('48765-2' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var433_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var435_resultof_filter">
								<xsl:variable name="var438_cur" as="node()" select="."/>
								<xsl:variable name="var437_resource" as="node()*" select="$var439_current/ns0:resource"/>
								<xsl:variable name="var436_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var437_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var437_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var437_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var437_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var437_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var437_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var437_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var437_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var437_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var437_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var437_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var437_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var437_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var437_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var437_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var437_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var437_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var436_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var438_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAlert'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'75310-3'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Health concerns Document'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Health concerns Document'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionAlert</xhtml:div>
						</text>
						<xsl:variable name="var513_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var504_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var504_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var505_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var505_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var506_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var506_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var507_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var507_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var508_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var508_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var509_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var509_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var510_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var510_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var511_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var511_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var512_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var512_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var513_let">
							<xsl:variable name="var503_current" as="node()" select="."/>
							<xsl:variable name="var499_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var498_resource" as="node()*" select="$var503_current/ns0:resource"/>
									<xsl:variable name="var451_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var450_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var498_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var450_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var497_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var451_test_resultof_any">
											<xsl:variable name="var496_cur" as="xs:string" select="."/>
											<xsl:variable name="var453_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var452_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var498_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var452_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var453_test_resultof_any">
												<xsl:variable name="var495_cur" as="xs:string" select="."/>
												<xsl:variable name="var455_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var454_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var498_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var454_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var455_test_resultof_any">
													<xsl:variable name="var494_cur" as="xs:string" select="."/>
													<xsl:variable name="var457_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var456_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var498_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var456_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var457_test_resultof_any">
														<xsl:variable name="var493_cur" as="xs:string" select="."/>
														<xsl:variable name="var459_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var458_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var498_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var458_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var459_test_resultof_any">
															<xsl:variable name="var492_cur" as="xs:string" select="."/>
															<xsl:variable name="var461_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var460_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var498_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var460_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var461_test_resultof_any">
																<xsl:variable name="var491_cur" as="xs:string" select="."/>
																<xsl:variable name="var463_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var462_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var498_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var462_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var463_test_resultof_any">
																	<xsl:variable name="var490_cur" as="xs:string" select="."/>
																	<xsl:variable name="var465_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var464_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var498_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var464_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var465_test_resultof_any">
																		<xsl:variable name="var489_cur" as="xs:string" select="."/>
																		<xsl:variable name="var467_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var466_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var498_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var466_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var467_test_resultof_any">
																			<xsl:variable name="var488_cur" as="xs:string" select="."/>
																			<xsl:variable name="var469_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var468_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var498_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var468_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var469_test_resultof_any">
																				<xsl:variable name="var487_cur" as="xs:string" select="."/>
																				<xsl:variable name="var471_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var470_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var498_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var470_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var471_test_resultof_any">
																					<xsl:variable name="var486_cur" as="xs:string" select="."/>
																					<xsl:variable name="var473_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var472_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var498_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var472_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var473_test_resultof_any">
																						<xsl:variable name="var485_cur" as="xs:string" select="."/>
																						<xsl:variable name="var475_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var474_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var498_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var474_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var475_test_resultof_any">
																							<xsl:variable name="var484_cur" as="xs:string" select="."/>
																							<xsl:variable name="var477_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var476_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var498_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var476_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var477_test_resultof_any">
																								<xsl:variable name="var483_cur" as="xs:string" select="."/>
																								<xsl:variable name="var479_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var478_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var498_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var478_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var479_test_resultof_any">
																									<xsl:variable name="var482_cur" as="xs:string" select="."/>
																									<xsl:variable name="var481_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var498_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var480_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var498_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var480_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var481_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('75310-3' = $var496_cur), ('75310-3' = $var495_cur), ('75310-3' = $var494_cur), ('75310-3' = $var493_cur), ('75310-3' = $var492_cur), ('75310-3' = $var491_cur), ('75310-3' = $var490_cur), ('75310-3' = $var489_cur), ('75310-3' = $var488_cur), ('75310-3' = $var487_cur), ('75310-3' = $var486_cur), ('75310-3' = $var485_cur), ('75310-3' = $var484_cur), ('75310-3' = $var483_cur), ('75310-3' = $var482_cur), ('75310-3' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var497_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var499_resultof_filter">
								<xsl:variable name="var502_cur" as="node()" select="."/>
								<xsl:variable name="var501_resource" as="node()*" select="$var503_current/ns0:resource"/>
								<xsl:variable name="var500_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var501_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var501_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var501_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var501_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var501_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var501_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var501_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var501_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var501_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var501_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var501_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var501_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var501_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var501_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var501_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var501_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var501_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var500_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var502_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionHospitalCourse'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8648-8'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital course note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital course note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionHospitalCourse</xhtml:div>
						</text>
						<xsl:variable name="var577_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var568_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var568_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var569_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var569_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var570_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var570_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var571_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var571_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var572_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var572_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var573_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var573_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var574_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var574_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var575_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var575_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var576_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var576_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var577_let">
							<xsl:variable name="var567_current" as="node()" select="."/>
							<xsl:variable name="var563_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var562_resource" as="node()*" select="$var567_current/ns0:resource"/>
									<xsl:variable name="var515_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var514_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var562_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var514_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var561_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var515_test_resultof_any">
											<xsl:variable name="var560_cur" as="xs:string" select="."/>
											<xsl:variable name="var517_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var516_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var562_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var516_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var517_test_resultof_any">
												<xsl:variable name="var559_cur" as="xs:string" select="."/>
												<xsl:variable name="var519_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var518_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var562_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var518_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var519_test_resultof_any">
													<xsl:variable name="var558_cur" as="xs:string" select="."/>
													<xsl:variable name="var521_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var520_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var562_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var520_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var521_test_resultof_any">
														<xsl:variable name="var557_cur" as="xs:string" select="."/>
														<xsl:variable name="var523_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var522_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var562_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var522_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var523_test_resultof_any">
															<xsl:variable name="var556_cur" as="xs:string" select="."/>
															<xsl:variable name="var525_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var524_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var562_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var524_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var525_test_resultof_any">
																<xsl:variable name="var555_cur" as="xs:string" select="."/>
																<xsl:variable name="var527_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var526_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var562_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var526_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var527_test_resultof_any">
																	<xsl:variable name="var554_cur" as="xs:string" select="."/>
																	<xsl:variable name="var529_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var528_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var562_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var528_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var529_test_resultof_any">
																		<xsl:variable name="var553_cur" as="xs:string" select="."/>
																		<xsl:variable name="var531_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var530_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var562_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var530_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var531_test_resultof_any">
																			<xsl:variable name="var552_cur" as="xs:string" select="."/>
																			<xsl:variable name="var533_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var532_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var562_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var532_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var533_test_resultof_any">
																				<xsl:variable name="var551_cur" as="xs:string" select="."/>
																				<xsl:variable name="var535_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var534_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var562_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var534_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var535_test_resultof_any">
																					<xsl:variable name="var550_cur" as="xs:string" select="."/>
																					<xsl:variable name="var537_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var536_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var562_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var536_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var537_test_resultof_any">
																						<xsl:variable name="var549_cur" as="xs:string" select="."/>
																						<xsl:variable name="var539_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var538_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var562_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var538_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var539_test_resultof_any">
																							<xsl:variable name="var548_cur" as="xs:string" select="."/>
																							<xsl:variable name="var541_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var540_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var562_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var540_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var541_test_resultof_any">
																								<xsl:variable name="var547_cur" as="xs:string" select="."/>
																								<xsl:variable name="var543_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var542_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var562_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var542_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var543_test_resultof_any">
																									<xsl:variable name="var546_cur" as="xs:string" select="."/>
																									<xsl:variable name="var545_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var562_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var544_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var562_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var544_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var545_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('8648-8' = $var560_cur), ('8648-8' = $var559_cur), ('8648-8' = $var558_cur), ('8648-8' = $var557_cur), ('8648-8' = $var556_cur), ('8648-8' = $var555_cur), ('8648-8' = $var554_cur), ('8648-8' = $var553_cur), ('8648-8' = $var552_cur), ('8648-8' = $var551_cur), ('8648-8' = $var550_cur), ('8648-8' = $var549_cur), ('8648-8' = $var548_cur), ('8648-8' = $var547_cur), ('8648-8' = $var546_cur), ('8648-8' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var561_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var563_resultof_filter">
								<xsl:variable name="var566_cur" as="node()" select="."/>
								<xsl:variable name="var565_resource" as="node()*" select="$var567_current/ns0:resource"/>
								<xsl:variable name="var564_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var565_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var565_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var565_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var565_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var565_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var565_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var565_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var565_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var565_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var565_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var565_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var565_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var565_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var565_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var565_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var565_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var565_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var564_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var566_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDiagnosticSummary'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11450-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Problem list - Reported'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Problem list - Reported'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionDiagnosticSummary</xhtml:div>
						</text>
						<xsl:variable name="var641_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var632_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var632_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var633_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var633_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var634_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var634_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var635_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var635_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var636_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var636_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var637_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var637_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var638_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var638_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var639_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var639_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var640_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var640_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var641_let">
							<xsl:variable name="var631_current" as="node()" select="."/>
							<xsl:variable name="var627_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var626_resource" as="node()*" select="$var631_current/ns0:resource"/>
									<xsl:variable name="var579_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var578_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var626_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var578_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var625_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var579_test_resultof_any">
											<xsl:variable name="var624_cur" as="xs:string" select="."/>
											<xsl:variable name="var581_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var580_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var626_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var580_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var581_test_resultof_any">
												<xsl:variable name="var623_cur" as="xs:string" select="."/>
												<xsl:variable name="var583_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var582_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var626_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var582_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var583_test_resultof_any">
													<xsl:variable name="var622_cur" as="xs:string" select="."/>
													<xsl:variable name="var585_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var584_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var626_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var584_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var585_test_resultof_any">
														<xsl:variable name="var621_cur" as="xs:string" select="."/>
														<xsl:variable name="var587_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var586_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var626_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var586_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var587_test_resultof_any">
															<xsl:variable name="var620_cur" as="xs:string" select="."/>
															<xsl:variable name="var589_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var588_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var626_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var588_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var589_test_resultof_any">
																<xsl:variable name="var619_cur" as="xs:string" select="."/>
																<xsl:variable name="var591_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var590_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var626_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var590_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var591_test_resultof_any">
																	<xsl:variable name="var618_cur" as="xs:string" select="."/>
																	<xsl:variable name="var593_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var592_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var626_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var592_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var593_test_resultof_any">
																		<xsl:variable name="var617_cur" as="xs:string" select="."/>
																		<xsl:variable name="var595_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var594_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var626_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var594_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var595_test_resultof_any">
																			<xsl:variable name="var616_cur" as="xs:string" select="."/>
																			<xsl:variable name="var597_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var596_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var626_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var596_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var597_test_resultof_any">
																				<xsl:variable name="var615_cur" as="xs:string" select="."/>
																				<xsl:variable name="var599_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var598_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var626_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var598_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var599_test_resultof_any">
																					<xsl:variable name="var614_cur" as="xs:string" select="."/>
																					<xsl:variable name="var601_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var600_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var626_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var600_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var601_test_resultof_any">
																						<xsl:variable name="var613_cur" as="xs:string" select="."/>
																						<xsl:variable name="var603_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var602_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var626_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var602_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var603_test_resultof_any">
																							<xsl:variable name="var612_cur" as="xs:string" select="."/>
																							<xsl:variable name="var605_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var604_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var626_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var604_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var605_test_resultof_any">
																								<xsl:variable name="var611_cur" as="xs:string" select="."/>
																								<xsl:variable name="var607_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var606_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var626_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var606_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var607_test_resultof_any">
																									<xsl:variable name="var610_cur" as="xs:string" select="."/>
																									<xsl:variable name="var609_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var626_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var608_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var626_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var608_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var609_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('11450-4' = $var624_cur), ('11450-4' = $var623_cur), ('11450-4' = $var622_cur), ('11450-4' = $var621_cur), ('11450-4' = $var620_cur), ('11450-4' = $var619_cur), ('11450-4' = $var618_cur), ('11450-4' = $var617_cur), ('11450-4' = $var616_cur), ('11450-4' = $var615_cur), ('11450-4' = $var614_cur), ('11450-4' = $var613_cur), ('11450-4' = $var612_cur), ('11450-4' = $var611_cur), ('11450-4' = $var610_cur), ('11450-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var625_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var627_resultof_filter">
								<xsl:variable name="var630_cur" as="node()" select="."/>
								<xsl:variable name="var629_resource" as="node()*" select="$var631_current/ns0:resource"/>
								<xsl:variable name="var628_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var629_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var629_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var629_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var629_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var629_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var629_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var629_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var629_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var629_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var629_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var629_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var629_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var629_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var629_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var629_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var629_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var629_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var628_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var630_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionSignificantProcedures'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10185-7'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital discharge procedure note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital discharge procedure note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionSignificantProcedures</xhtml:div>
						</text>
						<xsl:variable name="var705_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var696_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var696_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var697_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var697_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var698_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var698_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var699_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var699_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var700_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var700_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var701_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var701_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var702_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var702_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var703_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var703_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var704_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var704_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var705_let">
							<xsl:variable name="var695_current" as="node()" select="."/>
							<xsl:variable name="var691_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var690_resource" as="node()*" select="$var695_current/ns0:resource"/>
									<xsl:variable name="var643_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var642_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var690_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var642_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var689_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var643_test_resultof_any">
											<xsl:variable name="var688_cur" as="xs:string" select="."/>
											<xsl:variable name="var645_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var644_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var690_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var644_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var645_test_resultof_any">
												<xsl:variable name="var687_cur" as="xs:string" select="."/>
												<xsl:variable name="var647_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var646_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var690_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var646_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var647_test_resultof_any">
													<xsl:variable name="var686_cur" as="xs:string" select="."/>
													<xsl:variable name="var649_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var648_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var690_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var648_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var649_test_resultof_any">
														<xsl:variable name="var685_cur" as="xs:string" select="."/>
														<xsl:variable name="var651_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var650_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var690_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var650_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var651_test_resultof_any">
															<xsl:variable name="var684_cur" as="xs:string" select="."/>
															<xsl:variable name="var653_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var652_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var690_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var652_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var653_test_resultof_any">
																<xsl:variable name="var683_cur" as="xs:string" select="."/>
																<xsl:variable name="var655_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var654_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var690_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var654_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var655_test_resultof_any">
																	<xsl:variable name="var682_cur" as="xs:string" select="."/>
																	<xsl:variable name="var657_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var656_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var690_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var656_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var657_test_resultof_any">
																		<xsl:variable name="var681_cur" as="xs:string" select="."/>
																		<xsl:variable name="var659_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var658_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var690_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var658_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var659_test_resultof_any">
																			<xsl:variable name="var680_cur" as="xs:string" select="."/>
																			<xsl:variable name="var661_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var660_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var690_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var660_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var661_test_resultof_any">
																				<xsl:variable name="var679_cur" as="xs:string" select="."/>
																				<xsl:variable name="var663_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var662_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var690_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var662_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var663_test_resultof_any">
																					<xsl:variable name="var678_cur" as="xs:string" select="."/>
																					<xsl:variable name="var665_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var664_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var690_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var664_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var665_test_resultof_any">
																						<xsl:variable name="var677_cur" as="xs:string" select="."/>
																						<xsl:variable name="var667_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var666_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var690_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var666_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var667_test_resultof_any">
																							<xsl:variable name="var676_cur" as="xs:string" select="."/>
																							<xsl:variable name="var669_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var668_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var690_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var668_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var669_test_resultof_any">
																								<xsl:variable name="var675_cur" as="xs:string" select="."/>
																								<xsl:variable name="var671_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var670_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var690_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var670_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var671_test_resultof_any">
																									<xsl:variable name="var674_cur" as="xs:string" select="."/>
																									<xsl:variable name="var673_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var690_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var672_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var690_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var672_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var673_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10185-7' = $var688_cur), ('10185-7' = $var687_cur), ('10185-7' = $var686_cur), ('10185-7' = $var685_cur), ('10185-7' = $var684_cur), ('10185-7' = $var683_cur), ('10185-7' = $var682_cur), ('10185-7' = $var681_cur), ('10185-7' = $var680_cur), ('10185-7' = $var679_cur), ('10185-7' = $var678_cur), ('10185-7' = $var677_cur), ('10185-7' = $var676_cur), ('10185-7' = $var675_cur), ('10185-7' = $var674_cur), ('10185-7' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var689_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var691_resultof_filter">
								<xsl:variable name="var694_cur" as="node()" select="."/>
								<xsl:variable name="var693_resource" as="node()*" select="$var695_current/ns0:resource"/>
								<xsl:variable name="var692_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var693_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var693_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var693_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var693_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var693_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var693_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var693_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var693_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var693_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var693_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var693_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var693_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var693_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var693_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var693_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var693_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var693_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var692_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var694_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionMedicalDevices'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'46264-8'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of medical device use'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of medical device use'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionMedicalDevices</xhtml:div>
						</text>
						<xsl:variable name="var769_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var760_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var760_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var761_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var761_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var762_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var762_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var763_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var763_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var764_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var764_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var765_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var765_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var766_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var766_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var767_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var767_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var768_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var768_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var769_let">
							<xsl:variable name="var759_current" as="node()" select="."/>
							<xsl:variable name="var755_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var754_resource" as="node()*" select="$var759_current/ns0:resource"/>
									<xsl:variable name="var707_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var706_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var754_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var706_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var753_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var707_test_resultof_any">
											<xsl:variable name="var752_cur" as="xs:string" select="."/>
											<xsl:variable name="var709_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var708_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var754_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var708_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var709_test_resultof_any">
												<xsl:variable name="var751_cur" as="xs:string" select="."/>
												<xsl:variable name="var711_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var710_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var754_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var710_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var711_test_resultof_any">
													<xsl:variable name="var750_cur" as="xs:string" select="."/>
													<xsl:variable name="var713_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var712_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var754_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var712_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var713_test_resultof_any">
														<xsl:variable name="var749_cur" as="xs:string" select="."/>
														<xsl:variable name="var715_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var714_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var754_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var714_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var715_test_resultof_any">
															<xsl:variable name="var748_cur" as="xs:string" select="."/>
															<xsl:variable name="var717_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var716_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var754_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var716_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var717_test_resultof_any">
																<xsl:variable name="var747_cur" as="xs:string" select="."/>
																<xsl:variable name="var719_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var718_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var754_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var718_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var719_test_resultof_any">
																	<xsl:variable name="var746_cur" as="xs:string" select="."/>
																	<xsl:variable name="var721_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var720_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var754_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var720_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var721_test_resultof_any">
																		<xsl:variable name="var745_cur" as="xs:string" select="."/>
																		<xsl:variable name="var723_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var722_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var754_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var722_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var723_test_resultof_any">
																			<xsl:variable name="var744_cur" as="xs:string" select="."/>
																			<xsl:variable name="var725_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var724_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var754_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var724_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var725_test_resultof_any">
																				<xsl:variable name="var743_cur" as="xs:string" select="."/>
																				<xsl:variable name="var727_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var726_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var754_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var726_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var727_test_resultof_any">
																					<xsl:variable name="var742_cur" as="xs:string" select="."/>
																					<xsl:variable name="var729_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var728_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var754_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var728_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var729_test_resultof_any">
																						<xsl:variable name="var741_cur" as="xs:string" select="."/>
																						<xsl:variable name="var731_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var730_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var754_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var730_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var731_test_resultof_any">
																							<xsl:variable name="var740_cur" as="xs:string" select="."/>
																							<xsl:variable name="var733_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var732_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var754_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var732_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var733_test_resultof_any">
																								<xsl:variable name="var739_cur" as="xs:string" select="."/>
																								<xsl:variable name="var735_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var734_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var754_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var734_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var735_test_resultof_any">
																									<xsl:variable name="var738_cur" as="xs:string" select="."/>
																									<xsl:variable name="var737_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var754_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var736_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var754_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var736_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var737_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('46264-8' = $var752_cur), ('46264-8' = $var751_cur), ('46264-8' = $var750_cur), ('46264-8' = $var749_cur), ('46264-8' = $var748_cur), ('46264-8' = $var747_cur), ('46264-8' = $var746_cur), ('46264-8' = $var745_cur), ('46264-8' = $var744_cur), ('46264-8' = $var743_cur), ('46264-8' = $var742_cur), ('46264-8' = $var741_cur), ('46264-8' = $var740_cur), ('46264-8' = $var739_cur), ('46264-8' = $var738_cur), ('46264-8' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var753_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var755_resultof_filter">
								<xsl:variable name="var758_cur" as="node()" select="."/>
								<xsl:variable name="var757_resource" as="node()*" select="$var759_current/ns0:resource"/>
								<xsl:variable name="var756_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var757_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var757_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var757_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var757_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var757_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var757_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var757_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var757_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var757_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var757_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var757_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var757_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var757_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var757_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var757_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var757_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var757_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var756_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var758_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionMedications'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10160-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Medication use Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Medication use Narrative'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionMedications</xhtml:div>
						</text>
						<xsl:variable name="var833_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var824_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var824_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var825_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var825_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var826_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var826_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var827_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var827_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var828_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var828_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var829_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var829_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var830_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var830_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var831_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var831_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var832_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var832_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var833_let">
							<xsl:variable name="var823_current" as="node()" select="."/>
							<xsl:variable name="var819_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var818_resource" as="node()*" select="$var823_current/ns0:resource"/>
									<xsl:variable name="var771_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var770_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var818_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var770_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var817_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var771_test_resultof_any">
											<xsl:variable name="var816_cur" as="xs:string" select="."/>
											<xsl:variable name="var773_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var772_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var818_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var772_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var773_test_resultof_any">
												<xsl:variable name="var815_cur" as="xs:string" select="."/>
												<xsl:variable name="var775_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var774_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var818_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var774_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var775_test_resultof_any">
													<xsl:variable name="var814_cur" as="xs:string" select="."/>
													<xsl:variable name="var777_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var776_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var818_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var776_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var777_test_resultof_any">
														<xsl:variable name="var813_cur" as="xs:string" select="."/>
														<xsl:variable name="var779_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var778_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var818_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var778_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var779_test_resultof_any">
															<xsl:variable name="var812_cur" as="xs:string" select="."/>
															<xsl:variable name="var781_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var780_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var818_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var780_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var781_test_resultof_any">
																<xsl:variable name="var811_cur" as="xs:string" select="."/>
																<xsl:variable name="var783_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var782_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var818_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var782_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var783_test_resultof_any">
																	<xsl:variable name="var810_cur" as="xs:string" select="."/>
																	<xsl:variable name="var785_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var784_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var818_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var784_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var785_test_resultof_any">
																		<xsl:variable name="var809_cur" as="xs:string" select="."/>
																		<xsl:variable name="var787_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var786_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var818_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var786_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var787_test_resultof_any">
																			<xsl:variable name="var808_cur" as="xs:string" select="."/>
																			<xsl:variable name="var789_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var788_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var818_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var788_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var789_test_resultof_any">
																				<xsl:variable name="var807_cur" as="xs:string" select="."/>
																				<xsl:variable name="var791_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var790_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var818_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var790_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var791_test_resultof_any">
																					<xsl:variable name="var806_cur" as="xs:string" select="."/>
																					<xsl:variable name="var793_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var792_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var818_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var792_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var793_test_resultof_any">
																						<xsl:variable name="var805_cur" as="xs:string" select="."/>
																						<xsl:variable name="var795_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var794_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var818_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var794_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var795_test_resultof_any">
																							<xsl:variable name="var804_cur" as="xs:string" select="."/>
																							<xsl:variable name="var797_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var796_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var818_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var796_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var797_test_resultof_any">
																								<xsl:variable name="var803_cur" as="xs:string" select="."/>
																								<xsl:variable name="var799_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var798_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var818_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var798_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var799_test_resultof_any">
																									<xsl:variable name="var802_cur" as="xs:string" select="."/>
																									<xsl:variable name="var801_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var818_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var800_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var818_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var800_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var801_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10160-0' = $var816_cur), ('10160-0' = $var815_cur), ('10160-0' = $var814_cur), ('10160-0' = $var813_cur), ('10160-0' = $var812_cur), ('10160-0' = $var811_cur), ('10160-0' = $var810_cur), ('10160-0' = $var809_cur), ('10160-0' = $var808_cur), ('10160-0' = $var807_cur), ('10160-0' = $var806_cur), ('10160-0' = $var805_cur), ('10160-0' = $var804_cur), ('10160-0' = $var803_cur), ('10160-0' = $var802_cur), ('10160-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var817_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var819_resultof_filter">
								<xsl:variable name="var822_cur" as="node()" select="."/>
								<xsl:variable name="var821_resource" as="node()*" select="$var823_current/ns0:resource"/>
								<xsl:variable name="var820_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var821_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var821_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var821_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var821_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var821_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var821_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var821_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var821_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var821_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var821_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var821_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var821_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var821_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var821_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var821_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var821_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var821_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var820_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var822_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionSignificantResults'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Relevant diagnostic tests/laboratory data note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Relevant diagnostic tests/laboratory data note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionSignificantResults</xhtml:div>
						</text>
						<xsl:variable name="var897_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var888_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var888_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var889_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var889_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var890_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var890_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var891_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var891_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var892_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var892_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var893_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var893_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var894_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var894_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var895_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var895_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var896_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var896_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var897_let">
							<xsl:variable name="var887_current" as="node()" select="."/>
							<xsl:variable name="var883_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var882_resource" as="node()*" select="$var887_current/ns0:resource"/>
									<xsl:variable name="var835_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var834_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var882_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var834_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var881_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var835_test_resultof_any">
											<xsl:variable name="var880_cur" as="xs:string" select="."/>
											<xsl:variable name="var837_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var836_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var882_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var836_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var837_test_resultof_any">
												<xsl:variable name="var879_cur" as="xs:string" select="."/>
												<xsl:variable name="var839_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var838_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var882_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var838_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var839_test_resultof_any">
													<xsl:variable name="var878_cur" as="xs:string" select="."/>
													<xsl:variable name="var841_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var840_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var882_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var840_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var841_test_resultof_any">
														<xsl:variable name="var877_cur" as="xs:string" select="."/>
														<xsl:variable name="var843_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var842_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var882_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var842_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var843_test_resultof_any">
															<xsl:variable name="var876_cur" as="xs:string" select="."/>
															<xsl:variable name="var845_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var844_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var882_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var844_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var845_test_resultof_any">
																<xsl:variable name="var875_cur" as="xs:string" select="."/>
																<xsl:variable name="var847_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var846_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var882_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var846_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var847_test_resultof_any">
																	<xsl:variable name="var874_cur" as="xs:string" select="."/>
																	<xsl:variable name="var849_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var848_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var882_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var848_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var849_test_resultof_any">
																		<xsl:variable name="var873_cur" as="xs:string" select="."/>
																		<xsl:variable name="var851_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var850_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var882_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var850_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var851_test_resultof_any">
																			<xsl:variable name="var872_cur" as="xs:string" select="."/>
																			<xsl:variable name="var853_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var852_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var882_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var852_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var853_test_resultof_any">
																				<xsl:variable name="var871_cur" as="xs:string" select="."/>
																				<xsl:variable name="var855_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var854_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var882_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var854_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var855_test_resultof_any">
																					<xsl:variable name="var870_cur" as="xs:string" select="."/>
																					<xsl:variable name="var857_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var856_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var882_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var856_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var857_test_resultof_any">
																						<xsl:variable name="var869_cur" as="xs:string" select="."/>
																						<xsl:variable name="var859_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var858_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var882_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var858_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var859_test_resultof_any">
																							<xsl:variable name="var868_cur" as="xs:string" select="."/>
																							<xsl:variable name="var861_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var860_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var882_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var860_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var861_test_resultof_any">
																								<xsl:variable name="var867_cur" as="xs:string" select="."/>
																								<xsl:variable name="var863_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var862_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var882_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var862_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var863_test_resultof_any">
																									<xsl:variable name="var866_cur" as="xs:string" select="."/>
																									<xsl:variable name="var865_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var882_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var864_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var882_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var864_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var865_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('30954-2' = $var880_cur), ('30954-2' = $var879_cur), ('30954-2' = $var878_cur), ('30954-2' = $var877_cur), ('30954-2' = $var876_cur), ('30954-2' = $var875_cur), ('30954-2' = $var874_cur), ('30954-2' = $var873_cur), ('30954-2' = $var872_cur), ('30954-2' = $var871_cur), ('30954-2' = $var870_cur), ('30954-2' = $var869_cur), ('30954-2' = $var868_cur), ('30954-2' = $var867_cur), ('30954-2' = $var866_cur), ('30954-2' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var881_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var883_resultof_filter">
								<xsl:variable name="var886_cur" as="node()" select="."/>
								<xsl:variable name="var885_resource" as="node()*" select="$var887_current/ns0:resource"/>
								<xsl:variable name="var884_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var885_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var885_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var885_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var885_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var885_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var885_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var885_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var885_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var885_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var885_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var885_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var885_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var885_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var885_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var885_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var885_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var885_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var884_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var886_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionSynthesis'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'51848-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Evaluation note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Evaluation note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionSynthesis</xhtml:div>
						</text>
						<xsl:variable name="var961_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var952_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var952_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var953_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var953_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var954_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var954_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var955_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var955_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var956_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var956_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var957_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var957_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var958_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var958_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var959_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var959_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var960_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var960_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var961_let">
							<xsl:variable name="var951_current" as="node()" select="."/>
							<xsl:variable name="var947_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var946_resource" as="node()*" select="$var951_current/ns0:resource"/>
									<xsl:variable name="var899_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var898_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var946_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var898_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var945_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var899_test_resultof_any">
											<xsl:variable name="var944_cur" as="xs:string" select="."/>
											<xsl:variable name="var901_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var900_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var946_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var900_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var901_test_resultof_any">
												<xsl:variable name="var943_cur" as="xs:string" select="."/>
												<xsl:variable name="var903_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var902_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var946_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var902_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var903_test_resultof_any">
													<xsl:variable name="var942_cur" as="xs:string" select="."/>
													<xsl:variable name="var905_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var904_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var946_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var904_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var905_test_resultof_any">
														<xsl:variable name="var941_cur" as="xs:string" select="."/>
														<xsl:variable name="var907_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var906_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var946_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var906_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var907_test_resultof_any">
															<xsl:variable name="var940_cur" as="xs:string" select="."/>
															<xsl:variable name="var909_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var908_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var946_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var908_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var909_test_resultof_any">
																<xsl:variable name="var939_cur" as="xs:string" select="."/>
																<xsl:variable name="var911_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var910_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var946_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var910_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var911_test_resultof_any">
																	<xsl:variable name="var938_cur" as="xs:string" select="."/>
																	<xsl:variable name="var913_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var912_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var946_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var912_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var913_test_resultof_any">
																		<xsl:variable name="var937_cur" as="xs:string" select="."/>
																		<xsl:variable name="var915_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var914_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var946_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var914_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var915_test_resultof_any">
																			<xsl:variable name="var936_cur" as="xs:string" select="."/>
																			<xsl:variable name="var917_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var916_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var946_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var916_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var917_test_resultof_any">
																				<xsl:variable name="var935_cur" as="xs:string" select="."/>
																				<xsl:variable name="var919_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var918_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var946_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var918_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var919_test_resultof_any">
																					<xsl:variable name="var934_cur" as="xs:string" select="."/>
																					<xsl:variable name="var921_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var920_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var946_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var920_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var921_test_resultof_any">
																						<xsl:variable name="var933_cur" as="xs:string" select="."/>
																						<xsl:variable name="var923_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var922_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var946_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var922_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var923_test_resultof_any">
																							<xsl:variable name="var932_cur" as="xs:string" select="."/>
																							<xsl:variable name="var925_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var924_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var946_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var924_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var925_test_resultof_any">
																								<xsl:variable name="var931_cur" as="xs:string" select="."/>
																								<xsl:variable name="var927_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var926_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var946_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var926_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var927_test_resultof_any">
																									<xsl:variable name="var930_cur" as="xs:string" select="."/>
																									<xsl:variable name="var929_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var946_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var928_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var946_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var928_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var929_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('51848-0' = $var944_cur), ('51848-0' = $var943_cur), ('51848-0' = $var942_cur), ('51848-0' = $var941_cur), ('51848-0' = $var940_cur), ('51848-0' = $var939_cur), ('51848-0' = $var938_cur), ('51848-0' = $var937_cur), ('51848-0' = $var936_cur), ('51848-0' = $var935_cur), ('51848-0' = $var934_cur), ('51848-0' = $var933_cur), ('51848-0' = $var932_cur), ('51848-0' = $var931_cur), ('51848-0' = $var930_cur), ('51848-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var945_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var947_resultof_filter">
								<xsl:variable name="var950_cur" as="node()" select="."/>
								<xsl:variable name="var949_resource" as="node()*" select="$var951_current/ns0:resource"/>
								<xsl:variable name="var948_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var949_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var949_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var949_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var949_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var949_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var949_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var949_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var949_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var949_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var949_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var949_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var949_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var949_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var949_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var949_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var949_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var949_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var948_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var950_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDischargeDetails'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8650-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital discharge disposition note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital discharge disposition note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionDischargeDetails</xhtml:div>
						</text>
						<xsl:variable name="var1025_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1016_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1016_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1017_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1017_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1018_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1018_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1019_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1019_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1020_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1020_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1021_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1021_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1022_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1022_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1023_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1023_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1024_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1024_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1025_let">
							<xsl:variable name="var1015_current" as="node()" select="."/>
							<xsl:variable name="var1011_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1010_resource" as="node()*" select="$var1015_current/ns0:resource"/>
									<xsl:variable name="var963_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var962_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1010_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var962_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1009_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var963_test_resultof_any">
											<xsl:variable name="var1008_cur" as="xs:string" select="."/>
											<xsl:variable name="var965_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var964_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1010_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var964_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var965_test_resultof_any">
												<xsl:variable name="var1007_cur" as="xs:string" select="."/>
												<xsl:variable name="var967_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var966_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1010_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var966_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var967_test_resultof_any">
													<xsl:variable name="var1006_cur" as="xs:string" select="."/>
													<xsl:variable name="var969_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var968_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1010_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var968_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var969_test_resultof_any">
														<xsl:variable name="var1005_cur" as="xs:string" select="."/>
														<xsl:variable name="var971_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var970_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1010_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var970_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var971_test_resultof_any">
															<xsl:variable name="var1004_cur" as="xs:string" select="."/>
															<xsl:variable name="var973_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var972_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1010_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var972_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var973_test_resultof_any">
																<xsl:variable name="var1003_cur" as="xs:string" select="."/>
																<xsl:variable name="var975_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var974_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1010_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var974_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var975_test_resultof_any">
																	<xsl:variable name="var1002_cur" as="xs:string" select="."/>
																	<xsl:variable name="var977_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var976_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1010_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var976_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var977_test_resultof_any">
																		<xsl:variable name="var1001_cur" as="xs:string" select="."/>
																		<xsl:variable name="var979_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var978_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1010_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var978_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var979_test_resultof_any">
																			<xsl:variable name="var1000_cur" as="xs:string" select="."/>
																			<xsl:variable name="var981_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var980_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1010_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var980_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var981_test_resultof_any">
																				<xsl:variable name="var999_cur" as="xs:string" select="."/>
																				<xsl:variable name="var983_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var982_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1010_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var982_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var983_test_resultof_any">
																					<xsl:variable name="var998_cur" as="xs:string" select="."/>
																					<xsl:variable name="var985_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var984_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1010_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var984_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var985_test_resultof_any">
																						<xsl:variable name="var997_cur" as="xs:string" select="."/>
																						<xsl:variable name="var987_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var986_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1010_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var986_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var987_test_resultof_any">
																							<xsl:variable name="var996_cur" as="xs:string" select="."/>
																							<xsl:variable name="var989_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var988_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1010_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var988_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var989_test_resultof_any">
																								<xsl:variable name="var995_cur" as="xs:string" select="."/>
																								<xsl:variable name="var991_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var990_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1010_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var990_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var991_test_resultof_any">
																									<xsl:variable name="var994_cur" as="xs:string" select="."/>
																									<xsl:variable name="var993_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1010_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var992_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1010_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var992_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var993_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('8650-4' = $var1008_cur), ('8650-4' = $var1007_cur), ('8650-4' = $var1006_cur), ('8650-4' = $var1005_cur), ('8650-4' = $var1004_cur), ('8650-4' = $var1003_cur), ('8650-4' = $var1002_cur), ('8650-4' = $var1001_cur), ('8650-4' = $var1000_cur), ('8650-4' = $var999_cur), ('8650-4' = $var998_cur), ('8650-4' = $var997_cur), ('8650-4' = $var996_cur), ('8650-4' = $var995_cur), ('8650-4' = $var994_cur), ('8650-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1009_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1011_resultof_filter">
								<xsl:variable name="var1014_cur" as="node()" select="."/>
								<xsl:variable name="var1013_resource" as="node()*" select="$var1015_current/ns0:resource"/>
								<xsl:variable name="var1012_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1013_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1013_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1013_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1013_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1013_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1013_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1013_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1013_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1013_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1013_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1013_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1013_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1013_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1013_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1013_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1013_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1013_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1012_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1014_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDischargeFindings'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10184-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital discharge physical findings Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital discharge physical findings Narrative'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionDischargeFindings</xhtml:div>
						</text>
						<xsl:variable name="var1089_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1080_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1080_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1081_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1081_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1082_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1082_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1083_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1083_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1084_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1084_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1085_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1085_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1086_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1086_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1087_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1087_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1088_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1088_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1089_let">
							<xsl:variable name="var1079_current" as="node()" select="."/>
							<xsl:variable name="var1075_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1074_resource" as="node()*" select="$var1079_current/ns0:resource"/>
									<xsl:variable name="var1027_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1026_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1074_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1026_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1073_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1027_test_resultof_any">
											<xsl:variable name="var1072_cur" as="xs:string" select="."/>
											<xsl:variable name="var1029_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1028_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1074_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1028_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1029_test_resultof_any">
												<xsl:variable name="var1071_cur" as="xs:string" select="."/>
												<xsl:variable name="var1031_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1030_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1074_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1030_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1031_test_resultof_any">
													<xsl:variable name="var1070_cur" as="xs:string" select="."/>
													<xsl:variable name="var1033_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1032_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1074_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1032_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1033_test_resultof_any">
														<xsl:variable name="var1069_cur" as="xs:string" select="."/>
														<xsl:variable name="var1035_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1034_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1074_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1034_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1035_test_resultof_any">
															<xsl:variable name="var1068_cur" as="xs:string" select="."/>
															<xsl:variable name="var1037_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1036_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1074_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1036_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1037_test_resultof_any">
																<xsl:variable name="var1067_cur" as="xs:string" select="."/>
																<xsl:variable name="var1039_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1038_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1074_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1038_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1039_test_resultof_any">
																	<xsl:variable name="var1066_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1041_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1040_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1074_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1040_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1041_test_resultof_any">
																		<xsl:variable name="var1065_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1043_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1042_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1074_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1042_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1043_test_resultof_any">
																			<xsl:variable name="var1064_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1045_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1044_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1074_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1044_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1045_test_resultof_any">
																				<xsl:variable name="var1063_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1047_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1046_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1074_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1046_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1047_test_resultof_any">
																					<xsl:variable name="var1062_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1049_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1048_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1074_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1048_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1049_test_resultof_any">
																						<xsl:variable name="var1061_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1051_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1050_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1074_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1050_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1051_test_resultof_any">
																							<xsl:variable name="var1060_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1053_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1052_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1074_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1052_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1053_test_resultof_any">
																								<xsl:variable name="var1059_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1055_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1054_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1074_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1054_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1055_test_resultof_any">
																									<xsl:variable name="var1058_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1057_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1074_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1056_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1074_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1056_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1057_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10184-0' = $var1072_cur), ('10184-0' = $var1071_cur), ('10184-0' = $var1070_cur), ('10184-0' = $var1069_cur), ('10184-0' = $var1068_cur), ('10184-0' = $var1067_cur), ('10184-0' = $var1066_cur), ('10184-0' = $var1065_cur), ('10184-0' = $var1064_cur), ('10184-0' = $var1063_cur), ('10184-0' = $var1062_cur), ('10184-0' = $var1061_cur), ('10184-0' = $var1060_cur), ('10184-0' = $var1059_cur), ('10184-0' = $var1058_cur), ('10184-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1073_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1075_resultof_filter">
								<xsl:variable name="var1078_cur" as="node()" select="."/>
								<xsl:variable name="var1077_resource" as="node()*" select="$var1079_current/ns0:resource"/>
								<xsl:variable name="var1076_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1077_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1077_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1077_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1077_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1077_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1077_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1077_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1077_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1077_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1077_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1077_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1077_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1077_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1077_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1077_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1077_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1077_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1076_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1078_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionProceduresHx'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'47519-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Procedures Document'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Procedures Document'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionProceduresHx</xhtml:div>
						</text>
						<xsl:variable name="var1153_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1144_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1144_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1145_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1145_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1146_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1146_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1147_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1147_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1148_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1148_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1149_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1149_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1150_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1150_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1151_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1151_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1152_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1152_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1153_let">
							<xsl:variable name="var1143_current" as="node()" select="."/>
							<xsl:variable name="var1139_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1138_resource" as="node()*" select="$var1143_current/ns0:resource"/>
									<xsl:variable name="var1091_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1090_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1138_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1090_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1137_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1091_test_resultof_any">
											<xsl:variable name="var1136_cur" as="xs:string" select="."/>
											<xsl:variable name="var1093_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1092_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1138_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1092_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1093_test_resultof_any">
												<xsl:variable name="var1135_cur" as="xs:string" select="."/>
												<xsl:variable name="var1095_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1094_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1138_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1094_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1095_test_resultof_any">
													<xsl:variable name="var1134_cur" as="xs:string" select="."/>
													<xsl:variable name="var1097_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1096_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1138_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1096_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1097_test_resultof_any">
														<xsl:variable name="var1133_cur" as="xs:string" select="."/>
														<xsl:variable name="var1099_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1098_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1138_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1098_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1099_test_resultof_any">
															<xsl:variable name="var1132_cur" as="xs:string" select="."/>
															<xsl:variable name="var1101_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1100_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1138_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1100_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1101_test_resultof_any">
																<xsl:variable name="var1131_cur" as="xs:string" select="."/>
																<xsl:variable name="var1103_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1102_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1138_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1102_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1103_test_resultof_any">
																	<xsl:variable name="var1130_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1105_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1104_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1138_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1104_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1105_test_resultof_any">
																		<xsl:variable name="var1129_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1107_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1106_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1138_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1106_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1107_test_resultof_any">
																			<xsl:variable name="var1128_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1109_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1108_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1138_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1108_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1109_test_resultof_any">
																				<xsl:variable name="var1127_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1111_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1110_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1138_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1110_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1111_test_resultof_any">
																					<xsl:variable name="var1126_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1113_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1112_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1138_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1112_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1113_test_resultof_any">
																						<xsl:variable name="var1125_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1115_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1114_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1138_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1114_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1115_test_resultof_any">
																							<xsl:variable name="var1124_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1117_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1116_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1138_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1116_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1117_test_resultof_any">
																								<xsl:variable name="var1123_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1119_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1118_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1138_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1118_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1119_test_resultof_any">
																									<xsl:variable name="var1122_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1121_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1138_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1120_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1138_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1120_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1121_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('47519-4' = $var1136_cur), ('47519-4' = $var1135_cur), ('47519-4' = $var1134_cur), ('47519-4' = $var1133_cur), ('47519-4' = $var1132_cur), ('47519-4' = $var1131_cur), ('47519-4' = $var1130_cur), ('47519-4' = $var1129_cur), ('47519-4' = $var1128_cur), ('47519-4' = $var1127_cur), ('47519-4' = $var1126_cur), ('47519-4' = $var1125_cur), ('47519-4' = $var1124_cur), ('47519-4' = $var1123_cur), ('47519-4' = $var1122_cur), ('47519-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1137_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1139_resultof_filter">
								<xsl:variable name="var1142_cur" as="node()" select="."/>
								<xsl:variable name="var1141_resource" as="node()*" select="$var1143_current/ns0:resource"/>
								<xsl:variable name="var1140_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1141_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1141_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1141_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1141_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1141_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1141_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1141_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1141_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1141_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1141_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1141_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1141_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1141_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1141_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1141_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1141_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1141_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1140_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1142_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionImmunizations'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11369-6'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Immunization note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Immunization note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionImmunizations</xhtml:div>
						</text>
						<xsl:variable name="var1217_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1208_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1208_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1209_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1209_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1210_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1210_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1211_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1211_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1212_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1212_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1213_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1213_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1214_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1214_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1215_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1215_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1216_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1216_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1217_let">
							<xsl:variable name="var1207_current" as="node()" select="."/>
							<xsl:variable name="var1203_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1202_resource" as="node()*" select="$var1207_current/ns0:resource"/>
									<xsl:variable name="var1155_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1154_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1202_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1154_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1201_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1155_test_resultof_any">
											<xsl:variable name="var1200_cur" as="xs:string" select="."/>
											<xsl:variable name="var1157_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1156_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1202_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1156_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1157_test_resultof_any">
												<xsl:variable name="var1199_cur" as="xs:string" select="."/>
												<xsl:variable name="var1159_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1158_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1202_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1158_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1159_test_resultof_any">
													<xsl:variable name="var1198_cur" as="xs:string" select="."/>
													<xsl:variable name="var1161_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1160_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1202_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1160_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1161_test_resultof_any">
														<xsl:variable name="var1197_cur" as="xs:string" select="."/>
														<xsl:variable name="var1163_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1162_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1202_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1162_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1163_test_resultof_any">
															<xsl:variable name="var1196_cur" as="xs:string" select="."/>
															<xsl:variable name="var1165_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1164_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1202_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1164_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1165_test_resultof_any">
																<xsl:variable name="var1195_cur" as="xs:string" select="."/>
																<xsl:variable name="var1167_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1166_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1202_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1166_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1167_test_resultof_any">
																	<xsl:variable name="var1194_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1169_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1168_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1202_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1168_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1169_test_resultof_any">
																		<xsl:variable name="var1193_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1171_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1170_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1202_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1170_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1171_test_resultof_any">
																			<xsl:variable name="var1192_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1173_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1172_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1202_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1172_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1173_test_resultof_any">
																				<xsl:variable name="var1191_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1175_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1174_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1202_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1174_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1175_test_resultof_any">
																					<xsl:variable name="var1190_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1177_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1176_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1202_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1176_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1177_test_resultof_any">
																						<xsl:variable name="var1189_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1179_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1178_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1202_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1178_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1179_test_resultof_any">
																							<xsl:variable name="var1188_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1181_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1180_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1202_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1180_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1181_test_resultof_any">
																								<xsl:variable name="var1187_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1183_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1182_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1202_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1182_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1183_test_resultof_any">
																									<xsl:variable name="var1186_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1185_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1202_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1184_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1202_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1184_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1185_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('11369-6' = $var1200_cur), ('11369-6' = $var1199_cur), ('11369-6' = $var1198_cur), ('11369-6' = $var1197_cur), ('11369-6' = $var1196_cur), ('11369-6' = $var1195_cur), ('11369-6' = $var1194_cur), ('11369-6' = $var1193_cur), ('11369-6' = $var1192_cur), ('11369-6' = $var1191_cur), ('11369-6' = $var1190_cur), ('11369-6' = $var1189_cur), ('11369-6' = $var1188_cur), ('11369-6' = $var1187_cur), ('11369-6' = $var1186_cur), ('11369-6' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1201_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1203_resultof_filter">
								<xsl:variable name="var1206_cur" as="node()" select="."/>
								<xsl:variable name="var1205_resource" as="node()*" select="$var1207_current/ns0:resource"/>
								<xsl:variable name="var1204_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1205_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1205_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1205_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1205_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1205_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1205_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1205_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1205_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1205_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1205_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1205_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1205_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1205_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1205_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1205_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1205_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1205_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1204_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1206_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionFamilyHistory'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10157-6'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of family member diseases note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of family member diseases note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionFamilyHistory</xhtml:div>
						</text>
						<xsl:variable name="var1281_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1272_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1272_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1273_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1273_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1274_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1274_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1275_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1275_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1276_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1276_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1277_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1277_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1278_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1278_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1279_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1279_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1280_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1280_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1281_let">
							<xsl:variable name="var1271_current" as="node()" select="."/>
							<xsl:variable name="var1267_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1266_resource" as="node()*" select="$var1271_current/ns0:resource"/>
									<xsl:variable name="var1219_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1218_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1266_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1218_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1265_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1219_test_resultof_any">
											<xsl:variable name="var1264_cur" as="xs:string" select="."/>
											<xsl:variable name="var1221_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1220_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1266_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1220_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1221_test_resultof_any">
												<xsl:variable name="var1263_cur" as="xs:string" select="."/>
												<xsl:variable name="var1223_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1222_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1266_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1222_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1223_test_resultof_any">
													<xsl:variable name="var1262_cur" as="xs:string" select="."/>
													<xsl:variable name="var1225_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1224_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1266_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1224_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1225_test_resultof_any">
														<xsl:variable name="var1261_cur" as="xs:string" select="."/>
														<xsl:variable name="var1227_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1226_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1266_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1226_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1227_test_resultof_any">
															<xsl:variable name="var1260_cur" as="xs:string" select="."/>
															<xsl:variable name="var1229_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1228_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1266_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1228_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1229_test_resultof_any">
																<xsl:variable name="var1259_cur" as="xs:string" select="."/>
																<xsl:variable name="var1231_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1230_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1266_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1230_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1231_test_resultof_any">
																	<xsl:variable name="var1258_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1233_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1232_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1266_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1232_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1233_test_resultof_any">
																		<xsl:variable name="var1257_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1235_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1234_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1266_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1234_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1235_test_resultof_any">
																			<xsl:variable name="var1256_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1237_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1236_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1266_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1236_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1237_test_resultof_any">
																				<xsl:variable name="var1255_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1239_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1238_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1266_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1238_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1239_test_resultof_any">
																					<xsl:variable name="var1254_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1241_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1240_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1266_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1240_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1241_test_resultof_any">
																						<xsl:variable name="var1253_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1243_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1242_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1266_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1242_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1243_test_resultof_any">
																							<xsl:variable name="var1252_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1245_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1244_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1266_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1244_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1245_test_resultof_any">
																								<xsl:variable name="var1251_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1247_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1246_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1266_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1246_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1247_test_resultof_any">
																									<xsl:variable name="var1250_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1249_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1266_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1248_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1266_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1248_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1249_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10157-6' = $var1264_cur), ('10157-6' = $var1263_cur), ('10157-6' = $var1262_cur), ('10157-6' = $var1261_cur), ('10157-6' = $var1260_cur), ('10157-6' = $var1259_cur), ('10157-6' = $var1258_cur), ('10157-6' = $var1257_cur), ('10157-6' = $var1256_cur), ('10157-6' = $var1255_cur), ('10157-6' = $var1254_cur), ('10157-6' = $var1253_cur), ('10157-6' = $var1252_cur), ('10157-6' = $var1251_cur), ('10157-6' = $var1250_cur), ('10157-6' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1265_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1267_resultof_filter">
								<xsl:variable name="var1270_cur" as="node()" select="."/>
								<xsl:variable name="var1269_resource" as="node()*" select="$var1271_current/ns0:resource"/>
								<xsl:variable name="var1268_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1269_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1269_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1269_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1269_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1269_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1269_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1269_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1269_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1269_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1269_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1269_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1269_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1269_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1269_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1269_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1269_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1269_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1268_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1270_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPastIllnessHx'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11348-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Past illness note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Past illness note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionPastIllnessHx</xhtml:div>
						</text>
						<xsl:variable name="var1345_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1336_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1336_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1337_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1337_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1338_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1338_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1339_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1339_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1340_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1340_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1341_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1341_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1342_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1342_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1343_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1343_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1344_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1344_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1345_let">
							<xsl:variable name="var1335_current" as="node()" select="."/>
							<xsl:variable name="var1331_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1330_resource" as="node()*" select="$var1335_current/ns0:resource"/>
									<xsl:variable name="var1283_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1282_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1330_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1282_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1329_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1283_test_resultof_any">
											<xsl:variable name="var1328_cur" as="xs:string" select="."/>
											<xsl:variable name="var1285_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1284_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1330_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1284_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1285_test_resultof_any">
												<xsl:variable name="var1327_cur" as="xs:string" select="."/>
												<xsl:variable name="var1287_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1286_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1330_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1286_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1287_test_resultof_any">
													<xsl:variable name="var1326_cur" as="xs:string" select="."/>
													<xsl:variable name="var1289_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1288_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1330_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1288_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1289_test_resultof_any">
														<xsl:variable name="var1325_cur" as="xs:string" select="."/>
														<xsl:variable name="var1291_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1290_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1330_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1290_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1291_test_resultof_any">
															<xsl:variable name="var1324_cur" as="xs:string" select="."/>
															<xsl:variable name="var1293_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1292_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1330_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1292_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1293_test_resultof_any">
																<xsl:variable name="var1323_cur" as="xs:string" select="."/>
																<xsl:variable name="var1295_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1294_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1330_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1294_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1295_test_resultof_any">
																	<xsl:variable name="var1322_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1297_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1296_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1330_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1296_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1297_test_resultof_any">
																		<xsl:variable name="var1321_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1299_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1298_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1330_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1298_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1299_test_resultof_any">
																			<xsl:variable name="var1320_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1301_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1300_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1330_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1300_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1301_test_resultof_any">
																				<xsl:variable name="var1319_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1303_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1302_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1330_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1302_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1303_test_resultof_any">
																					<xsl:variable name="var1318_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1305_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1304_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1330_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1304_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1305_test_resultof_any">
																						<xsl:variable name="var1317_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1307_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1306_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1330_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1306_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1307_test_resultof_any">
																							<xsl:variable name="var1316_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1309_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1308_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1330_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1308_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1309_test_resultof_any">
																								<xsl:variable name="var1315_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1311_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1310_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1330_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1310_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1311_test_resultof_any">
																									<xsl:variable name="var1314_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1313_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1330_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1312_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1330_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1312_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1313_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('11348-0' = $var1328_cur), ('11348-0' = $var1327_cur), ('11348-0' = $var1326_cur), ('11348-0' = $var1325_cur), ('11348-0' = $var1324_cur), ('11348-0' = $var1323_cur), ('11348-0' = $var1322_cur), ('11348-0' = $var1321_cur), ('11348-0' = $var1320_cur), ('11348-0' = $var1319_cur), ('11348-0' = $var1318_cur), ('11348-0' = $var1317_cur), ('11348-0' = $var1316_cur), ('11348-0' = $var1315_cur), ('11348-0' = $var1314_cur), ('11348-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1329_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1331_resultof_filter">
								<xsl:variable name="var1334_cur" as="node()" select="."/>
								<xsl:variable name="var1333_resource" as="node()*" select="$var1335_current/ns0:resource"/>
								<xsl:variable name="var1332_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1333_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1333_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1333_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1333_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1333_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1333_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1333_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1333_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1333_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1333_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1333_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1333_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1333_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1333_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1333_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1333_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1333_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1332_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1334_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionCareTeam'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'85847-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Patient Care team information'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Patient Care team information'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionCareTeam</xhtml:div>
						</text>
						<xsl:variable name="var1409_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1400_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1400_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1401_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1401_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1402_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1402_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1403_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1403_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1404_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1404_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1405_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1405_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1406_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1406_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1407_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1407_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1408_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1408_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1409_let">
							<xsl:variable name="var1399_current" as="node()" select="."/>
							<xsl:variable name="var1395_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1394_resource" as="node()*" select="$var1399_current/ns0:resource"/>
									<xsl:variable name="var1347_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1346_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1394_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1346_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1393_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1347_test_resultof_any">
											<xsl:variable name="var1392_cur" as="xs:string" select="."/>
											<xsl:variable name="var1349_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1348_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1394_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1348_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1349_test_resultof_any">
												<xsl:variable name="var1391_cur" as="xs:string" select="."/>
												<xsl:variable name="var1351_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1350_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1394_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1350_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1351_test_resultof_any">
													<xsl:variable name="var1390_cur" as="xs:string" select="."/>
													<xsl:variable name="var1353_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1352_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1394_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1352_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1353_test_resultof_any">
														<xsl:variable name="var1389_cur" as="xs:string" select="."/>
														<xsl:variable name="var1355_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1354_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1394_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1354_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1355_test_resultof_any">
															<xsl:variable name="var1388_cur" as="xs:string" select="."/>
															<xsl:variable name="var1357_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1356_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1394_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1356_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1357_test_resultof_any">
																<xsl:variable name="var1387_cur" as="xs:string" select="."/>
																<xsl:variable name="var1359_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1358_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1394_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1358_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1359_test_resultof_any">
																	<xsl:variable name="var1386_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1361_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1360_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1394_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1360_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1361_test_resultof_any">
																		<xsl:variable name="var1385_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1363_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1362_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1394_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1362_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1363_test_resultof_any">
																			<xsl:variable name="var1384_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1365_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1364_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1394_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1364_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1365_test_resultof_any">
																				<xsl:variable name="var1383_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1367_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1366_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1394_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1366_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1367_test_resultof_any">
																					<xsl:variable name="var1382_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1369_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1368_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1394_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1368_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1369_test_resultof_any">
																						<xsl:variable name="var1381_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1371_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1370_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1394_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1370_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1371_test_resultof_any">
																							<xsl:variable name="var1380_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1373_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1372_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1394_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1372_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1373_test_resultof_any">
																								<xsl:variable name="var1379_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1375_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1374_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1394_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1374_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1375_test_resultof_any">
																									<xsl:variable name="var1378_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1377_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1394_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1376_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1394_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1376_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1377_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('85847-2' = $var1392_cur), ('85847-2' = $var1391_cur), ('85847-2' = $var1390_cur), ('85847-2' = $var1389_cur), ('85847-2' = $var1388_cur), ('85847-2' = $var1387_cur), ('85847-2' = $var1386_cur), ('85847-2' = $var1385_cur), ('85847-2' = $var1384_cur), ('85847-2' = $var1383_cur), ('85847-2' = $var1382_cur), ('85847-2' = $var1381_cur), ('85847-2' = $var1380_cur), ('85847-2' = $var1379_cur), ('85847-2' = $var1378_cur), ('85847-2' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1393_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1395_resultof_filter">
								<xsl:variable name="var1398_cur" as="node()" select="."/>
								<xsl:variable name="var1397_resource" as="node()*" select="$var1399_current/ns0:resource"/>
								<xsl:variable name="var1396_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1397_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1397_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1397_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1397_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1397_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1397_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1397_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1397_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1397_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1397_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1397_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1397_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1397_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1397_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1397_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1397_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1397_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1396_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1398_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionSocialHistory'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Social history note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Social history note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionSocialHistory</xhtml:div>
						</text>
						<xsl:variable name="var1473_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1464_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1464_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1465_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1465_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1466_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1466_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1467_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1467_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1468_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1468_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1469_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1469_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1470_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1470_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1471_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1471_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1472_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1472_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1473_let">
							<xsl:variable name="var1463_current" as="node()" select="."/>
							<xsl:variable name="var1459_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1458_resource" as="node()*" select="$var1463_current/ns0:resource"/>
									<xsl:variable name="var1411_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1410_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1458_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1410_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1457_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1411_test_resultof_any">
											<xsl:variable name="var1456_cur" as="xs:string" select="."/>
											<xsl:variable name="var1413_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1412_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1458_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1412_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1413_test_resultof_any">
												<xsl:variable name="var1455_cur" as="xs:string" select="."/>
												<xsl:variable name="var1415_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1414_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1458_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1414_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1415_test_resultof_any">
													<xsl:variable name="var1454_cur" as="xs:string" select="."/>
													<xsl:variable name="var1417_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1416_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1458_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1416_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1417_test_resultof_any">
														<xsl:variable name="var1453_cur" as="xs:string" select="."/>
														<xsl:variable name="var1419_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1418_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1458_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1418_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1419_test_resultof_any">
															<xsl:variable name="var1452_cur" as="xs:string" select="."/>
															<xsl:variable name="var1421_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1420_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1458_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1420_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1421_test_resultof_any">
																<xsl:variable name="var1451_cur" as="xs:string" select="."/>
																<xsl:variable name="var1423_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1422_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1458_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1422_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1423_test_resultof_any">
																	<xsl:variable name="var1450_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1425_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1424_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1458_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1424_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1425_test_resultof_any">
																		<xsl:variable name="var1449_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1427_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1426_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1458_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1426_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1427_test_resultof_any">
																			<xsl:variable name="var1448_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1429_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1428_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1458_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1428_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1429_test_resultof_any">
																				<xsl:variable name="var1447_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1431_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1430_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1458_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1430_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1431_test_resultof_any">
																					<xsl:variable name="var1446_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1433_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1432_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1458_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1432_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1433_test_resultof_any">
																						<xsl:variable name="var1445_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1435_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1434_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1458_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1434_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1435_test_resultof_any">
																							<xsl:variable name="var1444_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1437_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1436_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1458_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1436_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1437_test_resultof_any">
																								<xsl:variable name="var1443_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1439_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1438_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1458_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1438_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1439_test_resultof_any">
																									<xsl:variable name="var1442_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1441_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1458_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1440_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1458_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1440_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1441_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('29762-2' = $var1456_cur), ('29762-2' = $var1455_cur), ('29762-2' = $var1454_cur), ('29762-2' = $var1453_cur), ('29762-2' = $var1452_cur), ('29762-2' = $var1451_cur), ('29762-2' = $var1450_cur), ('29762-2' = $var1449_cur), ('29762-2' = $var1448_cur), ('29762-2' = $var1447_cur), ('29762-2' = $var1446_cur), ('29762-2' = $var1445_cur), ('29762-2' = $var1444_cur), ('29762-2' = $var1443_cur), ('29762-2' = $var1442_cur), ('29762-2' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1457_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1459_resultof_filter">
								<xsl:variable name="var1462_cur" as="node()" select="."/>
								<xsl:variable name="var1461_resource" as="node()*" select="$var1463_current/ns0:resource"/>
								<xsl:variable name="var1460_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1461_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1461_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1461_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1461_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1461_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1461_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1461_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1461_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1461_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1461_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1461_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1461_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1461_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1461_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1461_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1461_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1461_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1460_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1462_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPlanOfCare'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'18776-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Plan of care note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Plan of care note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionPlanOfCare</xhtml:div>
						</text>
						<xsl:variable name="var1537_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1528_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1528_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1529_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1529_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1530_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1530_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1531_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1531_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1532_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1532_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1533_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1533_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1534_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1534_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1535_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1535_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1536_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1536_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1537_let">
							<xsl:variable name="var1527_current" as="node()" select="."/>
							<xsl:variable name="var1523_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1522_resource" as="node()*" select="$var1527_current/ns0:resource"/>
									<xsl:variable name="var1475_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1474_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1522_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1474_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1521_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1475_test_resultof_any">
											<xsl:variable name="var1520_cur" as="xs:string" select="."/>
											<xsl:variable name="var1477_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1476_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1522_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1476_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1477_test_resultof_any">
												<xsl:variable name="var1519_cur" as="xs:string" select="."/>
												<xsl:variable name="var1479_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1478_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1522_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1478_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1479_test_resultof_any">
													<xsl:variable name="var1518_cur" as="xs:string" select="."/>
													<xsl:variable name="var1481_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1480_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1522_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1480_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1481_test_resultof_any">
														<xsl:variable name="var1517_cur" as="xs:string" select="."/>
														<xsl:variable name="var1483_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1482_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1522_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1482_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1483_test_resultof_any">
															<xsl:variable name="var1516_cur" as="xs:string" select="."/>
															<xsl:variable name="var1485_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1484_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1522_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1484_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1485_test_resultof_any">
																<xsl:variable name="var1515_cur" as="xs:string" select="."/>
																<xsl:variable name="var1487_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1486_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1522_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1486_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1487_test_resultof_any">
																	<xsl:variable name="var1514_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1489_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1488_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1522_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1488_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1489_test_resultof_any">
																		<xsl:variable name="var1513_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1491_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1490_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1522_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1490_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1491_test_resultof_any">
																			<xsl:variable name="var1512_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1493_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1492_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1522_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1492_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1493_test_resultof_any">
																				<xsl:variable name="var1511_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1495_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1494_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1522_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1494_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1495_test_resultof_any">
																					<xsl:variable name="var1510_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1497_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1496_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1522_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1496_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1497_test_resultof_any">
																						<xsl:variable name="var1509_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1499_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1498_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1522_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1498_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1499_test_resultof_any">
																							<xsl:variable name="var1508_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1501_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1500_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1522_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1500_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1501_test_resultof_any">
																								<xsl:variable name="var1507_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1503_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1502_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1522_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1502_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1503_test_resultof_any">
																									<xsl:variable name="var1506_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1505_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1522_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1504_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1522_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1504_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1505_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('18776-5' = $var1520_cur), ('18776-5' = $var1519_cur), ('18776-5' = $var1518_cur), ('18776-5' = $var1517_cur), ('18776-5' = $var1516_cur), ('18776-5' = $var1515_cur), ('18776-5' = $var1514_cur), ('18776-5' = $var1513_cur), ('18776-5' = $var1512_cur), ('18776-5' = $var1511_cur), ('18776-5' = $var1510_cur), ('18776-5' = $var1509_cur), ('18776-5' = $var1508_cur), ('18776-5' = $var1507_cur), ('18776-5' = $var1506_cur), ('18776-5' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1521_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1523_resultof_filter">
								<xsl:variable name="var1526_cur" as="node()" select="."/>
								<xsl:variable name="var1525_resource" as="node()*" select="$var1527_current/ns0:resource"/>
								<xsl:variable name="var1524_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1525_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1525_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1525_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1525_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1525_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1525_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1525_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1525_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1525_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1525_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1525_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1525_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1525_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1525_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1525_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1525_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1525_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1524_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1526_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDischargeMedications'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'75311-1'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Discharge medications note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Discharge medications note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionDischargeMedications</xhtml:div>
						</text>
						<xsl:variable name="var1601_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1592_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1592_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1593_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1593_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1594_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1594_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1595_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1595_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1596_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1596_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1597_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1597_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1598_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1598_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1599_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1599_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1600_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1600_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1601_let">
							<xsl:variable name="var1591_current" as="node()" select="."/>
							<xsl:variable name="var1587_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1586_resource" as="node()*" select="$var1591_current/ns0:resource"/>
									<xsl:variable name="var1539_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1538_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1586_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1538_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1585_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1539_test_resultof_any">
											<xsl:variable name="var1584_cur" as="xs:string" select="."/>
											<xsl:variable name="var1541_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1540_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1586_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1540_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1541_test_resultof_any">
												<xsl:variable name="var1583_cur" as="xs:string" select="."/>
												<xsl:variable name="var1543_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1542_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1586_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1542_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1543_test_resultof_any">
													<xsl:variable name="var1582_cur" as="xs:string" select="."/>
													<xsl:variable name="var1545_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1544_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1586_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1544_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1545_test_resultof_any">
														<xsl:variable name="var1581_cur" as="xs:string" select="."/>
														<xsl:variable name="var1547_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1546_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1586_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1546_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1547_test_resultof_any">
															<xsl:variable name="var1580_cur" as="xs:string" select="."/>
															<xsl:variable name="var1549_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1548_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1586_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1548_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1549_test_resultof_any">
																<xsl:variable name="var1579_cur" as="xs:string" select="."/>
																<xsl:variable name="var1551_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1550_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1586_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1550_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1551_test_resultof_any">
																	<xsl:variable name="var1578_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1553_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1552_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1586_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1552_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1553_test_resultof_any">
																		<xsl:variable name="var1577_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1555_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1554_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1586_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1554_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1555_test_resultof_any">
																			<xsl:variable name="var1576_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1557_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1556_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1586_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1556_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1557_test_resultof_any">
																				<xsl:variable name="var1575_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1559_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1558_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1586_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1558_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1559_test_resultof_any">
																					<xsl:variable name="var1574_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1561_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1560_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1586_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1560_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1561_test_resultof_any">
																						<xsl:variable name="var1573_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1563_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1562_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1586_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1562_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1563_test_resultof_any">
																							<xsl:variable name="var1572_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1565_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1564_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1586_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1564_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1565_test_resultof_any">
																								<xsl:variable name="var1571_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1567_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1566_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1586_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1566_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1567_test_resultof_any">
																									<xsl:variable name="var1570_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1569_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1586_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1568_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1586_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1568_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1569_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('75311-1' = $var1584_cur), ('75311-1' = $var1583_cur), ('75311-1' = $var1582_cur), ('75311-1' = $var1581_cur), ('75311-1' = $var1580_cur), ('75311-1' = $var1579_cur), ('75311-1' = $var1578_cur), ('75311-1' = $var1577_cur), ('75311-1' = $var1576_cur), ('75311-1' = $var1575_cur), ('75311-1' = $var1574_cur), ('75311-1' = $var1573_cur), ('75311-1' = $var1572_cur), ('75311-1' = $var1571_cur), ('75311-1' = $var1570_cur), ('75311-1' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1585_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1587_resultof_filter">
								<xsl:variable name="var1590_cur" as="node()" select="."/>
								<xsl:variable name="var1589_resource" as="node()*" select="$var1591_current/ns0:resource"/>
								<xsl:variable name="var1588_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1589_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1589_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1589_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1589_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1589_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1589_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1589_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1589_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1589_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1589_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1589_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1589_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1589_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1589_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1589_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1589_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1589_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1588_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1590_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDischargeInstructions'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8653-8'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital Discharge instructions'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital Discharge instructions'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionDischargeInstructions</xhtml:div>
						</text>
						<xsl:variable name="var1665_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1656_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1656_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1657_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1657_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1658_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1658_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1659_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1659_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1660_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1660_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1661_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1661_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1662_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1662_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1663_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1663_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1664_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1664_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1665_let">
							<xsl:variable name="var1655_current" as="node()" select="."/>
							<xsl:variable name="var1651_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1650_resource" as="node()*" select="$var1655_current/ns0:resource"/>
									<xsl:variable name="var1603_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1602_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1650_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1602_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1649_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1603_test_resultof_any">
											<xsl:variable name="var1648_cur" as="xs:string" select="."/>
											<xsl:variable name="var1605_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1604_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1650_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1604_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1605_test_resultof_any">
												<xsl:variable name="var1647_cur" as="xs:string" select="."/>
												<xsl:variable name="var1607_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1606_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1650_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1606_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1607_test_resultof_any">
													<xsl:variable name="var1646_cur" as="xs:string" select="."/>
													<xsl:variable name="var1609_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1608_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1650_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1608_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1609_test_resultof_any">
														<xsl:variable name="var1645_cur" as="xs:string" select="."/>
														<xsl:variable name="var1611_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1610_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1650_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1610_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1611_test_resultof_any">
															<xsl:variable name="var1644_cur" as="xs:string" select="."/>
															<xsl:variable name="var1613_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1612_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1650_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1612_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1613_test_resultof_any">
																<xsl:variable name="var1643_cur" as="xs:string" select="."/>
																<xsl:variable name="var1615_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1614_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1650_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1614_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1615_test_resultof_any">
																	<xsl:variable name="var1642_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1617_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1616_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1650_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1616_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1617_test_resultof_any">
																		<xsl:variable name="var1641_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1619_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1618_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1650_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1618_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1619_test_resultof_any">
																			<xsl:variable name="var1640_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1621_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1620_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1650_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1620_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1621_test_resultof_any">
																				<xsl:variable name="var1639_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1623_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1622_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1650_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1622_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1623_test_resultof_any">
																					<xsl:variable name="var1638_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1625_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1624_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1650_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1624_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1625_test_resultof_any">
																						<xsl:variable name="var1637_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1627_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1626_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1650_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1626_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1627_test_resultof_any">
																							<xsl:variable name="var1636_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1629_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1628_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1650_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1628_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1629_test_resultof_any">
																								<xsl:variable name="var1635_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1631_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1630_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1650_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1630_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1631_test_resultof_any">
																									<xsl:variable name="var1634_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1633_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1650_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1632_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1650_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1632_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1633_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('8653-8' = $var1648_cur), ('8653-8' = $var1647_cur), ('8653-8' = $var1646_cur), ('8653-8' = $var1645_cur), ('8653-8' = $var1644_cur), ('8653-8' = $var1643_cur), ('8653-8' = $var1642_cur), ('8653-8' = $var1641_cur), ('8653-8' = $var1640_cur), ('8653-8' = $var1639_cur), ('8653-8' = $var1638_cur), ('8653-8' = $var1637_cur), ('8653-8' = $var1636_cur), ('8653-8' = $var1635_cur), ('8653-8' = $var1634_cur), ('8653-8' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1649_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1651_resultof_filter">
								<xsl:variable name="var1654_cur" as="node()" select="."/>
								<xsl:variable name="var1653_resource" as="node()*" select="$var1655_current/ns0:resource"/>
								<xsl:variable name="var1652_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1653_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1653_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1653_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1653_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1653_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1653_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1653_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1653_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1653_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1653_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1653_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1653_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1653_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1653_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1653_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1653_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1653_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1652_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1654_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAdvanceDirectives'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'42348-3'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Advance healthcare directives'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Advance healthcare directives'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionAdvanceDirectives</xhtml:div>
						</text>
						<xsl:variable name="var1729_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1720_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1720_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1721_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1721_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1722_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1722_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1723_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1723_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1724_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1724_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1725_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1725_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1726_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1726_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1727_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1727_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1728_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1728_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1729_let">
							<xsl:variable name="var1719_current" as="node()" select="."/>
							<xsl:variable name="var1715_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1714_resource" as="node()*" select="$var1719_current/ns0:resource"/>
									<xsl:variable name="var1667_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1666_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1714_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1666_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1713_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1667_test_resultof_any">
											<xsl:variable name="var1712_cur" as="xs:string" select="."/>
											<xsl:variable name="var1669_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1668_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1714_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1668_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1669_test_resultof_any">
												<xsl:variable name="var1711_cur" as="xs:string" select="."/>
												<xsl:variable name="var1671_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1670_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1714_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1670_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1671_test_resultof_any">
													<xsl:variable name="var1710_cur" as="xs:string" select="."/>
													<xsl:variable name="var1673_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1672_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1714_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1672_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1673_test_resultof_any">
														<xsl:variable name="var1709_cur" as="xs:string" select="."/>
														<xsl:variable name="var1675_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1674_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1714_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1674_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1675_test_resultof_any">
															<xsl:variable name="var1708_cur" as="xs:string" select="."/>
															<xsl:variable name="var1677_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1676_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1714_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1676_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1677_test_resultof_any">
																<xsl:variable name="var1707_cur" as="xs:string" select="."/>
																<xsl:variable name="var1679_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1678_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1714_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1678_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1679_test_resultof_any">
																	<xsl:variable name="var1706_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1681_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1680_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1714_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1680_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1681_test_resultof_any">
																		<xsl:variable name="var1705_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1683_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1682_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1714_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1682_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1683_test_resultof_any">
																			<xsl:variable name="var1704_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1685_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1684_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1714_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1684_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1685_test_resultof_any">
																				<xsl:variable name="var1703_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1687_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1686_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1714_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1686_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1687_test_resultof_any">
																					<xsl:variable name="var1702_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1689_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1688_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1714_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1688_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1689_test_resultof_any">
																						<xsl:variable name="var1701_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1691_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1690_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1714_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1690_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1691_test_resultof_any">
																							<xsl:variable name="var1700_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1693_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1692_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1714_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1692_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1693_test_resultof_any">
																								<xsl:variable name="var1699_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1695_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1694_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1714_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1694_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1695_test_resultof_any">
																									<xsl:variable name="var1698_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1697_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1714_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1696_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1714_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1696_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1697_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('42348-3' = $var1712_cur), ('42348-3' = $var1711_cur), ('42348-3' = $var1710_cur), ('42348-3' = $var1709_cur), ('42348-3' = $var1708_cur), ('42348-3' = $var1707_cur), ('42348-3' = $var1706_cur), ('42348-3' = $var1705_cur), ('42348-3' = $var1704_cur), ('42348-3' = $var1703_cur), ('42348-3' = $var1702_cur), ('42348-3' = $var1701_cur), ('42348-3' = $var1700_cur), ('42348-3' = $var1699_cur), ('42348-3' = $var1698_cur), ('42348-3' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1713_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1715_resultof_filter">
								<xsl:variable name="var1718_cur" as="node()" select="."/>
								<xsl:variable name="var1717_resource" as="node()*" select="$var1719_current/ns0:resource"/>
								<xsl:variable name="var1716_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1717_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1717_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1717_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1717_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1717_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1717_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1717_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1717_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1717_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1717_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1717_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1717_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1717_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1717_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1717_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1717_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1717_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1716_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1718_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionTravelHx'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10182-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Travel note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Travel note'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionTravelHx</xhtml:div>
						</text>
						<xsl:variable name="var1793_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1784_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1784_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1785_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1785_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1786_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1786_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1787_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1787_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1788_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1788_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1789_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1789_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1790_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1790_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1791_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1791_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1792_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1792_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1793_let">
							<xsl:variable name="var1783_current" as="node()" select="."/>
							<xsl:variable name="var1779_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1778_resource" as="node()*" select="$var1783_current/ns0:resource"/>
									<xsl:variable name="var1731_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1730_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1778_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1730_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1777_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1731_test_resultof_any">
											<xsl:variable name="var1776_cur" as="xs:string" select="."/>
											<xsl:variable name="var1733_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1732_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1778_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1732_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1733_test_resultof_any">
												<xsl:variable name="var1775_cur" as="xs:string" select="."/>
												<xsl:variable name="var1735_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1734_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1778_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1734_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1735_test_resultof_any">
													<xsl:variable name="var1774_cur" as="xs:string" select="."/>
													<xsl:variable name="var1737_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1736_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1778_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1736_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1737_test_resultof_any">
														<xsl:variable name="var1773_cur" as="xs:string" select="."/>
														<xsl:variable name="var1739_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1738_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1778_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1738_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1739_test_resultof_any">
															<xsl:variable name="var1772_cur" as="xs:string" select="."/>
															<xsl:variable name="var1741_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1740_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1778_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1740_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1741_test_resultof_any">
																<xsl:variable name="var1771_cur" as="xs:string" select="."/>
																<xsl:variable name="var1743_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1742_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1778_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1742_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1743_test_resultof_any">
																	<xsl:variable name="var1770_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1745_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1744_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1778_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1744_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1745_test_resultof_any">
																		<xsl:variable name="var1769_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1747_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1746_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1778_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1746_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1747_test_resultof_any">
																			<xsl:variable name="var1768_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1749_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1748_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1778_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1748_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1749_test_resultof_any">
																				<xsl:variable name="var1767_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1751_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1750_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1778_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1750_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1751_test_resultof_any">
																					<xsl:variable name="var1766_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1753_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1752_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1778_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1752_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1753_test_resultof_any">
																						<xsl:variable name="var1765_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1755_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1754_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1778_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1754_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1755_test_resultof_any">
																							<xsl:variable name="var1764_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1757_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1756_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1778_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1756_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1757_test_resultof_any">
																								<xsl:variable name="var1763_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1759_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1758_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1778_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1758_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1759_test_resultof_any">
																									<xsl:variable name="var1762_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1761_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1778_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1760_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1778_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1760_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1761_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10182-4' = $var1776_cur), ('10182-4' = $var1775_cur), ('10182-4' = $var1774_cur), ('10182-4' = $var1773_cur), ('10182-4' = $var1772_cur), ('10182-4' = $var1771_cur), ('10182-4' = $var1770_cur), ('10182-4' = $var1769_cur), ('10182-4' = $var1768_cur), ('10182-4' = $var1767_cur), ('10182-4' = $var1766_cur), ('10182-4' = $var1765_cur), ('10182-4' = $var1764_cur), ('10182-4' = $var1763_cur), ('10182-4' = $var1762_cur), ('10182-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1777_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1779_resultof_filter">
								<xsl:variable name="var1782_cur" as="node()" select="."/>
								<xsl:variable name="var1781_resource" as="node()*" select="$var1783_current/ns0:resource"/>
								<xsl:variable name="var1780_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1781_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1781_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1781_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1781_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1781_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1781_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1781_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1781_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1781_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1781_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1781_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1781_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1781_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1781_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1781_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1781_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1781_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1780_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1782_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPayers'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'48768-6'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Payment sources Document'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Payment sources Document'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionPayers</xhtml:div>
						</text>
						<xsl:variable name="var1857_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1848_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1848_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1849_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1849_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1850_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1850_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1851_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1851_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1852_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1852_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1853_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1853_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1854_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1854_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1855_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1855_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1856_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1856_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1857_let">
							<xsl:variable name="var1847_current" as="node()" select="."/>
							<xsl:variable name="var1843_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1842_resource" as="node()*" select="$var1847_current/ns0:resource"/>
									<xsl:variable name="var1795_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1794_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1842_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1794_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1841_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1795_test_resultof_any">
											<xsl:variable name="var1840_cur" as="xs:string" select="."/>
											<xsl:variable name="var1797_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1796_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1842_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1796_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1797_test_resultof_any">
												<xsl:variable name="var1839_cur" as="xs:string" select="."/>
												<xsl:variable name="var1799_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1798_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1842_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1798_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1799_test_resultof_any">
													<xsl:variable name="var1838_cur" as="xs:string" select="."/>
													<xsl:variable name="var1801_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1800_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1842_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1800_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1801_test_resultof_any">
														<xsl:variable name="var1837_cur" as="xs:string" select="."/>
														<xsl:variable name="var1803_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1802_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1842_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1802_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1803_test_resultof_any">
															<xsl:variable name="var1836_cur" as="xs:string" select="."/>
															<xsl:variable name="var1805_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1804_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1842_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1804_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1805_test_resultof_any">
																<xsl:variable name="var1835_cur" as="xs:string" select="."/>
																<xsl:variable name="var1807_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1806_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1842_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1806_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1807_test_resultof_any">
																	<xsl:variable name="var1834_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1809_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1808_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1842_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1808_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1809_test_resultof_any">
																		<xsl:variable name="var1833_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1811_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1810_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1842_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1810_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1811_test_resultof_any">
																			<xsl:variable name="var1832_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1813_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1812_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1842_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1812_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1813_test_resultof_any">
																				<xsl:variable name="var1831_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1815_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1814_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1842_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1814_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1815_test_resultof_any">
																					<xsl:variable name="var1830_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1817_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1816_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1842_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1816_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1817_test_resultof_any">
																						<xsl:variable name="var1829_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1819_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1818_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1842_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1818_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1819_test_resultof_any">
																							<xsl:variable name="var1828_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1821_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1820_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1842_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1820_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1821_test_resultof_any">
																								<xsl:variable name="var1827_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1823_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1822_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1842_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1822_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1823_test_resultof_any">
																									<xsl:variable name="var1826_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1825_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1842_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1824_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1842_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1824_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1825_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('48768-6' = $var1840_cur), ('48768-6' = $var1839_cur), ('48768-6' = $var1838_cur), ('48768-6' = $var1837_cur), ('48768-6' = $var1836_cur), ('48768-6' = $var1835_cur), ('48768-6' = $var1834_cur), ('48768-6' = $var1833_cur), ('48768-6' = $var1832_cur), ('48768-6' = $var1831_cur), ('48768-6' = $var1830_cur), ('48768-6' = $var1829_cur), ('48768-6' = $var1828_cur), ('48768-6' = $var1827_cur), ('48768-6' = $var1826_cur), ('48768-6' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1841_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1843_resultof_filter">
								<xsl:variable name="var1846_cur" as="node()" select="."/>
								<xsl:variable name="var1845_resource" as="node()*" select="$var1847_current/ns0:resource"/>
								<xsl:variable name="var1844_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1845_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1845_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1845_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1845_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1845_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1845_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1845_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1845_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1845_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1845_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1845_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1845_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1845_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1845_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1845_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1845_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1845_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1844_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1846_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAttachments'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'77599-9'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Additional documentation'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Additional documentation'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionAttachments</xhtml:div>
						</text>
						<xsl:variable name="var1921_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1912_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1912_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1913_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1913_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1914_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1914_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1915_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1915_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1916_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1916_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1917_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1917_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1918_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1918_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1919_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1919_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1920_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1920_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1921_let">
							<xsl:variable name="var1911_current" as="node()" select="."/>
							<xsl:variable name="var1907_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1906_resource" as="node()*" select="$var1911_current/ns0:resource"/>
									<xsl:variable name="var1859_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1858_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1906_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1858_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1905_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1859_test_resultof_any">
											<xsl:variable name="var1904_cur" as="xs:string" select="."/>
											<xsl:variable name="var1861_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1860_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1906_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1860_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1861_test_resultof_any">
												<xsl:variable name="var1903_cur" as="xs:string" select="."/>
												<xsl:variable name="var1863_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1862_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1906_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1862_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1863_test_resultof_any">
													<xsl:variable name="var1902_cur" as="xs:string" select="."/>
													<xsl:variable name="var1865_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1864_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1906_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1864_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1865_test_resultof_any">
														<xsl:variable name="var1901_cur" as="xs:string" select="."/>
														<xsl:variable name="var1867_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1866_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1906_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1866_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1867_test_resultof_any">
															<xsl:variable name="var1900_cur" as="xs:string" select="."/>
															<xsl:variable name="var1869_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1868_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1906_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1868_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1869_test_resultof_any">
																<xsl:variable name="var1899_cur" as="xs:string" select="."/>
																<xsl:variable name="var1871_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1870_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1906_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1870_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1871_test_resultof_any">
																	<xsl:variable name="var1898_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1873_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1872_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1906_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1872_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1873_test_resultof_any">
																		<xsl:variable name="var1897_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1875_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1874_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1906_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1874_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1875_test_resultof_any">
																			<xsl:variable name="var1896_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1877_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1876_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1906_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1876_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1877_test_resultof_any">
																				<xsl:variable name="var1895_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1879_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1878_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1906_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1878_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1879_test_resultof_any">
																					<xsl:variable name="var1894_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1881_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1880_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1906_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1880_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1881_test_resultof_any">
																						<xsl:variable name="var1893_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1883_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1882_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1906_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1882_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1883_test_resultof_any">
																							<xsl:variable name="var1892_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1885_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1884_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1906_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1884_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1885_test_resultof_any">
																								<xsl:variable name="var1891_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1887_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1886_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1906_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1886_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1887_test_resultof_any">
																									<xsl:variable name="var1890_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1889_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1906_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1888_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1906_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1888_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1889_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('77599-9' = $var1904_cur), ('77599-9' = $var1903_cur), ('77599-9' = $var1902_cur), ('77599-9' = $var1901_cur), ('77599-9' = $var1900_cur), ('77599-9' = $var1899_cur), ('77599-9' = $var1898_cur), ('77599-9' = $var1897_cur), ('77599-9' = $var1896_cur), ('77599-9' = $var1895_cur), ('77599-9' = $var1894_cur), ('77599-9' = $var1893_cur), ('77599-9' = $var1892_cur), ('77599-9' = $var1891_cur), ('77599-9' = $var1890_cur), ('77599-9' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1905_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1907_resultof_filter">
								<xsl:variable name="var1910_cur" as="node()" select="."/>
								<xsl:variable name="var1909_resource" as="node()*" select="$var1911_current/ns0:resource"/>
								<xsl:variable name="var1908_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1909_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1909_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1909_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1909_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1909_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1909_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1909_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1909_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1909_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1909_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1909_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1909_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1909_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1909_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1909_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1909_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1909_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1908_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1910_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionEncounters'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2003_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'46240-8'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Hospitalizations+Outpatient visits Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Hospitalizations+Outpatient visits Narrative'"/>
							</text>
						</code>
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">sectionEncounters</xhtml:div>
						</text>
						<xsl:variable name="var1985_let" as="node()*">
							<xsl:for-each select="$var2005_ku_z_propz_admu">
								<xsl:variable name="var1976_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1976_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2004_ku_z_propz_dvp">
								<xsl:variable name="var1977_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1977_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1978_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1978_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2006_ku_z_propz_hosp">
								<xsl:variable name="var1979_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1979_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_sprij">
								<xsl:variable name="var1980_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2001_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1980_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1981_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1981_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1982_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1982_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1983_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1983_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1984_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2001_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1984_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1985_let">
							<xsl:variable name="var1975_current" as="node()" select="."/>
							<xsl:variable name="var1971_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1970_resource" as="node()*" select="$var1975_current/ns0:resource"/>
									<xsl:variable name="var1923_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1922_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1970_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1922_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1969_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1923_test_resultof_any">
											<xsl:variable name="var1968_cur" as="xs:string" select="."/>
											<xsl:variable name="var1925_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1924_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1970_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1924_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1925_test_resultof_any">
												<xsl:variable name="var1967_cur" as="xs:string" select="."/>
												<xsl:variable name="var1927_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1926_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1970_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1926_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1927_test_resultof_any">
													<xsl:variable name="var1966_cur" as="xs:string" select="."/>
													<xsl:variable name="var1929_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1928_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1970_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1928_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1929_test_resultof_any">
														<xsl:variable name="var1965_cur" as="xs:string" select="."/>
														<xsl:variable name="var1931_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1930_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1970_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1930_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1931_test_resultof_any">
															<xsl:variable name="var1964_cur" as="xs:string" select="."/>
															<xsl:variable name="var1933_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1932_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1970_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1932_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1933_test_resultof_any">
																<xsl:variable name="var1963_cur" as="xs:string" select="."/>
																<xsl:variable name="var1935_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1934_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1970_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1934_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1935_test_resultof_any">
																	<xsl:variable name="var1962_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1937_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1936_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1970_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1936_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1937_test_resultof_any">
																		<xsl:variable name="var1961_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1939_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1938_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1970_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1938_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1939_test_resultof_any">
																			<xsl:variable name="var1960_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1941_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1940_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1970_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1940_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1941_test_resultof_any">
																				<xsl:variable name="var1959_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1943_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1942_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1970_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1942_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1943_test_resultof_any">
																					<xsl:variable name="var1958_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1945_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1944_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1970_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1944_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1945_test_resultof_any">
																						<xsl:variable name="var1957_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1947_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1946_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1970_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1946_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1947_test_resultof_any">
																							<xsl:variable name="var1956_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1949_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1948_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1970_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1948_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1949_test_resultof_any">
																								<xsl:variable name="var1955_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1951_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1950_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1970_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1950_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1951_test_resultof_any">
																									<xsl:variable name="var1954_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1953_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1970_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1952_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1970_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1952_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1953_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('46240-8' = $var1968_cur), ('46240-8' = $var1967_cur), ('46240-8' = $var1966_cur), ('46240-8' = $var1965_cur), ('46240-8' = $var1964_cur), ('46240-8' = $var1963_cur), ('46240-8' = $var1962_cur), ('46240-8' = $var1961_cur), ('46240-8' = $var1960_cur), ('46240-8' = $var1959_cur), ('46240-8' = $var1958_cur), ('46240-8' = $var1957_cur), ('46240-8' = $var1956_cur), ('46240-8' = $var1955_cur), ('46240-8' = $var1954_cur), ('46240-8' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1969_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1971_resultof_filter">
								<xsl:variable name="var1974_cur" as="node()" select="."/>
								<xsl:variable name="var1973_resource" as="node()*" select="$var1975_current/ns0:resource"/>
								<xsl:variable name="var1972_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1973_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1973_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1973_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1973_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1973_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1973_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1973_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1973_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1973_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1973_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1973_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1973_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1973_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1973_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1973_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1973_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1973_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1972_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1974_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
				</Composition>
			</resource>
		</entry>
		<xsl:for-each select="$var2005_ku_z_propz_admu">
			<xsl:variable name="var1986_resultof_ku_z_propz_admu" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_admu">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var2001_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ku_z_propz_admuType" as="node()">
						<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_admuType>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1986_resultof_ku_z_propz_admu">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$var2004_ku_z_propz_dvp">
			<xsl:variable name="var1987_resultof_ku_z_propz_dvp" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_dvp">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var2001_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ku_z_propz_dvpType" as="node()">
						<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</ku_z_propz_dvpType>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1987_resultof_ku_z_propz_dvp">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$var2006_ku_z_propz_hosp">
			<xsl:variable name="var1988_resultof_ku_z_propz_hosp" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_hosp">
					<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
					<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var2001_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ku_z_propz_hospType" as="node()">
						<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_hospType>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1988_resultof_ku_z_propz_hosp">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var1989_resultof_ku_z_propz_urg" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_urg">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2001_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="ku_z_propz_urg" select="$var1998_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1989_resultof_ku_z_propz_urg">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$var2002_ku_z_propz_sprij">
			<xsl:variable name="var1990_resultof_ku_z_propz_sprij" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_sprij">
					<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
					<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var2001_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ku_z_propz_sprijType" as="node()">
						<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_sprijType>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1990_resultof_ku_z_propz_sprij">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var1991_resultof_ku_z_propz_anam" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam">
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2001_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="ku_z_propz_anamType" select="$var2000_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
				<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1991_resultof_ku_z_propz_anam">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var1992_resultof_ku_z_propz_prubh" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh">
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2001_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="ku_z_propz_prubhType" select="$var1999_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
				<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1992_resultof_ku_z_propz_prubh">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var1993_resultof_ku_z_propz_sprop" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_sprop">
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2001_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="ku_z_propz_spropType" select="$var1997_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1993_resultof_ku_z_propz_sprop">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var1994_resultof_ku_z_propz_dopor" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_dopor">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2001_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="dat_prov" select="$var1995_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="ku_z_propz_doporType" select="$var1996_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1994_resultof_ku_z_propz_dopor">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="ku_zType" select="()"/>
		<xsl:variable name="var3_guid" as="node()?" select="$ku_zType/@guid"/>
		<xsl:for-each select="$var3_guid">
			<xsl:for-each select="$ku_zType/ns2:ku_z_propz">
				<xsl:variable name="var2_cur" as="node()" select="."/>
				<xsl:for-each select="$var3_guid">
					<xsl:variable name="var1_resultof_ku_z_propz" as="node()*">
						<xsl:call-template name="provisio:ku_z_propz">
							<xsl:with-param name="patientReference" as="node()">
								<Reference xmlns="http://hl7.org/fhir">
									<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="GUID____ku_z" select="fn:string(.)" as="xs:string"/>
							<xsl:with-param name="ku_z_propzType" as="node()">
								<ku_z_propzType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="($var2_cur/@node(), $var2_cur/node())"/>
								</ku_z_propzType>
							</xsl:with-param>
							<xsl:with-param name="dat_prov" as="node()*">
								<xsl:for-each select="$ku_zType/ns2:dat_prov">
									<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_prov>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
							<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_ku_z_propz">
						<entry xmlns="http://hl7.org/fhir">
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Organization">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:is">
		<xsl:param name="is" select="()"/>
		<xsl:variable name="var4_guid" as="node()?" select="$is/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var4_guid">
				<xsl:for-each select="$var4_guid">
					<xsl:variable name="var1_resultof_FullURL_Organization" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Organization">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Organization">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Organization>
					<xsl:for-each select="$var4_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$is/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/core/StructureDefinition/cz-organization-core'))"/>
						</profile>
					</meta>
					<xsl:for-each select="$is/@ico">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/ico'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@icz">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/icz'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@icp">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/icp'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@icl">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/icl'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@pcz">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/pcz'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@oddel">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/oddel'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@oavl">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/oavl'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<active>
						<xsl:attribute name="value" namespace="" select="xs:string(fn:true())"/>
					</active>
					<xsl:for-each select="$is/ns1:a">
						<xsl:variable name="var3_cur" as="node()" select="."/>
						<address>
							<use>
								<xsl:attribute name="value" namespace="" select="'work'"/>
							</use>
							<text>
								<xsl:for-each select="ns1:jmeno">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
							<xsl:for-each select="ns1:adr">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:dop1">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:dop2">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:mesto">
								<city>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</city>
							</xsl:for-each>
							<xsl:for-each select="ns1:psc">
								<postalCode>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
								</postalCode>
							</xsl:for-each>
							<xsl:for-each select="ns1:stat">
								<xsl:variable name="var2_cur" as="node()" select="."/>
								<xsl:for-each select="$var3_cur/ns1:stat_text">
									<country>
										<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:string($var2_cur), ' - '), fn:string(.))"/>
									</country>
								</xsl:for-each>
							</xsl:for-each>
						</address>
					</xsl:for-each>
				</Organization>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:FullURL_PractitionerRole">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Practitioner">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('urn:uuid:', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:garant_dat">
		<xsl:param name="garant_dat" select="()"/>
		<xsl:variable name="var7_vguid" as="node()?" select="$garant_dat/@vguid"/>
		<xsl:variable name="var8_guid" as="node()?" select="$garant_dat/@guid"/>
		<xsl:variable name="var5_create_value_of_vguid" as="node()?">
			<xsl:for-each select="$var7_vguid">
				<xsl:attribute name="value" select="fn:string(.)"/>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var6_create_value_of_guid" as="node()?">
			<xsl:for-each select="$var8_guid">
				<xsl:attribute name="value" select="fn:string(.)"/>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var8_guid">
				<xsl:for-each select="$var8_guid">
					<xsl:variable name="var1_resultof_FullURL_Practitioner" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Practitioner">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Practitioner">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Practitioner>
					<id>
						<xsl:sequence select="$var6_create_value_of_guid"/>
					</id>
					<meta>
						<versionId>
							<xsl:sequence select="$var5_create_value_of_vguid"/>
						</versionId>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/core/StructureDefinition/cz-practitioner-core'))"/>
						</profile>
					</meta>
					<xsl:for-each select="$garant_dat/@id_zp">
						<identifier>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$garant_dat/@id_garant">
						<identifier>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$garant_dat/@id_clk">
						<identifier>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<name>
						<text>
							<xsl:attribute name="value" namespace="" select="fn:string($garant_dat)"/>
						</text>
					</name>
				</Practitioner>
			</resource>
		</entry>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var8_guid">
				<xsl:for-each select="$var8_guid">
					<xsl:variable name="var2_resultof_FullURL_PractitionerRole" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_PractitionerRole">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var2_resultof_FullURL_PractitionerRole">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<PractitionerRole>
					<id>
						<xsl:sequence select="$var6_create_value_of_guid"/>
					</id>
					<meta>
						<versionId>
							<xsl:sequence select="$var5_create_value_of_vguid"/>
						</versionId>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://fhir.hl7cr.eu/fhir/core/StructureDefinition/cz-practitionerrole-core'))"/>
						</profile>
					</meta>
					<practitioner>
						<reference>
							<xsl:for-each select="$var8_guid">
								<xsl:for-each select="$var7_vguid">
									<xsl:for-each select="$var8_guid">
										<xsl:variable name="var4_cur" as="node()" select="."/>
										<xsl:for-each select="$var7_vguid">
											<xsl:variable name="var3_resultof_Reference_Practitioner" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Practitioner">
													<xsl:with-param name="GUID" select="fn:string($var4_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var3_resultof_Reference_Practitioner">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
					</practitioner>
					<xsl:for-each select="$garant_dat/@role_klic">
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/WWBSK.htm'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
								<display>
									<xsl:for-each select="$garant_dat/@role_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</code>
					</xsl:for-each>
					<xsl:for-each select="$garant_dat/@odbornost">
						<specialty>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/UZAGT.htm'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
							</coding>
						</specialty>
					</xsl:for-each>
				</PractitionerRole>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:Reference_Practitioner">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('urn:uuid:', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:Reference_Organization">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('urn:uuid:', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf1_textType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::ns2:autor)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf3_autorType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:ptext)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf4_">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:ktext)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf5_ktextType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:priloha)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf6_prilohaType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:textAny)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf7_AnyType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf2_ku_z_propz_dvpType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::ns2:dat_dvp)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf8_dat_xxType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:dvp_typ)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:dvp_koment)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:dvp_dotstav)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf9_mknorphaType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:dvp_dokum)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf10_textType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf3_autorType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_zp">
			<xsl:attribute name="id_zp" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_autor">
			<xsl:attribute name="id_autor" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@odbornost">
			<xsl:attribute name="odbornost" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_clk">
			<xsl:attribute name="id_clk" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@role_klic">
			<xsl:attribute name="role_klic" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@role_text">
			<xsl:attribute name="role_text" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf4_">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@xml:space">
			<xsl:attribute name="xml:space" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf5_ktextType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@encode">
			<xsl:attribute name="encode" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@typ">
			<xsl:attribute name="typ" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf6_prilohaType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@zdroj">
			<xsl:attribute name="zdroj" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@typ">
			<xsl:attribute name="typ" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf7_AnyType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::*)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="(./@node(), ./node())"/>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf8_dat_xxType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@format">
			<xsl:attribute name="format" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf9_mknorphaType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::ns2:kod_syst)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:kod)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:kod_text)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf10_textType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::ns2:autor)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf11_autorType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:ptext)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf12_">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:ktext)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf13_ktextType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:priloha)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf14_prilohaType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:textAny)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf15_AnyType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf11_autorType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_zp">
			<xsl:attribute name="id_zp" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_autor">
			<xsl:attribute name="id_autor" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@odbornost">
			<xsl:attribute name="odbornost" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_clk">
			<xsl:attribute name="id_clk" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@role_klic">
			<xsl:attribute name="role_klic" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@role_text">
			<xsl:attribute name="role_text" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf12_">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@xml:space">
			<xsl:attribute name="xml:space" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf13_ktextType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@encode">
			<xsl:attribute name="encode" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@typ">
			<xsl:attribute name="typ" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf14_prilohaType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@zdroj">
			<xsl:attribute name="zdroj" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@typ">
			<xsl:attribute name="typ" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf15_AnyType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::*)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="(./@node(), ./node())"/>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="vmf:vmf1_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'inactive'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf2_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='HNMD'">
				<xsl:copy-of select="'228368007'"/>
			</xsl:when>
			<xsl:when test="$input='DNMD'">
				<xsl:copy-of select="'228367002'"/>
			</xsl:when>
			<xsl:when test="$input='MDIP'">
				<xsl:copy-of select="'44870007'"/>
			</xsl:when>
			<xsl:when test="$input='CDUS'">
				<xsl:copy-of select="'417284009'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf3_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='AMFETAM'">
				<xsl:copy-of select="'703842006'"/>
			</xsl:when>
			<xsl:when test="$input='ANABST'">
				<xsl:copy-of select="'111151007'"/>
			</xsl:when>
			<xsl:when test="$input='BARBIT'">
				<xsl:copy-of select="'372798009'"/>
			</xsl:when>
			<xsl:when test="$input='BENZOD'">
				<xsl:copy-of select="'372664007'"/>
			</xsl:when>
			<xsl:when test="$input='BUP'">
				<xsl:copy-of select="'387173000'"/>
			</xsl:when>
			<xsl:when test="$input='PHENC'">
				<xsl:copy-of select="'9721008'"/>
			</xsl:when>
			<xsl:when test="$input='FENTAN'">
				<xsl:copy-of select="'373492002'"/>
			</xsl:when>
			<xsl:when test="$input='HALLMUSH'">
				<xsl:copy-of select="'229006007'"/>
			</xsl:when>
			<xsl:when test="$input='HEROIN'">
				<xsl:copy-of select="'387341002'"/>
			</xsl:when>
			<xsl:when test="$input='3OHBUTYR'">
				<xsl:copy-of select="'62821004'"/>
			</xsl:when>
			<xsl:when test="$input='KETAM'">
				<xsl:copy-of select="'373464007'"/>
			</xsl:when>
			<xsl:when test="$input='COCAINE'">
				<xsl:copy-of select="'387085005'"/>
			</xsl:when>
			<xsl:when test="$input='COCFB'">
				<xsl:copy-of select="'229003004'"/>
			</xsl:when>
			<xsl:when test="$input='CANAB'">
				<xsl:copy-of select="'398705004'"/>
			</xsl:when>
			<xsl:when test="$input='LAXAT'">
				<xsl:copy-of select="'372800002'"/>
			</xsl:when>
			<xsl:when test="$input='LSD'">
				<xsl:copy-of select="'15698006'"/>
			</xsl:when>
			<xsl:when test="$input='MDMA'">
				<xsl:copy-of select="'288459003'"/>
			</xsl:when>
			<xsl:when test="$input='METHAD'">
				<xsl:copy-of select="'387286002'"/>
			</xsl:when>
			<xsl:when test="$input='METAMF'">
				<xsl:copy-of select="'387499002'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf4_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='ASSOC'">
				<xsl:copy-of select="&quot;Associate's or technical degree complete&quot;"/>
			</xsl:when>
			<xsl:when test="$input='BD'">
				<xsl:copy-of select="'College or baccalaureate degree complete'"/>
			</xsl:when>
			<xsl:when test="$input='ELEN'">
				<xsl:copy-of select="'Elementary School'"/>
			</xsl:when>
			<xsl:when test="$input='GD'">
				<xsl:copy-of select="'Graduate or professional Degree complete'"/>
			</xsl:when>
			<xsl:when test="$input='HS'">
				<xsl:copy-of select="'High School or secondary school degree complete'"/>
			</xsl:when>
			<xsl:when test="$input='PB'">
				<xsl:copy-of select="'Some post-baccalaureate education'"/>
			</xsl:when>
			<xsl:when test="$input='POSTG'">
				<xsl:copy-of select="'Doctoral or post graduate education'"/>
			</xsl:when>
			<xsl:when test="$input='SCOL'">
				<xsl:copy-of select="'Some College education'"/>
			</xsl:when>
			<xsl:when test="$input='SEC'">
				<xsl:copy-of select="'Some secondary or high school education'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf5_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='365508006'">
				<xsl:copy-of select="'Residence and accommodation circumstances'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf6_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='BSCH'">
				<xsl:copy-of select="'Vana / sprchové křeslo'"/>
			</xsl:when>
			<xsl:when test="$input='SLCH'">
				<xsl:copy-of select="'Schodišťový výtah, židle'"/>
			</xsl:when>
			<xsl:when test="$input='ASTO'">
				<xsl:copy-of select="'Pomocná toaleta'"/>
			</xsl:when>
			<xsl:when test="$input='ASBE'">
				<xsl:copy-of select="'Pomocné lůžko'"/>
			</xsl:when>
			<xsl:when test="$input='HPAF'">
				<xsl:copy-of select="'Pomocné vybavení / adaptace domu a prostor'"/>
			</xsl:when>
			<xsl:when test="$input='HARA'">
				<xsl:copy-of select="'Zábradlí, držadla'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf7_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='STHO'">
				<xsl:copy-of select="'Schody v domě'"/>
			</xsl:when>
			<xsl:when test="$input='LAWE'">
				<xsl:copy-of select="'Bydlí v bytě s výtahem'"/>
			</xsl:when>
			<xsl:when test="$input='ARBS'">
				<xsl:copy-of select="'Přístup do domu po schodech'"/>
			</xsl:when>
			<xsl:when test="$input='OMRE'">
				<xsl:copy-of select="'Blokovaný vstup do bytu'"/>
			</xsl:when>
			<xsl:when test="$input='HCSB'">
				<xsl:copy-of select="'Bydlení obsahuje strukturální překážky pohybu'"/>
			</xsl:when>
			<xsl:when test="$input='CLSP'">
				<xsl:copy-of select="'Zaneřáděný životní prostor'"/>
			</xsl:when>
			<xsl:when test="$input='DLCO'">
				<xsl:copy-of select="'Špinavé životní prostředí'"/>
			</xsl:when>
			<xsl:when test="$input='KEPE'">
				<xsl:copy-of select="'Chová domácí mazlíčky'"/>
			</xsl:when>
			<xsl:when test="$input='UFCO'">
				<xsl:copy-of select="'Nebezpečná podlahová krytina'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf8_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'fyziologická reakce'"/>
			</xsl:when>
			<xsl:when test="$input='H'">
				<xsl:copy-of select="'hyperreakce'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'neurologická reakce'"/>
			</xsl:when>
			<xsl:when test="$input='J'">
				<xsl:copy-of select="'jiná reakce'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf9_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'inactive'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf10_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'24484000'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'6736007'"/>
			</xsl:when>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'255604002'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf11_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'Severe'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'Moderate'"/>
			</xsl:when>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'Mild'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf12_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='R'">
				<xsl:copy-of select="'Registered'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'Preliminary'"/>
			</xsl:when>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'Final'"/>
			</xsl:when>
			<xsl:when test="$input='Z'">
				<xsl:copy-of select="'Amended'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf13_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'completed'"/>
			</xsl:when>
			<xsl:when test="$input='SF'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='SN'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf14_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'385669000'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'385671000'"/>
			</xsl:when>
			<xsl:when test="$input='C'">
				<xsl:copy-of select="'385670004'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf15_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'Úspěšný'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'Neúspěšný'"/>
			</xsl:when>
			<xsl:when test="$input='C'">
				<xsl:copy-of select="'Částečně úspěšný'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf16_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf17_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf18_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf19_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'completed'"/>
			</xsl:when>
			<xsl:when test="$input='E'">
				<xsl:copy-of select="'correction'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'entered-in-error'"/>
			</xsl:when>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'stopped'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'on-hold'"/>
			</xsl:when>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'stopped'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf20_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='ND'">
				<xsl:copy-of select="'nevhodné dávkování'"/>
			</xsl:when>
			<xsl:when test="$input='PD'">
				<xsl:copy-of select="'nedostatečné dávkování'"/>
			</xsl:when>
			<xsl:when test="$input='IL'">
				<xsl:copy-of select="'interakce léku'"/>
			</xsl:when>
			<xsl:when test="$input='J'">
				<xsl:copy-of select="'jiné'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf21_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'chronic'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'acute'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf22_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'Chronická (trvalá) medikace'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'Akutní (přechodná) medikace'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf23_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="'neodkladné'"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="'plánované'"/>
			</xsl:when>
			<xsl:when test="$input='3'">
				<xsl:copy-of select="'jiné'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf24_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='0'">
				<xsl:copy-of select="'narození v nemocnici'"/>
			</xsl:when>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="'praktický lékař pro dospělé/pro děti a dorost'"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="'jiný ošetřující lékař - ambulantní péče'"/>
			</xsl:when>
			<xsl:when test="$input='3'">
				<xsl:copy-of select="'lékař LSPP'"/>
			</xsl:when>
			<xsl:when test="$input='4'">
				<xsl:copy-of select="'lékař RZP'"/>
			</xsl:when>
			<xsl:when test="$input='5'">
				<xsl:copy-of select="'jiné zařízení'"/>
			</xsl:when>
			<xsl:when test="$input='6'">
				<xsl:copy-of select="'jiné oddělení téhož zařízení'"/>
			</xsl:when>
			<xsl:when test="$input='7'">
				<xsl:copy-of select="'bez doporučení lékaře'"/>
			</xsl:when>
			<xsl:when test="$input='8'">
				<xsl:copy-of select="'sociální pracovník'"/>
			</xsl:when>
			<xsl:when test="$input='9'">
				<xsl:copy-of select="'hospitalizace pokračuje'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf25_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='MKN-10'">
				<xsl:copy-of select="'MKN-10	'"/>
			</xsl:when>
			<xsl:when test="$input='MKN-O'">
				<xsl:copy-of select="'MKN-O'"/>
			</xsl:when>
			<xsl:when test="$input='ORPHACD'">
				<xsl:copy-of select="'ORPHA code
'"/>
			</xsl:when>
			<xsl:when test="$input='SNOMEDCT'">
				<xsl:copy-of select="'SNOMED CT'"/>
			</xsl:when>
			<xsl:when test="$input='TNM'">
				<xsl:copy-of select="'TNM'"/>
			</xsl:when>
			<xsl:when test="$input='IPS'">
				<xsl:copy-of select="'IPS'"/>
			</xsl:when>
			<xsl:when test="$input='OMIM'">
				<xsl:copy-of select="'OMIM'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf26_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='3435'">
				<xsl:copy-of select="'3435'"/>
			</xsl:when>
			<xsl:when test="$input='38-1a1'">
				<xsl:copy-of select="'70755000'"/>
			</xsl:when>
			<xsl:when test="$input='38-1a2'">
				<xsl:copy-of select="'1505002'"/>
			</xsl:when>
			<xsl:when test="$input='38-1a3'">
				<xsl:copy-of select="'70755000'"/>
			</xsl:when>
			<xsl:when test="$input='38-1b'">
				<xsl:copy-of select="'18038006'"/>
			</xsl:when>
			<xsl:when test="$input='38-1c'">
				<xsl:copy-of select="'183452005'"/>
			</xsl:when>
			<xsl:when test="$input='38-2'">
				<xsl:copy-of select="'386497007'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf27_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='SP'">
				<xsl:copy-of select="'resolved'"/>
			</xsl:when>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'inactive'"/>
			</xsl:when>
			<xsl:when test="$input='Z'">
				<xsl:copy-of select="'suspended'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf28_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'unconfirmed'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'refuted'"/>
			</xsl:when>
			<xsl:when test="$input='AF'">
				<xsl:copy-of select="'confirmed'"/>
			</xsl:when>
			<xsl:when test="$input='AN'">
				<xsl:copy-of select="'confirmed'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf29_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'allergy'"/>
			</xsl:when>
			<xsl:when test="$input='I'">
				<xsl:copy-of select="'intolerance'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf30_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='L'">
				<xsl:copy-of select="'medication'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'food'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'environment'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf31_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='255604002'">
				<xsl:copy-of select="'low'"/>
			</xsl:when>
			<xsl:when test="$input='371923003'">
				<xsl:copy-of select="'low'"/>
			</xsl:when>
			<xsl:when test="$input='6736007'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
			<xsl:when test="$input='371924009'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
			<xsl:when test="$input='24484000'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
			<xsl:when test="$input='442452003'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf32_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='D'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'phone'"/>
			</xsl:when>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'phone'"/>
			</xsl:when>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'fax'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'email'"/>
			</xsl:when>
			<xsl:when test="$input='X'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
			<xsl:when test="$input='E'">
				<xsl:copy-of select="'e-mail'"/>
			</xsl:when>
			<xsl:when test="$input='I'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
			<xsl:when test="$input='G'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf33_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'mobile'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf34_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="'temp'"/>
			</xsl:when>
			<xsl:when test="$input='3'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='4'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='5'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='6'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='7'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='8'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='9'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='C'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='K'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='Z'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='G'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='L'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'billing'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='O'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='X'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf35_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='K'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf36_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf37_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'Preliminary'"/>
			</xsl:when>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'Final'"/>
			</xsl:when>
			<xsl:when test="$input='Z'">
				<xsl:copy-of select="'Amended'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:output method="xml" encoding="UTF-8" byte-order-mark="no" indent="yes"/>
	<xsl:template match="/">
		<xsl:variable name="var13_dasta" as="node()?" select="ns1:dasta"/>
		<Bundle xmlns="http://hl7.org/fhir" xmlns:xhtml="http://www.w3.org/1999/xhtml">
			<identifier>
				<system>
					<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('urn:VUBEC_NEVIM_CO_SEM'))"/>
				</system>
				<value>
					<xsl:for-each select="$var13_dasta/@guid">
						<xsl:attribute name="value" namespace="" select="fn:concat('urn:uuid:', fn:string(.))"/>
					</xsl:for-each>
				</value>
			</identifier>
			<type>
				<xsl:attribute name="value" namespace="" select="'document'"/>
			</type>
			<timestamp>
				<xsl:for-each select="$var13_dasta">
					<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(@dat_vb)))"/>
				</xsl:for-each>
			</timestamp>
			<xsl:for-each select="$var13_dasta/ns1:is/ns2:ip">
				<xsl:variable name="var10_cur" as="node()" select="."/>
				<xsl:for-each select="ns2:ku/ns2:ku_z">
					<xsl:variable name="var9_resultof_ku_z" as="node()*">
						<xsl:call-template name="provisio:ku_z">
							<xsl:with-param name="patientReference" as="node()">
								<Reference>
									<identifier>
										<use>
											<xsl:attribute name="value" namespace="" select="'official'"/>
										</use>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
										</system>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string($var10_cur/@id_pac)"/>
										</value>
									</identifier>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="organizatinReference" as="xs:string*">
								<xsl:for-each select="$var13_dasta/ns1:is">
									<xsl:variable name="var4_resultof_is" as="node()*">
										<xsl:call-template name="provisio:is">
											<xsl:with-param name="is" as="node()">
												<is xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
													<xsl:sequence select="(./@node(), ./node())"/>
												</is>
											</xsl:with-param>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var4_resultof_is/ns0:resource/ns0:Organization">
										<xsl:variable name="var3_cur" as="node()" select="."/>
										<xsl:for-each select="ns0:id/@value">
											<xsl:variable name="var2_cur" as="node()" select="."/>
											<xsl:for-each select="$var3_cur/ns0:meta/ns0:versionId/@value">
												<xsl:variable name="var1_resultof_Reference_Organization" as="xs:string?">
													<xsl:call-template name="provisio:Reference_Organization">
														<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
														<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:sequence select="$var1_resultof_Reference_Organization"/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="practitionerReference" as="xs:string*">
								<xsl:for-each select="$var13_dasta/ns1:garant_dat">
									<xsl:variable name="var8_resultof_garant_dat" as="node()*">
										<xsl:call-template name="provisio:garant_dat">
											<xsl:with-param name="garant_dat" as="node()">
												<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
													<xsl:sequence select="(./@node(), ./node())"/>
												</garant_dat>
											</xsl:with-param>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var8_resultof_garant_dat/ns0:resource/ns0:Practitioner">
										<xsl:variable name="var7_cur" as="node()" select="."/>
										<xsl:for-each select="ns0:id/@value">
											<xsl:variable name="var6_cur" as="node()" select="."/>
											<xsl:for-each select="$var7_cur/ns0:meta/ns0:versionId/@value">
												<xsl:variable name="var5_resultof_Reference_Practitioner" as="xs:string?">
													<xsl:call-template name="provisio:Reference_Practitioner">
														<xsl:with-param name="GUID" select="fn:string($var6_cur)" as="xs:string"/>
														<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:sequence select="$var5_resultof_Reference_Practitioner"/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="ku_zType" as="node()">
								<ku_zType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</ku_zType>
							</xsl:with-param>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var9_resultof_ku_z">
						<entry>
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var13_dasta/ns1:is">
				<xsl:variable name="var11_resultof_is" as="node()*">
					<xsl:call-template name="provisio:is">
						<xsl:with-param name="is" as="node()">
							<is xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
								<xsl:sequence select="(./@node(), ./node())"/>
							</is>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var11_resultof_is">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var13_dasta/ns1:garant_dat">
				<xsl:variable name="var12_resultof_garant_dat" as="node()*">
					<xsl:call-template name="provisio:garant_dat">
						<xsl:with-param name="garant_dat" as="node()">
							<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
								<xsl:sequence select="(./@node(), ./node())"/>
							</garant_dat>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var12_resultof_garant_dat">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</Bundle>
	</xsl:template>
</xsl:stylesheet>
