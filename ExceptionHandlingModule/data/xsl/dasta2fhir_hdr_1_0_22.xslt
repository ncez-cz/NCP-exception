<?xml version="1.0" encoding="UTF-8"?>
<!--
This file was generated by Altova MapForce 2024r2sp1

YOU SHOULD NOT MODIFY THIS FILE, BECAUSE IT WILL BE
OVERWRITTEN WHEN YOU RE-RUN CODE GENERATION.

Refer to the Altova MapForce Documentation for further details.
http://www.altova.com/mapforce
-->
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns0="http://hl7.org/fhir" xmlns:provisio="http://www.altova.com/MapForce/UDF/provisio" xmlns:tbf="http://www.altova.com/MapForce/UDF/tbf" xmlns:vmf="http://www.altova.com/MapForce/UDF/vmf" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:xml="http://www.w3.org/XML/1998/namespace" xmlns:ns1="urn:cz-mzcr:ns:dasta:ds4:ds_dasta" xmlns:ns2="urn:cz-mzcr:ns:dasta:ds4:ds_ip" exclude-result-prefixes="ns0 provisio tbf vmf xs fn ns1 ns2">
	<xsl:template name="provisio:ku_z_propz_prubh_p">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubh_pType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$ku_z_propz_prubh_pType">
			<xsl:variable name="var9_cur" as="node()" select="."/>
			<xsl:variable name="var6_http___snomed_info_sct_as_string" as="xs:string" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
			<xsl:variable name="var7_prob_zav_kod" as="node()*" select="ns2:prob_zav_kod"/>
			<xsl:variable name="var8_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var8_guid">
					<xsl:for-each select="$var8_guid">
						<xsl:variable name="var1_resultof_FullURL_Condition" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Condition">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Condition">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Condition>
						<xsl:for-each select="$var8_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-condition-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'11450-4'"/>
								</code>
							</tag>
						</meta>
						<clinicalStatus>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-clinical'))"/>
								</system>
								<code>
									<xsl:for-each select="ns2:prob_klin">
										<xsl:variable name="var2_resultof_vmf__inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf1_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var2_resultof_vmf__inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</code>
							</coding>
						</clinicalStatus>
						<verificationStatus>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-ver-status'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'confirmed'"/>
								</code>
							</coding>
						</verificationStatus>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var6_http___snomed_info_sct_as_string"/>
								</system>
								<code>
									<xsl:for-each select="ns2:prob_kat_kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="ns2:prob_kat_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</category>
						<severity>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var6_http___snomed_info_sct_as_string"/>
								</system>
								<code>
									<xsl:for-each select="$var7_prob_zav_kod">
										<xsl:variable name="var3_resultof_vmf__inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf2_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var3_resultof_vmf__inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="$var7_prob_zav_kod">
										<xsl:variable name="var4_resultof_vmf__inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf3_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var4_resultof_vmf__inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</display>
							</coding>
						</severity>
						<xsl:for-each select="ns2:prob_kod">
							<xsl:variable name="var5_cur" as="node()" select="."/>
							<xsl:for-each select="ns2:kod_syst">
								<code>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
										</system>
										<code>
											<xsl:for-each select="$var5_cur/ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="$var5_cur/ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</code>
							</xsl:for-each>
						</xsl:for-each>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_dat_od">
							<onsetDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</onsetDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_dat_do">
							<abatementDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</abatementDateTime>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<recordedDate>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</recordedDate>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<recorder>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</recorder>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_stad_kod">
							<stage>
								<summary>
									<coding>
										<system>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
											</xsl:for-each>
										</system>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
									<xsl:for-each select="$var9_cur/ns2:prob_stad_text">
										<text>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</text>
									</xsl:for-each>
								</summary>
							</stage>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_popis">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_okol">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Condition>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_Observation">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Observation/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh_v">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubh_vType" select="()"/>
		<xsl:for-each select="$ku_z_propz_prubh_vType">
			<xsl:variable name="var23_guid" as="node()?" select="@guid"/>
			<xsl:variable name="var22_create_value_of_nazev" as="node()*">
				<xsl:for-each select="ns2:nazev">
					<xsl:attribute name="value" select="fn:string(.)"/>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var21_let" as="node()+">
				<system xmlns="http://hl7.org/fhir">
					<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/WWAUI'))"/>
				</system>
				<code xmlns="http://hl7.org/fhir">
					<xsl:for-each select="ns2:typku">
						<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
					</xsl:for-each>
				</code>
			</xsl:variable>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var23_guid">
					<xsl:for-each select="$var23_guid">
						<xsl:variable name="var1_resultof_FullURL_Composition" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Composition">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Composition">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Composition>
						<meta>
							<versionId>
								<xsl:for-each select="@vguid">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</versionId>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
							</tag>
						</meta>
						<identifier>
							<value>
								<xsl:for-each select="ns2:idku">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</value>
						</identifier>
						<xsl:for-each select="ns2:vys_stav">
							<xsl:variable name="var2_resultof_vmf__inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf4_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<status>
								<xsl:for-each select="$var2_resultof_vmf__inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</status>
						</xsl:for-each>
						<type>
							<coding>
								<xsl:sequence select="$var21_let"/>
							</coding>
						</type>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<date>
							<xsl:for-each select="ns2:dat_vys">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</date>
						<author>
							<reference>
								<xsl:for-each select="ns2:pracovnik">
									<xsl:variable name="var4_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var3_cur" as="node()" select="."/>
										<xsl:for-each select="$var4_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('PractitionerRole/', fn:string($var3_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
						</author>
						<title>
							<xsl:sequence select="$var22_create_value_of_nazev"/>
						</title>
						<custodian>
							<reference>
								<xsl:for-each select="ns2:pracoviste">
									<xsl:variable name="var8_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var7_cur" as="node()" select="."/>
										<xsl:variable name="var6_vguid" as="node()?" select="$var8_cur/@vguid"/>
										<xsl:for-each select="$var6_vguid">
											<xsl:for-each select="$var6_vguid">
												<xsl:variable name="var5_resultof_Reference_Organization" as="xs:string?">
													<xsl:call-template name="provisio:Reference_Organization">
														<xsl:with-param name="GUID" select="fn:string($var7_cur)" as="xs:string"/>
														<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:for-each select="$var5_resultof_Reference_Organization">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
						</custodian>
						<section>
							<title>
								<xsl:sequence select="$var22_create_value_of_nazev"/>
							</title>
							<code>
								<coding>
									<xsl:sequence select="$var21_let"/>
								</coding>
							</code>
							<entry>
								<reference>
									<xsl:for-each select="ns2:vys_v_snomed">
										<xsl:variable name="var12_cur" as="node()" select="."/>
										<xsl:for-each select="@guid">
											<xsl:variable name="var11_cur" as="node()" select="."/>
											<xsl:variable name="var10_vguid" as="node()?" select="$var12_cur/@vguid"/>
											<xsl:for-each select="$var10_vguid">
												<xsl:for-each select="$var10_vguid">
													<xsl:variable name="var9_resultof_Reference_Observation" as="xs:string?">
														<xsl:call-template name="provisio:Reference_Observation">
															<xsl:with-param name="GUID" select="fn:string($var11_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var9_resultof_Reference_Observation">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</entry>
							<entry>
								<reference>
									<xsl:for-each select="ns2:text_puvod">
										<xsl:variable name="var16_cur" as="node()" select="."/>
										<xsl:for-each select="@guid">
											<xsl:variable name="var15_cur" as="node()" select="."/>
											<xsl:variable name="var14_vguid" as="node()?" select="$var16_cur/@vguid"/>
											<xsl:for-each select="$var14_vguid">
												<xsl:for-each select="$var14_vguid">
													<xsl:variable name="var13_resultof_Reference_DocumentReference" as="xs:string?">
														<xsl:call-template name="provisio:Reference_DocumentReference">
															<xsl:with-param name="GUID" select="fn:string($var15_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var13_resultof_Reference_DocumentReference">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</entry>
							<entry>
								<reference>
									<xsl:for-each select="ns2:text_uprav">
										<xsl:variable name="var20_cur" as="node()" select="."/>
										<xsl:for-each select="@guid">
											<xsl:variable name="var19_cur" as="node()" select="."/>
											<xsl:variable name="var18_vguid" as="node()?" select="$var20_cur/@vguid"/>
											<xsl:for-each select="$var18_vguid">
												<xsl:for-each select="$var18_vguid">
													<xsl:variable name="var17_resultof_Reference_DocumentReference" as="xs:string?">
														<xsl:call-template name="provisio:Reference_DocumentReference">
															<xsl:with-param name="GUID" select="fn:string($var19_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var17_resultof_Reference_DocumentReference">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</entry>
						</section>
					</Composition>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var25_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:text_puvod">
				<xsl:variable name="var24_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var25_cur/@node(), $var25_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'30954-2'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var24_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var27_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:text_uprav">
				<xsl:variable name="var26_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var27_cur/@node(), $var27_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'30954-2'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var26_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:vys_v_snomed">
			<xsl:variable name="var28_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var28_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var29_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubh_vType/ns2:pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var29_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh_s">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubh_sType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$ku_z_propz_prubh_sType/ns2:ks_popis">
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/R4/observation.html'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_prubh_sType/ns2:ks_duv_prub_h">
			<xsl:variable name="var3_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid">
					<xsl:for-each select="$var3_guid">
						<xsl:variable name="var2_resultof_FullURL_DiagnosticReport" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_DiagnosticReport">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var2_resultof_FullURL_DiagnosticReport">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<DiagnosticReport>
						<xsl:for-each select="$var3_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/R4/diagnosticreport.html'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
					</DiagnosticReport>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_prubh_sType/ns2:ks_klin_uvaha">
			<xsl:variable name="var5_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var5_guid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var4_resultof_FullURL_DiagnosticReport" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_DiagnosticReport">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var4_resultof_FullURL_DiagnosticReport">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<DiagnosticReport>
						<xsl:for-each select="$var5_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/R4/diagnosticreport.html'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
					</DiagnosticReport>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh_d">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubh_dType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$ku_z_propz_prubh_dType">
			<xsl:variable name="var5_cur" as="node()" select="."/>
			<xsl:variable name="var3_guid" as="node()?" select="@guid"/>
			<xsl:variable name="var4_dat_prov_vykd" as="node()*" select="ns2:dat_prov_vykd"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid">
					<xsl:for-each select="$var3_guid">
						<xsl:variable name="var1_resultof_FullURL_Procedure" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Procedure">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Procedure">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Procedure>
						<xsl:for-each select="$var3_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-procedure-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'10185-7'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'completed'"/>
						</status>
						<code>
							<coding>
								<code>
									<xsl:attribute name="value" namespace="" select="'442083009'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Anatomical or acquired body structure'"/>
								</display>
							</coding>
							<text>
								<xsl:for-each select="ns2:vykd_lokal">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:variable name="var2_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($var4_dat_prov_vykd)">
									<xsl:for-each select="$var4_dat_prov_vykd">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var2_test_resultof_exists">
							<performedDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</performedDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<actor>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</actor>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:vykd_duv_kod">
							<reasonCode>
								<coding>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<display>
										<xsl:for-each select="$var5_cur/ns2:vykd_duv_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</reasonCode>
						</xsl:for-each>
						<note>
							<text>
								<xsl:for-each select="ns2:vykd_popis">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
						</note>
					</Procedure>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh">
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_prubhType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var8_create_Reference_of_patientReference" as="node()*">
			<xsl:for-each select="$patientReference">
				<Reference xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</Reference>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var9_create_dat_prov_of_dat_prov" as="node()*">
			<xsl:for-each select="$dat_prov">
				<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</dat_prov>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1_resultof_ku_z_propz_prubh_p" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_p">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="ku_z_propz_prubh_pType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:ku_z_propz_prubh_p">
						<ku_z_propz_prubh_pType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_prubh_pType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_ku_z_propz_prubh_p">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var2_resultof_ku_z_propz_anam_anam_vyk" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_vyk">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_vyk" as="node()">
					<anam_vyk xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:for-each select="$ku_z_propz_prubhType/ns2:chv">
							<chv>
								<xsl:sequence select="(./@node(), ./node())"/>
							</chv>
						</xsl:for-each>
					</anam_vyk>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var2_resultof_ku_z_propz_anam_anam_vyk">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var3_resultof_ku_z_propz_anam_anam_zpi" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_zpi">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_zpi" as="node()">
					<anam_zpi xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:for-each select="$ku_z_propz_prubhType/ns2:uniz">
							<uniz>
								<xsl:sequence select="(./@node(), ./node())"/>
							</uniz>
						</xsl:for-each>
					</anam_zpi>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var3_resultof_ku_z_propz_anam_anam_zpi">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var4_resultof_ku_z_propz_prubh_d" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_d">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="ku_z_propz_prubh_dType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:ku_z_propz_prubh_d">
						<ku_z_propz_prubh_dType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_prubh_dType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var4_resultof_ku_z_propz_prubh_d">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var5_resultof_ku_z_propz_prubh_le" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_le">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="leType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:le">
						<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</leType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var5_resultof_ku_z_propz_prubh_le">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var6_resultof_ku_z_propz_prubh_v" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_v">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="ku_z_propz_prubh_vType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:ku_z_propz_prubh_v">
						<ku_z_propz_prubh_vType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_prubh_vType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var6_resultof_ku_z_propz_prubh_v">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var7_resultof_ku_z_propz_prubh_s" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_s">
				<xsl:with-param name="patientReference" select="$var8_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="ku_z_propz_prubh_sType" as="node()*">
					<xsl:for-each select="$ku_z_propz_prubhType/ns2:ku_z_propz_prubh_s">
						<ku_z_propz_prubh_sType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_prubh_sType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var9_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var7_resultof_ku_z_propz_prubh_s">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_hosp">
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_hospType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var22_zdroj_prij" as="node()*" select="$ku_z_propz_hospType/ns2:zdroj_prij"/>
		<xsl:variable name="var23_dop_pracoviste" as="node()*" select="$ku_z_propz_hospType/ns2:dop_pracoviste"/>
		<xsl:variable name="var24_prop_pracoviste" as="node()*" select="$ku_z_propz_hospType/ns2:prop_pracoviste"/>
		<xsl:variable name="var25_duv_prij_kod" as="node()*" select="$ku_z_propz_hospType/ns2:duv_prij_kod"/>
		<xsl:variable name="var26_prij_pracovnik" as="node()*" select="$ku_z_propz_hospType/ns2:prij_pracovnik"/>
		<xsl:variable name="var27_guid" as="node()?" select="$ku_z_propz_hospType/@guid"/>
		<xsl:variable name="var28_dop_pracovnik" as="node()*" select="$ku_z_propz_hospType/ns2:dop_pracovnik"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var27_guid">
				<xsl:for-each select="$var27_guid">
					<xsl:variable name="var1_resultof_FullURL_Encounter" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Encounter">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Encounter">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Encounter>
					<meta>
						<xsl:for-each select="$ku_z_propz_hospType/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'46240-8'"/>
							</code>
						</tag>
					</meta>
					<xsl:for-each select="$ku_z_propz_hospType/ns2:hospital_text">
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'additional'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
								<xsl:sequence select="fn:string(.)"/>
							</xhtml:div>
						</text>
					</xsl:for-each>
					<status>
						<xsl:attribute name="value" namespace="" select="'in-progress'"/>
					</status>
					<class>
						<code>
							<xsl:for-each select="$ku_z_propz_hospType/ns2:typ_kontaktu">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</code>
					</class>
					<xsl:for-each select="$ku_z_propz_hospType/ns2:urg_prij">
						<xsl:variable name="var3_cur_as_string" as="xs:string" select="fn:string(.)"/>
						<priority>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/UZIScis_PrijetiPacientaKHospitalizaci'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="$var3_cur_as_string"/>
								</code>
								<xsl:variable name="var2_resultof_vmf__inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf5_inputtoresult">
										<xsl:with-param name="input" select="$var3_cur_as_string" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<display>
									<xsl:for-each select="$var2_resultof_vmf__inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</display>
							</coding>
						</priority>
					</xsl:for-each>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<participant>
						<individual>
							<reference>
								<xsl:for-each select="$var26_prij_pracovnik">
									<xsl:variable name="var5_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var4_cur" as="node()" select="."/>
										<xsl:for-each select="$var5_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('PractitionerRole/', fn:string($var4_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
							<display>
								<xsl:for-each select="$var26_prij_pracovnik/ns2:prijmeni">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</individual>
					</participant>
					<participant>
						<type>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-ParticipationType'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'REF'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'referrer'"/>
								</display>
							</coding>
						</type>
						<individual>
							<reference>
								<xsl:for-each select="$var28_dop_pracovnik">
									<xsl:variable name="var7_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var6_cur" as="node()" select="."/>
										<xsl:for-each select="$var7_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('PractitionerRole/', fn:string($var6_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
							<display>
								<xsl:for-each select="$var28_dop_pracovnik/ns2:prijmeni">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</individual>
					</participant>
					<period>
						<start>
							<xsl:for-each select="$ku_z_propz_hospType/ns2:dat_prij">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</start>
						<end>
							<xsl:for-each select="$ku_z_propz_hospType/ns2:dat_prop">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</end>
					</period>
					<reasonCode>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/DoporuceniHospitalizace'))"/>
							</system>
							<code>
								<xsl:for-each select="$var22_zdroj_prij">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$var22_zdroj_prij">
									<xsl:variable name="var8_resultof_vmf__inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf6_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var8_resultof_vmf__inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</display>
						</coding>
						<coding>
							<system>
								<xsl:for-each select="$var25_duv_prij_kod/ns2:kod_syst">
									<xsl:variable name="var9_resultof_vmf__inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf7_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var9_resultof_vmf__inputtoresult">
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</xsl:for-each>
								</xsl:for-each>
							</system>
							<code>
								<xsl:for-each select="$var25_duv_prij_kod/ns2:kod">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$var25_duv_prij_kod/ns2:kod_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</coding>
						<xsl:for-each select="$ku_z_propz_hospType/ns2:duv_prij_text">
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</xsl:for-each>
					</reasonCode>
					<xsl:for-each select="$ku_z_propz_hospType/ns2:po_prij_kod">
						<hospitalization>
							<specialCourtesy>
								<coding>
									<xsl:variable name="var10_resultof_vmf__inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf8_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var10_resultof_vmf__inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
									<xsl:for-each select="$ku_z_propz_hospType/ns2:po_prij_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</specialCourtesy>
							<destination>
								<reference>
									<xsl:for-each select="$var24_prop_pracoviste">
										<xsl:variable name="var14_cur" as="node()" select="."/>
										<xsl:for-each select="@guid">
											<xsl:variable name="var13_cur" as="node()" select="."/>
											<xsl:variable name="var12_vguid" as="node()?" select="$var14_cur/@vguid"/>
											<xsl:for-each select="$var12_vguid">
												<xsl:for-each select="$var12_vguid">
													<xsl:variable name="var11_resultof_Reference_Organization" as="xs:string?">
														<xsl:call-template name="provisio:Reference_Organization">
															<xsl:with-param name="GUID" select="fn:string($var13_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var11_resultof_Reference_Organization">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:for-each select="$var24_prop_pracoviste/ns2:nazev">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</destination>
							<xsl:for-each select="$ku_z_propz_hospType/ns2:cil_prop">
								<dischargeDisposition>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</dischargeDisposition>
							</xsl:for-each>
						</hospitalization>
					</xsl:for-each>
					<serviceProvider>
						<reference>
							<xsl:for-each select="$var23_dop_pracoviste">
								<xsl:variable name="var18_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var17_cur" as="node()" select="."/>
									<xsl:variable name="var16_vguid" as="node()?" select="$var18_cur/@vguid"/>
									<xsl:for-each select="$var16_vguid">
										<xsl:for-each select="$var16_vguid">
											<xsl:variable name="var15_resultof_Reference_Organization" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Organization">
													<xsl:with-param name="GUID" select="fn:string($var17_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var15_resultof_Reference_Organization">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
					</serviceProvider>
				</Encounter>
			</resource>
		</entry>
		<xsl:variable name="var19_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$var26_prij_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var19_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var20_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$var28_dop_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()*">
					<xsl:for-each select="$var23_dop_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var20_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var21_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()">
					<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovnikType>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()*">
					<xsl:for-each select="$var24_prop_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var21_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_sprop">
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_spropType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$ku_z_propz_spropType/@guid">
				<xsl:variable name="var1_resultof_FullURL_Encounter" as="xs:string?">
					<xsl:call-template name="provisio:FullURL_Encounter">
						<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var1_resultof_FullURL_Encounter">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
					</fullUrl>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Encounter>
					<id>
						<xsl:for-each select="$ku_z_propz_spropType/@guid">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</id>
					<meta>
						<versionId>
							<xsl:for-each select="$ku_z_propz_spropType/@vguid">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</versionId>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'67852-4'"/>
							</code>
						</tag>
					</meta>
					<xsl:for-each select="$ku_z_propz_spropType/ns2:poznamka">
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'additional'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
								<xsl:sequence select="fn:string(.)"/>
							</xhtml:div>
						</text>
					</xsl:for-each>
					<status>
						<xsl:attribute name="value" namespace="" select="'in-progress'"/>
					</status>
					<class>
						<system>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-ActCode'))"/>
						</system>
						<code>
							<xsl:attribute name="value" namespace="" select="'IMP'"/>
						</code>
						<display>
							<xsl:attribute name="value" namespace="" select="'inpatient encounter'"/>
						</display>
					</class>
					<xsl:for-each select="$patientReference">
						<subject>
							<xsl:sequence select="(./@node(), ./node())"/>
						</subject>
					</xsl:for-each>
					<participant>
						<individual>
							<reference>
								<xsl:for-each select="$ku_z_propz_spropType/ns2:prij_pracovnik">
									<xsl:variable name="var5_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var4_cur" as="node()" select="."/>
										<xsl:variable name="var3_vguid" as="node()?" select="$var5_cur/@vguid"/>
										<xsl:for-each select="$var3_vguid">
											<xsl:for-each select="$var3_vguid">
												<xsl:variable name="var2_resultof_Reference_Practitioner" as="xs:string?">
													<xsl:call-template name="provisio:Reference_Practitioner">
														<xsl:with-param name="GUID" select="fn:string($var4_cur)" as="xs:string"/>
														<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:for-each select="$var2_resultof_Reference_Practitioner">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
							<display>
								<xsl:for-each select="$ku_z_propz_spropType/ns2:prij_pracovnik">
									<xsl:variable name="var9_cur" as="node()" select="."/>
									<xsl:for-each select="ns2:titul_pred">
										<xsl:variable name="var8_cur" as="node()" select="."/>
										<xsl:for-each select="$var9_cur/ns2:jmeno">
											<xsl:variable name="var7_cur" as="node()" select="."/>
											<xsl:for-each select="$var9_cur/ns2:prijmeni">
												<xsl:variable name="var6_cur" as="node()" select="."/>
												<xsl:for-each select="$var9_cur/ns2:titul_za">
													<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat(fn:concat(fn:concat(fn:concat(fn:string($var8_cur), ' '), fn:string($var7_cur)), ' '), fn:string($var6_cur)), ' '), fn:string(.))"/>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</display>
						</individual>
					</participant>
					<period>
						<start>
							<xsl:for-each select="$ku_z_propz_spropType/ns2:dat_vys_prij">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</start>
					</period>
				</Encounter>
			</resource>
		</entry>
		<xsl:variable name="var10_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:prij_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var10_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var12_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_a_text">
				<xsl:variable name="var11_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var12_cur/@node(), $var12_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'8716-3'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var11_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var14_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:h">
				<xsl:variable name="var13_resultof_ku_z_propz_sprij_h" as="node()*">
					<xsl:call-template name="provisio:ku_z_propz_sprij_h">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var14_cur/@node(), $var14_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="hType" as="node()">
							<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</hType>
						</xsl:with-param>
						<xsl:with-param name="dat_prov" as="node()*">
							<xsl:for-each select="$dat_prov">
								<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</dat_prov>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
						<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var13_resultof_ku_z_propz_sprij_h">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_a_param/ns2:vys_v_snomed">
			<xsl:variable name="var15_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var15_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var16_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_a_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var16_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var18_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_f_text">
				<xsl:variable name="var17_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var18_cur/@node(), $var18_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'8716-3'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var17_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var19_resultof_ku_z_propz_sprij_fyznal" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_sprij_fyznal">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="(./@node(), ./node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="fyznalType" as="node()*">
						<xsl:for-each select="$ku_z_propz_spropType/ns2:fyznal">
							<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</fyznalType>
						</xsl:for-each>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" as="node()*">
						<xsl:for-each select="$dat_prov">
							<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</dat_prov>
						</xsl:for-each>
					</xsl:with-param>
					<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
					<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var19_resultof_ku_z_propz_sprij_fyznal">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_f_param/ns2:vys_v_snomed">
			<xsl:variable name="var20_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var20_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var21_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_f_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var21_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var23_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_s_text">
				<xsl:variable name="var22_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var23_cur/@node(), $var23_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'55286-9'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var22_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var24_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_s_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var24_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var26_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_fs_text">
				<xsl:variable name="var25_resultof_text_autor_ptext_ktext_priloha" as="node()*">
					<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var26_cur/@node(), $var26_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="text" as="node()">
							<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</text>
						</xsl:with-param>
						<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var25_resultof_text_autor_ptext_ktext_priloha">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var27_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_fs_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var27_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$patientReference">
			<xsl:variable name="var29_cur" as="node()" select="."/>
			<xsl:for-each select="$ku_z_propz_spropType/ns2:vys_fs_form">
				<xsl:variable name="var28_resultof_ku_z_propz_sprXX___vys_fs_form" as="node()*">
					<xsl:call-template name="provisio:ku_z_propz_sprXX_-_vys_fs_form">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="($var29_cur/@node(), $var29_cur/node())"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="vys_fs_form" as="node()">
							<vys_fs_form xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</vys_fs_form>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var28_resultof_ku_z_propz_sprXX___vys_fs_form">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_CarePlan">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('CarePlan/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_MedicationAdministration">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('MedicationAdministration/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_prubh_le">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="leType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$leType">
			<xsl:variable name="var13_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:lez">
				<xsl:variable name="var12_cur" as="node()" select="."/>
				<xsl:variable name="var9_kod_atc" as="node()?" select="@kod_atc"/>
				<xsl:variable name="var10_dat_ab" as="node()?" select="$var13_cur/@dat_ab"/>
				<xsl:variable name="var11_guid" as="node()?" select="@guid"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var11_guid">
						<xsl:for-each select="$var11_guid">
							<xsl:variable name="var1_resultof_FullURL_MedicationAdministration" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_MedicationAdministration">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_FullURL_MedicationAdministration">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<MedicationAdministration>
							<xsl:for-each select="$var11_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'10160-0'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:for-each select="@ind_oprav_sd">
									<xsl:variable name="var2_resultof_vmf__inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf9_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var2_resultof_vmf__inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</status>
							<xsl:for-each select="ns2:zmena_m_kod">
								<statusReason>
									<coding>
										<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf10_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<code>
											<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="$var12_cur/ns2:zmena_m_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</statusReason>
							</xsl:for-each>
							<category>
								<xsl:for-each select="@typ_med">
									<xsl:variable name="var6_cur_as_string" as="xs:string" select="fn:string(.)"/>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/medication-admin-category'))"/>
										</system>
										<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf11_inputtoresult">
												<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<code>
											<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</code>
										<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf12_inputtoresult">
												<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<display>
											<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</display>
									</coding>
								</xsl:for-each>
							</category>
							<medicationCodeableConcept>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://www.snomed.org/'))"/>
									</system>
									<code>
										<xsl:for-each select="@kod_lek">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="@nazev_lek">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
								<xsl:variable name="var7_test_resultof_exists" as="xs:string*">
									<xsl:choose>
										<xsl:when test="fn:exists($var9_kod_atc)">
											<xsl:sequence select="fn:string($var9_kod_atc)"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="ns2:aktivni_latka/@kod_atc">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<xsl:for-each select="$var7_test_resultof_exists">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://www.whocc.no/atc/'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="."/>
										</code>
										<xsl:for-each select="$var12_cur/ns2:aktivni_latka/@nazev">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
								<xsl:for-each select="@gene_lek">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</medicationCodeableConcept>
							<xsl:for-each select="$patientReference">
								<subject>
									<xsl:sequence select="(./@node(), ./node())"/>
								</subject>
							</xsl:for-each>
							<xsl:variable name="var8_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($var10_dat_ab)">
										<xsl:sequence select="xs:string(xs:dateTime(fn:string($var10_dat_ab)))"/>
									</xsl:when>
									<xsl:otherwise>
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var8_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="ns2:dat_od">
								<effectivePeriod>
									<start>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</start>
									<xsl:for-each select="$var12_cur/ns2:dat_do">
										<end>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</end>
									</xsl:for-each>
								</effectivePeriod>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<actor>
										<reference>
											<xsl:attribute name="value" namespace="" select="."/>
										</reference>
									</actor>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="ns2:ind_m_kod">
								<reasonCode>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
										</system>
										<version>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</version>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
									<xsl:for-each select="$var12_cur/ns2:ind_m_text">
										<text>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</text>
									</xsl:for-each>
								</reasonCode>
							</xsl:for-each>
							<xsl:for-each select="ns2:pozn">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
							<xsl:for-each select="ns2:rozpis_v">
								<dosage>
									<xsl:for-each select="$var12_cur/@misto_apl_klic">
										<site>
											<coding>
												<system>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUU.htm'))"/>
												</system>
												<code>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</code>
												<display>
													<xsl:for-each select="$var12_cur/@misto_apl_text">
														<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
													</xsl:for-each>
												</display>
											</coding>
										</site>
									</xsl:for-each>
									<xsl:for-each select="$var12_cur/@apl_cesta_klic">
										<route>
											<coding>
												<system>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUT.htm'))"/>
												</system>
												<code>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</code>
												<display>
													<xsl:for-each select="$var12_cur/@apl_cesta_text">
														<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
													</xsl:for-each>
												</display>
											</coding>
										</route>
									</xsl:for-each>
									<xsl:for-each select="$var12_cur/@forma_klic">
										<method>
											<coding>
												<system>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBRW.htm'))"/>
												</system>
												<code>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</code>
												<display>
													<xsl:for-each select="$var12_cur/@forma_text">
														<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
													</xsl:for-each>
												</display>
											</coding>
										</method>
									</xsl:for-each>
									<dose>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</value>
									</dose>
								</dosage>
							</xsl:for-each>
						</MedicationAdministration>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_dopor">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="ku_z_propz_doporType" select="()"/>
		<xsl:for-each select="$ku_z_propz_doporType">
			<xsl:variable name="var4_cur" as="node()" select="."/>
			<xsl:variable name="var2_pp_aktivita" as="node()*" select="ns2:pp_aktivita"/>
			<xsl:variable name="var3_pp_nemstav" as="node()*" select="ns2:pp_nemstav"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_pp_nemstav/@guid">
					<xsl:variable name="var1_resultof_FullURL_CarePlan" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_CarePlan">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_CarePlan">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<CarePlan>
						<id>
							<xsl:for-each select="$var3_pp_nemstav/@guid">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</id>
						<meta>
							<xsl:for-each select="$var3_pp_nemstav/@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-carePlan-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'18776-5'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'completed'"/>
						</status>
						<intent>
							<xsl:attribute name="value" namespace="" select="'plan'"/>
						</intent>
						<xsl:for-each select="$var3_pp_nemstav">
							<category>
								<coding>
									<system>
										<xsl:for-each select="ns2:kod_syst">
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
										</xsl:for-each>
									</system>
									<code>
										<xsl:for-each select="ns2:kod">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="ns2:kod_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</category>
						</xsl:for-each>
						<xsl:for-each select="ns2:pp_nazev">
							<title>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</title>
						</xsl:for-each>
						<xsl:for-each select="ns2:popis_dopor">
							<description>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</description>
						</xsl:for-each>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="ns2:ppo_dat_od">
							<period>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var4_cur/ns2:ppo_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</period>
						</xsl:for-each>
						<created>
							<xsl:for-each select="$dat_prov">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</created>
						<xsl:for-each select="$practitionerReference">
							<author>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</author>
						</xsl:for-each>
						<activity>
							<detail>
								<kind>
									<xsl:for-each select="$var2_pp_aktivita/ns2:aktivita_typ/ns2:ptext">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</kind>
								<status>
									<xsl:attribute name="value" namespace="" select="'completed'"/>
								</status>
								<xsl:for-each select="$var2_pp_aktivita/ns2:aktivita_popis">
									<description>
										<xsl:attribute name="value" namespace="" select="()"/>
									</description>
								</xsl:for-each>
							</detail>
						</activity>
						<xsl:for-each select="ns2:pp_podrob">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</CarePlan>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var5_resultof_ku_z_propz_prubh_le" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh_le">
				<xsl:with-param name="patientReference" as="node()*">
					<xsl:for-each select="$patientReference">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="(./@node(), ./node())"/>
						</Reference>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="leType" as="node()*">
					<xsl:for-each select="$ku_z_propz_doporType/ns2:medikace">
						<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</leType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" as="node()*">
					<xsl:for-each select="$dat_prov">
						<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</dat_prov>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var5_resultof_ku_z_propz_prubh_le">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Device">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('Device/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_DeviceUseStatement">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('DeviceUseStatement/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_zpi">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_zpi" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_zpi">
			<xsl:variable name="var7_current" as="node()" select="."/>
			<xsl:for-each select="ns2:uniz">
				<xsl:variable name="var6_cur" as="node()" select="."/>
				<xsl:variable name="var4_dat_ab" as="node()?" select="@dat_ab"/>
				<xsl:variable name="var5_guid" as="node()?" select="@guid"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var5_guid">
						<xsl:for-each select="$var5_guid">
							<xsl:variable name="var1_resultof_FullURL_DeviceUseStatement" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_DeviceUseStatement">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_FullURL_DeviceUseStatement">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<DeviceUseStatement>
							<xsl:for-each select="$var5_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<xsl:variable name="var2_test_resultof_exists" as="xs:string*">
									<xsl:choose>
										<xsl:when test="fn:exists($var4_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var4_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$dat_prov">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<xsl:for-each select="$var2_test_resultof_exists">
									<lastUpdated>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(.))"/>
									</lastUpdated>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.eu/fhir/hdr/StructureDefinition/deviceUseStatement-eu-hdr'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'46264-8'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:for-each select="@typ">
									<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf13_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</status>
							<xsl:for-each select="$patientReference">
								<subject>
									<xsl:sequence select="(./@node(), ./node())"/>
								</subject>
							</xsl:for-each>
							<xsl:for-each select="ns2:dat_du">
								<timingPeriod>
									<start>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</start>
									<xsl:for-each select="$var6_cur/ns2:dat_up">
										<end>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</end>
									</xsl:for-each>
								</timingPeriod>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<source>
									<display>
										<xsl:attribute name="value" namespace="" select="."/>
									</display>
								</source>
							</xsl:for-each>
							<device>
								<reference>
									<xsl:for-each select="ns2:unizf/@guid">
										<xsl:attribute name="value" namespace="" select="fn:concat('Device/', fn:string(.))"/>
									</xsl:for-each>
								</reference>
							</device>
							<xsl:for-each select="ns2:duvod_text">
								<reasonCode>
									<xsl:for-each select="$var6_cur/ns2:duvod_kod">
										<coding>
											<system>
												<xsl:for-each select="ns2:kod_syst">
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</xsl:for-each>
											</system>
											<code>
												<xsl:for-each select="ns2:kod">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</code>
											<display>
												<xsl:for-each select="ns2:kod_text">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</display>
										</coding>
									</xsl:for-each>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</reasonCode>
							</xsl:for-each>
							<xsl:for-each select="ns2:u_niz">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
							<xsl:for-each select="$var7_current/ns2:zpi_souhrn_text">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
						</DeviceUseStatement>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$anam_zpi/ns2:uniz">
			<xsl:variable name="var13_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:unizf">
				<xsl:variable name="var11_guid" as="node()?" select="@guid"/>
				<xsl:variable name="var12_dat_ab" as="node()?" select="$var13_cur/@dat_ab"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var11_guid">
						<xsl:for-each select="$var11_guid">
							<xsl:variable name="var8_resultof_FullURL_Device" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_Device">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var8_resultof_FullURL_Device">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Device>
							<xsl:for-each select="$var11_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<xsl:variable name="var9_test_resultof_exists" as="xs:string*">
									<xsl:choose>
										<xsl:when test="fn:exists($var12_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var12_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$dat_prov">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<xsl:for-each select="$var9_test_resultof_exists">
									<lastUpdated>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(.))"/>
									</lastUpdated>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/core/StructureDefinition/cz-medical-device'))"/>
								</profile>
							</meta>
							<status>
								<xsl:for-each select="$var13_cur/@typ">
									<xsl:variable name="var10_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf13_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var10_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</status>
							<xsl:for-each select="@niz_ident">
								<modelNumber>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</modelNumber>
							</xsl:for-each>
							<type>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
									</system>
									<code>
										<xsl:for-each select="@niz_klic">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="@niz_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
								<xsl:for-each select="@info_text">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</type>
						</Device>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Condition">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('Condition/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_prob">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_probType" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_probType">
			<xsl:variable name="var5_cur" as="node()" select="."/>
			<xsl:variable name="var3_prob_kod" as="node()*" select="ns2:prob_kod"/>
			<xsl:variable name="var4_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var4_guid">
					<xsl:for-each select="$var4_guid">
						<xsl:variable name="var1_resultof_FullURL_Condition" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Condition">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Condition">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Condition>
						<xsl:for-each select="$var4_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<xsl:for-each select="$dat_prov">
								<lastUpdated>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(.)))"/>
								</lastUpdated>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-condition-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'11450-4'"/>
								</code>
							</tag>
						</meta>
						<clinicalStatus>
							<xsl:for-each select="ns2:prob_klin">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-clinical'))"/>
									</system>
									<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf14_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
								</coding>
							</xsl:for-each>
						</clinicalStatus>
						<verificationStatus>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-ver-status'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'confirmed'"/>
								</code>
							</coding>
						</verificationStatus>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'encounter-diagnosis'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Encounter Diagnosis'"/>
								</display>
							</coding>
						</category>
						<xsl:for-each select="ns2:prob_zav_text">
							<severity>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</severity>
						</xsl:for-each>
						<code>
							<xsl:for-each select="$var3_prob_kod">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
									</system>
									<code>
										<xsl:for-each select="ns2:kod_syst">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="ns2:kod">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</xsl:for-each>
							<text>
								<xsl:for-each select="$var3_prob_kod/ns2:kod_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_dat_od">
							<onsetPeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var5_cur/ns2:prob_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</onsetPeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<recorder>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</recorder>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_stad_kod">
							<stage>
								<summary>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
										</system>
										<code>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
									<text>
										<xsl:for-each select="ns2:kod_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</text>
								</summary>
							</stage>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_stad_text">
							<stage>
								<type>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</type>
							</stage>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_popis">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
						<xsl:for-each select="ns2:prob_okol">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Condition>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_abj">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_abj" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_abj">
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<xsl:variable name="var2_abj_kod" as="node()*" select="ns2:abj_kod"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
								</system>
								<version>
									<xsl:for-each select="$var2_abj_kod/ns2:kod_syst">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</version>
								<code>
									<xsl:for-each select="$var2_abj_kod/ns2:kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="$var2_abj_kod/ns2:kod_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:abj_text">
							<valueCodeableConcept>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</valueCodeableConcept>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_abd">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_abd" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_abd">
			<xsl:variable name="var4_current" as="node()" select="."/>
			<xsl:variable name="var3_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var3_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWG.htm'))"/>
								</system>
								<xsl:for-each select="ns2:abd_stav_kod">
									<xsl:variable name="var1_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf15_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var1_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
								</xsl:for-each>
								<xsl:for-each select="ns2:abd_stav_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWH.htm'))"/>
								</system>
								<xsl:for-each select="ns2:abd_lattyp_kod">
									<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf16_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
								</xsl:for-each>
								<xsl:for-each select="ns2:abd_lattyp_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBSE.htm'))"/>
								</system>
								<code>
									<xsl:for-each select="ns2:abd_latzp_kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="ns2:abd_latzp_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:abd_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var4_current/ns2:abd_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:abd_mnoz_text">
							<valueCodeableConcept>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</valueCodeableConcept>
						</xsl:for-each>
						<xsl:for-each select="ns2:abd_koment">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_abk">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_abk" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_abk">
			<xsl:variable name="var2_current" as="node()" select="."/>
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
								</system>
								<xsl:for-each select="ns2:abk_stav_kod">
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
								</xsl:for-each>
								<xsl:for-each select="ns2:abk_stav_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:abk_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var2_current/ns2:abk_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:abk_mnoz_text">
							<valueCodeableConcept>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</valueCodeableConcept>
						</xsl:for-each>
						<xsl:for-each select="ns2:abk_koment">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_aba">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_aba" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_aba">
			<xsl:variable name="var2_current" as="node()" select="."/>
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
								</system>
								<xsl:for-each select="ns2:aba_stav_kod">
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
								</xsl:for-each>
								<xsl:for-each select="ns2:aba_stav_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:aba_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var2_current/ns2:aba_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:aba_mnoz_text">
							<valueCodeableConcept>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</valueCodeableConcept>
						</xsl:for-each>
						<xsl:for-each select="ns2:aba_koment">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_sa">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_sa" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_sa">
			<xsl:variable name="var10_current" as="node()" select="."/>
			<xsl:variable name="var9_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var9_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var9_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'social-history'"/>
								</code>
							</coding>
						</category>
						<code>
							<text>
								<xsl:attribute name="value" namespace="" select="'Sociln anamnza'"/>
							</text>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:sau_prac">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Pracovn zapojen'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sau_zajmy">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Konky'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sau_soc">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Sociln s'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sav_vzdel">
							<xsl:variable name="var2_cur_as_string" as="xs:string" select="fn:string(.)"/>
							<component>
								<code>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-EducationLevel'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="$var2_cur_as_string"/>
										</code>
										<xsl:variable name="var1_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf17_inputtoresult">
												<xsl:with-param name="input" select="$var2_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<display>
											<xsl:for-each select="$var1_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</display>
									</coding>
								</code>
								<valueString>
									<xsl:for-each select="$var10_current/ns2:sav_koment">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sab_zpbydl_text">
							<component>
								<code>
									<xsl:for-each select="$var10_current/ns2:sab_zpbydl_kod">
										<xsl:variable name="var4_cur_as_string" as="xs:string" select="fn:string(.)"/>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWB.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="$var4_cur_as_string"/>
											</code>
											<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
												<xsl:call-template name="vmf:vmf18_inputtoresult">
													<xsl:with-param name="input" select="$var4_cur_as_string" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<display>
												<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</display>
										</coding>
									</xsl:for-each>
									<text>
										<xsl:attribute name="value" namespace="" select="'Zpsob bydlen'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sab_prizp_text">
							<component>
								<code>
									<xsl:for-each select="$var10_current/ns2:sab_prizp_kod">
										<xsl:variable name="var6_cur_as_string" as="xs:string" select="fn:string(.)"/>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWC.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="$var6_cur_as_string"/>
											</code>
											<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
												<xsl:call-template name="vmf:vmf19_inputtoresult">
													<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<display>
												<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</display>
										</coding>
									</xsl:for-each>
									<text>
										<xsl:attribute name="value" namespace="" select="'Pizpsoben domcnosti'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sab_bariery_text">
							<component>
								<code>
									<xsl:for-each select="$var10_current/ns2:sab_bariery_kod">
										<xsl:variable name="var8_cur_as_string" as="xs:string" select="fn:string(.)"/>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWD.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="$var8_cur_as_string"/>
											</code>
											<xsl:variable name="var7_resultof_vmf___inputtoresult" as="xs:string?">
												<xsl:call-template name="vmf:vmf20_inputtoresult">
													<xsl:with-param name="input" select="$var8_cur_as_string" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<display>
												<xsl:for-each select="$var7_resultof_vmf___inputtoresult">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</display>
										</coding>
									</xsl:for-each>
									<text>
										<xsl:attribute name="value" namespace="" select="'Bariry'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_koment">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Rodinn situace'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_slozrod_text">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Sloen rodiny'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_rodstav_text">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Rodinn stav'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_pocdet">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Poet dt'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_pocdetd">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Poet dt ve spolen domcnosti'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_dite">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Podrobnosti o dtti'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
						<xsl:for-each select="ns2:sar_pecezc">
							<component>
								<code>
									<text>
										<xsl:attribute name="value" namespace="" select="'Peuje o zvislho lena'"/>
									</text>
								</code>
								<valueString>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</valueString>
							</component>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_FamilyMemberHistory">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('FamilyMemberHistory/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_rao">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_rao" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_rao">
			<xsl:variable name="var4_current" as="node()" select="."/>
			<xsl:variable name="var3_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid">
					<xsl:for-each select="$var3_guid">
						<xsl:variable name="var1_resultof_FullURL_FamilyMemberHistory" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_FamilyMemberHistory">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_FamilyMemberHistory">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<FamilyMemberHistory>
						<xsl:for-each select="$var3_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<xsl:for-each select="$dat_prov">
								<lastUpdated>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(.)))"/>
								</lastUpdated>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/czh-familyMemberHistory-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'10157-6'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'completed'"/>
						</status>
						<xsl:for-each select="$patientReference">
							<patient>
								<xsl:sequence select="(./@node(), ./node())"/>
							</patient>
						</xsl:for-each>
						<xsl:for-each select="ns2:rao_vztah_kod">
							<relationship>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/ValueSet/v3-FamilyMember'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<xsl:for-each select="$var4_current/ns2:rao_vztah_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</relationship>
						</xsl:for-each>
						<xsl:for-each select="ns2:rao_dat_nar">
							<bornDate>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</bornDate>
						</xsl:for-each>
						<xsl:for-each select="ns2:rao_dat_um">
							<deceasedDate>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</deceasedDate>
						</xsl:for-each>
						<note>
							<xsl:for-each select="$practitionerReference">
								<authorReference>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</authorReference>
							</xsl:for-each>
						</note>
						<xsl:for-each select="ns2:rao_zdrprob_kod">
							<xsl:variable name="var2_https___dastacr_cz_dasta_hyper_as_string" as="xs:string" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
							<condition>
								<code>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="$var2_https___dastacr_cz_dasta_hyper_as_string"/>
										</system>
										<version>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</version>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</code>
								<xsl:for-each select="$var4_current/ns2:rao_duvum_kod">
									<outcome>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="$var2_https___dastacr_cz_dasta_hyper_as_string"/>
											</system>
											<version>
												<xsl:for-each select="ns2:kod_syst">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</version>
											<code>
												<xsl:for-each select="ns2:kod">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</code>
											<display>
												<xsl:for-each select="ns2:kod_text">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</display>
										</coding>
									</outcome>
								</xsl:for-each>
							</condition>
						</xsl:for-each>
					</FamilyMemberHistory>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_infc">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_infcType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_infcType">
			<xsl:variable name="var2_cur" as="node()" select="."/>
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-travel-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'82753-5'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:infc_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var2_cur/ns2:infc_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:infc_stat_kod">
							<valueCodeableConcept>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/valueset-iso3166-1-2.html'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<display>
										<xsl:for-each select="$var2_cur/ns2:infc_stat_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
								<xsl:for-each select="$var2_cur/ns2:infc_koment">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</valueCodeableConcept>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_inf">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_infType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_infType">
			<xsl:variable name="var2_cur" as="node()" select="."/>
			<xsl:variable name="var1_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var1_guid">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var1_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-infectious-contact-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-ParticipationType'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'EXPAGNT'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$patientReference">
							<subject>
								<xsl:sequence select="(./@node(), ./node())"/>
							</subject>
						</xsl:for-each>
						<xsl:for-each select="$dat_prov">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:inf_dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var2_cur/ns2:inf_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:inf_stat_kod">
							<valueCodeableConcept>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/valueset-iso3166-1-2.html'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<display>
										<xsl:for-each select="$var2_cur/ns2:inf_stat_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</valueCodeableConcept>
						</xsl:for-each>
						<xsl:for-each select="ns2:inf_koment">
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Immunization">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('Immunization/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_oc">
		<xsl:param name="Reference" select="()"/>
		<xsl:param name="anam_oc" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_oc">
			<xsl:variable name="var11_current" as="node()" select="."/>
			<xsl:for-each select="ns2:ocz">
				<xsl:variable name="var10_cur" as="node()" select="."/>
				<xsl:variable name="var8_guid" as="node()?" select="@guid"/>
				<xsl:variable name="var9_davka" as="node()*" select="ns2:davka"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var8_guid">
						<xsl:for-each select="$var8_guid">
							<xsl:variable name="var1_resultof_FullURL_Immunization" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_Immunization">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_FullURL_Immunization">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Immunization>
							<xsl:for-each select="$var8_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-immunization-hdr'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'11369-6'"/>
									</code>
								</tag>
							</meta>
							<xsl:for-each select="@id_ockovani">
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'ID okovn'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSALA.htm'))"/>
									</system>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="@id_ockovani_isin">
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'ID okovn dle ISIN'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.uzis.cz/'))"/>
									</system>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/@id_davka">
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'ID dvky okovn'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSALA.htm'))"/>
									</system>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/@id_davka_isin">
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'ID dvky dle ISIN'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.uzis.cz/'))"/>
									</system>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<status>
								<xsl:attribute name="value" namespace="" select="'completed'"/>
							</status>
							<vaccineCode>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSAHW.htm'))"/>
									</system>
									<xsl:for-each select="@typ_oc_kod">
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
									</xsl:for-each>
									<xsl:for-each select="@typ_oc_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
								<xsl:for-each select="$var9_davka">
									<xsl:variable name="var2_cur" as="node()" select="."/>
									<xsl:for-each select="@kod_ol">
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://www.sukl.cz'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<xsl:for-each select="$var2_cur/@nazev_ol">
												<display>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</display>
											</xsl:for-each>
										</coding>
									</xsl:for-each>
								</xsl:for-each>
								<xsl:for-each select="ns2:agens">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSAKM.htm'))"/>
										</system>
										<code>
											<xsl:for-each select="@agens_klic">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<xsl:for-each select="@agens_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
								<xsl:for-each select="$var9_davka/@pozn">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</vaccineCode>
							<xsl:for-each select="$Reference">
								<patient>
									<xsl:sequence select="(./@node(), ./node())"/>
								</patient>
							</xsl:for-each>
							<xsl:variable name="var3_test_resultof_any" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists(($var9_davka)[fn:exists(ns2:dat_du)])">
										<xsl:for-each select="$var9_davka/ns2:dat_du">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var3_test_resultof_any">
								<occurrenceDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</occurrenceDateTime>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/@nazev_vyrobce">
								<manufacturer>
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</manufacturer>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/@cis_sarze">
								<lotNumber>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</lotNumber>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/ns2:dat_expirace">
								<expirationDate>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</expirationDate>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka">
								<xsl:variable name="var4_cur" as="node()" select="."/>
								<xsl:for-each select="@misto_apl_klic">
									<site>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUU.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<xsl:for-each select="$var4_cur/@misto_apl_text">
												<display>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</display>
											</xsl:for-each>
										</coding>
									</site>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka">
								<xsl:variable name="var5_cur" as="node()" select="."/>
								<xsl:for-each select="@apl_cesta_klic">
									<route>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUT.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<xsl:for-each select="$var5_cur/@apl_cesta_text">
												<display>
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</display>
											</xsl:for-each>
										</coding>
									</route>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<actor>
										<reference>
											<xsl:attribute name="value" namespace="" select="."/>
										</reference>
									</actor>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var11_current/ns2:oc_souhrn_text">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
							<xsl:for-each select="ns2:indikace">
								<reasonCode>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.uzis.cz/'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<xsl:for-each select="$var10_cur/@indikace_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</reasonCode>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka/ns2:reakce">
								<xsl:variable name="var7_typ" as="node()?" select="@typ"/>
								<reaction>
									<date>
										<xsl:for-each select="ns2:dat_or">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</date>
									<detail>
										<type>
											<xsl:for-each select="$var7_typ">
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
											</xsl:for-each>
										</type>
										<display>
											<xsl:for-each select="$var7_typ">
												<xsl:variable name="var6_resultof_vmf___inputtoresult" as="xs:string?">
													<xsl:call-template name="vmf:vmf21_inputtoresult">
														<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:for-each select="$var6_resultof_vmf___inputtoresult">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</xsl:for-each>
										</display>
									</detail>
								</reaction>
							</xsl:for-each>
							<xsl:for-each select="$var9_davka">
								<protocolApplied>
									<doseNumberPositiveInt>
										<xsl:for-each select="@cis_davky">
											<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
										</xsl:for-each>
									</doseNumberPositiveInt>
									<xsl:for-each select="@poc_davek">
										<seriesDosesString>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
										</seriesDosesString>
									</xsl:for-each>
								</protocolApplied>
							</xsl:for-each>
						</Immunization>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Procedure">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('Procedure/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam_anam_vyk">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_vyk" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:for-each select="$anam_vyk">
			<xsl:variable name="var10_current" as="node()" select="."/>
			<xsl:for-each select="ns2:chv">
				<xsl:variable name="var9_cur" as="node()" select="."/>
				<xsl:variable name="var7_guid" as="node()?" select="@guid"/>
				<xsl:variable name="var8_dat_vyk" as="node()*" select="ns2:dat_vyk"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var7_guid">
						<xsl:for-each select="$var7_guid">
							<xsl:variable name="var1_resultof_FullURL_Procedure" as="xs:string?">
								<xsl:call-template name="provisio:FullURL_Procedure">
									<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_FullURL_Procedure">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Procedure>
							<xsl:for-each select="$var7_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-procedure-hdr'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'47519-4'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'completed'"/>
							</status>
							<code>
								<xsl:for-each select="@chvps_klic">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<xsl:for-each select="$var9_cur/@chvps_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
								<xsl:for-each select="ns2:alv_text">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</code>
							<xsl:for-each select="$patientReference">
								<subject>
									<xsl:sequence select="(./@node(), ./node())"/>
								</subject>
							</xsl:for-each>
							<xsl:variable name="var3_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($var8_dat_vyk)">
										<xsl:for-each select="$var8_dat_vyk">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var2_dat_ab" as="node()?" select="@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var2_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var2_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$dat_prov">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var3_test_resultof_exists">
								<performedDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</performedDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<actor>
										<reference>
											<xsl:attribute name="value" namespace="" select="."/>
										</reference>
									</actor>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="ns2:duvod_kod">
								<reasonCode>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/sid/icd-10'))"/>
										</system>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
									<xsl:for-each select="$var9_cur/ns2:duvod_text">
										<text>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</text>
									</xsl:for-each>
								</reasonCode>
							</xsl:for-each>
							<xsl:for-each select="ns2:alv_form">
								<bodySite>
									<xsl:for-each select="ns2:ptext">
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
											</system>
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</coding>
									</xsl:for-each>
								</bodySite>
							</xsl:for-each>
							<xsl:for-each select="ns2:vysledek">
								<xsl:variable name="var6_cur_as_string" as="xs:string" select="fn:string(.)"/>
								<outcome>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
										</system>
										<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf22_inputtoresult">
												<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<code>
											<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</code>
										<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf23_inputtoresult">
												<xsl:with-param name="input" select="$var6_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<display>
											<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</display>
									</coding>
								</outcome>
							</xsl:for-each>
							<xsl:for-each select="ns2:komplikace">
								<complication>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/sid/icd-10'))"/>
										</system>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</complication>
							</xsl:for-each>
							<note>
								<xsl:for-each select="$var10_current/ns2:vyk_souhrn_text">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</note>
						</Procedure>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_anam">
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_anamType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var13_create_Reference_of_patientReference" as="node()*">
			<xsl:for-each select="$patientReference">
				<Reference xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</Reference>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var14_create_dat_prov_of_dat_prov" as="node()*">
			<xsl:for-each select="$dat_prov">
				<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</dat_prov>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1_resultof_ku_z_propz_anam_anam_prob" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_prob">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_probType" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_prob">
						<anam_probType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_probType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_ku_z_propz_anam_anam_prob">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var2_resultof_ku_z_propz_anam_anam_zpi" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_zpi">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_zpi" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_zpi">
						<anam_zpi xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_zpi>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var2_resultof_ku_z_propz_anam_anam_zpi">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var3_resultof_ku_z_propz_anam_anam_vyk" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_vyk">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_vyk" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_vyk">
						<anam_vyk xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_vyk>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var3_resultof_ku_z_propz_anam_anam_vyk">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var4_resultof_ku_z_propz_anam_anam_oc" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_oc">
				<xsl:with-param name="Reference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_oc" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_oc">
						<anam_oc xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_oc>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var4_resultof_ku_z_propz_anam_anam_oc">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var5_resultof_ku_z_propz_anam_anam_inf" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_inf">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_infType" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_inf">
						<anam_infType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_infType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var5_resultof_ku_z_propz_anam_anam_inf">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var6_resultof_ku_z_propz_anam_anam_infc" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_infc">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_infcType" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_infc">
						<anam_infcType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_infcType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var6_resultof_ku_z_propz_anam_anam_infc">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var7_resultof_ku_z_propz_anam_anam_rao" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_rao">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_rao" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_rao">
						<anam_rao xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_rao>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var7_resultof_ku_z_propz_anam_anam_rao">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var8_resultof_ku_z_propz_anam_anam_sa" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_sa">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_sa" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_sa">
						<anam_sa xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_sa>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var8_resultof_ku_z_propz_anam_anam_sa">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var9_resultof_ku_z_propz_anam_anam_aba" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_aba">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_aba" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_aba">
						<anam_aba xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_aba>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var9_resultof_ku_z_propz_anam_anam_aba">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var10_resultof_ku_z_propz_anam_anam_abk" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_abk">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_abk" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_abk">
						<anam_abk xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abk>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var10_resultof_ku_z_propz_anam_anam_abk">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var11_resultof_ku_z_propz_anam_anam_abd" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_abd">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_abd" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_abd">
						<anam_abd xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abd>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var11_resultof_ku_z_propz_anam_anam_abd">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var12_resultof_ku_z_propz_anam_anam_abj" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam_anam_abj">
				<xsl:with-param name="patientReference" select="$var13_create_Reference_of_patientReference" as="node()*"/>
				<xsl:with-param name="anam_abj" as="node()*">
					<xsl:for-each select="$ku_z_propz_anamType/ns2:anam_abj">
						<anam_abj xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abj>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var14_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var12_resultof_ku_z_propz_anam_anam_abj">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_sprij_fyznal">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="fyznalType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var5_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var3_guid_tk" as="node()?" select="$var5_cur/@guid_tk"/>
				<xsl:variable name="var4_http___loinc_org_as_string" as="xs:string" select="xs:string(xs:anyURI('http://loinc.org'))"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var3_guid_tk">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var3_guid_tk">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var5_cur/@vguid_tk">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/bp'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="$var4_http___loinc_org_as_string"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'85354-9'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Blood pressure panel with all children optional'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var2_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var1_dat_ab" as="node()?" select="$var5_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var1_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var1_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var5_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var2_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var5_cur/ns2:pozn">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
							<xsl:for-each select="$var5_cur/ns2:tk_syst">
								<component>
									<code>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="$var4_http___loinc_org_as_string"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="'8480-6'"/>
											</code>
											<display>
												<xsl:attribute name="value" namespace="" select="'Systolic blood pressure'"/>
											</display>
										</coding>
									</code>
									<valueQuantity>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</value>
										<unit>
											<xsl:attribute name="value" namespace="" select="'mmHg'"/>
										</unit>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="'mm[Hg]'"/>
										</code>
									</valueQuantity>
								</component>
							</xsl:for-each>
							<xsl:for-each select="$var5_cur/ns2:tk_diast">
								<component>
									<code>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="$var4_http___loinc_org_as_string"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="'8462-4'"/>
											</code>
											<display>
												<xsl:attribute name="value" namespace="" select="'Diastolic blood pressure'"/>
											</display>
										</coding>
									</code>
									<valueQuantity>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</value>
										<unit>
											<xsl:attribute name="value" namespace="" select="'mmHg'"/>
										</unit>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="'mm[Hg]'"/>
										</code>
									</valueQuantity>
								</component>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var9_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var8_guid_pulz" as="node()?" select="$var9_cur/@guid_pulz"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var8_guid_pulz">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var8_guid_pulz">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var9_cur/@vguid_pulz">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/heartrate'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'8867-4'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Heart rate'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var7_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var6_dat_ab" as="node()?" select="$var9_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var6_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var6_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var9_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var7_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var9_cur/ns2:pulz">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var13_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var12_guid_o_sat" as="node()?" select="$var13_cur/@guid_o2sat"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var12_guid_o_sat">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var12_guid_o_sat">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var13_cur/@vguid_o2sat">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/oxygensat'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'2708-6'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Oxygen saturation in Arterial blood'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var11_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var10_dat_ab" as="node()?" select="$var13_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var10_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var10_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var13_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var11_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var13_cur/ns2:o2sat">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'%'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'%'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var17_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var16_guid_dech" as="node()?" select="$var17_cur/@guid_dech"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var16_guid_dech">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var16_guid_dech">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var17_cur/@vguid_dech">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/resprate'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'9279-1'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Respiratory rate'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var15_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var14_dat_ab" as="node()?" select="$var17_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var14_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var14_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var17_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var15_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var17_cur/ns2:dech">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var21_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var20_guid_teplota" as="node()?" select="$var21_cur/@guid_teplota"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var20_guid_teplota">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
						</fullUrl>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var20_guid_teplota">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var21_cur/@vguid_teplota">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/bodytemp'))"/>
								</profile>
								<tag>
									<code>
										<xsl:attribute name="value" namespace="" select="'8716-3'"/>
									</code>
								</tag>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'8310-5'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Body temperature'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var19_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var18_dat_ab" as="node()?" select="$var21_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var18_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var18_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var21_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var19_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$practitionerReference">
								<performer>
									<reference>
										<xsl:attribute name="value" namespace="" select="."/>
									</reference>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var21_cur/ns2:teplota">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'C'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'Cel'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_sprij_h">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="hType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:for-each select="$hType/@vyska">
			<xsl:variable name="var3_guid_vyska" as="node()?" select="$hType/@guid_vyska"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var3_guid_vyska">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var3_guid_vyska">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_vyska">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-height-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8302-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Body height'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var2_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var1_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var1_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var1_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var2_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
						<xsl:for-each select="$hType/ns2:pozn">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@hmotnost">
			<xsl:variable name="var6_guid_hmotnost" as="node()?" select="$hType/@guid_hmotnost"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var6_guid_hmotnost">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var6_guid_hmotnost">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_hmotnost">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-weight-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'29463-7'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Body weight'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var5_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var4_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var4_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var4_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var5_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:decimal(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'kg'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'kg'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@bmi">
			<xsl:variable name="var9_guid_bmi" as="node()?" select="$hType/@guid_bmi"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var9_guid_bmi">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var9_guid_bmi">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_bmi">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-BMI-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'39156-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Body mass index (BMI) [Ratio]'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var8_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var7_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var7_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var7_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var8_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:decimal(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'kg/m2'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'kg/m2'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@o_hlava">
			<xsl:variable name="var12_guid_o_hlava" as="node()?" select="$hType/@guid_o_hlava"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var12_guid_o_hlava">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var12_guid_o_hlava">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_o_hlava">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-headCircumference-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8287-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Head Occipital-frontal circumference by Tape measure'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var11_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var10_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var10_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var10_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var11_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@o_hrudnik">
			<xsl:variable name="var15_guid_o_hrudnik" as="node()?" select="$hType/@guid_o_hrudnik"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var15_guid_o_hrudnik">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var15_guid_o_hrudnik">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_o_hrudnik">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-chestCircumference-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8280-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Waist Circumference at umbilicus by Tape measure'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var14_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var13_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var13_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var13_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var14_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@o_pas">
			<xsl:variable name="var18_guid_o_pas" as="node()?" select="$hType/@guid_o_pas"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var18_guid_o_pas">
					<fullUrl>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
					</fullUrl>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var18_guid_o_pas">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$hType/@vguid_o_pas">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-abdominalCircumference-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'56086-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Adult Waist Circumference Protocol'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var17_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var16_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var16_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var16_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var17_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<performer>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_sprXX_-_vys_fs_form">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="vys_fs_form" select="()"/>
		<xsl:for-each select="$vys_fs_form/ns2:vys_fo_text">
			<xsl:variable name="var1_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$vys_fs_form/ns2:vys_fo_popis">
			<xsl:variable name="var2_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var2_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$vys_fs_form/ns2:vys_fo_form">
			<xsl:variable name="var3_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var3_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Encounter">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('Encounter/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:vys_v_snomed">
		<xsl:param name="vys_v_snomed" select="()"/>
		<xsl:variable name="var13_vysl_pracovnik" as="node()*" select="$vys_v_snomed/ns2:vysl_pracovnik"/>
		<xsl:variable name="var14_guid" as="node()?" select="$vys_v_snomed/@guid"/>
		<xsl:variable name="var15_vysl_typ" as="node()*" select="$vys_v_snomed/ns2:vysl_typ"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var14_guid">
				<fullUrl>
					<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:concat('Observation/', fn:string(.))))"/>
				</fullUrl>
			</xsl:for-each>
			<resource>
				<Observation>
					<id>
						<xsl:for-each select="$var14_guid">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</id>
					<xsl:for-each select="$vys_v_snomed/@vguid">
						<meta>
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</tag>
						</meta>
					</xsl:for-each>
					<status>
						<xsl:for-each select="$vys_v_snomed/ns2:stav">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</status>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
							</system>
							<code>
								<xsl:for-each select="$vys_v_snomed/ns2:kod">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
						</coding>
					</code>
					<effectiveDateTime>
						<xsl:for-each select="$vys_v_snomed/ns2:dat_vysetreni">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</effectiveDateTime>
					<xsl:for-each select="$vys_v_snomed/ns2:dat_vydani">
						<issued>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(.)))"/>
						</issued>
					</xsl:for-each>
					<xsl:for-each select="$var13_vysl_pracovnik">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="ns2:prijmeni">
							<performer>
								<reference>
									<xsl:for-each select="$var2_cur/@guid">
										<xsl:variable name="var1_cur" as="node()" select="."/>
										<xsl:for-each select="$var2_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('PractitionerRole/', fn:string($var1_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</performer>
						</xsl:for-each>
					</xsl:for-each>
					<xsl:variable name="var4_resultof_filter" as="node()*">
						<xsl:for-each select="$var15_vysl_typ">
							<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:boolean">
								<xsl:call-template name="vmf:vmf24_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:if test="$var3_resultof_vmf___inputtoresult">
								<xsl:sequence select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:variable>
					<xsl:for-each select="($var4_resultof_filter)[fn:exists($vys_v_snomed/ns2:vysl_hodnota)]">
						<valueQuantity>
							<xsl:variable name="var5_cur_of_vysl_hodnota" as="xs:string*">
								<xsl:for-each select="$vys_v_snomed/ns2:vysl_hodnota">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:variable>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(fn:string-join(for $x in $var5_cur_of_vysl_hodnota return xs:string($x), ' '))"/>
							</value>
							<xsl:for-each select="$vys_v_snomed/ns2:vysl_jednotka">
								<unit>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</unit>
							</xsl:for-each>
						</valueQuantity>
					</xsl:for-each>
					<xsl:variable name="var7_resultof_filter" as="node()*">
						<xsl:for-each select="$var15_vysl_typ">
							<xsl:variable name="var6_resultof_vmf___inputtoresult" as="xs:boolean">
								<xsl:call-template name="vmf:vmf25_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:if test="$var6_resultof_vmf___inputtoresult">
								<xsl:sequence select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:variable>
					<xsl:for-each select="($var7_resultof_filter)[fn:exists($vys_v_snomed/ns2:vysl_hodnota)]">
						<xsl:variable name="var8_cur_of_vysl_hodnota" as="xs:string*">
							<xsl:for-each select="$vys_v_snomed/ns2:vysl_hodnota">
								<xsl:sequence select="fn:string(.)"/>
							</xsl:for-each>
						</xsl:variable>
						<valueCodeableConcept>
							<coding>
								<code>
									<xsl:attribute name="value" namespace="" select="xs:string(fn:string-join(for $x in $var8_cur_of_vysl_hodnota return xs:string($x), ' '))"/>
								</code>
							</coding>
						</valueCodeableConcept>
					</xsl:for-each>
					<xsl:variable name="var10_resultof_filter" as="node()*">
						<xsl:for-each select="$var15_vysl_typ">
							<xsl:variable name="var9_resultof_vmf___inputtoresult" as="xs:boolean">
								<xsl:call-template name="vmf:vmf26_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:if test="$var9_resultof_vmf___inputtoresult">
								<xsl:sequence select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:variable>
					<xsl:for-each select="($var10_resultof_filter)[fn:exists($vys_v_snomed/ns2:vysl_hodnota)]">
						<xsl:variable name="var11_cur_of_vysl_hodnota" as="xs:string*">
							<xsl:for-each select="$vys_v_snomed/ns2:vysl_hodnota">
								<xsl:sequence select="fn:string(.)"/>
							</xsl:for-each>
						</xsl:variable>
						<valueString>
							<xsl:attribute name="value" namespace="" select="xs:string(fn:string-join(for $x in $var11_cur_of_vysl_hodnota return xs:string($x), ' '))"/>
						</valueString>
					</xsl:for-each>
					<xsl:for-each select="$vys_v_snomed/ns2:vysl_pozn">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
					<xsl:for-each select="$vys_v_snomed/ns2:vysl_interpret">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
					<xsl:for-each select="$vys_v_snomed/ns2:vysl_rm_d">
						<referenceRange>
							<low>
								<value>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</value>
							</low>
							<xsl:for-each select="$vys_v_snomed/ns2:vysl_rm_h">
								<high>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</high>
							</xsl:for-each>
						</referenceRange>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
		<xsl:variable name="var12_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$var13_vysl_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()*">
					<xsl:for-each select="$vys_v_snomed/ns2:vysl_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var12_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_sprij">
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_sprijType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var26_guid" as="node()?" select="$ku_z_propz_sprijType/@guid"/>
		<xsl:variable name="var27_prij_pracovnik" as="node()*" select="$ku_z_propz_sprijType/ns2:prij_pracovnik"/>
		<xsl:variable name="var25_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var24_create_dat_prov_of_dat_prov" as="node()*">
			<xsl:for-each select="$dat_prov">
				<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</dat_prov>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var26_guid">
				<xsl:for-each select="$var26_guid">
					<xsl:variable name="var1_resultof_FullURL_Encounter" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Encounter">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Encounter">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Encounter>
					<meta>
						<xsl:for-each select="$ku_z_propz_sprijType/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'67852-4'"/>
							</code>
						</tag>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'in-progress'"/>
					</status>
					<class>
						<system>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-ActCode'))"/>
						</system>
						<code>
							<xsl:attribute name="value" namespace="" select="'IMP'"/>
						</code>
						<display>
							<xsl:attribute name="value" namespace="" select="'inpatient encounter'"/>
						</display>
					</class>
					<subject>
						<xsl:sequence select="$var25_let"/>
					</subject>
					<participant>
						<individual>
							<reference>
								<xsl:for-each select="$var27_prij_pracovnik">
									<xsl:variable name="var5_cur" as="node()" select="."/>
									<xsl:for-each select="@guid">
										<xsl:variable name="var4_cur" as="node()" select="."/>
										<xsl:variable name="var3_vguid" as="node()?" select="$var5_cur/@vguid"/>
										<xsl:for-each select="$var3_vguid">
											<xsl:for-each select="$var3_vguid">
												<xsl:variable name="var2_resultof_Reference_Practitioner" as="xs:string?">
													<xsl:call-template name="provisio:Reference_Practitioner">
														<xsl:with-param name="GUID" select="fn:string($var4_cur)" as="xs:string"/>
														<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:for-each select="$var2_resultof_Reference_Practitioner">
													<xsl:attribute name="value" namespace="" select="."/>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</reference>
							<display>
								<xsl:for-each select="$var27_prij_pracovnik">
									<xsl:variable name="var9_cur" as="node()" select="."/>
									<xsl:for-each select="ns2:titul_pred">
										<xsl:variable name="var8_cur" as="node()" select="."/>
										<xsl:for-each select="$var9_cur/ns2:jmeno">
											<xsl:variable name="var7_cur" as="node()" select="."/>
											<xsl:for-each select="$var9_cur/ns2:prijmeni">
												<xsl:variable name="var6_cur" as="node()" select="."/>
												<xsl:for-each select="$var9_cur/ns2:titul_za">
													<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat(fn:concat(fn:concat(fn:concat(fn:string($var8_cur), ' '), fn:string($var7_cur)), ' '), fn:string($var6_cur)), ' '), fn:string(.))"/>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</display>
						</individual>
					</participant>
					<period>
						<start>
							<xsl:for-each select="$ku_z_propz_sprijType/ns2:dat_vys_prij">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</start>
					</period>
				</Encounter>
			</resource>
		</entry>
		<xsl:variable name="var10_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$var27_prij_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var10_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_a_text">
			<xsl:variable name="var11_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'8716-3'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var11_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:h">
			<xsl:variable name="var12_resultof_ku_z_propz_sprij_h" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_sprij_h">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="hType" as="node()">
						<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</hType>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" select="$var24_create_dat_prov_of_dat_prov" as="node()*"/>
					<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
					<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var12_resultof_ku_z_propz_sprij_h">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_a_param/ns2:vys_v_snomed">
			<xsl:variable name="var13_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var13_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var14_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_a_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var14_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_f_text">
			<xsl:variable name="var15_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'8716-3'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var15_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var16_resultof_ku_z_propz_sprij_fyznal" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_sprij_fyznal">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var25_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="fyznalType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:fyznal">
						<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</fyznalType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var24_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var16_resultof_ku_z_propz_sprij_fyznal">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_f_param/ns2:vys_v_snomed">
			<xsl:variable name="var17_resultof_vys_v_snomed" as="node()*">
				<xsl:call-template name="provisio:vys_v_snomed">
					<xsl:with-param name="vys_v_snomed" as="node()">
						<vys_v_snomed xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_v_snomed>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var17_resultof_vys_v_snomed">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var18_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_f_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var18_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_s_text">
			<xsl:variable name="var19_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'55286-9'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var19_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var20_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_s_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var20_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_fs_text">
			<xsl:variable name="var21_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'47420-5'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var21_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var22_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_fs_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var22_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$ku_z_propz_sprijType/ns2:vys_fs_form">
			<xsl:variable name="var23_resultof_ku_z_propz_sprXX___vys_fs_form" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_sprXX_-_vys_fs_form">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var25_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="vys_fs_form" as="node()">
						<vys_fs_form xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</vys_fs_form>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var23_resultof_ku_z_propz_sprXX___vys_fs_form">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Flag">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('Flag/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_urg_v">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_urg_vType" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:for-each select="$ku_z_propz_urg_vType">
			<xsl:variable name="var4_cur" as="node()" select="."/>
			<xsl:variable name="var2_guid" as="node()?" select="@guid"/>
			<xsl:variable name="var3_var_stav" as="node()*" select="ns2:var_stav"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var2_guid">
					<xsl:for-each select="$var2_guid">
						<xsl:variable name="var1_resultof_FullURL_Flag" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Flag">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Flag">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Flag>
						<xsl:for-each select="$var2_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-flag-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'75310-3'"/>
								</code>
							</tag>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'active'"/>
						</status>
						<code>
							<coding>
								<system>
									<xsl:for-each select="$var3_var_stav/ns2:kod_syst">
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
									</xsl:for-each>
								</system>
								<code>
									<xsl:for-each select="$var3_var_stav/ns2:kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="$var3_var_stav/ns2:kod_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
							<text>
								<xsl:for-each select="ns2:var_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:for-each select="ns2:var_dat_od">
							<period>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var4_cur/ns2:var_dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</period>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<author>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</author>
						</xsl:for-each>
					</Flag>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var5_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()*">
					<xsl:for-each select="$ku_z_propz_urg_vType/ns2:sp_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="()"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var5_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_AllergyIntolerance">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('AllergyIntolerance/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_urg_alerg_int">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="uaType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:for-each select="$uaType">
			<xsl:variable name="var13_cur" as="node()" select="."/>
			<xsl:variable name="var11_dat_ab" as="node()?" select="@dat_ab"/>
			<xsl:variable name="var12_uaf" as="node()*" select="ns2:uaf"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var12_uaf/@guid">
					<xsl:variable name="var1_resultof_FullURL_AllergyIntolerance" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_AllergyIntolerance">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_AllergyIntolerance">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<AllergyIntolerance>
						<xsl:for-each select="$var12_uaf/@guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var12_uaf/@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-allergyIntolerance-hdr'))"/>
							</profile>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="'48765-2'"/>
								</code>
							</tag>
						</meta>
						<clinicalStatus>
							<xsl:for-each select="ns2:stav">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical'))"/>
									</system>
									<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf27_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
								</coding>
							</xsl:for-each>
						</clinicalStatus>
						<verificationStatus>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/allergyintolerance-verification'))"/>
								</system>
								<code>
									<xsl:for-each select="@typ">
										<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf28_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</code>
							</coding>
						</verificationStatus>
						<xsl:for-each select="$var12_uaf/@typ_reakce">
							<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf29_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<type>
								<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</type>
						</xsl:for-each>
						<xsl:for-each select="$var12_uaf/@typ_agens">
							<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf30_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<category>
								<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</category>
						</xsl:for-each>
						<criticality>
							<xsl:for-each select="$var12_uaf/@szp_klic">
								<xsl:variable name="var6_resultof_vmf___inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf31_inputtoresult">
										<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var6_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</xsl:for-each>
						</criticality>
						<code>
							<xsl:for-each select="$var12_uaf">
								<xsl:variable name="var7_cur" as="node()" select="."/>
								<xsl:for-each select="ns2:alerg_lek_klic">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<xsl:for-each select="$var7_cur/ns2:alerg_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var12_uaf">
								<xsl:variable name="var8_cur" as="node()" select="."/>
								<xsl:for-each select="ns2:alerg_nelek_klic">
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<xsl:for-each select="$var8_cur/ns2:alerg_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="ns2:u_al">
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</xsl:for-each>
						</code>
						<xsl:for-each select="$patientReference">
							<patient>
								<xsl:sequence select="(./@node(), ./node())"/>
							</patient>
						</xsl:for-each>
						<xsl:for-each select="ns2:dat_du">
							<onsetPeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var13_cur/ns2:dat_up">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</onsetPeriod>
						</xsl:for-each>
						<xsl:variable name="var9_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($var11_dat_ab)">
									<xsl:sequence select="xs:string(xs:dateTime(fn:string($var11_dat_ab)))"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var9_test_resultof_exists">
							<recordedDate>
								<xsl:attribute name="value" namespace="" select="."/>
							</recordedDate>
						</xsl:for-each>
						<xsl:for-each select="$practitionerReference">
							<recorder>
								<reference>
									<xsl:attribute name="value" namespace="" select="."/>
								</reference>
							</recorder>
						</xsl:for-each>
						<xsl:for-each select="$var12_uaf">
							<xsl:variable name="var10_cur" as="node()" select="."/>
							<xsl:for-each select="@ar_klic">
								<reaction>
									<manifestation>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<display>
												<xsl:for-each select="$var10_cur/@ar_text">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</display>
										</coding>
									</manifestation>
								</reaction>
							</xsl:for-each>
						</xsl:for-each>
					</AllergyIntolerance>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_urg">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="ku_z_propz_urg" select="()"/>
		<xsl:variable name="var3_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var1_resultof_ku_z_propz_urg_alerg_int" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_urg_alerg_int">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var3_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="uaType" as="node()*">
					<xsl:for-each select="$ku_z_propz_urg/ns2:alerg_int">
						<uaType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</uaType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" as="node()*">
					<xsl:for-each select="$dat_prov">
						<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</dat_prov>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_ku_z_propz_urg_alerg_int">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var2_resultof_ku_z_propz_urg_v" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_urg_v">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var3_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="ku_z_propz_urg_vType" as="node()*">
					<xsl:for-each select="$ku_z_propz_urg/ns2:ku_z_propz_urg_v">
						<ku_z_propz_urg_vType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_urg_vType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var2_resultof_ku_z_propz_urg_v">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_DiagnosticReport">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('DiagnosticReport/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_DocumentReference">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('DocumentReference/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:text_autor_ptext_ktext_priloha">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="text" select="()"/>
		<xsl:param name="tag" select="()"/>
		<xsl:variable name="var14_guid" as="node()?" select="$text/@guid"/>
		<xsl:variable name="var15_priloha" as="node()*" select="$text/ns2:priloha"/>
		<xsl:variable name="var12_test_resultof_exists" as="node()?">
			<xsl:if test="fn:exists($tag)">
				<xsl:attribute name="value" select="$tag"/>
			</xsl:if>
		</xsl:variable>
		<xsl:variable name="var13_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var10_let" as="node()+">
			<system xmlns="http://hl7.org/fhir">
				<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
			</system>
			<code xmlns="http://hl7.org/fhir">
				<xsl:attribute name="value" namespace="" select="'11503-0'"/>
			</code>
			<display xmlns="http://hl7.org/fhir">
				<xsl:attribute name="value" namespace="" select="'Medical records'"/>
			</display>
		</xsl:variable>
		<xsl:variable name="var11_create_value_of_ptext" as="node()*">
			<xsl:for-each select="$text/ns2:ptext">
				<xsl:attribute name="value" select="fn:normalize-space(fn:string(.))"/>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var14_guid">
				<xsl:for-each select="$var14_guid">
					<xsl:variable name="var1_resultof_FullURL_DiagnosticReport" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_DiagnosticReport">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_DiagnosticReport">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<DiagnosticReport>
					<meta>
						<versionId>
							<xsl:for-each select="$text/@vguid">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</versionId>
						<tag>
							<code>
								<xsl:sequence select="$var12_test_resultof_exists"/>
							</code>
						</tag>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<code>
						<coding>
							<xsl:sequence select="$var10_let"/>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="$var13_let"/>
					</subject>
					<xsl:for-each select="$var15_priloha">
						<xsl:variable name="var6_cur" as="node()" select="."/>
						<xsl:variable name="var5_guid" as="node()?" select="@guid"/>
						<media>
							<link>
								<reference>
									<xsl:for-each select="$var5_guid">
										<xsl:variable name="var4_vguid" as="node()?" select="$var6_cur/@vguid"/>
										<xsl:for-each select="$var4_vguid">
											<xsl:for-each select="$var5_guid">
												<xsl:variable name="var3_cur" as="node()" select="."/>
												<xsl:for-each select="$var4_vguid">
													<xsl:variable name="var2_resultof_Reference_DocumentReference" as="xs:string?">
														<xsl:call-template name="provisio:Reference_DocumentReference">
															<xsl:with-param name="GUID" select="fn:string($var3_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var2_resultof_Reference_DocumentReference">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</link>
						</media>
					</xsl:for-each>
					<conclusion>
						<xsl:sequence select="$var11_create_value_of_ptext"/>
					</conclusion>
					<xsl:for-each select="$text/ns2:ktext">
						<presentedForm>
							<contentType>
								<xsl:for-each select="@typ">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</contentType>
							<data>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:base64Binary(fn:string(.)))"/>
							</data>
						</presentedForm>
					</xsl:for-each>
				</DiagnosticReport>
			</resource>
		</entry>
		<xsl:for-each select="$var15_priloha">
			<xsl:variable name="var9_guid" as="node()?" select="@guid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var9_guid">
					<xsl:for-each select="$var9_guid">
						<xsl:variable name="var7_resultof_FullURL_DocumentReference" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_DocumentReference">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var7_resultof_FullURL_DocumentReference">
							<fullUrl>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
							</fullUrl>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<xsl:variable name="var8_create_DocumentReference" as="node()">
					<DocumentReference>
						<xsl:for-each select="$var9_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<xsl:for-each select="@vguid">
							<meta>
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
								<tag>
									<code>
										<xsl:sequence select="$var12_test_resultof_exists"/>
									</code>
								</tag>
							</meta>
						</xsl:for-each>
						<status>
							<xsl:attribute name="value" namespace="" select="'current'"/>
						</status>
						<type>
							<coding>
								<xsl:sequence select="$var10_let"/>
							</coding>
						</type>
						<subject>
							<xsl:sequence select="$var13_let"/>
						</subject>
						<description>
							<xsl:sequence select="$var11_create_value_of_ptext"/>
						</description>
						<content>
							<attachment>
								<contentType>
									<xsl:for-each select="@typ">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</contentType>
							</attachment>
						</content>
					</DocumentReference>
				</xsl:variable>
				<resource>
					<DocumentReference>
						<xsl:sequence select="($var8_create_DocumentReference/@node(), $var8_create_DocumentReference/node())"/>
					</DocumentReference>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_DocumentReference">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('DocumentReference/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Consent">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('Consent/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_dvp">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_dvpType" select="()"/>
		<xsl:variable name="var8_dvp_dokum" as="node()*" select="$ku_z_propz_dvpType/ns2:dvp_dokum"/>
		<xsl:variable name="var9_guid" as="node()?" select="$ku_z_propz_dvpType/@guid"/>
		<xsl:variable name="var7_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var9_guid">
				<xsl:for-each select="$var9_guid">
					<xsl:variable name="var1_resultof_FullURL_Consent" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Consent">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Consent">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Consent>
					<xsl:for-each select="$var9_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$ku_z_propz_dvpType/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'42348-3'"/>
							</code>
						</tag>
					</meta>
					<xsl:for-each select="$ku_z_propz_dvpType/ns2:dvp_koment">
						<text>
							<status>
								<xsl:attribute name="value" namespace="" select="'generated'"/>
							</status>
							<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
								<xsl:sequence select="fn:string(.)"/>
							</xhtml:div>
						</text>
					</xsl:for-each>
					<status>
						<xsl:attribute name="value" namespace="" select="'active'"/>
					</status>
					<scope>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/consentscope'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'adr'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Advanced Care Directive'"/>
							</display>
						</coding>
					</scope>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/WWBVY.htm'))"/>
							</system>
							<code>
								<xsl:for-each select="$ku_z_propz_dvpType/ns2:dvp_typ">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
						</coding>
					</category>
					<patient>
						<xsl:sequence select="$var7_let"/>
					</patient>
					<dateTime>
						<xsl:for-each select="$ku_z_propz_dvpType/ns2:dat_dvp">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</dateTime>
					<sourceReference>
						<reference>
							<xsl:for-each select="$var8_dvp_dokum">
								<xsl:variable name="var5_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var4_cur" as="node()" select="."/>
									<xsl:variable name="var3_vguid" as="node()?" select="$var5_cur/@vguid"/>
									<xsl:for-each select="$var3_vguid">
										<xsl:for-each select="$var3_vguid">
											<xsl:variable name="var2_resultof_Reference_DocumentReference" as="xs:string?">
												<xsl:call-template name="provisio:Reference_DocumentReference">
													<xsl:with-param name="GUID" select="fn:string($var4_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var2_resultof_Reference_DocumentReference">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
					</sourceReference>
					<provision>
						<xsl:for-each select="$ku_z_propz_dvpType/ns2:dvp_dotstav">
							<provision>
								<code>
									<coding>
										<system>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
											</xsl:for-each>
										</system>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<xsl:for-each select="ns2:kod_text">
											<display>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</display>
										</xsl:for-each>
									</coding>
								</code>
							</provision>
						</xsl:for-each>
					</provision>
				</Consent>
			</resource>
		</entry>
		<xsl:for-each select="$var8_dvp_dokum">
			<xsl:variable name="var6_resultof_text_autor_ptext_ktext_priloha" as="node()*">
				<xsl:call-template name="provisio:text_autor_ptext_ktext_priloha">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var7_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="text" as="node()">
						<text xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:call-template name="tbf:tbf1_textType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</text>
					</xsl:with-param>
					<xsl:with-param name="tag" select="'42348-3'" as="xs:string"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var6_resultof_text_autor_ptext_ktext_priloha">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:admu_a_prac">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="a_pracovnik" select="()"/>
		<xsl:param name="a_pracoviste" select="()"/>
		<xsl:variable name="var1_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()">
					<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="($a_pracovnik/@node(), $a_pracovnik/node())"/>
					</pracovnikType>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()">
					<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="($a_pracoviste/@node(), $a_pracoviste/node())"/>
					</pracovisteType>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:admu_p_prac">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="p_pracovnik" select="()"/>
		<xsl:param name="p_pracoviste" select="()"/>
		<xsl:variable name="var1_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()?">
					<xsl:for-each select="$p_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()?">
					<xsl:for-each select="$p_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Composition">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('Composition/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:admu_z_prac">
		<xsl:param name="z_pracovnik" select="()"/>
		<xsl:param name="z_pracoviste" select="()"/>
		<xsl:variable name="var1_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()?">
					<xsl:for-each select="$z_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()?">
					<xsl:for-each select="$z_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:adresa_spojeni">
		<xsl:param name="as" select="()"/>
		<xsl:for-each select="$as">
			<xsl:variable name="var3_typ" as="node()?" select="@typ"/>
			<ContactPoint xmlns="http://hl7.org/fhir">
				<system>
					<xsl:for-each select="$var3_typ">
						<xsl:variable name="var1_resultof_vmf___inputtoresult" as="xs:string?">
							<xsl:call-template name="vmf:vmf32_inputtoresult">
								<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_vmf___inputtoresult">
							<xsl:attribute name="value" namespace="" select="."/>
						</xsl:for-each>
					</xsl:for-each>
				</system>
				<xsl:for-each select="ns1:obsah">
					<value>
						<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
					</value>
				</xsl:for-each>
				<xsl:for-each select="$var3_typ">
					<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
						<xsl:call-template name="vmf:vmf33_inputtoresult">
							<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
						<use>
							<xsl:attribute name="value" namespace="" select="."/>
						</use>
					</xsl:for-each>
				</xsl:for-each>
				<xsl:for-each select="@poradi">
					<rank>
						<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
					</rank>
				</xsl:for-each>
			</ContactPoint>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:adresa">
		<xsl:param name="a" select="()"/>
		<xsl:variable name="var13_typ" as="node()?" select="$a/@typ"/>
		<Address xmlns="http://hl7.org/fhir">
			<use>
				<xsl:for-each select="$var13_typ">
					<xsl:variable name="var1_resultof_vmf___inputtoresult" as="xs:string?">
						<xsl:call-template name="vmf:vmf34_inputtoresult">
							<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_vmf___inputtoresult">
						<xsl:attribute name="value" namespace="" select="."/>
					</xsl:for-each>
				</xsl:for-each>
			</use>
			<xsl:for-each select="$a/@ind_kont">
				<xsl:variable name="var4_cur" as="node()" select="."/>
				<type>
					<xsl:for-each select="$var13_typ">
						<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:boolean">
							<xsl:call-template name="vmf:vmf35_inputtoresult">
								<xsl:with-param name="input" select="fn:string($var4_cur)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:boolean">
							<xsl:call-template name="vmf:vmf36_inputtoresult">
								<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:attribute name="value" namespace="">
							<xsl:choose>
								<xsl:when test="($var2_resultof_vmf___inputtoresult and $var3_resultof_vmf___inputtoresult)">
									<xsl:sequence select="'postal'"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:sequence select="'physical'"/>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:attribute>
					</xsl:for-each>
				</type>
			</xsl:for-each>
			<line>
				<xsl:for-each select="$a/ns1:jmeno">
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</xsl:for-each>
			</line>
			<xsl:for-each select="$a/ns1:adr">
				<line>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</line>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:dop1">
				<line>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</line>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:dop2">
				<line>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</line>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:mesto">
				<city>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</city>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:psc">
				<postalCode>
					<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
				</postalCode>
			</xsl:for-each>
			<xsl:for-each select="$a/ns1:stat">
				<country>
					<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
				</country>
			</xsl:for-each>
			<period>
				<xsl:variable name="var7_resultof_filter" as="node()*">
					<xsl:for-each select="$a/ns1:dat_od">
						<xsl:variable name="var6_cur_as_string" as="xs:string" select="fn:string(.)"/>
						<xsl:variable name="var5_test_resultof_equal" as="xs:string">
							<xsl:choose>
								<xsl:when test="(fn:string-length($var6_cur_as_string) = xs:decimal('16'))">
									<xsl:sequence select="fn:concat($var6_cur_as_string, ':00')"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:sequence select="$var6_cur_as_string"/>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:if test="(($var5_test_resultof_equal != '') and ($var5_test_resultof_equal != '    -  -  '))">
							<xsl:sequence select="."/>
						</xsl:if>
					</xsl:for-each>
				</xsl:variable>
				<xsl:for-each select="$var7_resultof_filter">
					<xsl:variable name="var8_cur_as_string" as="xs:string" select="fn:string(.)"/>
					<start>
						<xsl:attribute name="value" namespace="">
							<xsl:choose>
								<xsl:when test="(fn:string-length($var8_cur_as_string) = xs:decimal('16'))">
									<xsl:sequence select="fn:concat($var8_cur_as_string, ':00')"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:sequence select="$var8_cur_as_string"/>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:attribute>
					</start>
				</xsl:for-each>
				<xsl:variable name="var11_resultof_filter" as="node()*">
					<xsl:for-each select="$a/ns1:dat_do">
						<xsl:variable name="var10_cur_as_string" as="xs:string" select="fn:string(.)"/>
						<xsl:variable name="var9_test_resultof_equal" as="xs:string">
							<xsl:choose>
								<xsl:when test="(fn:string-length($var10_cur_as_string) = xs:decimal('16'))">
									<xsl:sequence select="fn:concat($var10_cur_as_string, ':00')"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:sequence select="$var10_cur_as_string"/>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:if test="(($var9_test_resultof_equal != '') and ($var9_test_resultof_equal != '    -  -  '))">
							<xsl:sequence select="."/>
						</xsl:if>
					</xsl:for-each>
				</xsl:variable>
				<xsl:for-each select="$var11_resultof_filter">
					<xsl:variable name="var12_cur_as_string" as="xs:string" select="fn:string(.)"/>
					<end>
						<xsl:attribute name="value" namespace="">
							<xsl:choose>
								<xsl:when test="(fn:string-length($var12_cur_as_string) = xs:decimal('16'))">
									<xsl:sequence select="fn:concat($var12_cur_as_string, ':00')"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:sequence select="$var12_cur_as_string"/>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:attribute>
					</end>
				</xsl:for-each>
			</period>
		</Address>
	</xsl:template>
	<xsl:template name="provisio:pracovnik_a_pracovi_t_">
		<xsl:param name="pracovnikType" select="()"/>
		<xsl:param name="pracovisteType" select="()"/>
		<xsl:for-each select="$pracovnikType">
			<xsl:variable name="var7_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:prijmeni">
				<xsl:variable name="var5_a" as="node()*" select="$var7_cur/ns1:a"/>
				<xsl:variable name="var6_guid" as="node()?" select="$var7_cur/@guid"/>
				<entry xmlns="http://hl7.org/fhir">
					<fullUrl>
						<xsl:for-each select="$var6_guid">
							<xsl:for-each select="$var6_guid">
								<xsl:variable name="var1_resultof_FullURL_Practitioner" as="xs:string?">
									<xsl:call-template name="provisio:FullURL_Practitioner">
										<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1_resultof_FullURL_Practitioner">
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</fullUrl>
					<resource>
						<Practitioner>
							<xsl:for-each select="$var6_guid">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var7_cur/@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
							</meta>
							<xsl:for-each select="$var7_cur/@id_zp">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var7_cur/@icl">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var7_cur/@id_pracovnik">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var7_cur/@id_clk">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<name>
								<family>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</family>
								<xsl:for-each select="$var7_cur/ns2:jmeno">
									<given>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</given>
								</xsl:for-each>
								<xsl:for-each select="$var7_cur/ns2:titul_pred">
									<prefix>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</prefix>
								</xsl:for-each>
								<xsl:for-each select="$var7_cur/ns2:titul_za">
									<suffix>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</suffix>
								</xsl:for-each>
							</name>
							<xsl:variable name="var2_map_of_a" as="node()*">
								<xsl:for-each select="$var5_a/ns1:as">
									<as xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
										<xsl:sequence select="(./@node(), ./node())"/>
									</as>
								</xsl:for-each>
							</xsl:variable>
							<xsl:variable name="var3_resultof_adresa_spojeni" as="node()?">
								<xsl:call-template name="provisio:adresa_spojeni">
									<xsl:with-param name="as" select="($var2_map_of_a)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var3_resultof_adresa_spojeni">
								<telecom>
									<xsl:sequence select="(./@node(), ./node())"/>
								</telecom>
							</xsl:for-each>
							<xsl:for-each select="$var5_a">
								<xsl:variable name="var4_resultof_adresa" as="node()?">
									<xsl:call-template name="provisio:adresa">
										<xsl:with-param name="a" as="node()">
											<a xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
												<xsl:sequence select="(./@node(), ./node())"/>
											</a>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var4_resultof_adresa">
									<address>
										<xsl:sequence select="(./@node(), ./node())"/>
									</address>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var7_cur/@odbornost">
								<qualification>
									<code>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/UZABB.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
										</coding>
									</code>
								</qualification>
							</xsl:for-each>
						</Practitioner>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$pracovnikType">
			<xsl:variable name="var17_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:prijmeni">
				<xsl:variable name="var15_vguid" as="node()?" select="$var17_cur/@vguid"/>
				<xsl:variable name="var16_guid" as="node()?" select="$var17_cur/@guid"/>
				<entry xmlns="http://hl7.org/fhir">
					<fullUrl>
						<xsl:for-each select="$var16_guid">
							<xsl:for-each select="$var16_guid">
								<xsl:variable name="var8_resultof_FullURL_PractitionerRole" as="xs:string?">
									<xsl:call-template name="provisio:FullURL_PractitionerRole">
										<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var8_resultof_FullURL_PractitionerRole">
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</fullUrl>
					<resource>
						<PractitionerRole>
							<xsl:for-each select="$var15_vguid">
								<meta>
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</meta>
							</xsl:for-each>
							<practitioner>
								<reference>
									<xsl:for-each select="$var16_guid">
										<xsl:for-each select="$var15_vguid">
											<xsl:for-each select="$var16_guid">
												<xsl:variable name="var10_cur" as="node()" select="."/>
												<xsl:for-each select="$var15_vguid">
													<xsl:variable name="var9_resultof_Reference_Practitioner" as="xs:string?">
														<xsl:call-template name="provisio:Reference_Practitioner">
															<xsl:with-param name="GUID" select="fn:string($var10_cur)" as="xs:string"/>
															<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:for-each select="$var9_resultof_Reference_Practitioner">
														<xsl:attribute name="value" namespace="" select="."/>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
							</practitioner>
							<xsl:for-each select="$pracovisteType">
								<xsl:variable name="var14_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var13_cur" as="node()" select="."/>
									<xsl:variable name="var12_vguid" as="node()?" select="$var14_cur/@vguid"/>
									<xsl:for-each select="$var12_vguid">
										<xsl:for-each select="$var12_vguid">
											<xsl:variable name="var11_resultof_Reference_Organization" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Organization">
													<xsl:with-param name="GUID" select="fn:string($var13_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var11_resultof_Reference_Organization">
												<organization>
													<reference>
														<xsl:attribute name="value" namespace="" select="."/>
													</reference>
												</organization>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var17_cur/@role_klic">
								<code>
									<coding>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<display>
											<xsl:for-each select="$var17_cur/@role_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</code>
							</xsl:for-each>
						</PractitionerRole>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$pracovisteType">
			<xsl:variable name="var22_cur" as="node()" select="."/>
			<xsl:for-each select="ns2:nazev">
				<xsl:variable name="var21_a" as="node()*" select="$var22_cur/ns1:a"/>
				<entry xmlns="http://hl7.org/fhir">
					<resource>
						<Organization>
							<id>
								<xsl:for-each select="$var22_cur/@guid">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</id>
							<meta>
								<xsl:for-each select="$var22_cur/@vguid">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
							</meta>
							<text>
								<status>
									<xsl:attribute name="value" namespace="" select="'generated'"/>
								</status>
								<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
									<xsl:for-each select="$var22_cur/ns2:pozn">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xhtml:div>
							</text>
							<xsl:for-each select="$var22_cur/@kod_lok">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var22_cur/@ico">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var22_cur/@icz">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var22_cur/@icp">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var22_cur/@ns">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var22_cur/@oddel">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<xsl:for-each select="$var22_cur/@pcz">
								<identifier>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</identifier>
							</xsl:for-each>
							<type>
								<coding>
									<display>
										<xsl:for-each select="$var22_cur/@odb">
											<xsl:attribute name="value" namespace="" select="fn:concat('Odbornost: ', fn:string(.))"/>
										</xsl:for-each>
									</display>
								</coding>
							</type>
							<name>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</name>
							<xsl:variable name="var18_map_of_a" as="node()*">
								<xsl:for-each select="$var21_a/ns1:as">
									<as xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
										<xsl:sequence select="(./@node(), ./node())"/>
									</as>
								</xsl:for-each>
							</xsl:variable>
							<xsl:variable name="var19_resultof_adresa_spojeni" as="node()?">
								<xsl:call-template name="provisio:adresa_spojeni">
									<xsl:with-param name="as" select="($var18_map_of_a)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var19_resultof_adresa_spojeni">
								<telecom>
									<xsl:sequence select="(./@node(), ./node())"/>
								</telecom>
							</xsl:for-each>
							<xsl:for-each select="$var21_a">
								<xsl:variable name="var20_resultof_adresa" as="node()?">
									<xsl:call-template name="provisio:adresa">
										<xsl:with-param name="a" as="node()">
											<a xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
												<xsl:sequence select="(./@node(), ./node())"/>
											</a>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var20_resultof_adresa">
									<address>
										<xsl:sequence select="(./@node(), ./node())"/>
									</address>
								</xsl:for-each>
							</xsl:for-each>
						</Organization>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:admu_o_prac">
		<xsl:param name="o_pracovnik" select="()"/>
		<xsl:param name="o_pracoviste" select="()"/>
		<xsl:variable name="var1_resultof_pracovnik_a_pracovi_t_" as="node()*">
			<xsl:call-template name="provisio:pracovnik_a_pracovi_t_">
				<xsl:with-param name="pracovnikType" as="node()?">
					<xsl:for-each select="$o_pracovnik">
						<pracovnikType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovnikType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="pracovisteType" as="node()?">
					<xsl:for-each select="$o_pracoviste">
						<pracovisteType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</pracovisteType>
					</xsl:for-each>
				</xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_pracovnik_a_pracovi_t_">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz_admu">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propz_admuType" select="()"/>
		<xsl:variable name="var27_a_pracoviste" as="node()*" select="$ku_z_propz_admuType/ns2:a_pracoviste"/>
		<xsl:variable name="var28_a_pracovnik" as="node()*" select="$ku_z_propz_admuType/ns2:a_pracovnik"/>
		<xsl:variable name="var29_z_pracovnik" as="node()*" select="$ku_z_propz_admuType/ns2:z_pracovnik"/>
		<xsl:variable name="var30_guid" as="node()?" select="$ku_z_propz_admuType/@guid"/>
		<xsl:variable name="var31_o_pracovnik" as="node()*" select="$ku_z_propz_admuType/ns2:o_pracovnik"/>
		<xsl:variable name="var32_http___loinc_org_as_string" as="xs:string" select="xs:string(xs:anyURI('http://loinc.org'))"/>
		<xsl:variable name="var26_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var30_guid">
				<xsl:for-each select="$var30_guid">
					<xsl:variable name="var1_resultof_FullURL_Composition" as="xs:string?">
						<xsl:call-template name="provisio:FullURL_Composition">
							<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var1_resultof_FullURL_Composition">
						<fullUrl>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</fullUrl>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Composition>
					<xsl:for-each select="$var30_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$ku_z_propz_admuType/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<tag>
							<code>
								<xsl:attribute name="value" namespace="" select="'8650-4'"/>
							</code>
						</tag>
					</meta>
					<text>
						<status>
							<xsl:attribute name="value" namespace="" select="'generated'"/>
						</status>
						<xhtml:div xmlns:xhtml="http://www.w3.org/1999/xhtml">
							<xsl:for-each select="$ku_z_propz_admuType/ns2:spr_dokum">
								<xsl:sequence select="fn:string(.)"/>
							</xsl:for-each>
						</xhtml:div>
					</text>
					<status>
						<xsl:for-each select="$ku_z_propz_admuType/ns2:stav_dokum">
							<xsl:variable name="var2_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf37_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var2_resultof_vmf___inputtoresult">
								<xsl:attribute name="value" namespace="" select="."/>
							</xsl:for-each>
						</xsl:for-each>
					</status>
					<type>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="$var32_http___loinc_org_as_string"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'18842-5'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Hospital discharge summary'"/>
							</display>
						</coding>
					</type>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="$var32_http___loinc_org_as_string"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'34105-7'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Summary of episode note'"/>
							</display>
						</coding>
					</category>
					<date>
						<xsl:for-each select="$ku_z_propz_admuType/ns2:dat_a_mod">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</date>
					<author>
						<reference>
							<xsl:for-each select="$var28_a_pracovnik">
								<xsl:variable name="var6_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var5_cur" as="node()" select="."/>
									<xsl:variable name="var4_vguid" as="node()?" select="$var6_cur/@vguid"/>
									<xsl:for-each select="$var4_vguid">
										<xsl:for-each select="$var4_vguid">
											<xsl:variable name="var3_resultof_Reference_Practitioner" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Practitioner">
													<xsl:with-param name="GUID" select="fn:string($var5_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var3_resultof_Reference_Practitioner">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
						<display>
							<xsl:for-each select="$var28_a_pracovnik/ns2:prijmeni">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</display>
					</author>
					<title>
						<xsl:attribute name="value" namespace="" select="'Hospital discharge summary'"/>
					</title>
					<xsl:for-each select="$var31_o_pracovnik">
						<xsl:variable name="var8_cur" as="node()" select="."/>
						<attester>
							<mode>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</mode>
							<time>
								<xsl:for-each select="$ku_z_propz_admuType/ns2:dat_overeni">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</time>
							<party>
								<reference>
									<xsl:for-each select="@guid">
										<xsl:variable name="var7_cur" as="node()" select="."/>
										<xsl:for-each select="$var8_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('PractitionerRole/', fn:string($var7_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:for-each select="ns2:prijmeni">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</party>
						</attester>
					</xsl:for-each>
					<xsl:for-each select="$var29_z_pracovnik">
						<xsl:variable name="var10_cur" as="node()" select="."/>
						<attester>
							<mode>
								<xsl:attribute name="value" namespace="" select="'legal'"/>
							</mode>
							<time>
								<xsl:for-each select="$ku_z_propz_admuType/ns2:dat_autorizace">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</time>
							<party>
								<reference>
									<xsl:for-each select="@guid">
										<xsl:variable name="var9_cur" as="node()" select="."/>
										<xsl:for-each select="$var10_cur/@vguid">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:concat('PractitionerRole/', fn:string($var9_cur)), '/_history/'), fn:string(.))"/>
										</xsl:for-each>
									</xsl:for-each>
								</reference>
								<display>
									<xsl:for-each select="ns2:prijmeni">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</party>
						</attester>
					</xsl:for-each>
					<custodian>
						<reference>
							<xsl:for-each select="$var27_a_pracoviste">
								<xsl:variable name="var14_cur" as="node()" select="."/>
								<xsl:for-each select="@guid">
									<xsl:variable name="var13_cur" as="node()" select="."/>
									<xsl:variable name="var12_vguid" as="node()?" select="$var14_cur/@vguid"/>
									<xsl:for-each select="$var12_vguid">
										<xsl:for-each select="$var12_vguid">
											<xsl:variable name="var11_resultof_Reference_Organization" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Organization">
													<xsl:with-param name="GUID" select="fn:string($var13_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var11_resultof_Reference_Organization">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
						<display>
							<xsl:for-each select="$var27_a_pracoviste/ns2:nazev">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</display>
					</custodian>
				</Composition>
			</resource>
		</entry>
		<xsl:variable name="var15_create_p_pracovnik_of_p_pracovnik" as="node()*">
			<xsl:for-each select="$ku_z_propz_admuType/ns2:p_pracovnik">
				<p_pracovnik xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</p_pracovnik>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var16_create_p_pracoviste_of_p_pracoviste" as="node()*">
			<xsl:for-each select="$ku_z_propz_admuType/ns2:p_pracoviste">
				<p_pracoviste xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</p_pracoviste>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var17_resultof_admu_p_prac" as="node()*">
			<xsl:call-template name="provisio:admu_p_prac">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var26_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="p_pracovnik" select="($var15_create_p_pracovnik_of_p_pracovnik)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				<xsl:with-param name="p_pracoviste" select="($var16_create_p_pracoviste_of_p_pracoviste)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var17_resultof_admu_p_prac">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$var28_a_pracovnik">
			<xsl:variable name="var19_cur" as="node()" select="."/>
			<xsl:for-each select="$var27_a_pracoviste">
				<xsl:variable name="var18_resultof_admu_a_prac" as="node()*">
					<xsl:call-template name="provisio:admu_a_prac">
						<xsl:with-param name="patientReference" as="node()">
							<Reference xmlns="http://hl7.org/fhir">
								<xsl:sequence select="$var26_let"/>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="a_pracovnik" as="node()">
							<a_pracovnik xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="($var19_cur/@node(), $var19_cur/node())"/>
							</a_pracovnik>
						</xsl:with-param>
						<xsl:with-param name="a_pracoviste" as="node()">
							<a_pracoviste xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</a_pracoviste>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var18_resultof_admu_a_prac">
					<entry xmlns="http://hl7.org/fhir">
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var20_create_o_pracovnik_of_o_pracovnik" as="node()*">
			<xsl:for-each select="$var31_o_pracovnik">
				<o_pracovnik xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</o_pracovnik>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var21_create_o_pracoviste_of_o_pracoviste" as="node()*">
			<xsl:for-each select="$ku_z_propz_admuType/ns2:o_pracoviste">
				<o_pracoviste xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</o_pracoviste>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var22_resultof_admu_o_prac" as="node()*">
			<xsl:call-template name="provisio:admu_o_prac">
				<xsl:with-param name="o_pracovnik" select="($var20_create_o_pracovnik_of_o_pracovnik)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				<xsl:with-param name="o_pracoviste" select="($var21_create_o_pracoviste_of_o_pracoviste)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var22_resultof_admu_o_prac">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var23_create_z_pracovnik_of_z_pracovnik" as="node()*">
			<xsl:for-each select="$var29_z_pracovnik">
				<z_pracovnik xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</z_pracovnik>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var24_create_z_pracoviste_of_z_pracoviste" as="node()*">
			<xsl:for-each select="$ku_z_propz_admuType/ns2:z_pracoviste">
				<z_pracoviste xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</z_pracoviste>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var25_resultof_admu_z_prac" as="node()*">
			<xsl:call-template name="provisio:admu_z_prac">
				<xsl:with-param name="z_pracovnik" select="($var23_create_z_pracovnik_of_z_pracovnik)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				<xsl:with-param name="z_pracoviste" select="($var24_create_z_pracoviste_of_z_pracoviste)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var25_resultof_admu_z_prac">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z_propz">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ku_z_propzType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:variable name="var2001_ku_z_propz_dvp" as="node()*" select="$ku_z_propzType/ns2:ku_z_propz_dvp"/>
		<xsl:variable name="var2002_ku_z_propz_hosp" as="node()*" select="$ku_z_propzType/ns2:ku_z_propz_hosp"/>
		<xsl:variable name="var2003_ku_z_propz_admu" as="node()*" select="$ku_z_propzType/ns2:ku_z_propz_admu"/>
		<xsl:variable name="var2004_http___loinc_org_as_string" as="xs:string" select="xs:string(xs:anyURI('http://loinc.org'))"/>
		<xsl:variable name="var2005_ku_z_propz_sprij" as="node()*" select="$ku_z_propzType/ns2:ku_z_propz_sprij"/>
		<xsl:variable name="var2000_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_urg">
				<ku_z_propz_urgType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_urgType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_sprop">
				<ku_z_propz_spropType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_spropType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_prubh">
				<ku_z_propz_prubhType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_prubhType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_dopor">
				<ku_z_propz_doporType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_doporType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*">
			<xsl:for-each select="$ku_z_propzType/ns2:ku_z_propz_anam">
				<ku_z_propz_anamType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</ku_z_propz_anamType>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1994_create_dat_prov_of_dat_prov" as="node()*">
			<xsl:for-each select="$dat_prov">
				<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</dat_prov>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<resource>
				<Composition>
					<meta>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-composition-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<type>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'34105-7'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Hospital Discharge summary'"/>
							</display>
						</coding>
					</type>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/ValueSet/document-classcodes'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'18842-5'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Discharge summary'"/>
							</display>
						</coding>
					</category>
					<date>
						<xsl:for-each select="$dat_prov">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</date>
					<author>
						<reference>
							<xsl:for-each select="$practitionerReference">
								<xsl:attribute name="value" namespace="" select="."/>
							</xsl:for-each>
						</reference>
					</author>
					<title>
						<xsl:attribute name="value" namespace="" select="'Propoutc zprva'"/>
					</title>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAdmissionEvaluation'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'67852-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital Admission evaluation note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital Admission evaluation note'"/>
							</text>
						</code>
						<xsl:variable name="var64_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var55_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var55_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var56_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var56_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var57_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var57_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var58_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var58_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var59_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var59_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var60_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var60_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var61_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var61_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var62_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var62_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var63_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var63_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var64_let">
							<xsl:variable name="var54_current" as="node()" select="."/>
							<xsl:variable name="var50_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var49_resource" as="node()*" select="$var54_current/ns0:resource"/>
									<xsl:variable name="var2_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var49_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var48_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var2_test_resultof_any">
											<xsl:variable name="var47_cur" as="xs:string" select="."/>
											<xsl:variable name="var4_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var3_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var49_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var3_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var4_test_resultof_any">
												<xsl:variable name="var46_cur" as="xs:string" select="."/>
												<xsl:variable name="var6_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var5_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var49_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var5_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var6_test_resultof_any">
													<xsl:variable name="var45_cur" as="xs:string" select="."/>
													<xsl:variable name="var8_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var7_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var49_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var7_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var8_test_resultof_any">
														<xsl:variable name="var44_cur" as="xs:string" select="."/>
														<xsl:variable name="var10_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var9_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var49_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var9_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var10_test_resultof_any">
															<xsl:variable name="var43_cur" as="xs:string" select="."/>
															<xsl:variable name="var12_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var11_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var49_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var11_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var12_test_resultof_any">
																<xsl:variable name="var42_cur" as="xs:string" select="."/>
																<xsl:variable name="var14_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var13_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var49_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var13_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var14_test_resultof_any">
																	<xsl:variable name="var41_cur" as="xs:string" select="."/>
																	<xsl:variable name="var16_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var15_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var49_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var15_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var16_test_resultof_any">
																		<xsl:variable name="var40_cur" as="xs:string" select="."/>
																		<xsl:variable name="var18_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var17_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var49_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var17_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var18_test_resultof_any">
																			<xsl:variable name="var39_cur" as="xs:string" select="."/>
																			<xsl:variable name="var20_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var19_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var49_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var19_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var20_test_resultof_any">
																				<xsl:variable name="var38_cur" as="xs:string" select="."/>
																				<xsl:variable name="var22_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var21_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var49_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var21_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var22_test_resultof_any">
																					<xsl:variable name="var37_cur" as="xs:string" select="."/>
																					<xsl:variable name="var24_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var23_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var49_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var23_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var24_test_resultof_any">
																						<xsl:variable name="var36_cur" as="xs:string" select="."/>
																						<xsl:variable name="var26_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var25_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var49_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var25_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var26_test_resultof_any">
																							<xsl:variable name="var35_cur" as="xs:string" select="."/>
																							<xsl:variable name="var28_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var27_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var49_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var27_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var28_test_resultof_any">
																								<xsl:variable name="var34_cur" as="xs:string" select="."/>
																								<xsl:variable name="var30_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var29_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var49_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var29_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var30_test_resultof_any">
																									<xsl:variable name="var33_cur" as="xs:string" select="."/>
																									<xsl:variable name="var32_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var49_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var31_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var49_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var31_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var32_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('67852-4' = $var47_cur), ('67852-4' = $var46_cur), ('67852-4' = $var45_cur), ('67852-4' = $var44_cur), ('67852-4' = $var43_cur), ('67852-4' = $var42_cur), ('67852-4' = $var41_cur), ('67852-4' = $var40_cur), ('67852-4' = $var39_cur), ('67852-4' = $var38_cur), ('67852-4' = $var37_cur), ('67852-4' = $var36_cur), ('67852-4' = $var35_cur), ('67852-4' = $var34_cur), ('67852-4' = $var33_cur), ('67852-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var48_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var50_resultof_filter">
								<xsl:variable name="var53_cur" as="node()" select="."/>
								<xsl:variable name="var52_resource" as="node()*" select="$var54_current/ns0:resource"/>
								<xsl:variable name="var51_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var52_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var52_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var52_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var52_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var52_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var52_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var52_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var52_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var52_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var52_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var52_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var52_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var52_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var52_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var52_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var52_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var52_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var51_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var53_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPatientHx'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11329-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History general Narrative - Reported'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History general Narrative - Reported'"/>
							</text>
						</code>
						<xsl:variable name="var128_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var119_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var119_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var120_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var120_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var121_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var121_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var122_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var122_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var123_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var123_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var124_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var124_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var125_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var125_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var126_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var126_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var127_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var127_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var128_let">
							<xsl:variable name="var118_current" as="node()" select="."/>
							<xsl:variable name="var114_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var113_resource" as="node()*" select="$var118_current/ns0:resource"/>
									<xsl:variable name="var66_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var65_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var113_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var65_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var112_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var66_test_resultof_any">
											<xsl:variable name="var111_cur" as="xs:string" select="."/>
											<xsl:variable name="var68_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var67_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var113_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var67_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var68_test_resultof_any">
												<xsl:variable name="var110_cur" as="xs:string" select="."/>
												<xsl:variable name="var70_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var69_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var113_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var69_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var70_test_resultof_any">
													<xsl:variable name="var109_cur" as="xs:string" select="."/>
													<xsl:variable name="var72_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var71_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var113_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var71_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var72_test_resultof_any">
														<xsl:variable name="var108_cur" as="xs:string" select="."/>
														<xsl:variable name="var74_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var73_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var113_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var73_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var74_test_resultof_any">
															<xsl:variable name="var107_cur" as="xs:string" select="."/>
															<xsl:variable name="var76_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var75_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var113_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var75_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var76_test_resultof_any">
																<xsl:variable name="var106_cur" as="xs:string" select="."/>
																<xsl:variable name="var78_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var77_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var113_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var77_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var78_test_resultof_any">
																	<xsl:variable name="var105_cur" as="xs:string" select="."/>
																	<xsl:variable name="var80_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var79_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var113_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var79_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var80_test_resultof_any">
																		<xsl:variable name="var104_cur" as="xs:string" select="."/>
																		<xsl:variable name="var82_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var81_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var113_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var81_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var82_test_resultof_any">
																			<xsl:variable name="var103_cur" as="xs:string" select="."/>
																			<xsl:variable name="var84_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var83_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var113_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var83_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var84_test_resultof_any">
																				<xsl:variable name="var102_cur" as="xs:string" select="."/>
																				<xsl:variable name="var86_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var85_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var113_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var85_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var86_test_resultof_any">
																					<xsl:variable name="var101_cur" as="xs:string" select="."/>
																					<xsl:variable name="var88_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var87_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var113_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var87_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var88_test_resultof_any">
																						<xsl:variable name="var100_cur" as="xs:string" select="."/>
																						<xsl:variable name="var90_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var89_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var113_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var89_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var90_test_resultof_any">
																							<xsl:variable name="var99_cur" as="xs:string" select="."/>
																							<xsl:variable name="var92_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var91_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var113_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var91_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var92_test_resultof_any">
																								<xsl:variable name="var98_cur" as="xs:string" select="."/>
																								<xsl:variable name="var94_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var93_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var113_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var93_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var94_test_resultof_any">
																									<xsl:variable name="var97_cur" as="xs:string" select="."/>
																									<xsl:variable name="var96_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var113_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var95_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var113_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var95_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var96_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('11329-0' = $var111_cur), ('11329-0' = $var110_cur), ('11329-0' = $var109_cur), ('11329-0' = $var108_cur), ('11329-0' = $var107_cur), ('11329-0' = $var106_cur), ('11329-0' = $var105_cur), ('11329-0' = $var104_cur), ('11329-0' = $var103_cur), ('11329-0' = $var102_cur), ('11329-0' = $var101_cur), ('11329-0' = $var100_cur), ('11329-0' = $var99_cur), ('11329-0' = $var98_cur), ('11329-0' = $var97_cur), ('11329-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var112_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var114_resultof_filter">
								<xsl:variable name="var117_cur" as="node()" select="."/>
								<xsl:variable name="var116_resource" as="node()*" select="$var118_current/ns0:resource"/>
								<xsl:variable name="var115_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var116_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var116_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var116_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var116_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var116_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var116_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var116_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var116_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var116_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var116_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var116_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var116_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var116_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var116_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var116_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var116_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var116_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var115_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var117_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPhysicalFindings'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'29545-1'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Physical findings Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Physical findings Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var192_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var183_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var183_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var184_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var184_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var185_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var185_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var186_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var186_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var187_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var187_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var188_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var188_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var189_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var189_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var190_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var190_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var191_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var191_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var192_let">
							<xsl:variable name="var182_current" as="node()" select="."/>
							<xsl:variable name="var178_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var177_resource" as="node()*" select="$var182_current/ns0:resource"/>
									<xsl:variable name="var130_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var129_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var177_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var129_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var176_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var130_test_resultof_any">
											<xsl:variable name="var175_cur" as="xs:string" select="."/>
											<xsl:variable name="var132_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var131_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var177_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var131_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var132_test_resultof_any">
												<xsl:variable name="var174_cur" as="xs:string" select="."/>
												<xsl:variable name="var134_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var133_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var177_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var133_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var134_test_resultof_any">
													<xsl:variable name="var173_cur" as="xs:string" select="."/>
													<xsl:variable name="var136_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var135_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var177_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var135_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var136_test_resultof_any">
														<xsl:variable name="var172_cur" as="xs:string" select="."/>
														<xsl:variable name="var138_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var137_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var177_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var137_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var138_test_resultof_any">
															<xsl:variable name="var171_cur" as="xs:string" select="."/>
															<xsl:variable name="var140_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var139_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var177_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var139_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var140_test_resultof_any">
																<xsl:variable name="var170_cur" as="xs:string" select="."/>
																<xsl:variable name="var142_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var141_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var177_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var141_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var142_test_resultof_any">
																	<xsl:variable name="var169_cur" as="xs:string" select="."/>
																	<xsl:variable name="var144_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var143_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var177_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var143_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var144_test_resultof_any">
																		<xsl:variable name="var168_cur" as="xs:string" select="."/>
																		<xsl:variable name="var146_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var145_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var177_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var145_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var146_test_resultof_any">
																			<xsl:variable name="var167_cur" as="xs:string" select="."/>
																			<xsl:variable name="var148_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var147_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var177_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var147_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var148_test_resultof_any">
																				<xsl:variable name="var166_cur" as="xs:string" select="."/>
																				<xsl:variable name="var150_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var149_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var177_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var149_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var150_test_resultof_any">
																					<xsl:variable name="var165_cur" as="xs:string" select="."/>
																					<xsl:variable name="var152_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var151_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var177_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var151_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var152_test_resultof_any">
																						<xsl:variable name="var164_cur" as="xs:string" select="."/>
																						<xsl:variable name="var154_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var153_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var177_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var153_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var154_test_resultof_any">
																							<xsl:variable name="var163_cur" as="xs:string" select="."/>
																							<xsl:variable name="var156_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var155_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var177_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var155_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var156_test_resultof_any">
																								<xsl:variable name="var162_cur" as="xs:string" select="."/>
																								<xsl:variable name="var158_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var157_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var177_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var157_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var158_test_resultof_any">
																									<xsl:variable name="var161_cur" as="xs:string" select="."/>
																									<xsl:variable name="var160_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var177_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var159_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var177_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var159_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var160_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('29545-1' = $var175_cur), ('29545-1' = $var174_cur), ('29545-1' = $var173_cur), ('29545-1' = $var172_cur), ('29545-1' = $var171_cur), ('29545-1' = $var170_cur), ('29545-1' = $var169_cur), ('29545-1' = $var168_cur), ('29545-1' = $var167_cur), ('29545-1' = $var166_cur), ('29545-1' = $var165_cur), ('29545-1' = $var164_cur), ('29545-1' = $var163_cur), ('29545-1' = $var162_cur), ('29545-1' = $var161_cur), ('29545-1' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var176_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var178_resultof_filter">
								<xsl:variable name="var181_cur" as="node()" select="."/>
								<xsl:variable name="var180_resource" as="node()*" select="$var182_current/ns0:resource"/>
								<xsl:variable name="var179_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var180_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var180_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var180_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var180_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var180_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var180_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var180_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var180_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var180_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var180_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var180_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var180_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var180_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var180_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var180_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var180_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var180_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var179_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var181_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPhysicalExamination'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'55286-9'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Physical exam by body areas'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Physical exam by body areas'"/>
							</text>
						</code>
						<xsl:variable name="var256_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var247_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var247_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var248_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var248_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var249_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var249_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var250_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var250_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var251_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var251_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var252_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var252_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var253_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var253_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var254_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var254_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var255_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var255_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var256_let">
							<xsl:variable name="var246_current" as="node()" select="."/>
							<xsl:variable name="var242_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var241_resource" as="node()*" select="$var246_current/ns0:resource"/>
									<xsl:variable name="var194_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var193_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var241_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var193_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var240_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var194_test_resultof_any">
											<xsl:variable name="var239_cur" as="xs:string" select="."/>
											<xsl:variable name="var196_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var195_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var241_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var195_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var196_test_resultof_any">
												<xsl:variable name="var238_cur" as="xs:string" select="."/>
												<xsl:variable name="var198_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var197_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var241_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var197_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var198_test_resultof_any">
													<xsl:variable name="var237_cur" as="xs:string" select="."/>
													<xsl:variable name="var200_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var199_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var241_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var199_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var200_test_resultof_any">
														<xsl:variable name="var236_cur" as="xs:string" select="."/>
														<xsl:variable name="var202_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var201_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var241_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var201_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var202_test_resultof_any">
															<xsl:variable name="var235_cur" as="xs:string" select="."/>
															<xsl:variable name="var204_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var203_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var241_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var203_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var204_test_resultof_any">
																<xsl:variable name="var234_cur" as="xs:string" select="."/>
																<xsl:variable name="var206_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var205_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var241_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var205_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var206_test_resultof_any">
																	<xsl:variable name="var233_cur" as="xs:string" select="."/>
																	<xsl:variable name="var208_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var207_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var241_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var207_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var208_test_resultof_any">
																		<xsl:variable name="var232_cur" as="xs:string" select="."/>
																		<xsl:variable name="var210_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var209_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var241_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var209_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var210_test_resultof_any">
																			<xsl:variable name="var231_cur" as="xs:string" select="."/>
																			<xsl:variable name="var212_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var211_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var241_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var211_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var212_test_resultof_any">
																				<xsl:variable name="var230_cur" as="xs:string" select="."/>
																				<xsl:variable name="var214_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var213_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var241_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var213_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var214_test_resultof_any">
																					<xsl:variable name="var229_cur" as="xs:string" select="."/>
																					<xsl:variable name="var216_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var215_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var241_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var215_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var216_test_resultof_any">
																						<xsl:variable name="var228_cur" as="xs:string" select="."/>
																						<xsl:variable name="var218_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var217_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var241_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var217_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var218_test_resultof_any">
																							<xsl:variable name="var227_cur" as="xs:string" select="."/>
																							<xsl:variable name="var220_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var219_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var241_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var219_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var220_test_resultof_any">
																								<xsl:variable name="var226_cur" as="xs:string" select="."/>
																								<xsl:variable name="var222_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var221_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var241_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var221_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var222_test_resultof_any">
																									<xsl:variable name="var225_cur" as="xs:string" select="."/>
																									<xsl:variable name="var224_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var241_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var223_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var241_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var223_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var224_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('55286-9' = $var239_cur), ('55286-9' = $var238_cur), ('55286-9' = $var237_cur), ('55286-9' = $var236_cur), ('55286-9' = $var235_cur), ('55286-9' = $var234_cur), ('55286-9' = $var233_cur), ('55286-9' = $var232_cur), ('55286-9' = $var231_cur), ('55286-9' = $var230_cur), ('55286-9' = $var229_cur), ('55286-9' = $var228_cur), ('55286-9' = $var227_cur), ('55286-9' = $var226_cur), ('55286-9' = $var225_cur), ('55286-9' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var240_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var242_resultof_filter">
								<xsl:variable name="var245_cur" as="node()" select="."/>
								<xsl:variable name="var244_resource" as="node()*" select="$var246_current/ns0:resource"/>
								<xsl:variable name="var243_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var244_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var244_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var244_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var244_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var244_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var244_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var244_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var244_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var244_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var244_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var244_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var244_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var244_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var244_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var244_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var244_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var244_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var243_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var245_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionVitalSigns'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital signs'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Vital signs'"/>
							</text>
						</code>
						<xsl:variable name="var320_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var311_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var311_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var312_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var312_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var313_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var313_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var314_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var314_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var315_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var315_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var316_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var316_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var317_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var317_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var318_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var318_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var319_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var319_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var320_let">
							<xsl:variable name="var310_current" as="node()" select="."/>
							<xsl:variable name="var306_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var305_resource" as="node()*" select="$var310_current/ns0:resource"/>
									<xsl:variable name="var258_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var257_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var305_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var257_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var304_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var258_test_resultof_any">
											<xsl:variable name="var303_cur" as="xs:string" select="."/>
											<xsl:variable name="var260_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var259_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var305_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var259_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var260_test_resultof_any">
												<xsl:variable name="var302_cur" as="xs:string" select="."/>
												<xsl:variable name="var262_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var261_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var305_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var261_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var262_test_resultof_any">
													<xsl:variable name="var301_cur" as="xs:string" select="."/>
													<xsl:variable name="var264_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var263_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var305_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var263_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var264_test_resultof_any">
														<xsl:variable name="var300_cur" as="xs:string" select="."/>
														<xsl:variable name="var266_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var265_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var305_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var265_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var266_test_resultof_any">
															<xsl:variable name="var299_cur" as="xs:string" select="."/>
															<xsl:variable name="var268_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var267_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var305_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var267_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var268_test_resultof_any">
																<xsl:variable name="var298_cur" as="xs:string" select="."/>
																<xsl:variable name="var270_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var269_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var305_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var269_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var270_test_resultof_any">
																	<xsl:variable name="var297_cur" as="xs:string" select="."/>
																	<xsl:variable name="var272_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var271_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var305_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var271_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var272_test_resultof_any">
																		<xsl:variable name="var296_cur" as="xs:string" select="."/>
																		<xsl:variable name="var274_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var273_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var305_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var273_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var274_test_resultof_any">
																			<xsl:variable name="var295_cur" as="xs:string" select="."/>
																			<xsl:variable name="var276_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var275_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var305_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var275_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var276_test_resultof_any">
																				<xsl:variable name="var294_cur" as="xs:string" select="."/>
																				<xsl:variable name="var278_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var277_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var305_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var277_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var278_test_resultof_any">
																					<xsl:variable name="var293_cur" as="xs:string" select="."/>
																					<xsl:variable name="var280_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var279_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var305_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var279_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var280_test_resultof_any">
																						<xsl:variable name="var292_cur" as="xs:string" select="."/>
																						<xsl:variable name="var282_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var281_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var305_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var281_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var282_test_resultof_any">
																							<xsl:variable name="var291_cur" as="xs:string" select="."/>
																							<xsl:variable name="var284_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var283_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var305_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var283_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var284_test_resultof_any">
																								<xsl:variable name="var290_cur" as="xs:string" select="."/>
																								<xsl:variable name="var286_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var285_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var305_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var285_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var286_test_resultof_any">
																									<xsl:variable name="var289_cur" as="xs:string" select="."/>
																									<xsl:variable name="var288_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var305_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var287_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var305_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var287_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var288_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('8716-3' = $var303_cur), ('8716-3' = $var302_cur), ('8716-3' = $var301_cur), ('8716-3' = $var300_cur), ('8716-3' = $var299_cur), ('8716-3' = $var298_cur), ('8716-3' = $var297_cur), ('8716-3' = $var296_cur), ('8716-3' = $var295_cur), ('8716-3' = $var294_cur), ('8716-3' = $var293_cur), ('8716-3' = $var292_cur), ('8716-3' = $var291_cur), ('8716-3' = $var290_cur), ('8716-3' = $var289_cur), ('8716-3' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var304_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var306_resultof_filter">
								<xsl:variable name="var309_cur" as="node()" select="."/>
								<xsl:variable name="var308_resource" as="node()*" select="$var310_current/ns0:resource"/>
								<xsl:variable name="var307_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var308_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var308_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var308_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var308_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var308_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var308_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var308_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var308_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var308_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var308_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var308_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var308_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var308_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var308_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var308_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var308_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var308_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var307_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var309_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionFunctionalStatus'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'47420-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Functional status assessment note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Functional status assessment note'"/>
							</text>
						</code>
						<xsl:variable name="var384_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var375_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var375_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var376_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var376_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var377_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var377_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var378_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var378_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var379_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var379_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var380_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var380_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var381_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var381_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var382_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var382_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var383_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var383_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var384_let">
							<xsl:variable name="var374_current" as="node()" select="."/>
							<xsl:variable name="var370_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var369_resource" as="node()*" select="$var374_current/ns0:resource"/>
									<xsl:variable name="var322_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var321_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var369_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var321_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var368_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var322_test_resultof_any">
											<xsl:variable name="var367_cur" as="xs:string" select="."/>
											<xsl:variable name="var324_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var323_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var369_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var323_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var324_test_resultof_any">
												<xsl:variable name="var366_cur" as="xs:string" select="."/>
												<xsl:variable name="var326_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var325_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var369_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var325_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var326_test_resultof_any">
													<xsl:variable name="var365_cur" as="xs:string" select="."/>
													<xsl:variable name="var328_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var327_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var369_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var327_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var328_test_resultof_any">
														<xsl:variable name="var364_cur" as="xs:string" select="."/>
														<xsl:variable name="var330_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var329_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var369_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var329_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var330_test_resultof_any">
															<xsl:variable name="var363_cur" as="xs:string" select="."/>
															<xsl:variable name="var332_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var331_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var369_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var331_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var332_test_resultof_any">
																<xsl:variable name="var362_cur" as="xs:string" select="."/>
																<xsl:variable name="var334_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var333_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var369_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var333_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var334_test_resultof_any">
																	<xsl:variable name="var361_cur" as="xs:string" select="."/>
																	<xsl:variable name="var336_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var335_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var369_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var335_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var336_test_resultof_any">
																		<xsl:variable name="var360_cur" as="xs:string" select="."/>
																		<xsl:variable name="var338_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var337_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var369_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var337_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var338_test_resultof_any">
																			<xsl:variable name="var359_cur" as="xs:string" select="."/>
																			<xsl:variable name="var340_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var339_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var369_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var339_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var340_test_resultof_any">
																				<xsl:variable name="var358_cur" as="xs:string" select="."/>
																				<xsl:variable name="var342_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var341_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var369_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var341_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var342_test_resultof_any">
																					<xsl:variable name="var357_cur" as="xs:string" select="."/>
																					<xsl:variable name="var344_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var343_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var369_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var343_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var344_test_resultof_any">
																						<xsl:variable name="var356_cur" as="xs:string" select="."/>
																						<xsl:variable name="var346_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var345_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var369_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var345_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var346_test_resultof_any">
																							<xsl:variable name="var355_cur" as="xs:string" select="."/>
																							<xsl:variable name="var348_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var347_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var369_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var347_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var348_test_resultof_any">
																								<xsl:variable name="var354_cur" as="xs:string" select="."/>
																								<xsl:variable name="var350_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var349_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var369_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var349_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var350_test_resultof_any">
																									<xsl:variable name="var353_cur" as="xs:string" select="."/>
																									<xsl:variable name="var352_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var369_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var351_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var369_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var351_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var352_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('47420-5' = $var367_cur), ('47420-5' = $var366_cur), ('47420-5' = $var365_cur), ('47420-5' = $var364_cur), ('47420-5' = $var363_cur), ('47420-5' = $var362_cur), ('47420-5' = $var361_cur), ('47420-5' = $var360_cur), ('47420-5' = $var359_cur), ('47420-5' = $var358_cur), ('47420-5' = $var357_cur), ('47420-5' = $var356_cur), ('47420-5' = $var355_cur), ('47420-5' = $var354_cur), ('47420-5' = $var353_cur), ('47420-5' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var368_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var370_resultof_filter">
								<xsl:variable name="var373_cur" as="node()" select="."/>
								<xsl:variable name="var372_resource" as="node()*" select="$var374_current/ns0:resource"/>
								<xsl:variable name="var371_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var372_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var372_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var372_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var372_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var372_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var372_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var372_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var372_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var372_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var372_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var372_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var372_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var372_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var372_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var372_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var372_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var372_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var371_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var373_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAllergies'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'48765-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Allergies and adverse reactions Document'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Allergies and adverse reactions Document'"/>
							</text>
						</code>
						<xsl:variable name="var448_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var439_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var439_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var440_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var440_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var441_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var441_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var442_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var442_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var443_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var443_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var444_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var444_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var445_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var445_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var446_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var446_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var447_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var447_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var448_let">
							<xsl:variable name="var438_current" as="node()" select="."/>
							<xsl:variable name="var434_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var433_resource" as="node()*" select="$var438_current/ns0:resource"/>
									<xsl:variable name="var386_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var385_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var433_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var385_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var432_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var386_test_resultof_any">
											<xsl:variable name="var431_cur" as="xs:string" select="."/>
											<xsl:variable name="var388_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var387_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var433_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var387_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var388_test_resultof_any">
												<xsl:variable name="var430_cur" as="xs:string" select="."/>
												<xsl:variable name="var390_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var389_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var433_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var389_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var390_test_resultof_any">
													<xsl:variable name="var429_cur" as="xs:string" select="."/>
													<xsl:variable name="var392_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var391_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var433_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var391_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var392_test_resultof_any">
														<xsl:variable name="var428_cur" as="xs:string" select="."/>
														<xsl:variable name="var394_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var393_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var433_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var393_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var394_test_resultof_any">
															<xsl:variable name="var427_cur" as="xs:string" select="."/>
															<xsl:variable name="var396_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var395_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var433_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var395_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var396_test_resultof_any">
																<xsl:variable name="var426_cur" as="xs:string" select="."/>
																<xsl:variable name="var398_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var397_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var433_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var397_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var398_test_resultof_any">
																	<xsl:variable name="var425_cur" as="xs:string" select="."/>
																	<xsl:variable name="var400_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var399_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var433_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var399_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var400_test_resultof_any">
																		<xsl:variable name="var424_cur" as="xs:string" select="."/>
																		<xsl:variable name="var402_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var401_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var433_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var401_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var402_test_resultof_any">
																			<xsl:variable name="var423_cur" as="xs:string" select="."/>
																			<xsl:variable name="var404_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var403_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var433_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var403_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var404_test_resultof_any">
																				<xsl:variable name="var422_cur" as="xs:string" select="."/>
																				<xsl:variable name="var406_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var405_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var433_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var405_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var406_test_resultof_any">
																					<xsl:variable name="var421_cur" as="xs:string" select="."/>
																					<xsl:variable name="var408_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var407_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var433_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var407_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var408_test_resultof_any">
																						<xsl:variable name="var420_cur" as="xs:string" select="."/>
																						<xsl:variable name="var410_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var409_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var433_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var409_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var410_test_resultof_any">
																							<xsl:variable name="var419_cur" as="xs:string" select="."/>
																							<xsl:variable name="var412_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var411_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var433_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var411_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var412_test_resultof_any">
																								<xsl:variable name="var418_cur" as="xs:string" select="."/>
																								<xsl:variable name="var414_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var413_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var433_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var413_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var414_test_resultof_any">
																									<xsl:variable name="var417_cur" as="xs:string" select="."/>
																									<xsl:variable name="var416_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var433_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var415_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var433_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var415_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var416_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('48765-2' = $var431_cur), ('48765-2' = $var430_cur), ('48765-2' = $var429_cur), ('48765-2' = $var428_cur), ('48765-2' = $var427_cur), ('48765-2' = $var426_cur), ('48765-2' = $var425_cur), ('48765-2' = $var424_cur), ('48765-2' = $var423_cur), ('48765-2' = $var422_cur), ('48765-2' = $var421_cur), ('48765-2' = $var420_cur), ('48765-2' = $var419_cur), ('48765-2' = $var418_cur), ('48765-2' = $var417_cur), ('48765-2' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var432_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var434_resultof_filter">
								<xsl:variable name="var437_cur" as="node()" select="."/>
								<xsl:variable name="var436_resource" as="node()*" select="$var438_current/ns0:resource"/>
								<xsl:variable name="var435_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var436_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var436_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var436_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var436_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var436_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var436_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var436_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var436_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var436_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var436_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var436_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var436_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var436_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var436_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var436_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var436_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var436_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var435_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var437_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAlert'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'75310-3'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Health concerns Document'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Health concerns Document'"/>
							</text>
						</code>
						<xsl:variable name="var512_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var503_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var503_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var504_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var504_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var505_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var505_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var506_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var506_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var507_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var507_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var508_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var508_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var509_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var509_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var510_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var510_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var511_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var511_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var512_let">
							<xsl:variable name="var502_current" as="node()" select="."/>
							<xsl:variable name="var498_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var497_resource" as="node()*" select="$var502_current/ns0:resource"/>
									<xsl:variable name="var450_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var449_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var497_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var449_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var496_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var450_test_resultof_any">
											<xsl:variable name="var495_cur" as="xs:string" select="."/>
											<xsl:variable name="var452_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var451_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var497_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var451_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var452_test_resultof_any">
												<xsl:variable name="var494_cur" as="xs:string" select="."/>
												<xsl:variable name="var454_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var453_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var497_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var453_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var454_test_resultof_any">
													<xsl:variable name="var493_cur" as="xs:string" select="."/>
													<xsl:variable name="var456_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var455_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var497_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var455_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var456_test_resultof_any">
														<xsl:variable name="var492_cur" as="xs:string" select="."/>
														<xsl:variable name="var458_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var457_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var497_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var457_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var458_test_resultof_any">
															<xsl:variable name="var491_cur" as="xs:string" select="."/>
															<xsl:variable name="var460_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var459_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var497_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var459_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var460_test_resultof_any">
																<xsl:variable name="var490_cur" as="xs:string" select="."/>
																<xsl:variable name="var462_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var461_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var497_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var461_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var462_test_resultof_any">
																	<xsl:variable name="var489_cur" as="xs:string" select="."/>
																	<xsl:variable name="var464_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var463_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var497_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var463_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var464_test_resultof_any">
																		<xsl:variable name="var488_cur" as="xs:string" select="."/>
																		<xsl:variable name="var466_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var465_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var497_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var465_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var466_test_resultof_any">
																			<xsl:variable name="var487_cur" as="xs:string" select="."/>
																			<xsl:variable name="var468_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var467_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var497_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var467_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var468_test_resultof_any">
																				<xsl:variable name="var486_cur" as="xs:string" select="."/>
																				<xsl:variable name="var470_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var469_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var497_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var469_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var470_test_resultof_any">
																					<xsl:variable name="var485_cur" as="xs:string" select="."/>
																					<xsl:variable name="var472_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var471_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var497_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var471_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var472_test_resultof_any">
																						<xsl:variable name="var484_cur" as="xs:string" select="."/>
																						<xsl:variable name="var474_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var473_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var497_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var473_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var474_test_resultof_any">
																							<xsl:variable name="var483_cur" as="xs:string" select="."/>
																							<xsl:variable name="var476_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var475_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var497_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var475_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var476_test_resultof_any">
																								<xsl:variable name="var482_cur" as="xs:string" select="."/>
																								<xsl:variable name="var478_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var477_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var497_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var477_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var478_test_resultof_any">
																									<xsl:variable name="var481_cur" as="xs:string" select="."/>
																									<xsl:variable name="var480_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var497_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var479_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var497_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var479_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var480_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('75310-3' = $var495_cur), ('75310-3' = $var494_cur), ('75310-3' = $var493_cur), ('75310-3' = $var492_cur), ('75310-3' = $var491_cur), ('75310-3' = $var490_cur), ('75310-3' = $var489_cur), ('75310-3' = $var488_cur), ('75310-3' = $var487_cur), ('75310-3' = $var486_cur), ('75310-3' = $var485_cur), ('75310-3' = $var484_cur), ('75310-3' = $var483_cur), ('75310-3' = $var482_cur), ('75310-3' = $var481_cur), ('75310-3' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var496_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var498_resultof_filter">
								<xsl:variable name="var501_cur" as="node()" select="."/>
								<xsl:variable name="var500_resource" as="node()*" select="$var502_current/ns0:resource"/>
								<xsl:variable name="var499_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var500_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var500_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var500_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var500_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var500_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var500_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var500_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var500_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var500_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var500_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var500_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var500_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var500_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var500_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var500_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var500_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var500_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var499_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var501_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionHospitalCourse'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8648-8'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital course'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital course'"/>
							</text>
						</code>
						<xsl:variable name="var576_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var567_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var567_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var568_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var568_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var569_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var569_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var570_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var570_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var571_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var571_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var572_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var572_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var573_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var573_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var574_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var574_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var575_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var575_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var576_let">
							<xsl:variable name="var566_current" as="node()" select="."/>
							<xsl:variable name="var562_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var561_resource" as="node()*" select="$var566_current/ns0:resource"/>
									<xsl:variable name="var514_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var513_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var561_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var513_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var560_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var514_test_resultof_any">
											<xsl:variable name="var559_cur" as="xs:string" select="."/>
											<xsl:variable name="var516_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var515_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var561_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var515_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var516_test_resultof_any">
												<xsl:variable name="var558_cur" as="xs:string" select="."/>
												<xsl:variable name="var518_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var517_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var561_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var517_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var518_test_resultof_any">
													<xsl:variable name="var557_cur" as="xs:string" select="."/>
													<xsl:variable name="var520_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var519_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var561_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var519_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var520_test_resultof_any">
														<xsl:variable name="var556_cur" as="xs:string" select="."/>
														<xsl:variable name="var522_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var521_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var561_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var521_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var522_test_resultof_any">
															<xsl:variable name="var555_cur" as="xs:string" select="."/>
															<xsl:variable name="var524_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var523_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var561_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var523_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var524_test_resultof_any">
																<xsl:variable name="var554_cur" as="xs:string" select="."/>
																<xsl:variable name="var526_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var525_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var561_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var525_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var526_test_resultof_any">
																	<xsl:variable name="var553_cur" as="xs:string" select="."/>
																	<xsl:variable name="var528_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var527_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var561_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var527_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var528_test_resultof_any">
																		<xsl:variable name="var552_cur" as="xs:string" select="."/>
																		<xsl:variable name="var530_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var529_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var561_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var529_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var530_test_resultof_any">
																			<xsl:variable name="var551_cur" as="xs:string" select="."/>
																			<xsl:variable name="var532_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var531_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var561_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var531_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var532_test_resultof_any">
																				<xsl:variable name="var550_cur" as="xs:string" select="."/>
																				<xsl:variable name="var534_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var533_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var561_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var533_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var534_test_resultof_any">
																					<xsl:variable name="var549_cur" as="xs:string" select="."/>
																					<xsl:variable name="var536_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var535_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var561_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var535_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var536_test_resultof_any">
																						<xsl:variable name="var548_cur" as="xs:string" select="."/>
																						<xsl:variable name="var538_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var537_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var561_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var537_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var538_test_resultof_any">
																							<xsl:variable name="var547_cur" as="xs:string" select="."/>
																							<xsl:variable name="var540_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var539_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var561_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var539_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var540_test_resultof_any">
																								<xsl:variable name="var546_cur" as="xs:string" select="."/>
																								<xsl:variable name="var542_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var541_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var561_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var541_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var542_test_resultof_any">
																									<xsl:variable name="var545_cur" as="xs:string" select="."/>
																									<xsl:variable name="var544_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var561_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var543_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var561_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var543_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var544_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('8648-8' = $var559_cur), ('8648-8' = $var558_cur), ('8648-8' = $var557_cur), ('8648-8' = $var556_cur), ('8648-8' = $var555_cur), ('8648-8' = $var554_cur), ('8648-8' = $var553_cur), ('8648-8' = $var552_cur), ('8648-8' = $var551_cur), ('8648-8' = $var550_cur), ('8648-8' = $var549_cur), ('8648-8' = $var548_cur), ('8648-8' = $var547_cur), ('8648-8' = $var546_cur), ('8648-8' = $var545_cur), ('8648-8' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var560_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var562_resultof_filter">
								<xsl:variable name="var565_cur" as="node()" select="."/>
								<xsl:variable name="var564_resource" as="node()*" select="$var566_current/ns0:resource"/>
								<xsl:variable name="var563_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var564_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var564_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var564_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var564_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var564_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var564_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var564_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var564_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var564_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var564_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var564_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var564_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var564_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var564_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var564_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var564_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var564_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var563_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var565_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDiagnosticSummary'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11450-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Problem list - Reported'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Problem list - Reported'"/>
							</text>
						</code>
						<xsl:variable name="var640_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var631_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var631_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var632_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var632_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var633_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var633_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var634_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var634_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var635_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var635_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var636_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var636_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var637_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var637_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var638_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var638_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var639_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var639_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var640_let">
							<xsl:variable name="var630_current" as="node()" select="."/>
							<xsl:variable name="var626_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var625_resource" as="node()*" select="$var630_current/ns0:resource"/>
									<xsl:variable name="var578_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var577_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var625_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var577_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var624_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var578_test_resultof_any">
											<xsl:variable name="var623_cur" as="xs:string" select="."/>
											<xsl:variable name="var580_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var579_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var625_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var579_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var580_test_resultof_any">
												<xsl:variable name="var622_cur" as="xs:string" select="."/>
												<xsl:variable name="var582_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var581_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var625_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var581_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var582_test_resultof_any">
													<xsl:variable name="var621_cur" as="xs:string" select="."/>
													<xsl:variable name="var584_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var583_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var625_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var583_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var584_test_resultof_any">
														<xsl:variable name="var620_cur" as="xs:string" select="."/>
														<xsl:variable name="var586_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var585_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var625_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var585_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var586_test_resultof_any">
															<xsl:variable name="var619_cur" as="xs:string" select="."/>
															<xsl:variable name="var588_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var587_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var625_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var587_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var588_test_resultof_any">
																<xsl:variable name="var618_cur" as="xs:string" select="."/>
																<xsl:variable name="var590_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var589_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var625_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var589_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var590_test_resultof_any">
																	<xsl:variable name="var617_cur" as="xs:string" select="."/>
																	<xsl:variable name="var592_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var591_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var625_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var591_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var592_test_resultof_any">
																		<xsl:variable name="var616_cur" as="xs:string" select="."/>
																		<xsl:variable name="var594_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var593_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var625_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var593_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var594_test_resultof_any">
																			<xsl:variable name="var615_cur" as="xs:string" select="."/>
																			<xsl:variable name="var596_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var595_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var625_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var595_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var596_test_resultof_any">
																				<xsl:variable name="var614_cur" as="xs:string" select="."/>
																				<xsl:variable name="var598_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var597_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var625_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var597_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var598_test_resultof_any">
																					<xsl:variable name="var613_cur" as="xs:string" select="."/>
																					<xsl:variable name="var600_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var599_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var625_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var599_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var600_test_resultof_any">
																						<xsl:variable name="var612_cur" as="xs:string" select="."/>
																						<xsl:variable name="var602_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var601_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var625_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var601_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var602_test_resultof_any">
																							<xsl:variable name="var611_cur" as="xs:string" select="."/>
																							<xsl:variable name="var604_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var603_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var625_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var603_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var604_test_resultof_any">
																								<xsl:variable name="var610_cur" as="xs:string" select="."/>
																								<xsl:variable name="var606_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var605_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var625_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var605_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var606_test_resultof_any">
																									<xsl:variable name="var609_cur" as="xs:string" select="."/>
																									<xsl:variable name="var608_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var625_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var607_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var625_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var607_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var608_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('11450-4' = $var623_cur), ('11450-4' = $var622_cur), ('11450-4' = $var621_cur), ('11450-4' = $var620_cur), ('11450-4' = $var619_cur), ('11450-4' = $var618_cur), ('11450-4' = $var617_cur), ('11450-4' = $var616_cur), ('11450-4' = $var615_cur), ('11450-4' = $var614_cur), ('11450-4' = $var613_cur), ('11450-4' = $var612_cur), ('11450-4' = $var611_cur), ('11450-4' = $var610_cur), ('11450-4' = $var609_cur), ('11450-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var624_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var626_resultof_filter">
								<xsl:variable name="var629_cur" as="node()" select="."/>
								<xsl:variable name="var628_resource" as="node()*" select="$var630_current/ns0:resource"/>
								<xsl:variable name="var627_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var628_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var628_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var628_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var628_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var628_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var628_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var628_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var628_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var628_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var628_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var628_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var628_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var628_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var628_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var628_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var628_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var628_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var627_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var629_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionSignificantProcedures'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10185-7'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital discharge procedures Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital discharge procedures Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var704_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var695_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var695_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var696_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var696_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var697_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var697_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var698_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var698_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var699_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var699_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var700_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var700_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var701_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var701_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var702_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var702_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var703_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var703_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var704_let">
							<xsl:variable name="var694_current" as="node()" select="."/>
							<xsl:variable name="var690_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var689_resource" as="node()*" select="$var694_current/ns0:resource"/>
									<xsl:variable name="var642_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var641_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var689_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var641_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var688_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var642_test_resultof_any">
											<xsl:variable name="var687_cur" as="xs:string" select="."/>
											<xsl:variable name="var644_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var643_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var689_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var643_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var644_test_resultof_any">
												<xsl:variable name="var686_cur" as="xs:string" select="."/>
												<xsl:variable name="var646_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var645_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var689_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var645_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var646_test_resultof_any">
													<xsl:variable name="var685_cur" as="xs:string" select="."/>
													<xsl:variable name="var648_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var647_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var689_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var647_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var648_test_resultof_any">
														<xsl:variable name="var684_cur" as="xs:string" select="."/>
														<xsl:variable name="var650_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var649_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var689_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var649_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var650_test_resultof_any">
															<xsl:variable name="var683_cur" as="xs:string" select="."/>
															<xsl:variable name="var652_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var651_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var689_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var651_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var652_test_resultof_any">
																<xsl:variable name="var682_cur" as="xs:string" select="."/>
																<xsl:variable name="var654_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var653_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var689_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var653_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var654_test_resultof_any">
																	<xsl:variable name="var681_cur" as="xs:string" select="."/>
																	<xsl:variable name="var656_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var655_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var689_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var655_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var656_test_resultof_any">
																		<xsl:variable name="var680_cur" as="xs:string" select="."/>
																		<xsl:variable name="var658_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var657_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var689_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var657_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var658_test_resultof_any">
																			<xsl:variable name="var679_cur" as="xs:string" select="."/>
																			<xsl:variable name="var660_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var659_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var689_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var659_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var660_test_resultof_any">
																				<xsl:variable name="var678_cur" as="xs:string" select="."/>
																				<xsl:variable name="var662_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var661_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var689_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var661_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var662_test_resultof_any">
																					<xsl:variable name="var677_cur" as="xs:string" select="."/>
																					<xsl:variable name="var664_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var663_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var689_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var663_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var664_test_resultof_any">
																						<xsl:variable name="var676_cur" as="xs:string" select="."/>
																						<xsl:variable name="var666_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var665_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var689_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var665_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var666_test_resultof_any">
																							<xsl:variable name="var675_cur" as="xs:string" select="."/>
																							<xsl:variable name="var668_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var667_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var689_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var667_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var668_test_resultof_any">
																								<xsl:variable name="var674_cur" as="xs:string" select="."/>
																								<xsl:variable name="var670_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var669_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var689_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var669_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var670_test_resultof_any">
																									<xsl:variable name="var673_cur" as="xs:string" select="."/>
																									<xsl:variable name="var672_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var689_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var671_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var689_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var671_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var672_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10185-7' = $var687_cur), ('10185-7' = $var686_cur), ('10185-7' = $var685_cur), ('10185-7' = $var684_cur), ('10185-7' = $var683_cur), ('10185-7' = $var682_cur), ('10185-7' = $var681_cur), ('10185-7' = $var680_cur), ('10185-7' = $var679_cur), ('10185-7' = $var678_cur), ('10185-7' = $var677_cur), ('10185-7' = $var676_cur), ('10185-7' = $var675_cur), ('10185-7' = $var674_cur), ('10185-7' = $var673_cur), ('10185-7' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var688_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var690_resultof_filter">
								<xsl:variable name="var693_cur" as="node()" select="."/>
								<xsl:variable name="var692_resource" as="node()*" select="$var694_current/ns0:resource"/>
								<xsl:variable name="var691_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var692_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var692_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var692_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var692_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var692_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var692_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var692_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var692_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var692_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var692_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var692_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var692_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var692_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var692_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var692_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var692_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var692_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var691_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var693_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionMedicalDevices'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'46264-8'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of medical device use'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of medical device use'"/>
							</text>
						</code>
						<xsl:variable name="var768_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var759_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var759_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var760_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var760_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var761_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var761_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var762_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var762_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var763_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var763_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var764_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var764_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var765_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var765_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var766_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var766_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var767_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var767_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var768_let">
							<xsl:variable name="var758_current" as="node()" select="."/>
							<xsl:variable name="var754_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var753_resource" as="node()*" select="$var758_current/ns0:resource"/>
									<xsl:variable name="var706_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var705_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var753_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var705_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var752_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var706_test_resultof_any">
											<xsl:variable name="var751_cur" as="xs:string" select="."/>
											<xsl:variable name="var708_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var707_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var753_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var707_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var708_test_resultof_any">
												<xsl:variable name="var750_cur" as="xs:string" select="."/>
												<xsl:variable name="var710_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var709_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var753_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var709_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var710_test_resultof_any">
													<xsl:variable name="var749_cur" as="xs:string" select="."/>
													<xsl:variable name="var712_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var711_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var753_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var711_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var712_test_resultof_any">
														<xsl:variable name="var748_cur" as="xs:string" select="."/>
														<xsl:variable name="var714_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var713_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var753_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var713_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var714_test_resultof_any">
															<xsl:variable name="var747_cur" as="xs:string" select="."/>
															<xsl:variable name="var716_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var715_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var753_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var715_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var716_test_resultof_any">
																<xsl:variable name="var746_cur" as="xs:string" select="."/>
																<xsl:variable name="var718_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var717_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var753_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var717_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var718_test_resultof_any">
																	<xsl:variable name="var745_cur" as="xs:string" select="."/>
																	<xsl:variable name="var720_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var719_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var753_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var719_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var720_test_resultof_any">
																		<xsl:variable name="var744_cur" as="xs:string" select="."/>
																		<xsl:variable name="var722_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var721_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var753_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var721_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var722_test_resultof_any">
																			<xsl:variable name="var743_cur" as="xs:string" select="."/>
																			<xsl:variable name="var724_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var723_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var753_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var723_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var724_test_resultof_any">
																				<xsl:variable name="var742_cur" as="xs:string" select="."/>
																				<xsl:variable name="var726_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var725_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var753_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var725_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var726_test_resultof_any">
																					<xsl:variable name="var741_cur" as="xs:string" select="."/>
																					<xsl:variable name="var728_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var727_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var753_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var727_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var728_test_resultof_any">
																						<xsl:variable name="var740_cur" as="xs:string" select="."/>
																						<xsl:variable name="var730_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var729_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var753_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var729_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var730_test_resultof_any">
																							<xsl:variable name="var739_cur" as="xs:string" select="."/>
																							<xsl:variable name="var732_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var731_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var753_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var731_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var732_test_resultof_any">
																								<xsl:variable name="var738_cur" as="xs:string" select="."/>
																								<xsl:variable name="var734_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var733_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var753_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var733_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var734_test_resultof_any">
																									<xsl:variable name="var737_cur" as="xs:string" select="."/>
																									<xsl:variable name="var736_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var753_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var735_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var753_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var735_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var736_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('46264-8' = $var751_cur), ('46264-8' = $var750_cur), ('46264-8' = $var749_cur), ('46264-8' = $var748_cur), ('46264-8' = $var747_cur), ('46264-8' = $var746_cur), ('46264-8' = $var745_cur), ('46264-8' = $var744_cur), ('46264-8' = $var743_cur), ('46264-8' = $var742_cur), ('46264-8' = $var741_cur), ('46264-8' = $var740_cur), ('46264-8' = $var739_cur), ('46264-8' = $var738_cur), ('46264-8' = $var737_cur), ('46264-8' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var752_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var754_resultof_filter">
								<xsl:variable name="var757_cur" as="node()" select="."/>
								<xsl:variable name="var756_resource" as="node()*" select="$var758_current/ns0:resource"/>
								<xsl:variable name="var755_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var756_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var756_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var756_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var756_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var756_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var756_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var756_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var756_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var756_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var756_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var756_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var756_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var756_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var756_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var756_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var756_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var756_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var755_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var757_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionMedications'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10160-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Medication use Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Medication use Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var832_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var823_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var823_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var824_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var824_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var825_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var825_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var826_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var826_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var827_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var827_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var828_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var828_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var829_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var829_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var830_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var830_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var831_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var831_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var832_let">
							<xsl:variable name="var822_current" as="node()" select="."/>
							<xsl:variable name="var818_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var817_resource" as="node()*" select="$var822_current/ns0:resource"/>
									<xsl:variable name="var770_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var769_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var817_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var769_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var816_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var770_test_resultof_any">
											<xsl:variable name="var815_cur" as="xs:string" select="."/>
											<xsl:variable name="var772_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var771_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var817_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var771_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var772_test_resultof_any">
												<xsl:variable name="var814_cur" as="xs:string" select="."/>
												<xsl:variable name="var774_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var773_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var817_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var773_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var774_test_resultof_any">
													<xsl:variable name="var813_cur" as="xs:string" select="."/>
													<xsl:variable name="var776_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var775_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var817_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var775_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var776_test_resultof_any">
														<xsl:variable name="var812_cur" as="xs:string" select="."/>
														<xsl:variable name="var778_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var777_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var817_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var777_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var778_test_resultof_any">
															<xsl:variable name="var811_cur" as="xs:string" select="."/>
															<xsl:variable name="var780_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var779_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var817_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var779_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var780_test_resultof_any">
																<xsl:variable name="var810_cur" as="xs:string" select="."/>
																<xsl:variable name="var782_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var781_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var817_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var781_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var782_test_resultof_any">
																	<xsl:variable name="var809_cur" as="xs:string" select="."/>
																	<xsl:variable name="var784_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var783_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var817_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var783_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var784_test_resultof_any">
																		<xsl:variable name="var808_cur" as="xs:string" select="."/>
																		<xsl:variable name="var786_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var785_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var817_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var785_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var786_test_resultof_any">
																			<xsl:variable name="var807_cur" as="xs:string" select="."/>
																			<xsl:variable name="var788_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var787_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var817_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var787_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var788_test_resultof_any">
																				<xsl:variable name="var806_cur" as="xs:string" select="."/>
																				<xsl:variable name="var790_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var789_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var817_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var789_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var790_test_resultof_any">
																					<xsl:variable name="var805_cur" as="xs:string" select="."/>
																					<xsl:variable name="var792_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var791_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var817_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var791_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var792_test_resultof_any">
																						<xsl:variable name="var804_cur" as="xs:string" select="."/>
																						<xsl:variable name="var794_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var793_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var817_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var793_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var794_test_resultof_any">
																							<xsl:variable name="var803_cur" as="xs:string" select="."/>
																							<xsl:variable name="var796_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var795_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var817_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var795_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var796_test_resultof_any">
																								<xsl:variable name="var802_cur" as="xs:string" select="."/>
																								<xsl:variable name="var798_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var797_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var817_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var797_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var798_test_resultof_any">
																									<xsl:variable name="var801_cur" as="xs:string" select="."/>
																									<xsl:variable name="var800_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var817_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var799_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var817_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var799_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var800_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10160-0' = $var815_cur), ('10160-0' = $var814_cur), ('10160-0' = $var813_cur), ('10160-0' = $var812_cur), ('10160-0' = $var811_cur), ('10160-0' = $var810_cur), ('10160-0' = $var809_cur), ('10160-0' = $var808_cur), ('10160-0' = $var807_cur), ('10160-0' = $var806_cur), ('10160-0' = $var805_cur), ('10160-0' = $var804_cur), ('10160-0' = $var803_cur), ('10160-0' = $var802_cur), ('10160-0' = $var801_cur), ('10160-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var816_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var818_resultof_filter">
								<xsl:variable name="var821_cur" as="node()" select="."/>
								<xsl:variable name="var820_resource" as="node()*" select="$var822_current/ns0:resource"/>
								<xsl:variable name="var819_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var820_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var820_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var820_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var820_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var820_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var820_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var820_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var820_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var820_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var820_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var820_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var820_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var820_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var820_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var820_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var820_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var820_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var819_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var821_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionSignificantResults'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Relevant diagnostic tests or laboratory data Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Relevant diagnostic tests or laboratory data Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var896_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var887_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var887_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var888_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var888_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var889_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var889_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var890_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var890_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var891_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var891_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var892_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var892_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var893_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var893_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var894_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var894_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var895_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var895_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var896_let">
							<xsl:variable name="var886_current" as="node()" select="."/>
							<xsl:variable name="var882_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var881_resource" as="node()*" select="$var886_current/ns0:resource"/>
									<xsl:variable name="var834_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var833_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var881_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var833_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var880_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var834_test_resultof_any">
											<xsl:variable name="var879_cur" as="xs:string" select="."/>
											<xsl:variable name="var836_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var835_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var881_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var835_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var836_test_resultof_any">
												<xsl:variable name="var878_cur" as="xs:string" select="."/>
												<xsl:variable name="var838_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var837_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var881_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var837_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var838_test_resultof_any">
													<xsl:variable name="var877_cur" as="xs:string" select="."/>
													<xsl:variable name="var840_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var839_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var881_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var839_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var840_test_resultof_any">
														<xsl:variable name="var876_cur" as="xs:string" select="."/>
														<xsl:variable name="var842_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var841_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var881_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var841_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var842_test_resultof_any">
															<xsl:variable name="var875_cur" as="xs:string" select="."/>
															<xsl:variable name="var844_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var843_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var881_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var843_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var844_test_resultof_any">
																<xsl:variable name="var874_cur" as="xs:string" select="."/>
																<xsl:variable name="var846_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var845_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var881_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var845_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var846_test_resultof_any">
																	<xsl:variable name="var873_cur" as="xs:string" select="."/>
																	<xsl:variable name="var848_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var847_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var881_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var847_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var848_test_resultof_any">
																		<xsl:variable name="var872_cur" as="xs:string" select="."/>
																		<xsl:variable name="var850_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var849_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var881_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var849_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var850_test_resultof_any">
																			<xsl:variable name="var871_cur" as="xs:string" select="."/>
																			<xsl:variable name="var852_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var851_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var881_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var851_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var852_test_resultof_any">
																				<xsl:variable name="var870_cur" as="xs:string" select="."/>
																				<xsl:variable name="var854_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var853_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var881_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var853_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var854_test_resultof_any">
																					<xsl:variable name="var869_cur" as="xs:string" select="."/>
																					<xsl:variable name="var856_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var855_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var881_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var855_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var856_test_resultof_any">
																						<xsl:variable name="var868_cur" as="xs:string" select="."/>
																						<xsl:variable name="var858_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var857_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var881_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var857_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var858_test_resultof_any">
																							<xsl:variable name="var867_cur" as="xs:string" select="."/>
																							<xsl:variable name="var860_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var859_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var881_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var859_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var860_test_resultof_any">
																								<xsl:variable name="var866_cur" as="xs:string" select="."/>
																								<xsl:variable name="var862_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var861_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var881_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var861_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var862_test_resultof_any">
																									<xsl:variable name="var865_cur" as="xs:string" select="."/>
																									<xsl:variable name="var864_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var881_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var863_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var881_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var863_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var864_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('30954-2' = $var879_cur), ('30954-2' = $var878_cur), ('30954-2' = $var877_cur), ('30954-2' = $var876_cur), ('30954-2' = $var875_cur), ('30954-2' = $var874_cur), ('30954-2' = $var873_cur), ('30954-2' = $var872_cur), ('30954-2' = $var871_cur), ('30954-2' = $var870_cur), ('30954-2' = $var869_cur), ('30954-2' = $var868_cur), ('30954-2' = $var867_cur), ('30954-2' = $var866_cur), ('30954-2' = $var865_cur), ('30954-2' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var880_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var882_resultof_filter">
								<xsl:variable name="var885_cur" as="node()" select="."/>
								<xsl:variable name="var884_resource" as="node()*" select="$var886_current/ns0:resource"/>
								<xsl:variable name="var883_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var884_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var884_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var884_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var884_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var884_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var884_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var884_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var884_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var884_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var884_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var884_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var884_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var884_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var884_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var884_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var884_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var884_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var883_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var885_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionSynthesis'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'51848-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Evaluation note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Evaluation note'"/>
							</text>
						</code>
						<xsl:variable name="var960_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var951_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var951_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var952_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var952_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var953_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var953_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var954_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var954_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var955_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var955_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var956_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var956_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var957_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var957_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var958_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var958_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var959_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var959_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var960_let">
							<xsl:variable name="var950_current" as="node()" select="."/>
							<xsl:variable name="var946_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var945_resource" as="node()*" select="$var950_current/ns0:resource"/>
									<xsl:variable name="var898_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var897_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var945_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var897_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var944_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var898_test_resultof_any">
											<xsl:variable name="var943_cur" as="xs:string" select="."/>
											<xsl:variable name="var900_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var899_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var945_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var899_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var900_test_resultof_any">
												<xsl:variable name="var942_cur" as="xs:string" select="."/>
												<xsl:variable name="var902_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var901_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var945_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var901_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var902_test_resultof_any">
													<xsl:variable name="var941_cur" as="xs:string" select="."/>
													<xsl:variable name="var904_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var903_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var945_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var903_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var904_test_resultof_any">
														<xsl:variable name="var940_cur" as="xs:string" select="."/>
														<xsl:variable name="var906_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var905_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var945_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var905_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var906_test_resultof_any">
															<xsl:variable name="var939_cur" as="xs:string" select="."/>
															<xsl:variable name="var908_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var907_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var945_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var907_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var908_test_resultof_any">
																<xsl:variable name="var938_cur" as="xs:string" select="."/>
																<xsl:variable name="var910_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var909_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var945_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var909_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var910_test_resultof_any">
																	<xsl:variable name="var937_cur" as="xs:string" select="."/>
																	<xsl:variable name="var912_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var911_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var945_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var911_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var912_test_resultof_any">
																		<xsl:variable name="var936_cur" as="xs:string" select="."/>
																		<xsl:variable name="var914_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var913_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var945_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var913_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var914_test_resultof_any">
																			<xsl:variable name="var935_cur" as="xs:string" select="."/>
																			<xsl:variable name="var916_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var915_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var945_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var915_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var916_test_resultof_any">
																				<xsl:variable name="var934_cur" as="xs:string" select="."/>
																				<xsl:variable name="var918_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var917_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var945_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var917_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var918_test_resultof_any">
																					<xsl:variable name="var933_cur" as="xs:string" select="."/>
																					<xsl:variable name="var920_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var919_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var945_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var919_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var920_test_resultof_any">
																						<xsl:variable name="var932_cur" as="xs:string" select="."/>
																						<xsl:variable name="var922_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var921_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var945_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var921_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var922_test_resultof_any">
																							<xsl:variable name="var931_cur" as="xs:string" select="."/>
																							<xsl:variable name="var924_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var923_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var945_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var923_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var924_test_resultof_any">
																								<xsl:variable name="var930_cur" as="xs:string" select="."/>
																								<xsl:variable name="var926_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var925_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var945_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var925_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var926_test_resultof_any">
																									<xsl:variable name="var929_cur" as="xs:string" select="."/>
																									<xsl:variable name="var928_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var945_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var927_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var945_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var927_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var928_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('51848-0' = $var943_cur), ('51848-0' = $var942_cur), ('51848-0' = $var941_cur), ('51848-0' = $var940_cur), ('51848-0' = $var939_cur), ('51848-0' = $var938_cur), ('51848-0' = $var937_cur), ('51848-0' = $var936_cur), ('51848-0' = $var935_cur), ('51848-0' = $var934_cur), ('51848-0' = $var933_cur), ('51848-0' = $var932_cur), ('51848-0' = $var931_cur), ('51848-0' = $var930_cur), ('51848-0' = $var929_cur), ('51848-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var944_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var946_resultof_filter">
								<xsl:variable name="var949_cur" as="node()" select="."/>
								<xsl:variable name="var948_resource" as="node()*" select="$var950_current/ns0:resource"/>
								<xsl:variable name="var947_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var948_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var948_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var948_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var948_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var948_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var948_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var948_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var948_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var948_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var948_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var948_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var948_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var948_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var948_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var948_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var948_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var948_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var947_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var949_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDischargeDetails'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8650-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital discharge disposition Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital discharge disposition Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var1024_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1015_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1015_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1016_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1016_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1017_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1017_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1018_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1018_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1019_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1019_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1020_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1020_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1021_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1021_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1022_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1022_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1023_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1023_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1024_let">
							<xsl:variable name="var1014_current" as="node()" select="."/>
							<xsl:variable name="var1010_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1009_resource" as="node()*" select="$var1014_current/ns0:resource"/>
									<xsl:variable name="var962_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var961_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1009_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var961_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1008_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var962_test_resultof_any">
											<xsl:variable name="var1007_cur" as="xs:string" select="."/>
											<xsl:variable name="var964_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var963_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1009_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var963_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var964_test_resultof_any">
												<xsl:variable name="var1006_cur" as="xs:string" select="."/>
												<xsl:variable name="var966_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var965_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1009_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var965_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var966_test_resultof_any">
													<xsl:variable name="var1005_cur" as="xs:string" select="."/>
													<xsl:variable name="var968_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var967_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1009_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var967_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var968_test_resultof_any">
														<xsl:variable name="var1004_cur" as="xs:string" select="."/>
														<xsl:variable name="var970_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var969_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1009_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var969_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var970_test_resultof_any">
															<xsl:variable name="var1003_cur" as="xs:string" select="."/>
															<xsl:variable name="var972_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var971_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1009_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var971_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var972_test_resultof_any">
																<xsl:variable name="var1002_cur" as="xs:string" select="."/>
																<xsl:variable name="var974_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var973_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1009_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var973_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var974_test_resultof_any">
																	<xsl:variable name="var1001_cur" as="xs:string" select="."/>
																	<xsl:variable name="var976_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var975_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1009_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var975_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var976_test_resultof_any">
																		<xsl:variable name="var1000_cur" as="xs:string" select="."/>
																		<xsl:variable name="var978_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var977_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1009_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var977_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var978_test_resultof_any">
																			<xsl:variable name="var999_cur" as="xs:string" select="."/>
																			<xsl:variable name="var980_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var979_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1009_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var979_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var980_test_resultof_any">
																				<xsl:variable name="var998_cur" as="xs:string" select="."/>
																				<xsl:variable name="var982_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var981_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1009_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var981_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var982_test_resultof_any">
																					<xsl:variable name="var997_cur" as="xs:string" select="."/>
																					<xsl:variable name="var984_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var983_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1009_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var983_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var984_test_resultof_any">
																						<xsl:variable name="var996_cur" as="xs:string" select="."/>
																						<xsl:variable name="var986_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var985_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1009_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var985_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var986_test_resultof_any">
																							<xsl:variable name="var995_cur" as="xs:string" select="."/>
																							<xsl:variable name="var988_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var987_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1009_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var987_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var988_test_resultof_any">
																								<xsl:variable name="var994_cur" as="xs:string" select="."/>
																								<xsl:variable name="var990_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var989_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1009_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var989_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var990_test_resultof_any">
																									<xsl:variable name="var993_cur" as="xs:string" select="."/>
																									<xsl:variable name="var992_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1009_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var991_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1009_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var991_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var992_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('8650-4' = $var1007_cur), ('8650-4' = $var1006_cur), ('8650-4' = $var1005_cur), ('8650-4' = $var1004_cur), ('8650-4' = $var1003_cur), ('8650-4' = $var1002_cur), ('8650-4' = $var1001_cur), ('8650-4' = $var1000_cur), ('8650-4' = $var999_cur), ('8650-4' = $var998_cur), ('8650-4' = $var997_cur), ('8650-4' = $var996_cur), ('8650-4' = $var995_cur), ('8650-4' = $var994_cur), ('8650-4' = $var993_cur), ('8650-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1008_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1010_resultof_filter">
								<xsl:variable name="var1013_cur" as="node()" select="."/>
								<xsl:variable name="var1012_resource" as="node()*" select="$var1014_current/ns0:resource"/>
								<xsl:variable name="var1011_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1012_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1012_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1012_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1012_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1012_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1012_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1012_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1012_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1012_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1012_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1012_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1012_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1012_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1012_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1012_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1012_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1012_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1011_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1013_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDischargeFindings'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10184-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital discharge physical findings Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital discharge physical findings Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var1088_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1079_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1079_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1080_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1080_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1081_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1081_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1082_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1082_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1083_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1083_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1084_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1084_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1085_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1085_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1086_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1086_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1087_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1087_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1088_let">
							<xsl:variable name="var1078_current" as="node()" select="."/>
							<xsl:variable name="var1074_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1073_resource" as="node()*" select="$var1078_current/ns0:resource"/>
									<xsl:variable name="var1026_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1025_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1073_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1025_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1072_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1026_test_resultof_any">
											<xsl:variable name="var1071_cur" as="xs:string" select="."/>
											<xsl:variable name="var1028_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1027_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1073_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1027_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1028_test_resultof_any">
												<xsl:variable name="var1070_cur" as="xs:string" select="."/>
												<xsl:variable name="var1030_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1029_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1073_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1029_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1030_test_resultof_any">
													<xsl:variable name="var1069_cur" as="xs:string" select="."/>
													<xsl:variable name="var1032_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1031_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1073_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1031_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1032_test_resultof_any">
														<xsl:variable name="var1068_cur" as="xs:string" select="."/>
														<xsl:variable name="var1034_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1033_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1073_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1033_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1034_test_resultof_any">
															<xsl:variable name="var1067_cur" as="xs:string" select="."/>
															<xsl:variable name="var1036_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1035_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1073_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1035_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1036_test_resultof_any">
																<xsl:variable name="var1066_cur" as="xs:string" select="."/>
																<xsl:variable name="var1038_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1037_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1073_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1037_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1038_test_resultof_any">
																	<xsl:variable name="var1065_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1040_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1039_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1073_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1039_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1040_test_resultof_any">
																		<xsl:variable name="var1064_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1042_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1041_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1073_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1041_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1042_test_resultof_any">
																			<xsl:variable name="var1063_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1044_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1043_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1073_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1043_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1044_test_resultof_any">
																				<xsl:variable name="var1062_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1046_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1045_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1073_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1045_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1046_test_resultof_any">
																					<xsl:variable name="var1061_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1048_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1047_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1073_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1047_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1048_test_resultof_any">
																						<xsl:variable name="var1060_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1050_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1049_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1073_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1049_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1050_test_resultof_any">
																							<xsl:variable name="var1059_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1052_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1051_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1073_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1051_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1052_test_resultof_any">
																								<xsl:variable name="var1058_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1054_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1053_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1073_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1053_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1054_test_resultof_any">
																									<xsl:variable name="var1057_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1056_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1073_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1055_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1073_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1055_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1056_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10184-0' = $var1071_cur), ('10184-0' = $var1070_cur), ('10184-0' = $var1069_cur), ('10184-0' = $var1068_cur), ('10184-0' = $var1067_cur), ('10184-0' = $var1066_cur), ('10184-0' = $var1065_cur), ('10184-0' = $var1064_cur), ('10184-0' = $var1063_cur), ('10184-0' = $var1062_cur), ('10184-0' = $var1061_cur), ('10184-0' = $var1060_cur), ('10184-0' = $var1059_cur), ('10184-0' = $var1058_cur), ('10184-0' = $var1057_cur), ('10184-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1072_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1074_resultof_filter">
								<xsl:variable name="var1077_cur" as="node()" select="."/>
								<xsl:variable name="var1076_resource" as="node()*" select="$var1078_current/ns0:resource"/>
								<xsl:variable name="var1075_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1076_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1076_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1076_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1076_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1076_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1076_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1076_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1076_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1076_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1076_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1076_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1076_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1076_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1076_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1076_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1076_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1076_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1075_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1077_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionProceduresHx'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'47519-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Procedures Document'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Procedures Document'"/>
							</text>
						</code>
						<xsl:variable name="var1152_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1143_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1143_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1144_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1144_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1145_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1145_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1146_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1146_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1147_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1147_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1148_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1148_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1149_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1149_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1150_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1150_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1151_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1151_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1152_let">
							<xsl:variable name="var1142_current" as="node()" select="."/>
							<xsl:variable name="var1138_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1137_resource" as="node()*" select="$var1142_current/ns0:resource"/>
									<xsl:variable name="var1090_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1089_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1137_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1089_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1136_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1090_test_resultof_any">
											<xsl:variable name="var1135_cur" as="xs:string" select="."/>
											<xsl:variable name="var1092_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1091_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1137_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1091_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1092_test_resultof_any">
												<xsl:variable name="var1134_cur" as="xs:string" select="."/>
												<xsl:variable name="var1094_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1093_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1137_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1093_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1094_test_resultof_any">
													<xsl:variable name="var1133_cur" as="xs:string" select="."/>
													<xsl:variable name="var1096_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1095_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1137_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1095_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1096_test_resultof_any">
														<xsl:variable name="var1132_cur" as="xs:string" select="."/>
														<xsl:variable name="var1098_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1097_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1137_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1097_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1098_test_resultof_any">
															<xsl:variable name="var1131_cur" as="xs:string" select="."/>
															<xsl:variable name="var1100_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1099_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1137_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1099_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1100_test_resultof_any">
																<xsl:variable name="var1130_cur" as="xs:string" select="."/>
																<xsl:variable name="var1102_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1101_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1137_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1101_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1102_test_resultof_any">
																	<xsl:variable name="var1129_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1104_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1103_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1137_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1103_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1104_test_resultof_any">
																		<xsl:variable name="var1128_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1106_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1105_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1137_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1105_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1106_test_resultof_any">
																			<xsl:variable name="var1127_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1108_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1107_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1137_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1107_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1108_test_resultof_any">
																				<xsl:variable name="var1126_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1110_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1109_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1137_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1109_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1110_test_resultof_any">
																					<xsl:variable name="var1125_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1112_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1111_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1137_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1111_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1112_test_resultof_any">
																						<xsl:variable name="var1124_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1114_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1113_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1137_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1113_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1114_test_resultof_any">
																							<xsl:variable name="var1123_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1116_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1115_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1137_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1115_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1116_test_resultof_any">
																								<xsl:variable name="var1122_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1118_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1117_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1137_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1117_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1118_test_resultof_any">
																									<xsl:variable name="var1121_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1120_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1137_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1119_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1137_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1119_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1120_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('47519-4' = $var1135_cur), ('47519-4' = $var1134_cur), ('47519-4' = $var1133_cur), ('47519-4' = $var1132_cur), ('47519-4' = $var1131_cur), ('47519-4' = $var1130_cur), ('47519-4' = $var1129_cur), ('47519-4' = $var1128_cur), ('47519-4' = $var1127_cur), ('47519-4' = $var1126_cur), ('47519-4' = $var1125_cur), ('47519-4' = $var1124_cur), ('47519-4' = $var1123_cur), ('47519-4' = $var1122_cur), ('47519-4' = $var1121_cur), ('47519-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1136_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1138_resultof_filter">
								<xsl:variable name="var1141_cur" as="node()" select="."/>
								<xsl:variable name="var1140_resource" as="node()*" select="$var1142_current/ns0:resource"/>
								<xsl:variable name="var1139_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1140_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1140_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1140_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1140_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1140_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1140_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1140_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1140_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1140_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1140_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1140_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1140_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1140_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1140_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1140_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1140_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1140_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1139_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1141_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionImmunizations'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11369-6'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Immunization Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Immunization Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var1216_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1207_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1207_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1208_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1208_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1209_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1209_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1210_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1210_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1211_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1211_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1212_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1212_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1213_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1213_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1214_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1214_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1215_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1215_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1216_let">
							<xsl:variable name="var1206_current" as="node()" select="."/>
							<xsl:variable name="var1202_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1201_resource" as="node()*" select="$var1206_current/ns0:resource"/>
									<xsl:variable name="var1154_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1153_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1201_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1153_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1200_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1154_test_resultof_any">
											<xsl:variable name="var1199_cur" as="xs:string" select="."/>
											<xsl:variable name="var1156_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1155_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1201_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1155_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1156_test_resultof_any">
												<xsl:variable name="var1198_cur" as="xs:string" select="."/>
												<xsl:variable name="var1158_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1157_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1201_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1157_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1158_test_resultof_any">
													<xsl:variable name="var1197_cur" as="xs:string" select="."/>
													<xsl:variable name="var1160_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1159_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1201_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1159_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1160_test_resultof_any">
														<xsl:variable name="var1196_cur" as="xs:string" select="."/>
														<xsl:variable name="var1162_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1161_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1201_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1161_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1162_test_resultof_any">
															<xsl:variable name="var1195_cur" as="xs:string" select="."/>
															<xsl:variable name="var1164_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1163_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1201_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1163_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1164_test_resultof_any">
																<xsl:variable name="var1194_cur" as="xs:string" select="."/>
																<xsl:variable name="var1166_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1165_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1201_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1165_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1166_test_resultof_any">
																	<xsl:variable name="var1193_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1168_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1167_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1201_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1167_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1168_test_resultof_any">
																		<xsl:variable name="var1192_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1170_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1169_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1201_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1169_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1170_test_resultof_any">
																			<xsl:variable name="var1191_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1172_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1171_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1201_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1171_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1172_test_resultof_any">
																				<xsl:variable name="var1190_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1174_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1173_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1201_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1173_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1174_test_resultof_any">
																					<xsl:variable name="var1189_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1176_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1175_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1201_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1175_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1176_test_resultof_any">
																						<xsl:variable name="var1188_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1178_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1177_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1201_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1177_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1178_test_resultof_any">
																							<xsl:variable name="var1187_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1180_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1179_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1201_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1179_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1180_test_resultof_any">
																								<xsl:variable name="var1186_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1182_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1181_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1201_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1181_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1182_test_resultof_any">
																									<xsl:variable name="var1185_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1184_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1201_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1183_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1201_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1183_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1184_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('11369-6' = $var1199_cur), ('11369-6' = $var1198_cur), ('11369-6' = $var1197_cur), ('11369-6' = $var1196_cur), ('11369-6' = $var1195_cur), ('11369-6' = $var1194_cur), ('11369-6' = $var1193_cur), ('11369-6' = $var1192_cur), ('11369-6' = $var1191_cur), ('11369-6' = $var1190_cur), ('11369-6' = $var1189_cur), ('11369-6' = $var1188_cur), ('11369-6' = $var1187_cur), ('11369-6' = $var1186_cur), ('11369-6' = $var1185_cur), ('11369-6' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1200_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1202_resultof_filter">
								<xsl:variable name="var1205_cur" as="node()" select="."/>
								<xsl:variable name="var1204_resource" as="node()*" select="$var1206_current/ns0:resource"/>
								<xsl:variable name="var1203_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1204_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1204_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1204_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1204_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1204_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1204_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1204_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1204_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1204_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1204_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1204_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1204_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1204_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1204_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1204_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1204_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1204_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1203_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1205_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionFamilyHistory'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10157-6'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of family member diseases Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of family member diseases Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var1280_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1271_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1271_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1272_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1272_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1273_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1273_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1274_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1274_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1275_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1275_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1276_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1276_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1277_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1277_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1278_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1278_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1279_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1279_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1280_let">
							<xsl:variable name="var1270_current" as="node()" select="."/>
							<xsl:variable name="var1266_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1265_resource" as="node()*" select="$var1270_current/ns0:resource"/>
									<xsl:variable name="var1218_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1217_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1265_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1217_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1264_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1218_test_resultof_any">
											<xsl:variable name="var1263_cur" as="xs:string" select="."/>
											<xsl:variable name="var1220_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1219_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1265_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1219_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1220_test_resultof_any">
												<xsl:variable name="var1262_cur" as="xs:string" select="."/>
												<xsl:variable name="var1222_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1221_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1265_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1221_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1222_test_resultof_any">
													<xsl:variable name="var1261_cur" as="xs:string" select="."/>
													<xsl:variable name="var1224_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1223_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1265_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1223_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1224_test_resultof_any">
														<xsl:variable name="var1260_cur" as="xs:string" select="."/>
														<xsl:variable name="var1226_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1225_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1265_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1225_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1226_test_resultof_any">
															<xsl:variable name="var1259_cur" as="xs:string" select="."/>
															<xsl:variable name="var1228_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1227_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1265_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1227_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1228_test_resultof_any">
																<xsl:variable name="var1258_cur" as="xs:string" select="."/>
																<xsl:variable name="var1230_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1229_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1265_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1229_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1230_test_resultof_any">
																	<xsl:variable name="var1257_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1232_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1231_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1265_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1231_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1232_test_resultof_any">
																		<xsl:variable name="var1256_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1234_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1233_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1265_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1233_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1234_test_resultof_any">
																			<xsl:variable name="var1255_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1236_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1235_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1265_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1235_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1236_test_resultof_any">
																				<xsl:variable name="var1254_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1238_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1237_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1265_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1237_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1238_test_resultof_any">
																					<xsl:variable name="var1253_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1240_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1239_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1265_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1239_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1240_test_resultof_any">
																						<xsl:variable name="var1252_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1242_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1241_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1265_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1241_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1242_test_resultof_any">
																							<xsl:variable name="var1251_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1244_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1243_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1265_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1243_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1244_test_resultof_any">
																								<xsl:variable name="var1250_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1246_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1245_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1265_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1245_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1246_test_resultof_any">
																									<xsl:variable name="var1249_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1248_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1265_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1247_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1265_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1247_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1248_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10157-6' = $var1263_cur), ('10157-6' = $var1262_cur), ('10157-6' = $var1261_cur), ('10157-6' = $var1260_cur), ('10157-6' = $var1259_cur), ('10157-6' = $var1258_cur), ('10157-6' = $var1257_cur), ('10157-6' = $var1256_cur), ('10157-6' = $var1255_cur), ('10157-6' = $var1254_cur), ('10157-6' = $var1253_cur), ('10157-6' = $var1252_cur), ('10157-6' = $var1251_cur), ('10157-6' = $var1250_cur), ('10157-6' = $var1249_cur), ('10157-6' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1264_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1266_resultof_filter">
								<xsl:variable name="var1269_cur" as="node()" select="."/>
								<xsl:variable name="var1268_resource" as="node()*" select="$var1270_current/ns0:resource"/>
								<xsl:variable name="var1267_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1268_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1268_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1268_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1268_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1268_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1268_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1268_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1268_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1268_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1268_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1268_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1268_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1268_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1268_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1268_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1268_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1268_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1267_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1269_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPastIllnessHx'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11348-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Past illness Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Past illness Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var1344_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1335_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1335_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1336_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1336_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1337_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1337_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1338_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1338_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1339_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1339_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1340_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1340_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1341_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1341_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1342_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1342_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1343_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1343_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1344_let">
							<xsl:variable name="var1334_current" as="node()" select="."/>
							<xsl:variable name="var1330_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1329_resource" as="node()*" select="$var1334_current/ns0:resource"/>
									<xsl:variable name="var1282_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1281_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1329_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1281_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1328_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1282_test_resultof_any">
											<xsl:variable name="var1327_cur" as="xs:string" select="."/>
											<xsl:variable name="var1284_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1283_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1329_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1283_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1284_test_resultof_any">
												<xsl:variable name="var1326_cur" as="xs:string" select="."/>
												<xsl:variable name="var1286_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1285_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1329_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1285_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1286_test_resultof_any">
													<xsl:variable name="var1325_cur" as="xs:string" select="."/>
													<xsl:variable name="var1288_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1287_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1329_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1287_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1288_test_resultof_any">
														<xsl:variable name="var1324_cur" as="xs:string" select="."/>
														<xsl:variable name="var1290_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1289_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1329_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1289_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1290_test_resultof_any">
															<xsl:variable name="var1323_cur" as="xs:string" select="."/>
															<xsl:variable name="var1292_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1291_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1329_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1291_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1292_test_resultof_any">
																<xsl:variable name="var1322_cur" as="xs:string" select="."/>
																<xsl:variable name="var1294_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1293_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1329_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1293_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1294_test_resultof_any">
																	<xsl:variable name="var1321_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1296_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1295_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1329_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1295_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1296_test_resultof_any">
																		<xsl:variable name="var1320_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1298_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1297_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1329_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1297_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1298_test_resultof_any">
																			<xsl:variable name="var1319_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1300_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1299_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1329_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1299_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1300_test_resultof_any">
																				<xsl:variable name="var1318_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1302_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1301_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1329_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1301_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1302_test_resultof_any">
																					<xsl:variable name="var1317_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1304_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1303_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1329_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1303_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1304_test_resultof_any">
																						<xsl:variable name="var1316_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1306_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1305_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1329_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1305_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1306_test_resultof_any">
																							<xsl:variable name="var1315_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1308_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1307_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1329_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1307_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1308_test_resultof_any">
																								<xsl:variable name="var1314_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1310_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1309_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1329_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1309_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1310_test_resultof_any">
																									<xsl:variable name="var1313_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1312_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1329_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1311_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1329_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1311_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1312_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('11348-0' = $var1327_cur), ('11348-0' = $var1326_cur), ('11348-0' = $var1325_cur), ('11348-0' = $var1324_cur), ('11348-0' = $var1323_cur), ('11348-0' = $var1322_cur), ('11348-0' = $var1321_cur), ('11348-0' = $var1320_cur), ('11348-0' = $var1319_cur), ('11348-0' = $var1318_cur), ('11348-0' = $var1317_cur), ('11348-0' = $var1316_cur), ('11348-0' = $var1315_cur), ('11348-0' = $var1314_cur), ('11348-0' = $var1313_cur), ('11348-0' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1328_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1330_resultof_filter">
								<xsl:variable name="var1333_cur" as="node()" select="."/>
								<xsl:variable name="var1332_resource" as="node()*" select="$var1334_current/ns0:resource"/>
								<xsl:variable name="var1331_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1332_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1332_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1332_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1332_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1332_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1332_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1332_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1332_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1332_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1332_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1332_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1332_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1332_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1332_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1332_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1332_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1332_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1331_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1333_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionCareTeam'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'85847-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Patient Care team information'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Patient Care team information'"/>
							</text>
						</code>
						<xsl:variable name="var1408_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1399_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1399_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1400_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1400_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1401_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1401_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1402_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1402_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1403_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1403_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1404_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1404_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1405_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1405_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1406_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1406_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1407_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1407_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1408_let">
							<xsl:variable name="var1398_current" as="node()" select="."/>
							<xsl:variable name="var1394_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1393_resource" as="node()*" select="$var1398_current/ns0:resource"/>
									<xsl:variable name="var1346_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1345_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1393_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1345_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1392_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1346_test_resultof_any">
											<xsl:variable name="var1391_cur" as="xs:string" select="."/>
											<xsl:variable name="var1348_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1347_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1393_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1347_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1348_test_resultof_any">
												<xsl:variable name="var1390_cur" as="xs:string" select="."/>
												<xsl:variable name="var1350_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1349_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1393_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1349_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1350_test_resultof_any">
													<xsl:variable name="var1389_cur" as="xs:string" select="."/>
													<xsl:variable name="var1352_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1351_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1393_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1351_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1352_test_resultof_any">
														<xsl:variable name="var1388_cur" as="xs:string" select="."/>
														<xsl:variable name="var1354_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1353_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1393_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1353_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1354_test_resultof_any">
															<xsl:variable name="var1387_cur" as="xs:string" select="."/>
															<xsl:variable name="var1356_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1355_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1393_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1355_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1356_test_resultof_any">
																<xsl:variable name="var1386_cur" as="xs:string" select="."/>
																<xsl:variable name="var1358_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1357_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1393_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1357_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1358_test_resultof_any">
																	<xsl:variable name="var1385_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1360_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1359_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1393_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1359_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1360_test_resultof_any">
																		<xsl:variable name="var1384_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1362_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1361_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1393_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1361_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1362_test_resultof_any">
																			<xsl:variable name="var1383_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1364_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1363_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1393_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1363_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1364_test_resultof_any">
																				<xsl:variable name="var1382_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1366_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1365_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1393_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1365_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1366_test_resultof_any">
																					<xsl:variable name="var1381_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1368_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1367_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1393_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1367_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1368_test_resultof_any">
																						<xsl:variable name="var1380_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1370_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1369_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1393_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1369_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1370_test_resultof_any">
																							<xsl:variable name="var1379_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1372_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1371_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1393_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1371_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1372_test_resultof_any">
																								<xsl:variable name="var1378_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1374_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1373_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1393_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1373_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1374_test_resultof_any">
																									<xsl:variable name="var1377_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1376_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1393_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1375_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1393_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1375_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1376_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('85847-2' = $var1391_cur), ('85847-2' = $var1390_cur), ('85847-2' = $var1389_cur), ('85847-2' = $var1388_cur), ('85847-2' = $var1387_cur), ('85847-2' = $var1386_cur), ('85847-2' = $var1385_cur), ('85847-2' = $var1384_cur), ('85847-2' = $var1383_cur), ('85847-2' = $var1382_cur), ('85847-2' = $var1381_cur), ('85847-2' = $var1380_cur), ('85847-2' = $var1379_cur), ('85847-2' = $var1378_cur), ('85847-2' = $var1377_cur), ('85847-2' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1392_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1394_resultof_filter">
								<xsl:variable name="var1397_cur" as="node()" select="."/>
								<xsl:variable name="var1396_resource" as="node()*" select="$var1398_current/ns0:resource"/>
								<xsl:variable name="var1395_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1396_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1396_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1396_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1396_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1396_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1396_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1396_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1396_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1396_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1396_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1396_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1396_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1396_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1396_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1396_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1396_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1396_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1395_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1397_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionSocialHistory'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Social history Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Social history Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var1472_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1463_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1463_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1464_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1464_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1465_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1465_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1466_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1466_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1467_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1467_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1468_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1468_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1469_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1469_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1470_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1470_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1471_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1471_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1472_let">
							<xsl:variable name="var1462_current" as="node()" select="."/>
							<xsl:variable name="var1458_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1457_resource" as="node()*" select="$var1462_current/ns0:resource"/>
									<xsl:variable name="var1410_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1409_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1457_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1409_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1456_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1410_test_resultof_any">
											<xsl:variable name="var1455_cur" as="xs:string" select="."/>
											<xsl:variable name="var1412_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1411_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1457_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1411_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1412_test_resultof_any">
												<xsl:variable name="var1454_cur" as="xs:string" select="."/>
												<xsl:variable name="var1414_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1413_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1457_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1413_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1414_test_resultof_any">
													<xsl:variable name="var1453_cur" as="xs:string" select="."/>
													<xsl:variable name="var1416_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1415_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1457_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1415_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1416_test_resultof_any">
														<xsl:variable name="var1452_cur" as="xs:string" select="."/>
														<xsl:variable name="var1418_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1417_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1457_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1417_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1418_test_resultof_any">
															<xsl:variable name="var1451_cur" as="xs:string" select="."/>
															<xsl:variable name="var1420_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1419_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1457_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1419_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1420_test_resultof_any">
																<xsl:variable name="var1450_cur" as="xs:string" select="."/>
																<xsl:variable name="var1422_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1421_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1457_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1421_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1422_test_resultof_any">
																	<xsl:variable name="var1449_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1424_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1423_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1457_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1423_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1424_test_resultof_any">
																		<xsl:variable name="var1448_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1426_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1425_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1457_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1425_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1426_test_resultof_any">
																			<xsl:variable name="var1447_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1428_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1427_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1457_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1427_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1428_test_resultof_any">
																				<xsl:variable name="var1446_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1430_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1429_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1457_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1429_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1430_test_resultof_any">
																					<xsl:variable name="var1445_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1432_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1431_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1457_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1431_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1432_test_resultof_any">
																						<xsl:variable name="var1444_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1434_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1433_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1457_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1433_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1434_test_resultof_any">
																							<xsl:variable name="var1443_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1436_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1435_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1457_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1435_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1436_test_resultof_any">
																								<xsl:variable name="var1442_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1438_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1437_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1457_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1437_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1438_test_resultof_any">
																									<xsl:variable name="var1441_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1440_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1457_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1439_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1457_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1439_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1440_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('29762-2' = $var1455_cur), ('29762-2' = $var1454_cur), ('29762-2' = $var1453_cur), ('29762-2' = $var1452_cur), ('29762-2' = $var1451_cur), ('29762-2' = $var1450_cur), ('29762-2' = $var1449_cur), ('29762-2' = $var1448_cur), ('29762-2' = $var1447_cur), ('29762-2' = $var1446_cur), ('29762-2' = $var1445_cur), ('29762-2' = $var1444_cur), ('29762-2' = $var1443_cur), ('29762-2' = $var1442_cur), ('29762-2' = $var1441_cur), ('29762-2' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1456_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1458_resultof_filter">
								<xsl:variable name="var1461_cur" as="node()" select="."/>
								<xsl:variable name="var1460_resource" as="node()*" select="$var1462_current/ns0:resource"/>
								<xsl:variable name="var1459_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1460_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1460_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1460_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1460_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1460_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1460_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1460_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1460_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1460_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1460_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1460_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1460_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1460_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1460_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1460_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1460_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1460_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1459_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1461_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPlanOfCare'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'18776-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Plan of care note'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Plan of care note'"/>
							</text>
						</code>
						<xsl:variable name="var1536_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1527_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1527_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1528_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1528_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1529_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1529_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1530_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1530_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1531_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1531_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1532_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1532_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1533_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1533_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1534_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1534_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1535_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1535_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1536_let">
							<xsl:variable name="var1526_current" as="node()" select="."/>
							<xsl:variable name="var1522_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1521_resource" as="node()*" select="$var1526_current/ns0:resource"/>
									<xsl:variable name="var1474_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1473_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1521_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1473_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1520_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1474_test_resultof_any">
											<xsl:variable name="var1519_cur" as="xs:string" select="."/>
											<xsl:variable name="var1476_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1475_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1521_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1475_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1476_test_resultof_any">
												<xsl:variable name="var1518_cur" as="xs:string" select="."/>
												<xsl:variable name="var1478_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1477_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1521_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1477_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1478_test_resultof_any">
													<xsl:variable name="var1517_cur" as="xs:string" select="."/>
													<xsl:variable name="var1480_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1479_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1521_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1479_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1480_test_resultof_any">
														<xsl:variable name="var1516_cur" as="xs:string" select="."/>
														<xsl:variable name="var1482_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1481_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1521_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1481_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1482_test_resultof_any">
															<xsl:variable name="var1515_cur" as="xs:string" select="."/>
															<xsl:variable name="var1484_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1483_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1521_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1483_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1484_test_resultof_any">
																<xsl:variable name="var1514_cur" as="xs:string" select="."/>
																<xsl:variable name="var1486_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1485_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1521_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1485_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1486_test_resultof_any">
																	<xsl:variable name="var1513_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1488_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1487_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1521_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1487_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1488_test_resultof_any">
																		<xsl:variable name="var1512_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1490_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1489_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1521_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1489_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1490_test_resultof_any">
																			<xsl:variable name="var1511_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1492_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1491_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1521_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1491_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1492_test_resultof_any">
																				<xsl:variable name="var1510_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1494_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1493_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1521_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1493_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1494_test_resultof_any">
																					<xsl:variable name="var1509_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1496_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1495_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1521_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1495_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1496_test_resultof_any">
																						<xsl:variable name="var1508_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1498_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1497_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1521_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1497_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1498_test_resultof_any">
																							<xsl:variable name="var1507_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1500_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1499_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1521_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1499_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1500_test_resultof_any">
																								<xsl:variable name="var1506_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1502_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1501_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1521_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1501_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1502_test_resultof_any">
																									<xsl:variable name="var1505_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1504_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1521_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1503_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1521_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1503_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1504_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('18776-5' = $var1519_cur), ('18776-5' = $var1518_cur), ('18776-5' = $var1517_cur), ('18776-5' = $var1516_cur), ('18776-5' = $var1515_cur), ('18776-5' = $var1514_cur), ('18776-5' = $var1513_cur), ('18776-5' = $var1512_cur), ('18776-5' = $var1511_cur), ('18776-5' = $var1510_cur), ('18776-5' = $var1509_cur), ('18776-5' = $var1508_cur), ('18776-5' = $var1507_cur), ('18776-5' = $var1506_cur), ('18776-5' = $var1505_cur), ('18776-5' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1520_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1522_resultof_filter">
								<xsl:variable name="var1525_cur" as="node()" select="."/>
								<xsl:variable name="var1524_resource" as="node()*" select="$var1526_current/ns0:resource"/>
								<xsl:variable name="var1523_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1524_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1524_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1524_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1524_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1524_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1524_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1524_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1524_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1524_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1524_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1524_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1524_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1524_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1524_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1524_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1524_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1524_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1523_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1525_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDischargeMedications'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'75311-1'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Discharge medications Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Discharge medications Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var1600_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1591_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1591_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1592_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1592_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1593_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1593_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1594_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1594_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1595_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1595_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1596_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1596_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1597_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1597_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1598_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1598_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1599_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1599_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1600_let">
							<xsl:variable name="var1590_current" as="node()" select="."/>
							<xsl:variable name="var1586_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1585_resource" as="node()*" select="$var1590_current/ns0:resource"/>
									<xsl:variable name="var1538_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1537_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1585_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1537_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1584_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1538_test_resultof_any">
											<xsl:variable name="var1583_cur" as="xs:string" select="."/>
											<xsl:variable name="var1540_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1539_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1585_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1539_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1540_test_resultof_any">
												<xsl:variable name="var1582_cur" as="xs:string" select="."/>
												<xsl:variable name="var1542_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1541_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1585_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1541_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1542_test_resultof_any">
													<xsl:variable name="var1581_cur" as="xs:string" select="."/>
													<xsl:variable name="var1544_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1543_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1585_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1543_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1544_test_resultof_any">
														<xsl:variable name="var1580_cur" as="xs:string" select="."/>
														<xsl:variable name="var1546_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1545_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1585_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1545_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1546_test_resultof_any">
															<xsl:variable name="var1579_cur" as="xs:string" select="."/>
															<xsl:variable name="var1548_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1547_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1585_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1547_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1548_test_resultof_any">
																<xsl:variable name="var1578_cur" as="xs:string" select="."/>
																<xsl:variable name="var1550_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1549_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1585_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1549_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1550_test_resultof_any">
																	<xsl:variable name="var1577_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1552_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1551_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1585_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1551_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1552_test_resultof_any">
																		<xsl:variable name="var1576_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1554_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1553_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1585_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1553_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1554_test_resultof_any">
																			<xsl:variable name="var1575_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1556_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1555_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1585_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1555_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1556_test_resultof_any">
																				<xsl:variable name="var1574_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1558_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1557_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1585_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1557_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1558_test_resultof_any">
																					<xsl:variable name="var1573_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1560_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1559_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1585_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1559_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1560_test_resultof_any">
																						<xsl:variable name="var1572_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1562_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1561_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1585_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1561_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1562_test_resultof_any">
																							<xsl:variable name="var1571_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1564_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1563_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1585_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1563_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1564_test_resultof_any">
																								<xsl:variable name="var1570_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1566_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1565_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1585_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1565_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1566_test_resultof_any">
																									<xsl:variable name="var1569_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1568_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1585_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1567_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1585_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1567_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1568_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('75311-1' = $var1583_cur), ('75311-1' = $var1582_cur), ('75311-1' = $var1581_cur), ('75311-1' = $var1580_cur), ('75311-1' = $var1579_cur), ('75311-1' = $var1578_cur), ('75311-1' = $var1577_cur), ('75311-1' = $var1576_cur), ('75311-1' = $var1575_cur), ('75311-1' = $var1574_cur), ('75311-1' = $var1573_cur), ('75311-1' = $var1572_cur), ('75311-1' = $var1571_cur), ('75311-1' = $var1570_cur), ('75311-1' = $var1569_cur), ('75311-1' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1584_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1586_resultof_filter">
								<xsl:variable name="var1589_cur" as="node()" select="."/>
								<xsl:variable name="var1588_resource" as="node()*" select="$var1590_current/ns0:resource"/>
								<xsl:variable name="var1587_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1588_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1588_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1588_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1588_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1588_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1588_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1588_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1588_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1588_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1588_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1588_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1588_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1588_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1588_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1588_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1588_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1588_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1587_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1589_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionDischargeInstructions'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8653-8'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Hospital Discharge instructions'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Hospital Discharge instructions'"/>
							</text>
						</code>
						<xsl:variable name="var1664_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1655_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1655_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1656_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1656_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1657_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1657_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1658_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1658_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1659_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1659_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1660_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1660_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1661_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1661_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1662_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1662_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1663_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1663_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1664_let">
							<xsl:variable name="var1654_current" as="node()" select="."/>
							<xsl:variable name="var1650_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1649_resource" as="node()*" select="$var1654_current/ns0:resource"/>
									<xsl:variable name="var1602_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1601_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1649_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1601_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1648_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1602_test_resultof_any">
											<xsl:variable name="var1647_cur" as="xs:string" select="."/>
											<xsl:variable name="var1604_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1603_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1649_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1603_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1604_test_resultof_any">
												<xsl:variable name="var1646_cur" as="xs:string" select="."/>
												<xsl:variable name="var1606_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1605_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1649_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1605_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1606_test_resultof_any">
													<xsl:variable name="var1645_cur" as="xs:string" select="."/>
													<xsl:variable name="var1608_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1607_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1649_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1607_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1608_test_resultof_any">
														<xsl:variable name="var1644_cur" as="xs:string" select="."/>
														<xsl:variable name="var1610_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1609_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1649_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1609_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1610_test_resultof_any">
															<xsl:variable name="var1643_cur" as="xs:string" select="."/>
															<xsl:variable name="var1612_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1611_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1649_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1611_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1612_test_resultof_any">
																<xsl:variable name="var1642_cur" as="xs:string" select="."/>
																<xsl:variable name="var1614_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1613_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1649_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1613_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1614_test_resultof_any">
																	<xsl:variable name="var1641_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1616_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1615_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1649_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1615_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1616_test_resultof_any">
																		<xsl:variable name="var1640_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1618_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1617_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1649_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1617_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1618_test_resultof_any">
																			<xsl:variable name="var1639_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1620_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1619_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1649_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1619_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1620_test_resultof_any">
																				<xsl:variable name="var1638_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1622_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1621_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1649_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1621_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1622_test_resultof_any">
																					<xsl:variable name="var1637_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1624_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1623_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1649_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1623_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1624_test_resultof_any">
																						<xsl:variable name="var1636_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1626_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1625_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1649_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1625_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1626_test_resultof_any">
																							<xsl:variable name="var1635_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1628_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1627_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1649_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1627_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1628_test_resultof_any">
																								<xsl:variable name="var1634_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1630_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1629_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1649_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1629_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1630_test_resultof_any">
																									<xsl:variable name="var1633_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1632_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1649_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1631_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1649_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1631_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1632_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('8653-8' = $var1647_cur), ('8653-8' = $var1646_cur), ('8653-8' = $var1645_cur), ('8653-8' = $var1644_cur), ('8653-8' = $var1643_cur), ('8653-8' = $var1642_cur), ('8653-8' = $var1641_cur), ('8653-8' = $var1640_cur), ('8653-8' = $var1639_cur), ('8653-8' = $var1638_cur), ('8653-8' = $var1637_cur), ('8653-8' = $var1636_cur), ('8653-8' = $var1635_cur), ('8653-8' = $var1634_cur), ('8653-8' = $var1633_cur), ('8653-8' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1648_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1650_resultof_filter">
								<xsl:variable name="var1653_cur" as="node()" select="."/>
								<xsl:variable name="var1652_resource" as="node()*" select="$var1654_current/ns0:resource"/>
								<xsl:variable name="var1651_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1652_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1652_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1652_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1652_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1652_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1652_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1652_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1652_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1652_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1652_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1652_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1652_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1652_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1652_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1652_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1652_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1652_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1651_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1653_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAdvanceDirectives'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'42348-3'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Advance healthcare directives'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Advance healthcare directives'"/>
							</text>
						</code>
						<xsl:variable name="var1728_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1719_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1719_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1720_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1720_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1721_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1721_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1722_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1722_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1723_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1723_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1724_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1724_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1725_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1725_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1726_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1726_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1727_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1727_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1728_let">
							<xsl:variable name="var1718_current" as="node()" select="."/>
							<xsl:variable name="var1714_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1713_resource" as="node()*" select="$var1718_current/ns0:resource"/>
									<xsl:variable name="var1666_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1665_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1713_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1665_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1712_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1666_test_resultof_any">
											<xsl:variable name="var1711_cur" as="xs:string" select="."/>
											<xsl:variable name="var1668_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1667_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1713_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1667_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1668_test_resultof_any">
												<xsl:variable name="var1710_cur" as="xs:string" select="."/>
												<xsl:variable name="var1670_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1669_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1713_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1669_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1670_test_resultof_any">
													<xsl:variable name="var1709_cur" as="xs:string" select="."/>
													<xsl:variable name="var1672_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1671_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1713_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1671_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1672_test_resultof_any">
														<xsl:variable name="var1708_cur" as="xs:string" select="."/>
														<xsl:variable name="var1674_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1673_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1713_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1673_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1674_test_resultof_any">
															<xsl:variable name="var1707_cur" as="xs:string" select="."/>
															<xsl:variable name="var1676_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1675_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1713_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1675_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1676_test_resultof_any">
																<xsl:variable name="var1706_cur" as="xs:string" select="."/>
																<xsl:variable name="var1678_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1677_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1713_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1677_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1678_test_resultof_any">
																	<xsl:variable name="var1705_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1680_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1679_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1713_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1679_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1680_test_resultof_any">
																		<xsl:variable name="var1704_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1682_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1681_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1713_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1681_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1682_test_resultof_any">
																			<xsl:variable name="var1703_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1684_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1683_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1713_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1683_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1684_test_resultof_any">
																				<xsl:variable name="var1702_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1686_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1685_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1713_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1685_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1686_test_resultof_any">
																					<xsl:variable name="var1701_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1688_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1687_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1713_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1687_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1688_test_resultof_any">
																						<xsl:variable name="var1700_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1690_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1689_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1713_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1689_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1690_test_resultof_any">
																							<xsl:variable name="var1699_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1692_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1691_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1713_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1691_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1692_test_resultof_any">
																								<xsl:variable name="var1698_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1694_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1693_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1713_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1693_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1694_test_resultof_any">
																									<xsl:variable name="var1697_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1696_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1713_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1695_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1713_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1695_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1696_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('42348-3' = $var1711_cur), ('42348-3' = $var1710_cur), ('42348-3' = $var1709_cur), ('42348-3' = $var1708_cur), ('42348-3' = $var1707_cur), ('42348-3' = $var1706_cur), ('42348-3' = $var1705_cur), ('42348-3' = $var1704_cur), ('42348-3' = $var1703_cur), ('42348-3' = $var1702_cur), ('42348-3' = $var1701_cur), ('42348-3' = $var1700_cur), ('42348-3' = $var1699_cur), ('42348-3' = $var1698_cur), ('42348-3' = $var1697_cur), ('42348-3' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1712_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1714_resultof_filter">
								<xsl:variable name="var1717_cur" as="node()" select="."/>
								<xsl:variable name="var1716_resource" as="node()*" select="$var1718_current/ns0:resource"/>
								<xsl:variable name="var1715_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1716_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1716_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1716_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1716_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1716_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1716_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1716_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1716_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1716_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1716_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1716_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1716_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1716_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1716_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1716_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1716_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1716_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1715_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1717_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionTravelHx'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10182-4'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Travel Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Travel Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var1792_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1783_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1783_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1784_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1784_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1785_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1785_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1786_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1786_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1787_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1787_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1788_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1788_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1789_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1789_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1790_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1790_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1791_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1791_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1792_let">
							<xsl:variable name="var1782_current" as="node()" select="."/>
							<xsl:variable name="var1778_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1777_resource" as="node()*" select="$var1782_current/ns0:resource"/>
									<xsl:variable name="var1730_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1729_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1777_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1729_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1776_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1730_test_resultof_any">
											<xsl:variable name="var1775_cur" as="xs:string" select="."/>
											<xsl:variable name="var1732_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1731_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1777_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1731_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1732_test_resultof_any">
												<xsl:variable name="var1774_cur" as="xs:string" select="."/>
												<xsl:variable name="var1734_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1733_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1777_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1733_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1734_test_resultof_any">
													<xsl:variable name="var1773_cur" as="xs:string" select="."/>
													<xsl:variable name="var1736_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1735_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1777_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1735_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1736_test_resultof_any">
														<xsl:variable name="var1772_cur" as="xs:string" select="."/>
														<xsl:variable name="var1738_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1737_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1777_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1737_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1738_test_resultof_any">
															<xsl:variable name="var1771_cur" as="xs:string" select="."/>
															<xsl:variable name="var1740_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1739_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1777_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1739_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1740_test_resultof_any">
																<xsl:variable name="var1770_cur" as="xs:string" select="."/>
																<xsl:variable name="var1742_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1741_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1777_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1741_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1742_test_resultof_any">
																	<xsl:variable name="var1769_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1744_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1743_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1777_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1743_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1744_test_resultof_any">
																		<xsl:variable name="var1768_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1746_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1745_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1777_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1745_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1746_test_resultof_any">
																			<xsl:variable name="var1767_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1748_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1747_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1777_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1747_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1748_test_resultof_any">
																				<xsl:variable name="var1766_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1750_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1749_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1777_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1749_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1750_test_resultof_any">
																					<xsl:variable name="var1765_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1752_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1751_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1777_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1751_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1752_test_resultof_any">
																						<xsl:variable name="var1764_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1754_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1753_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1777_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1753_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1754_test_resultof_any">
																							<xsl:variable name="var1763_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1756_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1755_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1777_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1755_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1756_test_resultof_any">
																								<xsl:variable name="var1762_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1758_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1757_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1777_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1757_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1758_test_resultof_any">
																									<xsl:variable name="var1761_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1760_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1777_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1759_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1777_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1759_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1760_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('10182-4' = $var1775_cur), ('10182-4' = $var1774_cur), ('10182-4' = $var1773_cur), ('10182-4' = $var1772_cur), ('10182-4' = $var1771_cur), ('10182-4' = $var1770_cur), ('10182-4' = $var1769_cur), ('10182-4' = $var1768_cur), ('10182-4' = $var1767_cur), ('10182-4' = $var1766_cur), ('10182-4' = $var1765_cur), ('10182-4' = $var1764_cur), ('10182-4' = $var1763_cur), ('10182-4' = $var1762_cur), ('10182-4' = $var1761_cur), ('10182-4' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1776_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1778_resultof_filter">
								<xsl:variable name="var1781_cur" as="node()" select="."/>
								<xsl:variable name="var1780_resource" as="node()*" select="$var1782_current/ns0:resource"/>
								<xsl:variable name="var1779_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1780_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1780_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1780_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1780_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1780_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1780_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1780_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1780_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1780_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1780_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1780_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1780_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1780_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1780_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1780_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1780_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1780_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1779_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1781_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionPayers'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'48768-6'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Payment sources Document'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Payment sources Document'"/>
							</text>
						</code>
						<xsl:variable name="var1856_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1847_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1847_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1848_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1848_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1849_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1849_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1850_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1850_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1851_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1851_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1852_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1852_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1853_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1853_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1854_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1854_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1855_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1855_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1856_let">
							<xsl:variable name="var1846_current" as="node()" select="."/>
							<xsl:variable name="var1842_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1841_resource" as="node()*" select="$var1846_current/ns0:resource"/>
									<xsl:variable name="var1794_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1793_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1841_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1793_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1840_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1794_test_resultof_any">
											<xsl:variable name="var1839_cur" as="xs:string" select="."/>
											<xsl:variable name="var1796_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1795_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1841_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1795_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1796_test_resultof_any">
												<xsl:variable name="var1838_cur" as="xs:string" select="."/>
												<xsl:variable name="var1798_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1797_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1841_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1797_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1798_test_resultof_any">
													<xsl:variable name="var1837_cur" as="xs:string" select="."/>
													<xsl:variable name="var1800_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1799_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1841_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1799_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1800_test_resultof_any">
														<xsl:variable name="var1836_cur" as="xs:string" select="."/>
														<xsl:variable name="var1802_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1801_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1841_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1801_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1802_test_resultof_any">
															<xsl:variable name="var1835_cur" as="xs:string" select="."/>
															<xsl:variable name="var1804_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1803_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1841_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1803_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1804_test_resultof_any">
																<xsl:variable name="var1834_cur" as="xs:string" select="."/>
																<xsl:variable name="var1806_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1805_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1841_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1805_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1806_test_resultof_any">
																	<xsl:variable name="var1833_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1808_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1807_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1841_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1807_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1808_test_resultof_any">
																		<xsl:variable name="var1832_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1810_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1809_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1841_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1809_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1810_test_resultof_any">
																			<xsl:variable name="var1831_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1812_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1811_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1841_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1811_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1812_test_resultof_any">
																				<xsl:variable name="var1830_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1814_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1813_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1841_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1813_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1814_test_resultof_any">
																					<xsl:variable name="var1829_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1816_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1815_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1841_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1815_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1816_test_resultof_any">
																						<xsl:variable name="var1828_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1818_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1817_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1841_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1817_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1818_test_resultof_any">
																							<xsl:variable name="var1827_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1820_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1819_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1841_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1819_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1820_test_resultof_any">
																								<xsl:variable name="var1826_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1822_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1821_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1841_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1821_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1822_test_resultof_any">
																									<xsl:variable name="var1825_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1824_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1841_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1823_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1841_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1823_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1824_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('48768-6' = $var1839_cur), ('48768-6' = $var1838_cur), ('48768-6' = $var1837_cur), ('48768-6' = $var1836_cur), ('48768-6' = $var1835_cur), ('48768-6' = $var1834_cur), ('48768-6' = $var1833_cur), ('48768-6' = $var1832_cur), ('48768-6' = $var1831_cur), ('48768-6' = $var1830_cur), ('48768-6' = $var1829_cur), ('48768-6' = $var1828_cur), ('48768-6' = $var1827_cur), ('48768-6' = $var1826_cur), ('48768-6' = $var1825_cur), ('48768-6' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1840_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1842_resultof_filter">
								<xsl:variable name="var1845_cur" as="node()" select="."/>
								<xsl:variable name="var1844_resource" as="node()*" select="$var1846_current/ns0:resource"/>
								<xsl:variable name="var1843_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1844_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1844_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1844_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1844_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1844_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1844_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1844_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1844_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1844_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1844_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1844_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1844_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1844_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1844_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1844_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1844_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1844_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1843_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1845_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionAttachments'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'77599-9'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Additional documentation'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'Additional documentation'"/>
							</text>
						</code>
						<xsl:variable name="var1920_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1911_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1911_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1912_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1912_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1913_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1913_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1914_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1914_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1915_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1915_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1916_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1916_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1917_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1917_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1918_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1918_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1919_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1919_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1920_let">
							<xsl:variable name="var1910_current" as="node()" select="."/>
							<xsl:variable name="var1906_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1905_resource" as="node()*" select="$var1910_current/ns0:resource"/>
									<xsl:variable name="var1858_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1857_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1905_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1857_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1904_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1858_test_resultof_any">
											<xsl:variable name="var1903_cur" as="xs:string" select="."/>
											<xsl:variable name="var1860_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1859_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1905_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1859_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1860_test_resultof_any">
												<xsl:variable name="var1902_cur" as="xs:string" select="."/>
												<xsl:variable name="var1862_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1861_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1905_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1861_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1862_test_resultof_any">
													<xsl:variable name="var1901_cur" as="xs:string" select="."/>
													<xsl:variable name="var1864_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1863_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1905_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1863_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1864_test_resultof_any">
														<xsl:variable name="var1900_cur" as="xs:string" select="."/>
														<xsl:variable name="var1866_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1865_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1905_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1865_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1866_test_resultof_any">
															<xsl:variable name="var1899_cur" as="xs:string" select="."/>
															<xsl:variable name="var1868_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1867_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1905_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1867_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1868_test_resultof_any">
																<xsl:variable name="var1898_cur" as="xs:string" select="."/>
																<xsl:variable name="var1870_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1869_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1905_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1869_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1870_test_resultof_any">
																	<xsl:variable name="var1897_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1872_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1871_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1905_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1871_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1872_test_resultof_any">
																		<xsl:variable name="var1896_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1874_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1873_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1905_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1873_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1874_test_resultof_any">
																			<xsl:variable name="var1895_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1876_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1875_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1905_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1875_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1876_test_resultof_any">
																				<xsl:variable name="var1894_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1878_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1877_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1905_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1877_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1878_test_resultof_any">
																					<xsl:variable name="var1893_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1880_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1879_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1905_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1879_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1880_test_resultof_any">
																						<xsl:variable name="var1892_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1882_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1881_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1905_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1881_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1882_test_resultof_any">
																							<xsl:variable name="var1891_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1884_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1883_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1905_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1883_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1884_test_resultof_any">
																								<xsl:variable name="var1890_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1886_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1885_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1905_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1885_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1886_test_resultof_any">
																									<xsl:variable name="var1889_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1888_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1905_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1887_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1905_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1887_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1888_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('77599-9' = $var1903_cur), ('77599-9' = $var1902_cur), ('77599-9' = $var1901_cur), ('77599-9' = $var1900_cur), ('77599-9' = $var1899_cur), ('77599-9' = $var1898_cur), ('77599-9' = $var1897_cur), ('77599-9' = $var1896_cur), ('77599-9' = $var1895_cur), ('77599-9' = $var1894_cur), ('77599-9' = $var1893_cur), ('77599-9' = $var1892_cur), ('77599-9' = $var1891_cur), ('77599-9' = $var1890_cur), ('77599-9' = $var1889_cur), ('77599-9' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1904_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1906_resultof_filter">
								<xsl:variable name="var1909_cur" as="node()" select="."/>
								<xsl:variable name="var1908_resource" as="node()*" select="$var1910_current/ns0:resource"/>
								<xsl:variable name="var1907_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1908_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1908_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1908_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1908_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1908_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1908_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1908_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1908_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1908_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1908_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1908_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1908_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1908_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1908_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1908_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1908_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1908_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1907_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1909_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'sectionEncounters'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var2004_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'46240-8'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'History of Hospitalizations+Outpatient visits Narrative'"/>
								</display>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'History of Hospitalizations+Outpatient visits Narrative'"/>
							</text>
						</code>
						<xsl:variable name="var1984_let" as="node()*">
							<xsl:for-each select="$var2003_ku_z_propz_admu">
								<xsl:variable name="var1975_resultof_ku_z_propz_admu" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_admu">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_admuType" as="node()">
											<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_admuType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1975_resultof_ku_z_propz_admu">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2001_ku_z_propz_dvp">
								<xsl:variable name="var1976_resultof_ku_z_propz_dvp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_dvp">
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_dvpType" as="node()">
											<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
													<xsl:with-param name="input" select="." as="node()"/>
												</xsl:call-template>
											</ku_z_propz_dvpType>
										</xsl:with-param>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1976_resultof_ku_z_propz_dvp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1977_resultof_ku_z_propz_urg" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_urg">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1977_resultof_ku_z_propz_urg">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:for-each select="$var2002_ku_z_propz_hosp">
								<xsl:variable name="var1978_resultof_ku_z_propz_hosp" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_hosp">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_hospType" as="node()">
											<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_hospType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1978_resultof_ku_z_propz_hosp">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:for-each select="$var2005_ku_z_propz_sprij">
								<xsl:variable name="var1979_resultof_ku_z_propz_sprij" as="node()*">
									<xsl:call-template name="provisio:ku_z_propz_sprij">
										<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
										<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
										<xsl:with-param name="patientReference" as="node()">
											<Reference>
												<xsl:sequence select="$var2000_let"/>
											</Reference>
										</xsl:with-param>
										<xsl:with-param name="ku_z_propz_sprijType" as="node()">
											<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
												<xsl:sequence select="(./@node(), ./node())"/>
											</ku_z_propz_sprijType>
										</xsl:with-param>
										<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1979_resultof_ku_z_propz_sprij">
									<entry>
										<xsl:sequence select="(./@node(), ./node())"/>
									</entry>
								</xsl:for-each>
							</xsl:for-each>
							<xsl:variable name="var1980_resultof_ku_z_propz_anam" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_anam">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1980_resultof_ku_z_propz_anam">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1981_resultof_ku_z_propz_prubh" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_prubh">
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1981_resultof_ku_z_propz_prubh">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1982_resultof_ku_z_propz_sprop" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_sprop">
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1982_resultof_ku_z_propz_sprop">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
							<xsl:variable name="var1983_resultof_ku_z_propz_dopor" as="node()*">
								<xsl:call-template name="provisio:ku_z_propz_dopor">
									<xsl:with-param name="patientReference" as="node()">
										<Reference>
											<xsl:sequence select="$var2000_let"/>
										</Reference>
									</xsl:with-param>
									<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
									<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
									<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
									<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1983_resultof_ku_z_propz_dopor">
								<entry>
									<xsl:sequence select="(./@node(), ./node())"/>
								</entry>
							</xsl:for-each>
						</xsl:variable>
						<xsl:for-each select="$var1984_let">
							<xsl:variable name="var1974_current" as="node()" select="."/>
							<xsl:variable name="var1970_resultof_filter" as="node()*">
								<xsl:for-each select="ns0:fullUrl/@value">
									<xsl:variable name="var1969_resource" as="node()*" select="$var1974_current/ns0:resource"/>
									<xsl:variable name="var1922_test_resultof_any" as="xs:string+">
										<xsl:choose>
											<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
												<xsl:variable name="var1921_map_of_resource" as="xs:string+">
													<xsl:for-each select="$var1969_resource/ns0:Observation/ns0:meta/ns0:tag/ns0:code/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:variable>
												<xsl:sequence select="$var1921_map_of_resource"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:sequence select="''"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:variable>
									<xsl:variable name="var1968_map_of_test_any" as="xs:boolean*">
										<xsl:for-each select="$var1922_test_resultof_any">
											<xsl:variable name="var1967_cur" as="xs:string" select="."/>
											<xsl:variable name="var1924_test_resultof_any" as="xs:string+">
												<xsl:choose>
													<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
														<xsl:variable name="var1923_map_of_resource" as="xs:string+">
															<xsl:for-each select="$var1969_resource/ns0:Practitioner/ns0:meta/ns0:tag/ns0:code/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:sequence select="$var1923_map_of_resource"/>
													</xsl:when>
													<xsl:otherwise>
														<xsl:sequence select="''"/>
													</xsl:otherwise>
												</xsl:choose>
											</xsl:variable>
											<xsl:for-each select="$var1924_test_resultof_any">
												<xsl:variable name="var1966_cur" as="xs:string" select="."/>
												<xsl:variable name="var1926_test_resultof_any" as="xs:string+">
													<xsl:choose>
														<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
															<xsl:variable name="var1925_map_of_resource" as="xs:string+">
																<xsl:for-each select="$var1969_resource/ns0:AllergyIntolerance/ns0:meta/ns0:tag/ns0:code/@value">
																	<xsl:sequence select="fn:string(.)"/>
																</xsl:for-each>
															</xsl:variable>
															<xsl:sequence select="$var1925_map_of_resource"/>
														</xsl:when>
														<xsl:otherwise>
															<xsl:sequence select="''"/>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:variable>
												<xsl:for-each select="$var1926_test_resultof_any">
													<xsl:variable name="var1965_cur" as="xs:string" select="."/>
													<xsl:variable name="var1928_test_resultof_any" as="xs:string+">
														<xsl:choose>
															<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																<xsl:variable name="var1927_map_of_resource" as="xs:string+">
																	<xsl:for-each select="$var1969_resource/ns0:Flag/ns0:meta/ns0:tag/ns0:code/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:variable>
																<xsl:sequence select="$var1927_map_of_resource"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:sequence select="''"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													<xsl:for-each select="$var1928_test_resultof_any">
														<xsl:variable name="var1964_cur" as="xs:string" select="."/>
														<xsl:variable name="var1930_test_resultof_any" as="xs:string+">
															<xsl:choose>
																<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																	<xsl:variable name="var1929_map_of_resource" as="xs:string+">
																		<xsl:for-each select="$var1969_resource/ns0:Condition/ns0:meta/ns0:tag/ns0:code/@value">
																			<xsl:sequence select="fn:string(.)"/>
																		</xsl:for-each>
																	</xsl:variable>
																	<xsl:sequence select="$var1929_map_of_resource"/>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:sequence select="''"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:for-each select="$var1930_test_resultof_any">
															<xsl:variable name="var1963_cur" as="xs:string" select="."/>
															<xsl:variable name="var1932_test_resultof_any" as="xs:string+">
																<xsl:choose>
																	<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																		<xsl:variable name="var1931_map_of_resource" as="xs:string+">
																			<xsl:for-each select="$var1969_resource/ns0:DeviceUseStatement/ns0:meta/ns0:tag/ns0:code/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:variable>
																		<xsl:sequence select="$var1931_map_of_resource"/>
																	</xsl:when>
																	<xsl:otherwise>
																		<xsl:sequence select="''"/>
																	</xsl:otherwise>
																</xsl:choose>
															</xsl:variable>
															<xsl:for-each select="$var1932_test_resultof_any">
																<xsl:variable name="var1962_cur" as="xs:string" select="."/>
																<xsl:variable name="var1934_test_resultof_any" as="xs:string+">
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																			<xsl:variable name="var1933_map_of_resource" as="xs:string+">
																				<xsl:for-each select="$var1969_resource/ns0:Procedure/ns0:meta/ns0:tag/ns0:code/@value">
																					<xsl:sequence select="fn:string(.)"/>
																				</xsl:for-each>
																			</xsl:variable>
																			<xsl:sequence select="$var1933_map_of_resource"/>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:sequence select="''"/>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:variable>
																<xsl:for-each select="$var1934_test_resultof_any">
																	<xsl:variable name="var1961_cur" as="xs:string" select="."/>
																	<xsl:variable name="var1936_test_resultof_any" as="xs:string+">
																		<xsl:choose>
																			<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																				<xsl:variable name="var1935_map_of_resource" as="xs:string+">
																					<xsl:for-each select="$var1969_resource/ns0:Immunization/ns0:meta/ns0:tag/ns0:code/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:variable>
																				<xsl:sequence select="$var1935_map_of_resource"/>
																			</xsl:when>
																			<xsl:otherwise>
																				<xsl:sequence select="''"/>
																			</xsl:otherwise>
																		</xsl:choose>
																	</xsl:variable>
																	<xsl:for-each select="$var1936_test_resultof_any">
																		<xsl:variable name="var1960_cur" as="xs:string" select="."/>
																		<xsl:variable name="var1938_test_resultof_any" as="xs:string+">
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																					<xsl:variable name="var1937_map_of_resource" as="xs:string+">
																						<xsl:for-each select="$var1969_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:tag/ns0:code/@value">
																							<xsl:sequence select="fn:string(.)"/>
																						</xsl:for-each>
																					</xsl:variable>
																					<xsl:sequence select="$var1937_map_of_resource"/>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:sequence select="''"/>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:variable>
																		<xsl:for-each select="$var1938_test_resultof_any">
																			<xsl:variable name="var1959_cur" as="xs:string" select="."/>
																			<xsl:variable name="var1940_test_resultof_any" as="xs:string+">
																				<xsl:choose>
																					<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																						<xsl:variable name="var1939_map_of_resource" as="xs:string+">
																							<xsl:for-each select="$var1969_resource/ns0:MedicationAdministration/ns0:meta/ns0:tag/ns0:code/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:variable>
																						<xsl:sequence select="$var1939_map_of_resource"/>
																					</xsl:when>
																					<xsl:otherwise>
																						<xsl:sequence select="''"/>
																					</xsl:otherwise>
																				</xsl:choose>
																			</xsl:variable>
																			<xsl:for-each select="$var1940_test_resultof_any">
																				<xsl:variable name="var1958_cur" as="xs:string" select="."/>
																				<xsl:variable name="var1942_test_resultof_any" as="xs:string+">
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																							<xsl:variable name="var1941_map_of_resource" as="xs:string+">
																								<xsl:for-each select="$var1969_resource/ns0:DiagnosticReport/ns0:meta/ns0:tag/ns0:code/@value">
																									<xsl:sequence select="fn:string(.)"/>
																								</xsl:for-each>
																							</xsl:variable>
																							<xsl:sequence select="$var1941_map_of_resource"/>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:sequence select="''"/>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:variable>
																				<xsl:for-each select="$var1942_test_resultof_any">
																					<xsl:variable name="var1957_cur" as="xs:string" select="."/>
																					<xsl:variable name="var1944_test_resultof_any" as="xs:string+">
																						<xsl:choose>
																							<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																								<xsl:variable name="var1943_map_of_resource" as="xs:string+">
																									<xsl:for-each select="$var1969_resource/ns0:CarePlan/ns0:meta/ns0:tag/ns0:code/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:variable>
																								<xsl:sequence select="$var1943_map_of_resource"/>
																							</xsl:when>
																							<xsl:otherwise>
																								<xsl:sequence select="''"/>
																							</xsl:otherwise>
																						</xsl:choose>
																					</xsl:variable>
																					<xsl:for-each select="$var1944_test_resultof_any">
																						<xsl:variable name="var1956_cur" as="xs:string" select="."/>
																						<xsl:variable name="var1946_test_resultof_any" as="xs:string+">
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																									<xsl:variable name="var1945_map_of_resource" as="xs:string+">
																										<xsl:for-each select="$var1969_resource/ns0:Consent/ns0:meta/ns0:tag/ns0:code/@value">
																											<xsl:sequence select="fn:string(.)"/>
																										</xsl:for-each>
																									</xsl:variable>
																									<xsl:sequence select="$var1945_map_of_resource"/>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:sequence select="''"/>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:variable>
																						<xsl:for-each select="$var1946_test_resultof_any">
																							<xsl:variable name="var1955_cur" as="xs:string" select="."/>
																							<xsl:variable name="var1948_test_resultof_any" as="xs:string+">
																								<xsl:choose>
																									<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																										<xsl:variable name="var1947_map_of_resource" as="xs:string+">
																											<xsl:for-each select="$var1969_resource/ns0:Composition/ns0:meta/ns0:tag/ns0:code/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:variable>
																										<xsl:sequence select="$var1947_map_of_resource"/>
																									</xsl:when>
																									<xsl:otherwise>
																										<xsl:sequence select="''"/>
																									</xsl:otherwise>
																								</xsl:choose>
																							</xsl:variable>
																							<xsl:for-each select="$var1948_test_resultof_any">
																								<xsl:variable name="var1954_cur" as="xs:string" select="."/>
																								<xsl:variable name="var1950_test_resultof_any" as="xs:string+">
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																											<xsl:variable name="var1949_map_of_resource" as="xs:string+">
																												<xsl:for-each select="$var1969_resource/ns0:Encounter/ns0:meta/ns0:tag/ns0:code/@value">
																													<xsl:sequence select="fn:string(.)"/>
																												</xsl:for-each>
																											</xsl:variable>
																											<xsl:sequence select="$var1949_map_of_resource"/>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:sequence select="''"/>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:variable>
																								<xsl:for-each select="$var1950_test_resultof_any">
																									<xsl:variable name="var1953_cur" as="xs:string" select="."/>
																									<xsl:variable name="var1952_test_resultof_any" as="xs:string+">
																										<xsl:choose>
																											<xsl:when test="fn:exists(($var1969_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:tag)[fn:exists((./ns0:code)[fn:exists(@value)])])])])])">
																												<xsl:variable name="var1951_map_of_resource" as="xs:string+">
																													<xsl:for-each select="$var1969_resource/ns0:DocumentReference/ns0:meta/ns0:tag/ns0:code/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:variable>
																												<xsl:sequence select="$var1951_map_of_resource"/>
																											</xsl:when>
																											<xsl:otherwise>
																												<xsl:sequence select="''"/>
																											</xsl:otherwise>
																										</xsl:choose>
																									</xsl:variable>
																									<xsl:for-each select="$var1952_test_resultof_any">
																										<xsl:sequence select="fn:exists(((('46240-8' = $var1967_cur), ('46240-8' = $var1966_cur), ('46240-8' = $var1965_cur), ('46240-8' = $var1964_cur), ('46240-8' = $var1963_cur), ('46240-8' = $var1962_cur), ('46240-8' = $var1961_cur), ('46240-8' = $var1960_cur), ('46240-8' = $var1959_cur), ('46240-8' = $var1958_cur), ('46240-8' = $var1957_cur), ('46240-8' = $var1956_cur), ('46240-8' = $var1955_cur), ('46240-8' = $var1954_cur), ('46240-8' = $var1953_cur), ('46240-8' = .)))[.])"/>
																									</xsl:for-each>
																								</xsl:for-each>
																							</xsl:for-each>
																						</xsl:for-each>
																					</xsl:for-each>
																				</xsl:for-each>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:variable>
									<xsl:if test="fn:exists(($var1968_map_of_test_any)[.])">
										<xsl:sequence select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:variable>
							<xsl:for-each select="$var1970_resultof_filter">
								<xsl:variable name="var1973_cur" as="node()" select="."/>
								<xsl:variable name="var1972_resource" as="node()*" select="$var1974_current/ns0:resource"/>
								<xsl:variable name="var1971_test_resultof_any" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:Observation)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
											<xsl:for-each select="$var1972_resource/ns0:Observation/ns0:meta/ns0:versionId/@value">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:choose>
												<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:Practitioner)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
													<xsl:for-each select="$var1972_resource/ns0:Practitioner/ns0:meta/ns0:versionId/@value">
														<xsl:sequence select="fn:string(.)"/>
													</xsl:for-each>
												</xsl:when>
												<xsl:otherwise>
													<xsl:choose>
														<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:AllergyIntolerance)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
															<xsl:for-each select="$var1972_resource/ns0:AllergyIntolerance/ns0:meta/ns0:versionId/@value">
																<xsl:sequence select="fn:string(.)"/>
															</xsl:for-each>
														</xsl:when>
														<xsl:otherwise>
															<xsl:choose>
																<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:Flag)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																	<xsl:for-each select="$var1972_resource/ns0:Flag/ns0:meta/ns0:versionId/@value">
																		<xsl:sequence select="fn:string(.)"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:choose>
																		<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:Condition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																			<xsl:for-each select="$var1972_resource/ns0:Condition/ns0:meta/ns0:versionId/@value">
																				<xsl:sequence select="fn:string(.)"/>
																			</xsl:for-each>
																		</xsl:when>
																		<xsl:otherwise>
																			<xsl:choose>
																				<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:DeviceUseStatement)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																					<xsl:for-each select="$var1972_resource/ns0:DeviceUseStatement/ns0:meta/ns0:versionId/@value">
																						<xsl:sequence select="fn:string(.)"/>
																					</xsl:for-each>
																				</xsl:when>
																				<xsl:otherwise>
																					<xsl:choose>
																						<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:Procedure)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																							<xsl:for-each select="$var1972_resource/ns0:Procedure/ns0:meta/ns0:versionId/@value">
																								<xsl:sequence select="fn:string(.)"/>
																							</xsl:for-each>
																						</xsl:when>
																						<xsl:otherwise>
																							<xsl:choose>
																								<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:Immunization)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																									<xsl:for-each select="$var1972_resource/ns0:Immunization/ns0:meta/ns0:versionId/@value">
																										<xsl:sequence select="fn:string(.)"/>
																									</xsl:for-each>
																								</xsl:when>
																								<xsl:otherwise>
																									<xsl:choose>
																										<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:FamilyMemberHistory)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																											<xsl:for-each select="$var1972_resource/ns0:FamilyMemberHistory/ns0:meta/ns0:versionId/@value">
																												<xsl:sequence select="fn:string(.)"/>
																											</xsl:for-each>
																										</xsl:when>
																										<xsl:otherwise>
																											<xsl:choose>
																												<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:MedicationAdministration)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																													<xsl:for-each select="$var1972_resource/ns0:MedicationAdministration/ns0:meta/ns0:versionId/@value">
																														<xsl:sequence select="fn:string(.)"/>
																													</xsl:for-each>
																												</xsl:when>
																												<xsl:otherwise>
																													<xsl:choose>
																														<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:DiagnosticReport)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																															<xsl:for-each select="$var1972_resource/ns0:DiagnosticReport/ns0:meta/ns0:versionId/@value">
																																<xsl:sequence select="fn:string(.)"/>
																															</xsl:for-each>
																														</xsl:when>
																														<xsl:otherwise>
																															<xsl:choose>
																																<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:CarePlan)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																	<xsl:for-each select="$var1972_resource/ns0:CarePlan/ns0:meta/ns0:versionId/@value">
																																		<xsl:sequence select="fn:string(.)"/>
																																	</xsl:for-each>
																																</xsl:when>
																																<xsl:otherwise>
																																	<xsl:choose>
																																		<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:Consent)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																			<xsl:for-each select="$var1972_resource/ns0:Consent/ns0:meta/ns0:versionId/@value">
																																				<xsl:sequence select="fn:string(.)"/>
																																			</xsl:for-each>
																																		</xsl:when>
																																		<xsl:otherwise>
																																			<xsl:choose>
																																				<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:Composition)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																					<xsl:for-each select="$var1972_resource/ns0:Composition/ns0:meta/ns0:versionId/@value">
																																						<xsl:sequence select="fn:string(.)"/>
																																					</xsl:for-each>
																																				</xsl:when>
																																				<xsl:otherwise>
																																					<xsl:choose>
																																						<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:Encounter)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																							<xsl:for-each select="$var1972_resource/ns0:Encounter/ns0:meta/ns0:versionId/@value">
																																								<xsl:sequence select="fn:string(.)"/>
																																							</xsl:for-each>
																																						</xsl:when>
																																						<xsl:otherwise>
																																							<xsl:choose>
																																								<xsl:when test="fn:exists(($var1972_resource)[fn:exists((./ns0:DocumentReference)[fn:exists((./ns0:meta)[fn:exists((./ns0:versionId)[fn:exists(@value)])])])])">
																																									<xsl:for-each select="$var1972_resource/ns0:DocumentReference/ns0:meta/ns0:versionId/@value">
																																										<xsl:sequence select="fn:string(.)"/>
																																									</xsl:for-each>
																																								</xsl:when>
																																								<xsl:otherwise>
																																									<xsl:sequence select="''"/>
																																								</xsl:otherwise>
																																							</xsl:choose>
																																						</xsl:otherwise>
																																					</xsl:choose>
																																				</xsl:otherwise>
																																			</xsl:choose>
																																		</xsl:otherwise>
																																	</xsl:choose>
																																</xsl:otherwise>
																															</xsl:choose>
																														</xsl:otherwise>
																													</xsl:choose>
																												</xsl:otherwise>
																											</xsl:choose>
																										</xsl:otherwise>
																									</xsl:choose>
																								</xsl:otherwise>
																							</xsl:choose>
																						</xsl:otherwise>
																					</xsl:choose>
																				</xsl:otherwise>
																			</xsl:choose>
																		</xsl:otherwise>
																	</xsl:choose>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:otherwise>
													</xsl:choose>
												</xsl:otherwise>
											</xsl:choose>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<entry>
									<reference>
										<xsl:for-each select="$var1971_test_resultof_any">
											<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(xs:string(xs:anyURI(fn:string($var1973_cur))), '/_history/'), .)"/>
										</xsl:for-each>
									</reference>
								</entry>
							</xsl:for-each>
						</xsl:for-each>
					</section>
				</Composition>
			</resource>
		</entry>
		<xsl:for-each select="$var2003_ku_z_propz_admu">
			<xsl:variable name="var1985_resultof_ku_z_propz_admu" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_admu">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var2000_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ku_z_propz_admuType" as="node()">
						<ku_z_propz_admuType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_admuType>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1985_resultof_ku_z_propz_admu">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$var2001_ku_z_propz_dvp">
			<xsl:variable name="var1986_resultof_ku_z_propz_dvp" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_dvp">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var2000_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ku_z_propz_dvpType" as="node()">
						<ku_z_propz_dvpType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:call-template name="tbf:tbf2_ku_z_propz_dvpType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</ku_z_propz_dvpType>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1986_resultof_ku_z_propz_dvp">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$var2002_ku_z_propz_hosp">
			<xsl:variable name="var1987_resultof_ku_z_propz_hosp" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_hosp">
					<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
					<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var2000_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ku_z_propz_hospType" as="node()">
						<ku_z_propz_hospType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_hospType>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1987_resultof_ku_z_propz_hosp">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var1988_resultof_ku_z_propz_urg" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_urg">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2000_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="ku_z_propz_urg" select="$var1995_create_ku_z_propz_urgType_of_ku_z_propz_urg" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1988_resultof_ku_z_propz_urg">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$var2005_ku_z_propz_sprij">
			<xsl:variable name="var1989_resultof_ku_z_propz_sprij" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz_sprij">
					<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
					<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="$var2000_let"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ku_z_propz_sprijType" as="node()">
						<ku_z_propz_sprijType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propz_sprijType>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1989_resultof_ku_z_propz_sprij">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:variable name="var1990_resultof_ku_z_propz_anam" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_anam">
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2000_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="ku_z_propz_anamType" select="$var1999_create_ku_z_propz_anamType_of_ku_z_propz_anam" as="node()*"/>
				<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1990_resultof_ku_z_propz_anam">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var1991_resultof_ku_z_propz_prubh" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_prubh">
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2000_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="ku_z_propz_prubhType" select="$var1997_create_ku_z_propz_prubhType_of_ku_z_propz_prubh" as="node()*"/>
				<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1991_resultof_ku_z_propz_prubh">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var1992_resultof_ku_z_propz_sprop" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_sprop">
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2000_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="ku_z_propz_spropType" select="$var1996_create_ku_z_propz_spropType_of_ku_z_propz_sprop" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1992_resultof_ku_z_propz_sprop">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var1993_resultof_ku_z_propz_dopor" as="node()*">
			<xsl:call-template name="provisio:ku_z_propz_dopor">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var2000_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
				<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				<xsl:with-param name="dat_prov" select="$var1994_create_dat_prov_of_dat_prov" as="node()*"/>
				<xsl:with-param name="ku_z_propz_doporType" select="$var1998_create_ku_z_propz_doporType_of_ku_z_propz_dopor" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1993_resultof_ku_z_propz_dopor">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:ku_z">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="organizatinReference" select="()"/>
		<xsl:param name="practitionerReference" select="()"/>
		<xsl:param name="ku_zType" select="()"/>
		<xsl:for-each select="$ku_zType/ns2:ku_z_propz">
			<xsl:variable name="var1_resultof_ku_z_propz" as="node()*">
				<xsl:call-template name="provisio:ku_z_propz">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ku_z_propzType" as="node()">
						<ku_z_propzType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ku_z_propzType>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" as="node()*">
						<xsl:for-each select="$ku_zType/ns2:dat_prov">
							<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</dat_prov>
						</xsl:for-each>
					</xsl:with-param>
					<xsl:with-param name="organizatinReference" select="$organizatinReference" as="xs:string*"/>
					<xsl:with-param name="practitionerReference" select="$practitionerReference" as="xs:string*"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1_resultof_ku_z_propz">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:is">
		<xsl:param name="is" select="()"/>
		<xsl:variable name="var5_guid" as="node()?" select="$is/@guid"/>
		<xsl:variable name="var6_vguid" as="node()?" select="$is/@vguid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var5_guid">
				<xsl:for-each select="$var6_vguid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var6_vguid">
							<xsl:variable name="var1_resultof_Reference_Organization" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Organization">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Organization">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Organization>
					<xsl:for-each select="$var5_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var6_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
					</meta>
					<xsl:for-each select="$is/@ico">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/ico'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@icz">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/icz'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@icp">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/icp'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@icl">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/icl'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@pcz">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/pcz'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@oddel">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/oddel'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@oavl">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/oavl'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<active>
						<xsl:attribute name="value" namespace="" select="xs:string(fn:true())"/>
					</active>
					<xsl:for-each select="$is/ns1:a">
						<xsl:variable name="var4_cur" as="node()" select="."/>
						<address>
							<use>
								<xsl:attribute name="value" namespace="" select="'work'"/>
							</use>
							<text>
								<xsl:for-each select="ns1:jmeno">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
							<xsl:for-each select="ns1:adr">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:dop1">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:dop2">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:mesto">
								<city>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</city>
							</xsl:for-each>
							<xsl:for-each select="ns1:psc">
								<postalCode>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
								</postalCode>
							</xsl:for-each>
							<xsl:for-each select="ns1:stat">
								<xsl:variable name="var3_cur" as="node()" select="."/>
								<xsl:for-each select="$var4_cur/ns1:stat_text">
									<country>
										<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:string($var3_cur), ' - '), fn:string(.))"/>
									</country>
								</xsl:for-each>
							</xsl:for-each>
						</address>
					</xsl:for-each>
				</Organization>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:FullURL_PractitionerRole">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('PractitionerRole/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:FullURL_Practitioner">
		<xsl:param name="GUID" select="()"/>
		<xsl:sequence select="fn:concat('Practitioner/', $GUID)"/>
	</xsl:template>
	<xsl:template name="provisio:garant_dat">
		<xsl:param name="garant_dat" select="()"/>
		<xsl:variable name="var5_vguid" as="node()?" select="$garant_dat/@vguid"/>
		<xsl:variable name="var6_guid" as="node()?" select="$garant_dat/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<fullUrl>
				<xsl:for-each select="$var6_guid">
					<xsl:for-each select="$var6_guid">
						<xsl:variable name="var1_resultof_FullURL_Practitioner" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_Practitioner">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var1_resultof_FullURL_Practitioner">
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</fullUrl>
			<resource>
				<Practitioner>
					<id>
						<xsl:for-each select="$var6_guid">
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</xsl:for-each>
					</id>
					<meta>
						<versionId>
							<xsl:for-each select="$var5_vguid">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</versionId>
					</meta>
					<xsl:for-each select="$garant_dat/@id_zp">
						<identifier>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$garant_dat/@id_garant">
						<identifier>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$garant_dat/@id_clk">
						<identifier>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<name>
						<text>
							<xsl:attribute name="value" namespace="" select="fn:string($garant_dat)"/>
						</text>
					</name>
				</Practitioner>
			</resource>
		</entry>
		<entry xmlns="http://hl7.org/fhir">
			<fullUrl>
				<xsl:for-each select="$var6_guid">
					<xsl:for-each select="$var6_guid">
						<xsl:variable name="var2_resultof_FullURL_PractitionerRole" as="xs:string?">
							<xsl:call-template name="provisio:FullURL_PractitionerRole">
								<xsl:with-param name="GUID" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var2_resultof_FullURL_PractitionerRole">
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</fullUrl>
			<resource>
				<PractitionerRole>
					<practitioner>
						<reference>
							<xsl:for-each select="$var6_guid">
								<xsl:for-each select="$var5_vguid">
									<xsl:for-each select="$var6_guid">
										<xsl:variable name="var4_cur" as="node()" select="."/>
										<xsl:for-each select="$var5_vguid">
											<xsl:variable name="var3_resultof_Reference_Practitioner" as="xs:string?">
												<xsl:call-template name="provisio:Reference_Practitioner">
													<xsl:with-param name="GUID" select="fn:string($var4_cur)" as="xs:string"/>
													<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var3_resultof_Reference_Practitioner">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</reference>
					</practitioner>
					<xsl:for-each select="$garant_dat/@role_klic">
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/WWBSK.htm'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
								<display>
									<xsl:for-each select="$garant_dat/@role_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</code>
					</xsl:for-each>
					<xsl:for-each select="$garant_dat/@odbornost">
						<specialty>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dasta.mzcr.cz/UZAGT.htm'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
							</coding>
						</specialty>
					</xsl:for-each>
				</PractitionerRole>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:Reference_Practitioner">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Practitioner/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:Reference_Organization">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Organization/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf1_textType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::ns2:autor)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf3_autorType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:ptext)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf4_">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:ktext)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf5_ktextType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:priloha)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf6_prilohaType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:textAny)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf7_AnyType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf2_ku_z_propz_dvpType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::ns2:dat_dvp)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf8_dat_xxType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:dvp_typ)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:dvp_koment)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:dvp_dotstav)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf9_mknorphaType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:dvp_dokum)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf10_textType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf3_autorType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_zp">
			<xsl:attribute name="id_zp" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_autor">
			<xsl:attribute name="id_autor" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@odbornost">
			<xsl:attribute name="odbornost" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_clk">
			<xsl:attribute name="id_clk" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@role_klic">
			<xsl:attribute name="role_klic" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@role_text">
			<xsl:attribute name="role_text" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf4_">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@xml:space">
			<xsl:attribute name="xml:space" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf5_ktextType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@encode">
			<xsl:attribute name="encode" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@typ">
			<xsl:attribute name="typ" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf6_prilohaType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@zdroj">
			<xsl:attribute name="zdroj" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@typ">
			<xsl:attribute name="typ" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf7_AnyType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::*)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="(./@node(), ./node())"/>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf8_dat_xxType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@format">
			<xsl:attribute name="format" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf9_mknorphaType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::ns2:kod_syst)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:kod)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:kod_text)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="fn:string(.)"/>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf10_textType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::ns2:autor)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf11_autorType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:ptext)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf12_">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:ktext)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf13_ktextType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:priloha)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf14_prilohaType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
					<xsl:if test="fn:boolean(self::ns2:textAny)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:call-template name="tbf:tbf15_AnyType">
								<xsl:with-param name="input" select="." as="node()"/>
							</xsl:call-template>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="tbf:tbf11_autorType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@guid">
			<xsl:attribute name="guid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@vguid">
			<xsl:attribute name="vguid" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_zp">
			<xsl:attribute name="id_zp" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_autor">
			<xsl:attribute name="id_autor" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@odbornost">
			<xsl:attribute name="odbornost" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@id_clk">
			<xsl:attribute name="id_clk" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@role_klic">
			<xsl:attribute name="role_klic" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@role_text">
			<xsl:attribute name="role_text" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf12_">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@xml:space">
			<xsl:attribute name="xml:space" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf13_ktextType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@encode">
			<xsl:attribute name="encode" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@typ">
			<xsl:attribute name="typ" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf14_prilohaType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/@zdroj">
			<xsl:attribute name="zdroj" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:for-each select="$input/@typ">
			<xsl:attribute name="typ" select="fn:string(.)"/>
		</xsl:for-each>
		<xsl:sequence select="fn:string($input)"/>
	</xsl:template>
	<xsl:template name="tbf:tbf15_AnyType">
		<xsl:param name="input" select="()"/>
		<xsl:for-each select="$input/node()">
			<xsl:choose>
				<xsl:when test="fn:boolean(self::*)">
					<xsl:if test="fn:boolean(self::*)">
						<xsl:element name="{fn:string(fn:node-name(.))}" namespace="{fn:namespace-uri-from-QName(fn:node-name(.))}">
							<xsl:sequence select="(./@node(), ./node())"/>
						</xsl:element>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>
					<xsl:if test="fn:not(fn:boolean(self::text()))">
						<xsl:sequence select="."/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="vmf:vmf1_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'inactive'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf2_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'24484000'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'6736007'"/>
			</xsl:when>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'255604002'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf3_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'Severe'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'Moderate'"/>
			</xsl:when>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'Mild'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf4_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='R'">
				<xsl:copy-of select="'Registered'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'Preliminary'"/>
			</xsl:when>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'Final'"/>
			</xsl:when>
			<xsl:when test="$input='Z'">
				<xsl:copy-of select="'Amended'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf5_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="'neodkladn'"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="'plnovan'"/>
			</xsl:when>
			<xsl:when test="$input='3'">
				<xsl:copy-of select="'jin'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf6_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='0'">
				<xsl:copy-of select="'narozen v nemocnici'"/>
			</xsl:when>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="'praktick lka pro dospl/pro dti a dorost'"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="'jin oetujc lka - ambulantn pe'"/>
			</xsl:when>
			<xsl:when test="$input='3'">
				<xsl:copy-of select="'lka LSPP'"/>
			</xsl:when>
			<xsl:when test="$input='4'">
				<xsl:copy-of select="'lka RZP'"/>
			</xsl:when>
			<xsl:when test="$input='5'">
				<xsl:copy-of select="'jin zazen'"/>
			</xsl:when>
			<xsl:when test="$input='6'">
				<xsl:copy-of select="'jin oddlen tho zazen'"/>
			</xsl:when>
			<xsl:when test="$input='7'">
				<xsl:copy-of select="'bez doporuen lkae'"/>
			</xsl:when>
			<xsl:when test="$input='8'">
				<xsl:copy-of select="'sociln pracovnk'"/>
			</xsl:when>
			<xsl:when test="$input='9'">
				<xsl:copy-of select="'hospitalizace pokrauje'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf7_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='MKN-10'">
				<xsl:copy-of select="'MKN-10	'"/>
			</xsl:when>
			<xsl:when test="$input='MKN-O'">
				<xsl:copy-of select="'MKN-O'"/>
			</xsl:when>
			<xsl:when test="$input='ORPHACD'">
				<xsl:copy-of select="'ORPHA code
'"/>
			</xsl:when>
			<xsl:when test="$input='SNOMEDCT'">
				<xsl:copy-of select="'SNOMED CT'"/>
			</xsl:when>
			<xsl:when test="$input='TNM'">
				<xsl:copy-of select="'TNM'"/>
			</xsl:when>
			<xsl:when test="$input='IPS'">
				<xsl:copy-of select="'IPS'"/>
			</xsl:when>
			<xsl:when test="$input='OMIM'">
				<xsl:copy-of select="'OMIM'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf8_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='3435'">
				<xsl:copy-of select="'3435'"/>
			</xsl:when>
			<xsl:when test="$input='38-1a1'">
				<xsl:copy-of select="'70755000'"/>
			</xsl:when>
			<xsl:when test="$input='38-1a2'">
				<xsl:copy-of select="'1505002'"/>
			</xsl:when>
			<xsl:when test="$input='38-1a3'">
				<xsl:copy-of select="'70755000'"/>
			</xsl:when>
			<xsl:when test="$input='38-1b'">
				<xsl:copy-of select="'18038006'"/>
			</xsl:when>
			<xsl:when test="$input='38-1c'">
				<xsl:copy-of select="'183452005'"/>
			</xsl:when>
			<xsl:when test="$input='38-2'">
				<xsl:copy-of select="'386497007'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf9_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'completed'"/>
			</xsl:when>
			<xsl:when test="$input='E'">
				<xsl:copy-of select="'correction'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'entered-in-error'"/>
			</xsl:when>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'stopped'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'on-hold'"/>
			</xsl:when>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'stopped'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf10_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='ND'">
				<xsl:copy-of select="'nevhodn dvkovn'"/>
			</xsl:when>
			<xsl:when test="$input='PD'">
				<xsl:copy-of select="'nedostaten dvkovn'"/>
			</xsl:when>
			<xsl:when test="$input='IL'">
				<xsl:copy-of select="'interakce lku'"/>
			</xsl:when>
			<xsl:when test="$input='J'">
				<xsl:copy-of select="'jin'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf11_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'chronic'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'acute'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf12_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'Chronick (trval) medikace'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'Akutn (pechodn) medikace'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf13_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'completed'"/>
			</xsl:when>
			<xsl:when test="$input='SF'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='SN'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf14_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'inactive'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf15_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='HNMD'">
				<xsl:copy-of select="'228368007'"/>
			</xsl:when>
			<xsl:when test="$input='DNMD'">
				<xsl:copy-of select="'228367002'"/>
			</xsl:when>
			<xsl:when test="$input='MDIP'">
				<xsl:copy-of select="'44870007'"/>
			</xsl:when>
			<xsl:when test="$input='CDUS'">
				<xsl:copy-of select="'417284009'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf16_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='AMFETAM'">
				<xsl:copy-of select="'703842006'"/>
			</xsl:when>
			<xsl:when test="$input='ANABST'">
				<xsl:copy-of select="'111151007'"/>
			</xsl:when>
			<xsl:when test="$input='BARBIT'">
				<xsl:copy-of select="'372798009'"/>
			</xsl:when>
			<xsl:when test="$input='BENZOD'">
				<xsl:copy-of select="'372664007'"/>
			</xsl:when>
			<xsl:when test="$input='BUP'">
				<xsl:copy-of select="'387173000'"/>
			</xsl:when>
			<xsl:when test="$input='PHENC'">
				<xsl:copy-of select="'9721008'"/>
			</xsl:when>
			<xsl:when test="$input='FENTAN'">
				<xsl:copy-of select="'373492002'"/>
			</xsl:when>
			<xsl:when test="$input='HALLMUSH'">
				<xsl:copy-of select="'229006007'"/>
			</xsl:when>
			<xsl:when test="$input='HEROIN'">
				<xsl:copy-of select="'387341002'"/>
			</xsl:when>
			<xsl:when test="$input='3OHBUTYR'">
				<xsl:copy-of select="'62821004'"/>
			</xsl:when>
			<xsl:when test="$input='KETAM'">
				<xsl:copy-of select="'373464007'"/>
			</xsl:when>
			<xsl:when test="$input='COCAINE'">
				<xsl:copy-of select="'387085005'"/>
			</xsl:when>
			<xsl:when test="$input='COCFB'">
				<xsl:copy-of select="'229003004'"/>
			</xsl:when>
			<xsl:when test="$input='CANAB'">
				<xsl:copy-of select="'398705004'"/>
			</xsl:when>
			<xsl:when test="$input='LAXAT'">
				<xsl:copy-of select="'372800002'"/>
			</xsl:when>
			<xsl:when test="$input='LSD'">
				<xsl:copy-of select="'15698006'"/>
			</xsl:when>
			<xsl:when test="$input='MDMA'">
				<xsl:copy-of select="'288459003'"/>
			</xsl:when>
			<xsl:when test="$input='METHAD'">
				<xsl:copy-of select="'387286002'"/>
			</xsl:when>
			<xsl:when test="$input='METAMF'">
				<xsl:copy-of select="'387499002'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf17_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='ASSOC'">
				<xsl:copy-of select="&quot;Associate's or technical degree complete&quot;"/>
			</xsl:when>
			<xsl:when test="$input='BD'">
				<xsl:copy-of select="'College or baccalaureate degree complete'"/>
			</xsl:when>
			<xsl:when test="$input='ELEN'">
				<xsl:copy-of select="'Elementary School'"/>
			</xsl:when>
			<xsl:when test="$input='GD'">
				<xsl:copy-of select="'Graduate or professional Degree complete'"/>
			</xsl:when>
			<xsl:when test="$input='HS'">
				<xsl:copy-of select="'High School or secondary school degree complete'"/>
			</xsl:when>
			<xsl:when test="$input='PB'">
				<xsl:copy-of select="'Some post-baccalaureate education'"/>
			</xsl:when>
			<xsl:when test="$input='POSTG'">
				<xsl:copy-of select="'Doctoral or post graduate education'"/>
			</xsl:when>
			<xsl:when test="$input='SCOL'">
				<xsl:copy-of select="'Some College education'"/>
			</xsl:when>
			<xsl:when test="$input='SEC'">
				<xsl:copy-of select="'Some secondary or high school education'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf18_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='365508006'">
				<xsl:copy-of select="'Residence and accommodation circumstances'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf19_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='BSCH'">
				<xsl:copy-of select="'Vana / sprchov keslo'"/>
			</xsl:when>
			<xsl:when test="$input='SLCH'">
				<xsl:copy-of select="'Schodiov vtah, idle'"/>
			</xsl:when>
			<xsl:when test="$input='ASTO'">
				<xsl:copy-of select="'Pomocn toaleta'"/>
			</xsl:when>
			<xsl:when test="$input='ASBE'">
				<xsl:copy-of select="'Pomocn lko'"/>
			</xsl:when>
			<xsl:when test="$input='HPAF'">
				<xsl:copy-of select="'Pomocn vybaven / adaptace domu a prostor'"/>
			</xsl:when>
			<xsl:when test="$input='HARA'">
				<xsl:copy-of select="'Zbradl, dradla'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf20_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='STHO'">
				<xsl:copy-of select="'Schody v dom'"/>
			</xsl:when>
			<xsl:when test="$input='LAWE'">
				<xsl:copy-of select="'Bydl v byt s vtahem'"/>
			</xsl:when>
			<xsl:when test="$input='ARBS'">
				<xsl:copy-of select="'Pstup do domu po schodech'"/>
			</xsl:when>
			<xsl:when test="$input='OMRE'">
				<xsl:copy-of select="'Blokovan vstup do bytu'"/>
			</xsl:when>
			<xsl:when test="$input='HCSB'">
				<xsl:copy-of select="'Bydlen obsahuje strukturln pekky pohybu'"/>
			</xsl:when>
			<xsl:when test="$input='CLSP'">
				<xsl:copy-of select="'Zanedn ivotn prostor'"/>
			</xsl:when>
			<xsl:when test="$input='DLCO'">
				<xsl:copy-of select="'pinav ivotn prosted'"/>
			</xsl:when>
			<xsl:when test="$input='KEPE'">
				<xsl:copy-of select="'Chov domc mazlky'"/>
			</xsl:when>
			<xsl:when test="$input='UFCO'">
				<xsl:copy-of select="'Nebezpen podlahov krytina'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf21_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'fyziologick reakce'"/>
			</xsl:when>
			<xsl:when test="$input='H'">
				<xsl:copy-of select="'hyperreakce'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'neurologick reakce'"/>
			</xsl:when>
			<xsl:when test="$input='J'">
				<xsl:copy-of select="'jin reakce'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf22_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'385669000'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'385671000'"/>
			</xsl:when>
			<xsl:when test="$input='C'">
				<xsl:copy-of select="'385670004'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf23_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'spn'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'Nespn'"/>
			</xsl:when>
			<xsl:when test="$input='C'">
				<xsl:copy-of select="'sten spn'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf24_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf25_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf26_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf27_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='SP'">
				<xsl:copy-of select="'resolved'"/>
			</xsl:when>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'inactive'"/>
			</xsl:when>
			<xsl:when test="$input='Z'">
				<xsl:copy-of select="'suspended'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf28_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'unconfirmed'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'refuted'"/>
			</xsl:when>
			<xsl:when test="$input='AF'">
				<xsl:copy-of select="'confirmed'"/>
			</xsl:when>
			<xsl:when test="$input='AN'">
				<xsl:copy-of select="'confirmed'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf29_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'allergy'"/>
			</xsl:when>
			<xsl:when test="$input='I'">
				<xsl:copy-of select="'intolerance'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf30_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='L'">
				<xsl:copy-of select="'medication'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'food'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'environment'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf31_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='255604002'">
				<xsl:copy-of select="'low'"/>
			</xsl:when>
			<xsl:when test="$input='371923003'">
				<xsl:copy-of select="'low'"/>
			</xsl:when>
			<xsl:when test="$input='6736007'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
			<xsl:when test="$input='371924009'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
			<xsl:when test="$input='24484000'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
			<xsl:when test="$input='442452003'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf32_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='D'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'phone'"/>
			</xsl:when>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'phone'"/>
			</xsl:when>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'fax'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'email'"/>
			</xsl:when>
			<xsl:when test="$input='X'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
			<xsl:when test="$input='E'">
				<xsl:copy-of select="'e-mail'"/>
			</xsl:when>
			<xsl:when test="$input='I'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
			<xsl:when test="$input='G'">
				<xsl:copy-of select="'other'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf33_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'mobile'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf34_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="'temp'"/>
			</xsl:when>
			<xsl:when test="$input='3'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='4'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='5'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='6'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='7'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='8'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='9'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='C'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='K'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='Z'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='G'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='L'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'billing'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='O'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
			<xsl:when test="$input='X'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf35_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='K'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf36_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="true()"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="false()"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf37_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'Preliminary'"/>
			</xsl:when>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'Final'"/>
			</xsl:when>
			<xsl:when test="$input='Z'">
				<xsl:copy-of select="'Amended'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:output method="xml" encoding="UTF-8" byte-order-mark="no" indent="yes"/>
	<xsl:template match="/">
		<xsl:variable name="var13_dasta" as="node()?" select="ns1:dasta"/>
		<Bundle xmlns="http://hl7.org/fhir" xmlns:xhtml="http://www.w3.org/1999/xhtml">
			<xsl:attribute name="xsi:schemaLocation" namespace="http://www.w3.org/2001/XMLSchema-instance" select="'http://hl7.org/fhir file:///C:/converters/Dasta2FHIR/mapforce/schemas/hl7-fhir/bundle.xsd'"/>
			<type>
				<xsl:attribute name="value" namespace="" select="'message'"/>
			</type>
			<xsl:for-each select="$var13_dasta/ns1:is">
				<xsl:variable name="var1_resultof_is" as="node()*">
					<xsl:call-template name="provisio:is">
						<xsl:with-param name="is" as="node()">
							<is xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
								<xsl:sequence select="(./@node(), ./node())"/>
							</is>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var1_resultof_is">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var13_dasta/ns1:garant_dat">
				<xsl:variable name="var2_resultof_garant_dat" as="node()*">
					<xsl:call-template name="provisio:garant_dat">
						<xsl:with-param name="garant_dat" as="node()">
							<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
								<xsl:sequence select="(./@node(), ./node())"/>
							</garant_dat>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var2_resultof_garant_dat">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var13_dasta/ns1:is/ns2:ip">
				<xsl:variable name="var12_cur" as="node()" select="."/>
				<xsl:for-each select="ns2:ku/ns2:ku_z">
					<xsl:variable name="var11_resultof_ku_z" as="node()*">
						<xsl:call-template name="provisio:ku_z">
							<xsl:with-param name="patientReference" as="node()">
								<Reference>
									<identifier>
										<use>
											<xsl:attribute name="value" namespace="" select="'official'"/>
										</use>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
										</system>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string($var12_cur/@id_pac)"/>
										</value>
									</identifier>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="organizatinReference" as="xs:string*">
								<xsl:for-each select="$var13_dasta/ns1:is">
									<xsl:variable name="var6_resultof_is" as="node()*">
										<xsl:call-template name="provisio:is">
											<xsl:with-param name="is" as="node()">
												<is xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
													<xsl:sequence select="(./@node(), ./node())"/>
												</is>
											</xsl:with-param>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var6_resultof_is/ns0:resource/ns0:Organization">
										<xsl:variable name="var5_cur" as="node()" select="."/>
										<xsl:for-each select="ns0:id/@value">
											<xsl:variable name="var4_cur" as="node()" select="."/>
											<xsl:for-each select="$var5_cur/ns0:meta/ns0:versionId/@value">
												<xsl:variable name="var3_resultof_Reference_Organization" as="xs:string?">
													<xsl:call-template name="provisio:Reference_Organization">
														<xsl:with-param name="GUID" select="fn:string($var4_cur)" as="xs:string"/>
														<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:sequence select="$var3_resultof_Reference_Organization"/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="practitionerReference" as="xs:string*">
								<xsl:for-each select="$var13_dasta/ns1:garant_dat">
									<xsl:variable name="var10_resultof_garant_dat" as="node()*">
										<xsl:call-template name="provisio:garant_dat">
											<xsl:with-param name="garant_dat" as="node()">
												<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
													<xsl:sequence select="(./@node(), ./node())"/>
												</garant_dat>
											</xsl:with-param>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var10_resultof_garant_dat/ns0:resource/ns0:Practitioner">
										<xsl:variable name="var9_cur" as="node()" select="."/>
										<xsl:for-each select="ns0:id/@value">
											<xsl:variable name="var8_cur" as="node()" select="."/>
											<xsl:for-each select="$var9_cur/ns0:meta/ns0:versionId/@value">
												<xsl:variable name="var7_resultof_Reference_Practitioner" as="xs:string?">
													<xsl:call-template name="provisio:Reference_Practitioner">
														<xsl:with-param name="GUID" select="fn:string($var8_cur)" as="xs:string"/>
														<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:sequence select="$var7_resultof_Reference_Practitioner"/>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="ku_zType" as="node()">
								<ku_zType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</ku_zType>
							</xsl:with-param>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var11_resultof_ku_z">
						<entry>
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
		</Bundle>
	</xsl:template>
</xsl:stylesheet>
