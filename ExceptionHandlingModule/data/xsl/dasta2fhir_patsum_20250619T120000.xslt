<?xml version="1.0" encoding="UTF-8"?>
<!--
This file was generated by Altova MapForce 2024r2sp1

YOU SHOULD NOT MODIFY THIS FILE, BECAUSE IT WILL BE
OVERWRITTEN WHEN YOU RE-RUN CODE GENERATION.

Refer to the Altova MapForce Documentation for further details.
http://www.altova.com/mapforce
-->
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns0="http://hl7.org/fhir" xmlns:provisio="http://www.altova.com/MapForce/UDF/provisio" xmlns:vmf="http://www.altova.com/MapForce/UDF/vmf" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:ns1="urn:cz-mzcr:ns:dasta:ds4:ds_dasta" xmlns:ns2="urn:cz-mzcr:ns:dasta:ds4:ds_ip" exclude-result-prefixes="ns0 provisio vmf xs fn ns1 ns2">
	<xsl:param name="ds_ip-4_15_07133" select="'../samples/ip.xml'"/>
	<xsl:template name="provisio:Composition_EU_PS">
		<xsl:param name="HDRdate" select="()"/>
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="sectionMedications_le" select="()"/>
		<xsl:param name="sectionAllergies_ua" select="()"/>
		<xsl:param name="sectionFunctionalStatus_fs" select="()"/>
		<xsl:param name="sectionPlanOfCare_ld" select="()"/>
		<xsl:param name="authorReference" select="()"/>
		<xsl:param name="sectionProceduresHx_chv" select="()"/>
		<xsl:param name="sectionImmunizations_oc" select="()"/>
		<xsl:param name="sectionVitalSigns_h" select="()"/>
		<xsl:param name="sectionVitalSigns_fyznal" select="()"/>
		<xsl:param name="sectionResults_uks" select="()"/>
		<xsl:param name="sectionResults_an" select="()"/>
		<xsl:param name="sectionPregnancyHx_grav" select="()"/>
		<xsl:param name="sectionMedicalDevices_uniz" select="()"/>
		<xsl:param name="sectionAlert_urf_utm_uot" select="()"/>
		<xsl:param name="sectionProblems_anf_anam_prob" select="()"/>
		<xsl:param name="sectionSocialHistory_anf_rao" select="()"/>
		<xsl:param name="sectionSocialHistory_anf_inf_infc_sa" select="()"/>
		<xsl:param name="sectionProblems_dg" select="()"/>
		<xsl:variable name="var1_http___loinc_org_as_string" as="xs:string" select="xs:string(xs:anyURI('http://loinc.org'))"/>
		<entry xmlns="http://hl7.org/fhir">
			<resource>
				<Composition>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<type>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'60591-5'"/>
							</code>
						</coding>
					</type>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<date>
						<xsl:if test="fn:exists($HDRdate)">
							<xsl:attribute name="value" namespace="" select="$HDRdate"/>
						</xsl:if>
					</date>
					<author>
						<xsl:sequence select="($authorReference/@node(), $authorReference/node())"/>
					</author>
					<title>
						<xsl:attribute name="value" namespace="" select="'Patient Summary'"/>
					</title>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'Problems section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11450-4'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionProblems_anf_anam_prob">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
						<xsl:for-each select="$sectionProblems_dg">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'Allergies section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'48765-2'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionAllergies_ua">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'Medication section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10160-0'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionMedications_le">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'Immunizations section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11369-6'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionImmunizations_oc">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'Results section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'30954-2'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionResults_uks">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
						<xsl:for-each select="$sectionResults_an">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'ProceduresHx section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'47519-4'"/>
								</code>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'ProceduresHx section'"/>
							</text>
						</code>
						<xsl:for-each select="$sectionProceduresHx_chv">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'MedicalDevices section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'46264-8'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionMedicalDevices_uniz">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'AdvanceDirectives section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'42348-3'"/>
								</code>
							</coding>
						</code>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'Alerts section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'104605-1'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionAlert_urf_utm_uot">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'FunctionalStatus section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'47420-5'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionFunctionalStatus_fs">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'PastIllnessHx section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'11348-0'"/>
								</code>
							</coding>
						</code>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'PatientStory section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'81338-6'"/>
								</code>
							</coding>
						</code>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'PregnancyHx section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'10162-6'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionPregnancyHx_grav">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'PlanOfCare section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'18776-5'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionPlanOfCare_ld">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'SocialHistory section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'29762-2'"/>
								</code>
							</coding>
							<text>
								<xsl:attribute name="value" namespace="" select="'SocialHistory section'"/>
							</text>
						</code>
						<xsl:for-each select="$sectionSocialHistory_anf_rao">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
						<xsl:for-each select="$sectionSocialHistory_anf_inf_infc_sa">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
					<section>
						<title>
							<xsl:attribute name="value" namespace="" select="'VitalSigns section'"/>
						</title>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var1_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8716-3'"/>
								</code>
							</coding>
						</code>
						<xsl:for-each select="$sectionVitalSigns_h">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
						<xsl:for-each select="$sectionVitalSigns_fyznal">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</section>
				</Composition>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:anf_anam_abj">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_abj" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:variable name="var4_abj_kod" as="node()*" select="$anam_abj/ns2:abj_kod"/>
		<xsl:variable name="var5_vguid" as="node()?" select="$anam_abj/@vguid"/>
		<xsl:variable name="var6_guid" as="node()?" select="$anam_abj/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var6_guid">
				<xsl:for-each select="$var5_vguid">
					<xsl:for-each select="$var6_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var5_vguid">
							<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Observation">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Observation">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Observation>
					<xsl:for-each select="$var6_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var5_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'social-history'"/>
							</code>
						</coding>
					</category>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
							</system>
							<version>
								<xsl:for-each select="$var4_abj_kod/ns2:kod_syst">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</version>
							<code>
								<xsl:for-each select="$var4_abj_kod/ns2:kod">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$var4_abj_kod/ns2:kod_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$dat_ab">
						<effectiveDateTime>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</effectiveDateTime>
					</xsl:for-each>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var3_test_resultof_exists">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</performer>
					</xsl:for-each>
					<xsl:for-each select="$anam_abj/ns2:abj_text">
						<valueCodeableConcept>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</valueCodeableConcept>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:anf_anam_prob">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_probType" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var5_prob_kod" as="node()*" select="$anam_probType/ns2:prob_kod"/>
		<xsl:variable name="var6_vguid" as="node()?" select="$anam_probType/@vguid"/>
		<xsl:variable name="var7_guid" as="node()?" select="$anam_probType/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var7_guid">
				<xsl:for-each select="$var6_vguid">
					<xsl:for-each select="$var7_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var6_vguid">
							<xsl:variable name="var1_resultof_Reference_Condition" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Condition">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Condition">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Condition>
					<xsl:for-each select="$var7_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var6_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<xsl:for-each select="$dat_ab">
							<lastUpdated>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(.)))"/>
							</lastUpdated>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-condition-hdr'))"/>
						</profile>
					</meta>
					<clinicalStatus>
						<xsl:for-each select="$anam_probType/ns2:prob_klin">
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-clinical'))"/>
								</system>
								<xsl:variable name="var3_resultof_vmf__inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf1_inputtoresult">
										<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<code>
									<xsl:for-each select="$var3_resultof_vmf__inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</code>
							</coding>
						</xsl:for-each>
					</clinicalStatus>
					<verificationStatus>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-ver-status'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'confirmed'"/>
							</code>
						</coding>
					</verificationStatus>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-category'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'encounter-diagnosis'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Encounter Diagnosis'"/>
							</display>
						</coding>
					</category>
					<xsl:for-each select="$anam_probType/ns2:prob_zav_text">
						<severity>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</severity>
					</xsl:for-each>
					<code>
						<xsl:for-each select="$var5_prob_kod">
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
								</system>
								<code>
									<xsl:for-each select="ns2:kod_syst">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="ns2:kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</xsl:for-each>
						<text>
							<xsl:for-each select="$var5_prob_kod/ns2:kod_text">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</text>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$anam_probType/ns2:prob_dat_od">
						<onsetPeriod>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$anam_probType/ns2:prob_dat_do">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</onsetPeriod>
					</xsl:for-each>
					<xsl:variable name="var4_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var4_test_resultof_exists">
						<recorder>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</recorder>
					</xsl:for-each>
					<xsl:for-each select="$anam_probType/ns2:prob_stad_kod">
						<stage>
							<summary>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
									</system>
									<code>
										<xsl:for-each select="ns2:kod_syst">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="ns2:kod">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
								<text>
									<xsl:for-each select="ns2:kod_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</text>
							</summary>
						</stage>
					</xsl:for-each>
					<xsl:for-each select="$anam_probType/ns2:prob_stad_text">
						<stage>
							<type>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</type>
						</stage>
					</xsl:for-each>
					<xsl:for-each select="$anam_probType/ns2:prob_popis">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
					<xsl:for-each select="$anam_probType/ns2:prob_okol">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
				</Condition>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:Reference_FamilyMemberHistory">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('FamilyMemberHistory/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:anf_anam_rao">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_rao" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var5_vguid" as="node()?" select="$anam_rao/@vguid"/>
		<xsl:variable name="var6_guid" as="node()?" select="$anam_rao/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var6_guid">
				<xsl:for-each select="$var5_vguid">
					<xsl:for-each select="$var6_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var5_vguid">
							<xsl:variable name="var1_resultof_Reference_FamilyMemberHistory" as="xs:string?">
								<xsl:call-template name="provisio:Reference_FamilyMemberHistory">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_FamilyMemberHistory">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<FamilyMemberHistory>
					<xsl:for-each select="$var6_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var5_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<xsl:for-each select="$dat_ab">
							<lastUpdated>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(.)))"/>
							</lastUpdated>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/czh-familyMemberHistory-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'completed'"/>
					</status>
					<patient>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</patient>
					<xsl:for-each select="$anam_rao/ns2:rao_vztah_kod">
						<relationship>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/ValueSet/v3-FamilyMember'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
								<xsl:for-each select="$anam_rao/ns2:rao_vztah_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
						</relationship>
					</xsl:for-each>
					<xsl:for-each select="$anam_rao/ns2:rao_dat_nar">
						<bornDate>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</bornDate>
					</xsl:for-each>
					<xsl:for-each select="$anam_rao/ns2:rao_dat_um">
						<deceasedDate>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</deceasedDate>
					</xsl:for-each>
					<xsl:for-each select="$anam_rao/ns2:rao_vzdel">
						<note>
							<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
								<xsl:choose>
									<xsl:when test="fn:exists($dasta_garant_dat)">
										<xsl:sequence select="fn:string($dasta_garant_dat)"/>
									</xsl:when>
									<xsl:otherwise>
										<xsl:for-each select="$garant_dat">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var3_test_resultof_exists">
								<authorString>
									<xsl:attribute name="value" namespace="" select="."/>
								</authorString>
							</xsl:for-each>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
					<xsl:for-each select="$anam_rao/ns2:rao_zdrprob_kod">
						<xsl:variable name="var4_https___dastacr_cz_dasta_hyper_as_string" as="xs:string" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
						<condition>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="$var4_https___dastacr_cz_dasta_hyper_as_string"/>
									</system>
									<version>
										<xsl:for-each select="ns2:kod_syst">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</version>
									<code>
										<xsl:for-each select="ns2:kod">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="ns2:kod_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</code>
							<xsl:for-each select="$anam_rao/ns2:rao_duvum_kod">
								<outcome>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="$var4_https___dastacr_cz_dasta_hyper_as_string"/>
										</system>
										<version>
											<xsl:for-each select="ns2:kod_syst">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</version>
										<code>
											<xsl:for-each select="ns2:kod">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</code>
										<display>
											<xsl:for-each select="ns2:kod_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</outcome>
							</xsl:for-each>
						</condition>
					</xsl:for-each>
				</FamilyMemberHistory>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:anf_anam_abd">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_abd" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:variable name="var6_vguid" as="node()?" select="$anam_abd/@vguid"/>
		<xsl:variable name="var7_guid" as="node()?" select="$anam_abd/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var7_guid">
				<xsl:for-each select="$var6_vguid">
					<xsl:for-each select="$var7_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var6_vguid">
							<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Observation">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Observation">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Observation>
					<xsl:for-each select="$var7_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var6_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'social-history'"/>
							</code>
						</coding>
					</category>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWG.htm'))"/>
							</system>
							<xsl:for-each select="$anam_abd/ns2:abd_stav_kod">
								<xsl:variable name="var3_resultof_vmf__inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf2_inputtoresult">
										<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<code>
									<xsl:for-each select="$var3_resultof_vmf__inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</code>
							</xsl:for-each>
							<xsl:for-each select="$anam_abd/ns2:abd_stav_text">
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</xsl:for-each>
						</coding>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWH.htm'))"/>
							</system>
							<xsl:for-each select="$anam_abd/ns2:abd_lattyp_kod">
								<xsl:variable name="var4_resultof_vmf__inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf3_inputtoresult">
										<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<code>
									<xsl:for-each select="$var4_resultof_vmf__inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</code>
							</xsl:for-each>
							<xsl:for-each select="$anam_abd/ns2:abd_lattyp_text">
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</xsl:for-each>
						</coding>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBSE.htm'))"/>
							</system>
							<code>
								<xsl:for-each select="$anam_abd/ns2:abd_latzp_kod">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$anam_abd/ns2:abd_latzp_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$dat_ab">
						<effectiveDateTime>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</effectiveDateTime>
					</xsl:for-each>
					<xsl:for-each select="$anam_abd/ns2:abd_dat_od">
						<effectivePeriod>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$anam_abd/ns2:abd_dat_do">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</effectivePeriod>
					</xsl:for-each>
					<xsl:variable name="var5_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var5_test_resultof_exists">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</performer>
					</xsl:for-each>
					<xsl:for-each select="$anam_abd/ns2:abd_mnoz_text">
						<valueCodeableConcept>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</valueCodeableConcept>
					</xsl:for-each>
					<xsl:for-each select="$anam_abd/ns2:abd_koment">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:anf_anam_abk">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_abk" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:variable name="var4_vguid" as="node()?" select="$anam_abk/@vguid"/>
		<xsl:variable name="var5_guid" as="node()?" select="$anam_abk/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var5_guid">
				<xsl:for-each select="$var4_vguid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var4_vguid">
							<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Observation">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Observation">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Observation>
					<xsl:for-each select="$var5_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var4_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'social-history'"/>
							</code>
						</coding>
					</category>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
							</system>
							<xsl:for-each select="$anam_abk/ns2:abk_stav_kod">
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
							</xsl:for-each>
							<xsl:for-each select="$anam_abk/ns2:abk_stav_text">
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</xsl:for-each>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$dat_ab">
						<effectiveDateTime>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</effectiveDateTime>
					</xsl:for-each>
					<xsl:for-each select="$anam_abk/ns2:abk_dat_od">
						<effectivePeriod>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$anam_abk/ns2:abk_dat_do">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</effectivePeriod>
					</xsl:for-each>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var3_test_resultof_exists">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</performer>
					</xsl:for-each>
					<xsl:for-each select="$anam_abk/ns2:abk_mnoz_text">
						<valueCodeableConcept>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</valueCodeableConcept>
					</xsl:for-each>
					<xsl:for-each select="$anam_abk/ns2:abk_koment">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:anf_anam_aba">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_aba" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:variable name="var4_vguid" as="node()?" select="$anam_aba/@vguid"/>
		<xsl:variable name="var5_guid" as="node()?" select="$anam_aba/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var5_guid">
				<xsl:for-each select="$var4_vguid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var4_vguid">
							<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Observation">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Observation">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Observation>
					<xsl:for-each select="$var5_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var4_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'social-history'"/>
							</code>
						</coding>
					</category>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
							</system>
							<xsl:for-each select="$anam_aba/ns2:aba_stav_kod">
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
							</xsl:for-each>
							<xsl:for-each select="$anam_aba/ns2:aba_stav_text">
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</xsl:for-each>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$dat_ab">
						<effectiveDateTime>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</effectiveDateTime>
					</xsl:for-each>
					<xsl:for-each select="$anam_aba/ns2:aba_dat_od">
						<effectivePeriod>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$anam_aba/ns2:aba_dat_do">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</effectivePeriod>
					</xsl:for-each>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var3_test_resultof_exists">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</performer>
					</xsl:for-each>
					<xsl:for-each select="$anam_aba/ns2:aba_mnoz_text">
						<valueCodeableConcept>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</valueCodeableConcept>
					</xsl:for-each>
					<xsl:for-each select="$anam_aba/ns2:aba_koment">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:anf_anam_sa">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_sa" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:variable name="var12_guid" as="node()?" select="$anam_sa/@guid"/>
		<xsl:variable name="var13_vguid" as="node()?" select="$anam_sa/@vguid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var12_guid">
				<xsl:for-each select="$var13_vguid">
					<xsl:for-each select="$var12_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var13_vguid">
							<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Observation">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Observation">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Observation>
					<xsl:for-each select="$var12_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var13_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-sdoh-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'social-history'"/>
							</code>
						</coding>
					</category>
					<code>
						<text>
							<xsl:attribute name="value" namespace="" select="'Sociln anamnza'"/>
						</text>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$dat_ab">
						<effectiveDateTime>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</effectiveDateTime>
					</xsl:for-each>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var3_test_resultof_exists">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</performer>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sau_prac">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Pracovn zapojen'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sau_zajmy">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Konky'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sau_soc">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Sociln s'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sav_vzdel">
						<xsl:variable name="var5_cur_as_string" as="xs:string" select="fn:string(.)"/>
						<component>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-EducationLevel'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="$var5_cur_as_string"/>
									</code>
									<xsl:variable name="var4_resultof_vmf__inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf4_inputtoresult">
											<xsl:with-param name="input" select="$var5_cur_as_string" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<display>
										<xsl:for-each select="$var4_resultof_vmf__inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</display>
								</coding>
							</code>
							<valueString>
								<xsl:for-each select="$anam_sa/ns2:sav_koment">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sab_zpbydl_text">
						<component>
							<code>
								<xsl:for-each select="$anam_sa/ns2:sab_zpbydl_kod">
									<xsl:variable name="var7_cur_as_string" as="xs:string" select="fn:string(.)"/>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWB.htm'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="$var7_cur_as_string"/>
										</code>
										<xsl:variable name="var6_resultof_vmf__inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf5_inputtoresult">
												<xsl:with-param name="input" select="$var7_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<display>
											<xsl:for-each select="$var6_resultof_vmf__inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</display>
									</coding>
								</xsl:for-each>
								<text>
									<xsl:attribute name="value" namespace="" select="'Zpsob bydlen'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sab_prizp_text">
						<component>
							<code>
								<xsl:for-each select="$anam_sa/ns2:sab_prizp_kod">
									<xsl:variable name="var9_cur_as_string" as="xs:string" select="fn:string(.)"/>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWC.htm'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="$var9_cur_as_string"/>
										</code>
										<xsl:variable name="var8_resultof_vmf__inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf6_inputtoresult">
												<xsl:with-param name="input" select="$var9_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<display>
											<xsl:for-each select="$var8_resultof_vmf__inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</display>
									</coding>
								</xsl:for-each>
								<text>
									<xsl:attribute name="value" namespace="" select="'Pizpsoben domcnosti'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sab_bariery_text">
						<component>
							<code>
								<xsl:for-each select="$anam_sa/ns2:sab_bariery_kod">
									<xsl:variable name="var11_cur_as_string" as="xs:string" select="fn:string(.)"/>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWD.htm'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="$var11_cur_as_string"/>
										</code>
										<xsl:variable name="var10_resultof_vmf__inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf7_inputtoresult">
												<xsl:with-param name="input" select="$var11_cur_as_string" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<display>
											<xsl:for-each select="$var10_resultof_vmf__inputtoresult">
												<xsl:attribute name="value" namespace="" select="."/>
											</xsl:for-each>
										</display>
									</coding>
								</xsl:for-each>
								<text>
									<xsl:attribute name="value" namespace="" select="'Bariry'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sar_koment">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Rodinn situace'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sar_slozrod_text">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Sloen rodiny'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sar_rodstav_text">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Rodinn stav'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sar_pocdet">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Poet dt'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sar_pocdetd">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Poet dt ve spolen domcnosti'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sar_dite">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Podrobnosti o dtti'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
					<xsl:for-each select="$anam_sa/ns2:sar_pecezc">
						<component>
							<code>
								<text>
									<xsl:attribute name="value" namespace="" select="'Peuje o zvislho lena'"/>
								</text>
							</code>
							<valueString>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</valueString>
						</component>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:anf_anam_infc">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_infcType" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:variable name="var4_guid" as="node()?" select="$anam_infcType/@guid"/>
		<xsl:variable name="var5_vguid" as="node()?" select="$anam_infcType/@vguid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var4_guid">
				<xsl:for-each select="$var5_vguid">
					<xsl:for-each select="$var4_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var5_vguid">
							<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Observation">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Observation">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Observation>
					<xsl:for-each select="$var4_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var5_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-travel-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'82753-5'"/>
							</code>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$dat_ab">
						<effectiveDateTime>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</effectiveDateTime>
					</xsl:for-each>
					<xsl:for-each select="$anam_infcType/ns2:infc_dat_od">
						<effectivePeriod>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$anam_infcType/ns2:infc_dat_do">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</effectivePeriod>
					</xsl:for-each>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var3_test_resultof_exists">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</performer>
					</xsl:for-each>
					<xsl:for-each select="$anam_infcType/ns2:infc_stat_kod">
						<valueCodeableConcept>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/valueset-iso3166-1-2.html'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
								<display>
									<xsl:for-each select="$anam_infcType/ns2:infc_stat_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
							<xsl:for-each select="$anam_infcType/ns2:infc_koment">
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</xsl:for-each>
						</valueCodeableConcept>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:anf_anam_inf">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anam_infType" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var4_guid" as="node()?" select="$anam_infType/@guid"/>
		<xsl:variable name="var5_vguid" as="node()?" select="$anam_infType/@vguid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var4_guid">
				<xsl:for-each select="$var5_vguid">
					<xsl:for-each select="$var4_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var5_vguid">
							<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Observation">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Observation">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Observation>
					<xsl:for-each select="$var4_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var5_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-infectious-contact-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v3-ParticipationType'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'EXPAGNT'"/>
							</code>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$dat_ab">
						<effectiveDateTime>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</effectiveDateTime>
					</xsl:for-each>
					<xsl:for-each select="$anam_infType/ns2:inf_dat_od">
						<effectivePeriod>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$anam_infType/ns2:inf_dat_do">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</effectivePeriod>
					</xsl:for-each>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var3_test_resultof_exists">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</performer>
					</xsl:for-each>
					<xsl:for-each select="$anam_infType/ns2:inf_stat_kod">
						<valueCodeableConcept>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.org/fhir/valueset-iso3166-1-2.html'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
								<display>
									<xsl:for-each select="$anam_infType/ns2:inf_stat_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</valueCodeableConcept>
					</xsl:for-each>
					<xsl:for-each select="$anam_infType/ns2:inf_koment">
						<valueString>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</valueString>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:anf_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ds_ip4150719" select="()"/>
		<xsl:param name="ip_anf" select="()"/>
		<xsl:param name="ds_ip4150729" select="()"/>
		<xsl:param name="patsumdat_anf" select="()"/>
		<xsl:param name="ds_dasta40331" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:for-each select="$ip_anf/ns2:anam_prob">
			<xsl:variable name="var1_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150729">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var2_map_of_ip_anf" as="node()*">
				<xsl:for-each select="$ip_anf/ns2:dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var3_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var4_resultof_anf_anam_prob" as="node()?">
				<xsl:call-template name="provisio:anf_anam_prob">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_probType" as="node()">
						<anam_probType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_probType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var1_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var2_map_of_ip_anf)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var3_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var4_resultof_anf_anam_prob">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf/ns2:anam_prob">
			<xsl:variable name="var5_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150719">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var6_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var7_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var8_resultof_anf_anam_prob" as="node()?">
				<xsl:call-template name="provisio:anf_anam_prob">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_probType" as="node()">
						<anam_probType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_probType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var5_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var6_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var7_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var8_resultof_anf_anam_prob">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_anf/ns2:anam_inf">
			<xsl:variable name="var9_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150729">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var10_map_of_ip_anf" as="node()*">
				<xsl:for-each select="$ip_anf/ns2:dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var11_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var12_resultof_anf_anam_inf" as="node()?">
				<xsl:call-template name="provisio:anf_anam_inf">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_infType" as="node()">
						<anam_infType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_infType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var9_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var10_map_of_ip_anf)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var11_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var12_resultof_anf_anam_inf">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf/ns2:anam_inf">
			<xsl:variable name="var13_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150719">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var14_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var15_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var16_resultof_anf_anam_inf" as="node()?">
				<xsl:call-template name="provisio:anf_anam_inf">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_infType" as="node()">
						<anam_infType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_infType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var13_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var14_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var15_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var16_resultof_anf_anam_inf">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_anf/ns2:anam_infc">
			<xsl:variable name="var17_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var18_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150729">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var19_map_of_ip_anf" as="node()*">
				<xsl:for-each select="$ip_anf/ns2:dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var20_resultof_anf_anam_infc" as="node()?">
				<xsl:call-template name="provisio:anf_anam_infc">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_infcType" as="node()">
						<anam_infcType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_infcType>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var17_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var18_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var19_map_of_ip_anf)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var20_resultof_anf_anam_infc">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf/ns2:anam_infc">
			<xsl:variable name="var21_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var22_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150719">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var23_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var24_resultof_anf_anam_infc" as="node()?">
				<xsl:call-template name="provisio:anf_anam_infc">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_infcType" as="node()">
						<anam_infcType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_infcType>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var21_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var22_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var23_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var24_resultof_anf_anam_infc">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_anf/ns2:anam_rao">
			<xsl:variable name="var25_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150729">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var26_map_of_ip_anf" as="node()*">
				<xsl:for-each select="$ip_anf/ns2:dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var27_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var28_resultof_anf_anam_rao" as="node()?">
				<xsl:call-template name="provisio:anf_anam_rao">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_rao" as="node()">
						<anam_rao xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_rao>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var25_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var26_map_of_ip_anf)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var27_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var28_resultof_anf_anam_rao">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf/ns2:anam_rao">
			<xsl:variable name="var29_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150719">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var30_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var31_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var32_resultof_anf_anam_rao" as="node()?">
				<xsl:call-template name="provisio:anf_anam_rao">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_rao" as="node()">
						<anam_rao xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_rao>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var29_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var30_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var31_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var32_resultof_anf_anam_rao">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_anf/ns2:anam_sa">
			<xsl:variable name="var33_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var34_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150729">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var35_map_of_ip_anf" as="node()*">
				<xsl:for-each select="$ip_anf/ns2:dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var36_resultof_anf_anam_sa" as="node()?">
				<xsl:call-template name="provisio:anf_anam_sa">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_sa" as="node()">
						<anam_sa xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_sa>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var33_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var34_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var35_map_of_ip_anf)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var36_resultof_anf_anam_sa">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf/ns2:anam_sa">
			<xsl:variable name="var37_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var38_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150719">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var39_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var40_resultof_anf_anam_sa" as="node()?">
				<xsl:call-template name="provisio:anf_anam_sa">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_sa" as="node()">
						<anam_sa xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_sa>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var37_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var38_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var39_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var40_resultof_anf_anam_sa">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_anf/ns2:anam_aba">
			<xsl:variable name="var41_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var42_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150729">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var43_map_of_ip_anf" as="node()*">
				<xsl:for-each select="$ip_anf/ns2:dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var44_resultof_anf_anam_aba" as="node()?">
				<xsl:call-template name="provisio:anf_anam_aba">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_aba" as="node()">
						<anam_aba xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_aba>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var41_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var42_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var43_map_of_ip_anf)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var44_resultof_anf_anam_aba">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf/ns2:anam_aba">
			<xsl:variable name="var45_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var46_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150719">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var47_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var48_resultof_anf_anam_aba" as="node()?">
				<xsl:call-template name="provisio:anf_anam_aba">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_aba" as="node()">
						<anam_aba xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_aba>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var45_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var46_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var47_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var48_resultof_anf_anam_aba">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_anf/ns2:anam_abk">
			<xsl:variable name="var49_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var50_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150729">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var51_map_of_ip_anf" as="node()*">
				<xsl:for-each select="$ip_anf/ns2:dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var52_resultof_anf_anam_abk" as="node()?">
				<xsl:call-template name="provisio:anf_anam_abk">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_abk" as="node()">
						<anam_abk xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abk>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var49_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var50_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var51_map_of_ip_anf)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var52_resultof_anf_anam_abk">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf/ns2:anam_abk">
			<xsl:variable name="var53_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var54_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150719">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var55_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var56_resultof_anf_anam_abk" as="node()?">
				<xsl:call-template name="provisio:anf_anam_abk">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_abk" as="node()">
						<anam_abk xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abk>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var53_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var54_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var55_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var56_resultof_anf_anam_abk">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_anf/ns2:anam_abd">
			<xsl:variable name="var57_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var58_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150729">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var59_map_of_ip_anf" as="node()*">
				<xsl:for-each select="$ip_anf/ns2:dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var60_resultof_anf_anam_abd" as="node()?">
				<xsl:call-template name="provisio:anf_anam_abd">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_abd" as="node()">
						<anam_abd xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abd>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var57_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var58_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var59_map_of_ip_anf)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var60_resultof_anf_anam_abd">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf/ns2:anam_abd">
			<xsl:variable name="var61_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var62_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150719">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var63_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var64_resultof_anf_anam_abd" as="node()?">
				<xsl:call-template name="provisio:anf_anam_abd">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_abd" as="node()">
						<anam_abd xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abd>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var61_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var62_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var63_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var64_resultof_anf_anam_abd">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_anf/ns2:anam_abj">
			<xsl:variable name="var65_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var66_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150729">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var67_map_of_ip_anf" as="node()*">
				<xsl:for-each select="$ip_anf/ns2:dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var68_resultof_anf_anam_abj" as="node()?">
				<xsl:call-template name="provisio:anf_anam_abj">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_abj" as="node()">
						<anam_abj xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abj>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var65_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var66_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var67_map_of_ip_anf)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var68_resultof_anf_anam_abj">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf/ns2:anam_abj">
			<xsl:variable name="var69_create_garant_dat_of_ds_dasta_____" as="node()*">
				<xsl:for-each select="$ds_dasta40331">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var70_create_garant_dat_of_ds_ip_______" as="node()*">
				<xsl:for-each select="$ds_ip4150719">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var71_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var72_resultof_anf_anam_abj" as="node()?">
				<xsl:call-template name="provisio:anf_anam_abj">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anam_abj" as="node()">
						<anam_abj xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anam_abj>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var69_create_garant_dat_of_ds_dasta_____)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="garant_dat" select="($var70_create_garant_dat_of_ds_ip_______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var71_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var72_resultof_anf_anam_abj">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_AllergyIntolerance">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('AllergyIntolerance/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ua">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="uaType" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var15_dat_ab" as="node()?" select="$uaType/@dat_ab"/>
		<xsl:variable name="var16_uaf" as="node()*" select="$uaType/ns2:uaf"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var16_uaf">
				<xsl:variable name="var4_cur" as="node()" select="."/>
				<xsl:for-each select="@guid">
					<xsl:variable name="var3_cur" as="node()" select="."/>
					<xsl:variable name="var2_vguid" as="node()?" select="$var4_cur/@vguid"/>
					<xsl:for-each select="$var2_vguid">
						<xsl:for-each select="$var2_vguid">
							<xsl:variable name="var1_resultof_Reference_AllergyIntolerance" as="xs:string?">
								<xsl:call-template name="provisio:Reference_AllergyIntolerance">
									<xsl:with-param name="GUID" select="fn:string($var3_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_AllergyIntolerance">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<AllergyIntolerance>
					<xsl:for-each select="$var16_uaf/@guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var16_uaf/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-allergyIntolerance-hdr'))"/>
						</profile>
					</meta>
					<clinicalStatus>
						<xsl:for-each select="$uaType/ns2:stav">
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical'))"/>
								</system>
								<xsl:variable name="var5_resultof_vmf__inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf8_inputtoresult">
										<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<code>
									<xsl:for-each select="$var5_resultof_vmf__inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</code>
							</coding>
						</xsl:for-each>
					</clinicalStatus>
					<verificationStatus>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/allergyintolerance-verification'))"/>
							</system>
							<code>
								<xsl:for-each select="$uaType/@typ">
									<xsl:variable name="var6_resultof_vmf__inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf9_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var6_resultof_vmf__inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</code>
						</coding>
					</verificationStatus>
					<xsl:for-each select="$var16_uaf/@typ_reakce">
						<xsl:variable name="var7_resultof_vmf___inputtoresult" as="xs:string?">
							<xsl:call-template name="vmf:vmf10_inputtoresult">
								<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<type>
							<xsl:for-each select="$var7_resultof_vmf___inputtoresult">
								<xsl:attribute name="value" namespace="" select="."/>
							</xsl:for-each>
						</type>
					</xsl:for-each>
					<xsl:for-each select="$var16_uaf/@typ_agens">
						<xsl:variable name="var8_resultof_vmf___inputtoresult" as="xs:string?">
							<xsl:call-template name="vmf:vmf11_inputtoresult">
								<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<category>
							<xsl:for-each select="$var8_resultof_vmf___inputtoresult">
								<xsl:attribute name="value" namespace="" select="."/>
							</xsl:for-each>
						</category>
					</xsl:for-each>
					<criticality>
						<xsl:for-each select="$var16_uaf/@szp_klic">
							<xsl:variable name="var9_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf12_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var9_resultof_vmf___inputtoresult">
								<xsl:attribute name="value" namespace="" select="."/>
							</xsl:for-each>
						</xsl:for-each>
					</criticality>
					<code>
						<xsl:for-each select="$var16_uaf">
							<xsl:variable name="var10_cur" as="node()" select="."/>
							<xsl:for-each select="ns2:alerg_lek_klic">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<xsl:for-each select="$var10_cur/ns2:alerg_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</xsl:for-each>
						</xsl:for-each>
						<xsl:for-each select="$var16_uaf">
							<xsl:variable name="var11_cur" as="node()" select="."/>
							<xsl:for-each select="ns2:alerg_nelek_klic">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<xsl:for-each select="$var11_cur/ns2:alerg_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</xsl:for-each>
						</xsl:for-each>
						<xsl:for-each select="$uaType/ns2:u_al">
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</xsl:for-each>
					</code>
					<patient>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</patient>
					<xsl:for-each select="$uaType/ns2:dat_du">
						<onsetPeriod>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$uaType/ns2:dat_up">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</onsetPeriod>
					</xsl:for-each>
					<xsl:variable name="var12_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($var15_dat_ab)">
								<xsl:sequence select="xs:string(xs:dateTime(fn:string($var15_dat_ab)))"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$dat_ab">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var12_test_resultof_exists">
						<recordedDate>
							<xsl:attribute name="value" namespace="" select="."/>
						</recordedDate>
					</xsl:for-each>
					<xsl:variable name="var13_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var13_test_resultof_exists">
						<recorder>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</recorder>
					</xsl:for-each>
					<xsl:for-each select="$var16_uaf">
						<xsl:variable name="var14_cur" as="node()" select="."/>
						<xsl:for-each select="@ar_klic">
							<reaction>
								<manifestation>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
										<display>
											<xsl:for-each select="$var14_cur/@ar_text">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</display>
									</coding>
								</manifestation>
							</reaction>
						</xsl:for-each>
					</xsl:for-each>
				</AllergyIntolerance>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:uks">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="uksType" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var10_ks_rh" as="node()*" select="$uksType/ns2:ks_rh"/>
		<xsl:variable name="var11_vguid" as="node()?" select="$uksType/@vguid"/>
		<xsl:variable name="var12_guid" as="node()?" select="$uksType/@guid"/>
		<xsl:variable name="var13_dat_ab" as="node()?" select="$uksType/@dat_ab"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var12_guid">
				<xsl:for-each select="$var11_vguid">
					<xsl:for-each select="$var12_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var11_vguid">
							<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Observation">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Observation">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Observation>
					<xsl:for-each select="$var12_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var11_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.dastacr.cz/dasta/hypertext/DSAJQ.htm'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'PKS'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Krevn skupina - popis'"/>
							</display>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($var13_dat_ab)">
								<xsl:sequence select="xs:string(xs:dateTime(fn:string($var13_dat_ab)))"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$dat_ab">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var3_test_resultof_exists">
						<effectiveDateTime>
							<xsl:attribute name="value" namespace="" select="."/>
						</effectiveDateTime>
					</xsl:for-each>
					<xsl:variable name="var4_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var4_test_resultof_exists">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</performer>
					</xsl:for-each>
					<xsl:variable name="var6_test_resultof_exists" as="xs:string*">
						<xsl:choose>
							<xsl:when test="fn:exists($var10_ks_rh)">
								<xsl:for-each select="$var10_ks_rh">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$uksType/ns2:krevskup">
									<xsl:variable name="var5_cur" as="node()" select="."/>
									<xsl:for-each select="$uksType/ns2:rh">
										<xsl:sequence select="fn:concat(fn:string($var5_cur), fn:string(.))"/>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var6_test_resultof_exists">
						<xsl:variable name="var9_ks_rh_text" as="node()*" select="$uksType/ns2:ks_rh_text"/>
						<valueCodeableConcept>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSAIR.htm'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="."/>
								</code>
								<xsl:variable name="var7_test_resultof_exists" as="xs:string+">
									<xsl:choose>
										<xsl:when test="fn:exists($var9_ks_rh_text)">
											<xsl:for-each select="$var9_ks_rh_text">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:when>
										<xsl:otherwise>
											<xsl:sequence select="."/>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:variable>
								<display>
									<xsl:for-each select="$var7_test_resultof_exists">
										<xsl:variable name="var8_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf13_inputtoresult">
												<xsl:with-param name="input" select="." as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var8_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</display>
							</coding>
						</valueCodeableConcept>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:uot">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="uotType" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var5_vguid" as="node()?" select="$uotType/@vguid"/>
		<xsl:variable name="var6_dat_ab" as="node()?" select="$uotType/@dat_ab"/>
		<xsl:variable name="var7_guid" as="node()?" select="$uotType/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var7_guid">
				<xsl:for-each select="$var5_vguid">
					<xsl:for-each select="$var7_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var5_vguid">
							<xsl:variable name="var1_resultof_Reference_Flag" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Flag">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Flag">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Flag>
					<xsl:for-each select="$var7_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var5_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
							<xsl:choose>
								<xsl:when test="fn:exists($var6_dat_ab)">
									<xsl:sequence select="xs:string(xs:dateTime(fn:string($var6_dat_ab)))"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:for-each select="$dat_ab">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var3_test_resultof_exists">
							<lastUpdated>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(.))"/>
							</lastUpdated>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-flag-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'active'"/>
					</status>
					<code>
						<text>
							<xsl:attribute name="value" namespace="" select="'Okovn proti tetanu'"/>
						</text>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$uotType/ns2:dat_du">
						<period>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
						</period>
					</xsl:for-each>
					<xsl:variable name="var4_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var4_test_resultof_exists">
						<author>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</author>
					</xsl:for-each>
				</Flag>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:utm">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="utmType" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var5_guid" as="node()?" select="$utmType/@guid"/>
		<xsl:variable name="var6_vguid" as="node()?" select="$utmType/@vguid"/>
		<xsl:variable name="var7_dat_ab" as="node()?" select="$utmType/@dat_ab"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var5_guid">
				<xsl:for-each select="$var6_vguid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var6_vguid">
							<xsl:variable name="var1_resultof_Reference_Flag" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Flag">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Flag">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Flag>
					<xsl:for-each select="$var5_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var6_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
							<xsl:choose>
								<xsl:when test="fn:exists($var7_dat_ab)">
									<xsl:sequence select="xs:string(xs:dateTime(fn:string($var7_dat_ab)))"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:for-each select="$dat_ab">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var3_test_resultof_exists">
							<lastUpdated>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(.))"/>
							</lastUpdated>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-flag-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'active'"/>
					</status>
					<code>
						<text>
							<xsl:for-each select="$utmType/ns2:u_tm">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</text>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$utmType/ns2:dat_du">
						<period>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
						</period>
					</xsl:for-each>
					<xsl:variable name="var4_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var4_test_resultof_exists">
						<author>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</author>
					</xsl:for-each>
				</Flag>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:Reference_Device">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Device/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:Reference_DeviceUseStatement">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('DeviceUseStatement/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:uniz">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="unizType" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var12_guid" as="node()?" select="$unizType/@guid"/>
		<xsl:variable name="var13_unizf" as="node()*" select="$unizType/ns2:unizf"/>
		<xsl:variable name="var14_vguid" as="node()?" select="$unizType/@vguid"/>
		<xsl:variable name="var15_dat_ab" as="node()?" select="$unizType/@dat_ab"/>
		<xsl:variable name="var11_map_of_typ" as="node()?">
			<xsl:for-each select="$unizType/@typ">
				<xsl:variable name="var10_resultof_vmf___inputtoresult" as="xs:string?">
					<xsl:call-template name="vmf:vmf14_inputtoresult">
						<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var10_resultof_vmf___inputtoresult">
					<xsl:attribute name="value" select="."/>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var8_test_resultof_exists" as="xs:string?">
			<xsl:choose>
				<xsl:when test="fn:exists($var15_dat_ab)">
					<xsl:sequence select="xs:string(xs:dateTime(fn:string($var15_dat_ab)))"/>
				</xsl:when>
				<xsl:otherwise>
					<xsl:for-each select="$dat_ab">
						<xsl:sequence select="fn:string(.)"/>
					</xsl:for-each>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		<xsl:variable name="var9_create_lastUpdated_of_test_exists" as="node()?">
			<xsl:for-each select="$var8_test_resultof_exists">
				<lastUpdated xmlns="http://hl7.org/fhir">
					<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(.))"/>
				</lastUpdated>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var12_guid">
				<xsl:for-each select="$var14_vguid">
					<xsl:for-each select="$var12_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var14_vguid">
							<xsl:variable name="var1_resultof_Reference_DeviceUseStatement" as="xs:string?">
								<xsl:call-template name="provisio:Reference_DeviceUseStatement">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_DeviceUseStatement">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<DeviceUseStatement>
					<xsl:for-each select="$var12_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var14_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<xsl:sequence select="$var9_create_lastUpdated_of_test_exists"/>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/uv/ips/StructureDefinition/DeviceUseStatement-uv-ips'))"/>
						</profile>
					</meta>
					<status>
						<xsl:sequence select="$var11_map_of_typ"/>
					</status>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$unizType/ns2:dat_du">
						<timingPeriod>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$unizType/ns2:dat_up">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</timingPeriod>
					</xsl:for-each>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var3_test_resultof_exists">
						<source>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</source>
					</xsl:for-each>
					<device>
						<reference>
							<xsl:for-each select="$var13_unizf/@guid">
								<xsl:attribute name="value" namespace="" select="fn:concat('Device/', fn:string(.))"/>
							</xsl:for-each>
						</reference>
					</device>
				</DeviceUseStatement>
			</resource>
		</entry>
		<xsl:for-each select="$var13_unizf">
			<xsl:variable name="var6_guid" as="node()?" select="@guid"/>
			<xsl:variable name="var7_vguid" as="node()?" select="@vguid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var6_guid">
					<xsl:for-each select="$var7_vguid">
						<xsl:for-each select="$var6_guid">
							<xsl:variable name="var5_cur" as="node()" select="."/>
							<xsl:for-each select="$var7_vguid">
								<xsl:variable name="var4_resultof_Reference_Device" as="xs:string?">
									<xsl:call-template name="provisio:Reference_Device">
										<xsl:with-param name="GUID" select="fn:string($var5_cur)" as="xs:string"/>
										<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var4_resultof_Reference_Device">
									<fullUrl>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</fullUrl>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Device>
						<xsl:for-each select="$var6_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var7_vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<xsl:sequence select="$var9_create_lastUpdated_of_test_exists"/>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/core/StructureDefinition/cz-medical-device'))"/>
							</profile>
						</meta>
						<status>
							<xsl:sequence select="$var11_map_of_typ"/>
						</status>
						<xsl:for-each select="@niz_ident">
							<modelNumber>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</modelNumber>
						</xsl:for-each>
						<type>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
								</system>
								<code>
									<xsl:for-each select="@niz_klic">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="@niz_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</type>
					</Device>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_Flag">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Flag/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:urf">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="urfType" select="()"/>
		<xsl:param name="garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var9_urff" as="node()*" select="$urfType/ns2:urff"/>
		<xsl:variable name="var10_dat_ab" as="node()?" select="$urfType/@dat_ab"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var9_urff">
				<xsl:variable name="var4_cur" as="node()" select="."/>
				<xsl:for-each select="@guid">
					<xsl:variable name="var3_cur" as="node()" select="."/>
					<xsl:variable name="var2_vguid" as="node()?" select="$var4_cur/@vguid"/>
					<xsl:for-each select="$var2_vguid">
						<xsl:for-each select="$var2_vguid">
							<xsl:variable name="var1_resultof_Reference_Flag" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Flag">
									<xsl:with-param name="GUID" select="fn:string($var3_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Flag">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Flag>
					<xsl:for-each select="$var9_urff/@guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var9_urff/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<xsl:variable name="var5_test_resultof_exists" as="xs:string?">
							<xsl:choose>
								<xsl:when test="fn:exists($var10_dat_ab)">
									<xsl:sequence select="xs:string(xs:dateTime(fn:string($var10_dat_ab)))"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:for-each select="$dat_ab">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var5_test_resultof_exists">
							<lastUpdated>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(.))"/>
							</lastUpdated>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-flag-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:for-each select="$urfType/@typ">
							<xsl:variable name="var6_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf15_inputtoresult">
									<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var6_resultof_vmf___inputtoresult">
								<xsl:attribute name="value" namespace="" select="."/>
							</xsl:for-each>
						</xsl:for-each>
					</status>
					<code>
						<xsl:for-each select="$var9_urff">
							<xsl:variable name="var7_cur" as="node()" select="."/>
							<xsl:for-each select="@rf_klic">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/sid/icd-10'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<xsl:for-each select="$var7_cur/@rf_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</xsl:for-each>
						</xsl:for-each>
						<xsl:for-each select="$var9_urff/@info_text">
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</xsl:for-each>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:for-each select="$urfType/ns2:dat_du">
						<period>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$urfType/ns2:dat_up">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</period>
					</xsl:for-each>
					<xsl:variable name="var8_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var8_test_resultof_exists">
						<author>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</author>
					</xsl:for-each>
				</Flag>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:u_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ip_u" select="()"/>
		<xsl:param name="garant_dat_dasta" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="patsumdat_u" select="()"/>
		<xsl:for-each select="$ip_u/ns2:ua">
			<xsl:variable name="var1_map_of_ip_u" as="node()*">
				<xsl:for-each select="$ip_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var2_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var3_resultof_ua" as="node()?">
				<xsl:call-template name="provisio:ua">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="uaType" as="node()">
						<uaType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</uaType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var1_map_of_ip_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var2_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var3_resultof_ua">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_u/ns2:ua">
			<xsl:variable name="var4_map_of_patsumdat_u" as="node()*">
				<xsl:for-each select="$patsumdat_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var5_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var6_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var7_resultof_ua" as="node()?">
				<xsl:call-template name="provisio:ua">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="uaType" as="node()">
						<uaType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</uaType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var4_map_of_patsumdat_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var5_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var6_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var7_resultof_ua">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_u/ns2:urf">
			<xsl:variable name="var8_map_of_ip_u" as="node()*">
				<xsl:for-each select="$ip_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var9_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var10_resultof_urf" as="node()?">
				<xsl:call-template name="provisio:urf">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="urfType" as="node()">
						<urfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</urfType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var8_map_of_ip_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var9_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var10_resultof_urf">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_u/ns2:urf">
			<xsl:variable name="var11_map_of_patsumdat_u" as="node()*">
				<xsl:for-each select="$patsumdat_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var12_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var13_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var14_resultof_urf" as="node()?">
				<xsl:call-template name="provisio:urf">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="urfType" as="node()">
						<urfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</urfType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var11_map_of_patsumdat_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var12_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var13_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var14_resultof_urf">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_u/ns2:uniz">
			<xsl:variable name="var15_map_of_ip_u" as="node()*">
				<xsl:for-each select="$ip_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var16_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var17_resultof_uniz" as="node()*">
				<xsl:call-template name="provisio:uniz">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="unizType" as="node()">
						<unizType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</unizType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var15_map_of_ip_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var16_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var17_resultof_uniz">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_u/ns2:uniz">
			<xsl:variable name="var18_map_of_patsumdat_u" as="node()*">
				<xsl:for-each select="$patsumdat_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var19_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var20_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var21_resultof_uniz" as="node()*">
				<xsl:call-template name="provisio:uniz">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="unizType" as="node()">
						<unizType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</unizType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var18_map_of_patsumdat_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var19_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var20_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var21_resultof_uniz">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_u/ns2:utm">
			<xsl:variable name="var22_map_of_ip_u" as="node()*">
				<xsl:for-each select="$ip_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var23_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var24_resultof_utm" as="node()?">
				<xsl:call-template name="provisio:utm">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="utmType" as="node()">
						<utmType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</utmType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var22_map_of_ip_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var23_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var24_resultof_utm">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_u/ns2:utm">
			<xsl:variable name="var25_map_of_patsumdat_u" as="node()*">
				<xsl:for-each select="$patsumdat_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var26_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var27_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var28_resultof_utm" as="node()?">
				<xsl:call-template name="provisio:utm">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="utmType" as="node()">
						<utmType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</utmType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var25_map_of_patsumdat_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var26_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var27_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var28_resultof_utm">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_u/ns2:uks">
			<xsl:variable name="var29_map_of_ip_u" as="node()*">
				<xsl:for-each select="$ip_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var30_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var31_resultof_uks" as="node()?">
				<xsl:call-template name="provisio:uks">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="uksType" as="node()">
						<uksType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</uksType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var29_map_of_ip_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var30_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var31_resultof_uks">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_u/ns2:uks">
			<xsl:variable name="var32_map_of_patsumdat_u" as="node()*">
				<xsl:for-each select="$patsumdat_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var33_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var34_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var35_resultof_uks" as="node()?">
				<xsl:call-template name="provisio:uks">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="uksType" as="node()">
						<uksType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</uksType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var32_map_of_patsumdat_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var33_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var34_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var35_resultof_uks">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_u/ns2:uot">
			<xsl:variable name="var36_map_of_ip_u" as="node()*">
				<xsl:for-each select="$ip_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var37_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var38_resultof_uot" as="node()?">
				<xsl:call-template name="provisio:uot">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="uotType" as="node()">
						<uotType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</uotType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var36_map_of_ip_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var37_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var38_resultof_uot">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_u/ns2:uot">
			<xsl:variable name="var39_map_of_patsumdat_u" as="node()*">
				<xsl:for-each select="$patsumdat_u/ns2:garant_dat">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var40_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var41_create_garant_dat_of_garant_dat_dasta" as="node()*">
				<xsl:for-each select="$garant_dat_dasta">
					<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
						<xsl:sequence select="(./@node(), ./node())"/>
					</garant_dat>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var42_resultof_uot" as="node()?">
				<xsl:call-template name="provisio:uot">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="uotType" as="node()">
						<uotType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</uotType>
					</xsl:with-param>
					<xsl:with-param name="garant_dat" select="($var39_map_of_patsumdat_u)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var40_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var41_create_garant_dat_of_garant_dat_dasta)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var42_resultof_uot">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_CarePlan">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('CarePlan/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ld">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ldType" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var4_vguid" as="node()?" select="$ldType/@vguid"/>
		<xsl:variable name="var5_guid" as="node()?" select="$ldType/@guid"/>
		<xsl:variable name="var6_dat_ab" as="node()?" select="$ldType/@dat_ab"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var5_guid">
				<xsl:for-each select="$var4_vguid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var4_vguid">
							<xsl:variable name="var1_resultof_Reference_CarePlan" as="xs:string?">
								<xsl:call-template name="provisio:Reference_CarePlan">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_CarePlan">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<CarePlan>
					<xsl:for-each select="$var5_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var4_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-carePlan-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'completed'"/>
					</status>
					<intent>
						<xsl:attribute name="value" namespace="" select="'plan'"/>
					</intent>
					<xsl:for-each select="$ldType/ns2:text">
						<description>
							<xsl:for-each select="ns2:ptext">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</description>
					</xsl:for-each>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($var6_dat_ab)">
								<xsl:sequence select="xs:string(xs:dateTime(fn:string($var6_dat_ab)))"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$dat_ab">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<created>
						<xsl:for-each select="$var3_test_resultof_exists">
							<xsl:attribute name="value" namespace="" select="."/>
						</xsl:for-each>
					</created>
					<xsl:for-each select="$dasta_garant_dat">
						<author>
							<display>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</display>
						</author>
					</xsl:for-each>
				</CarePlan>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:ld_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ip_ld" select="()"/>
		<xsl:param name="patsumdat_ld" select="()"/>
		<xsl:param name="ds_dasta40331" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:for-each select="$ip_ld">
			<xsl:variable name="var1_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var2_resultof_ld" as="node()?">
				<xsl:call-template name="provisio:ld">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ldType" as="node()">
						<ldType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ldType>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var1_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var2_resultof_ld">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_ld">
			<xsl:variable name="var3_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var4_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var5_resultof_ld" as="node()?">
				<xsl:call-template name="provisio:ld">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="ldType" as="node()">
						<ldType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</ldType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var3_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var4_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var5_resultof_ld">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:h">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="hType" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:for-each select="$hType/@vyska">
			<xsl:variable name="var5_vguid_vyska" as="node()?" select="$hType/@vguid_vyska"/>
			<xsl:variable name="var6_guid_vyska" as="node()?" select="$hType/@guid_vyska"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var6_guid_vyska">
					<xsl:for-each select="$var5_vguid_vyska">
						<xsl:for-each select="$var6_guid_vyska">
							<xsl:variable name="var2_cur" as="node()" select="."/>
							<xsl:for-each select="$var5_vguid_vyska">
								<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
									<xsl:call-template name="provisio:Reference_Observation">
										<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
										<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var1_resultof_Reference_Observation">
									<fullUrl>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</fullUrl>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var6_guid_vyska">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var5_vguid_vyska">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-height-hdr'))"/>
							</profile>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8302-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Body height'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var4_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var3_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var3_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var3_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var4_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$hType/ns2:autor">
							<performer>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
						<xsl:for-each select="$hType/ns2:pozn">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@hmotnost">
			<xsl:variable name="var11_vguid_hmotnost" as="node()?" select="$hType/@vguid_hmotnost"/>
			<xsl:variable name="var12_guid_hmotnost" as="node()?" select="$hType/@guid_hmotnost"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var12_guid_hmotnost">
					<xsl:for-each select="$var11_vguid_hmotnost">
						<xsl:for-each select="$var12_guid_hmotnost">
							<xsl:variable name="var8_cur" as="node()" select="."/>
							<xsl:for-each select="$var11_vguid_hmotnost">
								<xsl:variable name="var7_resultof_Reference_Observation" as="xs:string?">
									<xsl:call-template name="provisio:Reference_Observation">
										<xsl:with-param name="GUID" select="fn:string($var8_cur)" as="xs:string"/>
										<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var7_resultof_Reference_Observation">
									<fullUrl>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</fullUrl>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var12_guid_hmotnost">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var11_vguid_hmotnost">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-weight-hdr'))"/>
							</profile>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'29463-7'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Body weight'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var10_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var9_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var9_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var9_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var10_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$hType/ns2:autor">
							<performer>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:decimal(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'kg'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'kg'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@bmi">
			<xsl:variable name="var17_vguid_bmi" as="node()?" select="$hType/@vguid_bmi"/>
			<xsl:variable name="var18_guid_bmi" as="node()?" select="$hType/@guid_bmi"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var18_guid_bmi">
					<xsl:for-each select="$var17_vguid_bmi">
						<xsl:for-each select="$var18_guid_bmi">
							<xsl:variable name="var14_cur" as="node()" select="."/>
							<xsl:for-each select="$var17_vguid_bmi">
								<xsl:variable name="var13_resultof_Reference_Observation" as="xs:string?">
									<xsl:call-template name="provisio:Reference_Observation">
										<xsl:with-param name="GUID" select="fn:string($var14_cur)" as="xs:string"/>
										<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var13_resultof_Reference_Observation">
									<fullUrl>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</fullUrl>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var18_guid_bmi">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var17_vguid_bmi">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-BMI-hdr'))"/>
							</profile>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'39156-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Body mass index (BMI) [Ratio]'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var16_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var15_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var15_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var15_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var16_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$hType/ns2:autor">
							<performer>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:decimal(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'kg/m2'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'kg/m2'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@o_hlava">
			<xsl:variable name="var23_vguid_o_hlava" as="node()?" select="$hType/@vguid_o_hlava"/>
			<xsl:variable name="var24_guid_o_hlava" as="node()?" select="$hType/@guid_o_hlava"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var24_guid_o_hlava">
					<xsl:for-each select="$var23_vguid_o_hlava">
						<xsl:for-each select="$var24_guid_o_hlava">
							<xsl:variable name="var20_cur" as="node()" select="."/>
							<xsl:for-each select="$var23_vguid_o_hlava">
								<xsl:variable name="var19_resultof_Reference_Observation" as="xs:string?">
									<xsl:call-template name="provisio:Reference_Observation">
										<xsl:with-param name="GUID" select="fn:string($var20_cur)" as="xs:string"/>
										<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var19_resultof_Reference_Observation">
									<fullUrl>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</fullUrl>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var24_guid_o_hlava">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var23_vguid_o_hlava">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-headCircumference-hdr'))"/>
							</profile>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8287-5'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Head Occipital-frontal circumference by Tape measure'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var22_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var21_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var21_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var21_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var22_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$hType/ns2:autor">
							<performer>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@o_hrudnik">
			<xsl:variable name="var29_guid_o_hrudnik" as="node()?" select="$hType/@guid_o_hrudnik"/>
			<xsl:variable name="var30_vguid_o_hrudnik" as="node()?" select="$hType/@vguid_o_hrudnik"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var29_guid_o_hrudnik">
					<xsl:for-each select="$var30_vguid_o_hrudnik">
						<xsl:for-each select="$var29_guid_o_hrudnik">
							<xsl:variable name="var26_cur" as="node()" select="."/>
							<xsl:for-each select="$var30_vguid_o_hrudnik">
								<xsl:variable name="var25_resultof_Reference_Observation" as="xs:string?">
									<xsl:call-template name="provisio:Reference_Observation">
										<xsl:with-param name="GUID" select="fn:string($var26_cur)" as="xs:string"/>
										<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var25_resultof_Reference_Observation">
									<fullUrl>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</fullUrl>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var29_guid_o_hrudnik">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var30_vguid_o_hrudnik">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-chestCircumference-hdr'))"/>
							</profile>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'8280-0'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Waist Circumference at umbilicus by Tape measure'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var28_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var27_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var27_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var27_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var28_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$hType/ns2:autor">
							<performer>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
		<xsl:for-each select="$hType/@o_pas">
			<xsl:variable name="var35_guid_o_pas" as="node()?" select="$hType/@guid_o_pas"/>
			<xsl:variable name="var36_vguid_o_pas" as="node()?" select="$hType/@vguid_o_pas"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var35_guid_o_pas">
					<xsl:for-each select="$var36_vguid_o_pas">
						<xsl:for-each select="$var35_guid_o_pas">
							<xsl:variable name="var32_cur" as="node()" select="."/>
							<xsl:for-each select="$var36_vguid_o_pas">
								<xsl:variable name="var31_resultof_Reference_Observation" as="xs:string?">
									<xsl:call-template name="provisio:Reference_Observation">
										<xsl:with-param name="GUID" select="fn:string($var32_cur)" as="xs:string"/>
										<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var31_resultof_Reference_Observation">
									<fullUrl>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</fullUrl>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var35_guid_o_pas">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var36_vguid_o_pas">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-observation-abdominalCircumference-hdr'))"/>
							</profile>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<category>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
								</display>
							</coding>
						</category>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'56086-2'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'Adult Waist Circumference Protocol'"/>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var34_test_resultof_exists" as="xs:string*">
							<xsl:choose>
								<xsl:when test="fn:exists($dat_prov)">
									<xsl:for-each select="$dat_prov">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:variable name="var33_dat_ab" as="node()?" select="$hType/@dat_ab"/>
									<xsl:choose>
										<xsl:when test="fn:exists($var33_dat_ab)">
											<xsl:sequence select="xs:string(xs:dateTime(fn:string($var33_dat_ab)))"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:for-each select="$hType/ns2:dat_vys">
												<xsl:sequence select="fn:string(.)"/>
											</xsl:for-each>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var34_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="$hType/ns2:autor">
							<performer>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</performer>
						</xsl:for-each>
						<valueQuantity>
							<value>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
							</value>
							<unit>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</unit>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'cm'"/>
							</code>
						</valueQuantity>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:h_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="ip_h" select="()"/>
		<xsl:param name="patsumdat_h" select="()"/>
		<xsl:for-each select="$ip_h">
			<xsl:variable name="var1_resultof_h" as="node()*">
				<xsl:call-template name="provisio:h">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="hType" as="node()">
						<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</hType>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" as="node()*">
						<xsl:for-each select="$dat_prov">
							<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</dat_prov>
						</xsl:for-each>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1_resultof_h">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_h">
			<xsl:variable name="var2_resultof_h" as="node()*">
				<xsl:call-template name="provisio:h">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="hType" as="node()">
						<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</hType>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" as="node()*">
						<xsl:for-each select="$dat_prov">
							<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</dat_prov>
						</xsl:for-each>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var2_resultof_h">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_DiagnosticReport">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('DiagnosticReport/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:an">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="anType" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var5_guid" as="node()?" select="$anType/@guid"/>
		<xsl:variable name="var6_vguid" as="node()?" select="$anType/@vguid"/>
		<xsl:variable name="var7_dat_ab" as="node()?" select="$anType/@dat_ab"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var5_guid">
				<xsl:for-each select="$var6_vguid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var6_vguid">
							<xsl:variable name="var1_resultof_Reference_DiagnosticReport" as="xs:string?">
								<xsl:call-template name="provisio:Reference_DiagnosticReport">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_DiagnosticReport">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<DiagnosticReport>
					<xsl:for-each select="$var5_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var6_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://loinc.org/'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'34117-2'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'History and physical note'"/>
							</display>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:variable name="var3_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($var7_dat_ab)">
								<xsl:sequence select="xs:string(xs:dateTime(fn:string($var7_dat_ab)))"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$dat_ab">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var3_test_resultof_exists">
						<effectiveDateTime>
							<xsl:attribute name="value" namespace="" select="."/>
						</effectiveDateTime>
					</xsl:for-each>
					<xsl:variable name="var4_test_resultof_exists" as="xs:string*">
						<xsl:choose>
							<xsl:when test="fn:exists($dasta_garant_dat)">
								<xsl:sequence select="fn:string($dasta_garant_dat)"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$anType/ns2:garant_dat">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var4_test_resultof_exists">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="."/>
							</display>
						</performer>
					</xsl:for-each>
					<conclusion>
						<xsl:for-each select="$anType/ns2:text/ns2:ptext">
							<xsl:attribute name="value" namespace="" select="fn:normalize-space(fn:string(.))"/>
						</xsl:for-each>
					</conclusion>
				</DiagnosticReport>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:an_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="ds_dasta40331" select="()"/>
		<xsl:param name="ip_an" select="()"/>
		<xsl:param name="patsumdat_an" select="()"/>
		<xsl:for-each select="$ip_an">
			<xsl:variable name="var1_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var2_resultof_an" as="node()?">
				<xsl:call-template name="provisio:an">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anType" as="node()">
						<anType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anType>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var1_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var2_resultof_an">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_an">
			<xsl:variable name="var3_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var4_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var5_resultof_an" as="node()?">
				<xsl:call-template name="provisio:an">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="anType" as="node()">
						<anType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</anType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var3_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var4_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var5_resultof_an">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:grav">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="gravType" select="()"/>
		<xsl:param name="garant_datReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var16_guid" as="node()?" select="$gravType/@guid"/>
		<xsl:variable name="var17_typ" as="node()?" select="$gravType/@typ"/>
		<xsl:variable name="var18_http___loinc_org_as_string" as="xs:string" select="xs:string(xs:anyURI('http://loinc.org'))"/>
		<xsl:variable name="var19_display" as="node()*" select="$garant_datReference/ns0:display"/>
		<xsl:variable name="var20_vguid" as="node()?" select="$gravType/@vguid"/>
		<xsl:variable name="var21_grav_tp" as="node()*" select="$gravType/ns2:grav_tp"/>
		<xsl:variable name="var15_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var13_test_resultof_exists" as="xs:string*">
			<xsl:choose>
				<xsl:when test="fn:exists($dat_prov)">
					<xsl:for-each select="$dat_prov">
						<xsl:sequence select="fn:string(.)"/>
					</xsl:for-each>
				</xsl:when>
				<xsl:otherwise>
					<xsl:variable name="var12_dat_ab" as="node()?" select="$gravType/@dat_ab"/>
					<xsl:choose>
						<xsl:when test="fn:exists($var12_dat_ab)">
							<xsl:sequence select="xs:string(xs:dateTime(fn:string($var12_dat_ab)))"/>
						</xsl:when>
						<xsl:otherwise>
							<xsl:for-each select="$gravType/ns2:dat_vys">
								<xsl:sequence select="fn:string(.)"/>
							</xsl:for-each>
						</xsl:otherwise>
					</xsl:choose>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		<xsl:variable name="var14_create_effectiveDateTime_of_test_exists" as="node()*">
			<xsl:for-each select="$var13_test_resultof_exists">
				<effectiveDateTime xmlns="http://hl7.org/fhir">
					<xsl:attribute name="value" namespace="" select="."/>
				</effectiveDateTime>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var16_guid">
				<xsl:for-each select="$var20_vguid">
					<xsl:for-each select="$var16_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var20_vguid">
							<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Observation">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Observation">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Observation>
					<xsl:for-each select="$var16_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var20_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-pregnancy-status-uv-ips'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'final'"/>
					</status>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="$var18_http___loinc_org_as_string"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'82810-3'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Pregnancy status'"/>
							</display>
						</coding>
					</code>
					<subject>
						<xsl:sequence select="$var15_let"/>
					</subject>
					<xsl:sequence select="$var14_create_effectiveDateTime_of_test_exists"/>
					<xsl:for-each select="$var19_display/@value">
						<performer>
							<display>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</display>
						</performer>
					</xsl:for-each>
					<valueCodeableConcept>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
							</system>
							<code>
								<xsl:for-each select="$var17_typ">
									<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf16_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$var17_typ">
									<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf16_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
										<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf17_inputtoresult">
												<xsl:with-param name="input" select="." as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</display>
						</coding>
					</valueCodeableConcept>
					<xsl:for-each select="$var21_grav_tp">
						<hasMember>
							<reference>
								<xsl:for-each select="@guid">
									<xsl:attribute name="value" namespace="" select="fn:concat('Observation/', fn:string(.))"/>
								</xsl:for-each>
							</reference>
						</hasMember>
					</xsl:for-each>
				</Observation>
			</resource>
		</entry>
		<xsl:for-each select="$var21_grav_tp">
			<xsl:variable name="var9_zutp_klic" as="node()?" select="@zutp_klic"/>
			<xsl:variable name="var10_guid" as="node()?" select="@guid"/>
			<xsl:variable name="var11_vguid" as="node()?" select="@vguid"/>
			<entry xmlns="http://hl7.org/fhir">
				<xsl:for-each select="$var10_guid">
					<xsl:for-each select="$var11_vguid">
						<xsl:for-each select="$var10_guid">
							<xsl:variable name="var7_cur" as="node()" select="."/>
							<xsl:for-each select="$var11_vguid">
								<xsl:variable name="var6_resultof_Reference_Observation" as="xs:string?">
									<xsl:call-template name="provisio:Reference_Observation">
										<xsl:with-param name="GUID" select="fn:string($var7_cur)" as="xs:string"/>
										<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var6_resultof_Reference_Observation">
									<fullUrl>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
									</fullUrl>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
				<resource>
					<Observation>
						<xsl:for-each select="$var10_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$var11_vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
							<profile>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/uv/ips/StructureDefinition/Observation-pregnancy-edd-uv-ips'))"/>
							</profile>
						</meta>
						<status>
							<xsl:attribute name="value" namespace="" select="'final'"/>
						</status>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var18_http___loinc_org_as_string"/>
								</system>
								<code>
									<xsl:for-each select="$var9_zutp_klic">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="$var9_zutp_klic">
										<xsl:variable name="var8_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf18_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var8_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</display>
							</coding>
						</code>
						<subject>
							<xsl:sequence select="$var15_let"/>
						</subject>
						<xsl:sequence select="$var14_create_effectiveDateTime_of_test_exists"/>
						<xsl:for-each select="$var19_display">
							<performer>
								<xsl:for-each select="@id">
									<xsl:attribute name="id" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
								<xsl:for-each select="@value">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:dat_por">
							<valueDateTime>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:date(fn:string(.)))"/>
							</valueDateTime>
						</xsl:for-each>
					</Observation>
				</resource>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:grav_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="garant_datReference" select="()"/>
		<xsl:param name="ip_grav" select="()"/>
		<xsl:param name="patsumdat_grav" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:for-each select="$ip_grav">
			<xsl:variable name="var1_resultof_grav" as="node()*">
				<xsl:call-template name="provisio:grav">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="gravType" as="node()">
						<gravType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</gravType>
					</xsl:with-param>
					<xsl:with-param name="garant_datReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($garant_datReference/@node(), $garant_datReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" as="node()*">
						<xsl:for-each select="$dat_prov">
							<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</dat_prov>
						</xsl:for-each>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var1_resultof_grav">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_grav">
			<xsl:variable name="var2_resultof_grav" as="node()*">
				<xsl:call-template name="provisio:grav">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="gravType" as="node()">
						<gravType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</gravType>
					</xsl:with-param>
					<xsl:with-param name="garant_datReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($garant_datReference/@node(), $garant_datReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="dat_prov" as="node()*">
						<xsl:for-each select="$dat_prov">
							<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
								<xsl:sequence select="(./@node(), ./node())"/>
							</dat_prov>
						</xsl:for-each>
					</xsl:with-param>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var2_resultof_grav">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_Observation">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Observation/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:fyznal">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="fyznalType" select="()"/>
		<xsl:param name="garant_datReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var8_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var5_http___loinc_org_as_string" as="xs:string" select="xs:string(xs:anyURI('http://loinc.org'))"/>
				<xsl:variable name="var6_vguid_tk" as="node()?" select="$var8_cur/@vguid_tk"/>
				<xsl:variable name="var7_guid_tk" as="node()?" select="$var8_cur/@guid_tk"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var7_guid_tk">
						<xsl:for-each select="$var6_vguid_tk">
							<xsl:for-each select="$var7_guid_tk">
								<xsl:variable name="var2_cur" as="node()" select="."/>
								<xsl:for-each select="$var6_vguid_tk">
									<xsl:variable name="var1_resultof_Reference_Observation" as="xs:string?">
										<xsl:call-template name="provisio:Reference_Observation">
											<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
											<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var1_resultof_Reference_Observation">
										<fullUrl>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
										</fullUrl>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var7_guid_tk">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var6_vguid_tk">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/bp'))"/>
								</profile>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="$var5_http___loinc_org_as_string"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'85354-9'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Blood pressure panel with all children optional'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var4_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var3_dat_ab" as="node()?" select="$var8_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var3_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var3_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var8_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var4_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$garant_datReference/ns0:display/@value">
								<performer>
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var8_cur/ns2:pozn">
								<note>
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</note>
							</xsl:for-each>
							<xsl:for-each select="$var8_cur/ns2:tk_syst">
								<component>
									<code>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="$var5_http___loinc_org_as_string"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="'8480-6'"/>
											</code>
											<display>
												<xsl:attribute name="value" namespace="" select="'Systolic blood pressure'"/>
											</display>
										</coding>
									</code>
									<valueQuantity>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</value>
										<unit>
											<xsl:attribute name="value" namespace="" select="'mmHg'"/>
										</unit>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="'mm[Hg]'"/>
										</code>
									</valueQuantity>
								</component>
							</xsl:for-each>
							<xsl:for-each select="$var8_cur/ns2:tk_diast">
								<component>
									<code>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="$var5_http___loinc_org_as_string"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="'8462-4'"/>
											</code>
											<display>
												<xsl:attribute name="value" namespace="" select="'Diastolic blood pressure'"/>
											</display>
										</coding>
									</code>
									<valueQuantity>
										<value>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</value>
										<unit>
											<xsl:attribute name="value" namespace="" select="'mmHg'"/>
										</unit>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="'mm[Hg]'"/>
										</code>
									</valueQuantity>
								</component>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var15_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var13_guid_pulz" as="node()?" select="$var15_cur/@guid_pulz"/>
				<xsl:variable name="var14_vguid_pulz" as="node()?" select="$var15_cur/@vguid_pulz"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var13_guid_pulz">
						<xsl:for-each select="$var14_vguid_pulz">
							<xsl:for-each select="$var13_guid_pulz">
								<xsl:variable name="var10_cur" as="node()" select="."/>
								<xsl:for-each select="$var14_vguid_pulz">
									<xsl:variable name="var9_resultof_Reference_Observation" as="xs:string?">
										<xsl:call-template name="provisio:Reference_Observation">
											<xsl:with-param name="GUID" select="fn:string($var10_cur)" as="xs:string"/>
											<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var9_resultof_Reference_Observation">
										<fullUrl>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
										</fullUrl>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var13_guid_pulz">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var14_vguid_pulz">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/heartrate'))"/>
								</profile>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'8867-4'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Heart rate'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var12_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var11_dat_ab" as="node()?" select="$var15_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var11_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var11_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var15_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var12_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$garant_datReference/ns0:display/@value">
								<performer>
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var15_cur/ns2:pulz">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var22_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var20_vguid_o_sat" as="node()?" select="$var22_cur/@vguid_o2sat"/>
				<xsl:variable name="var21_guid_o_sat" as="node()?" select="$var22_cur/@guid_o2sat"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var21_guid_o_sat">
						<xsl:for-each select="$var20_vguid_o_sat">
							<xsl:for-each select="$var21_guid_o_sat">
								<xsl:variable name="var17_cur" as="node()" select="."/>
								<xsl:for-each select="$var20_vguid_o_sat">
									<xsl:variable name="var16_resultof_Reference_Observation" as="xs:string?">
										<xsl:call-template name="provisio:Reference_Observation">
											<xsl:with-param name="GUID" select="fn:string($var17_cur)" as="xs:string"/>
											<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var16_resultof_Reference_Observation">
										<fullUrl>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
										</fullUrl>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var21_guid_o_sat">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var20_vguid_o_sat">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/oxygensat'))"/>
								</profile>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'2708-6'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Oxygen saturation in Arterial blood'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var19_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var18_dat_ab" as="node()?" select="$var22_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var18_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var18_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var22_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var19_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$garant_datReference/ns0:display/@value">
								<performer>
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var22_cur/ns2:o2sat">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'%'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'%'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var29_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var27_guid_dech" as="node()?" select="$var29_cur/@guid_dech"/>
				<xsl:variable name="var28_vguid_dech" as="node()?" select="$var29_cur/@vguid_dech"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var27_guid_dech">
						<xsl:for-each select="$var28_vguid_dech">
							<xsl:for-each select="$var27_guid_dech">
								<xsl:variable name="var24_cur" as="node()" select="."/>
								<xsl:for-each select="$var28_vguid_dech">
									<xsl:variable name="var23_resultof_Reference_Observation" as="xs:string?">
										<xsl:call-template name="provisio:Reference_Observation">
											<xsl:with-param name="GUID" select="fn:string($var24_cur)" as="xs:string"/>
											<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var23_resultof_Reference_Observation">
										<fullUrl>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
										</fullUrl>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var27_guid_dech">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var28_vguid_dech">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/resprate'))"/>
								</profile>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'9279-1'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Respiratory rate'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var26_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var25_dat_ab" as="node()?" select="$var29_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var25_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var25_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var29_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var26_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$garant_datReference/ns0:display/@value">
								<performer>
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var29_cur/ns2:dech">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'/min'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$fyznalType">
			<xsl:variable name="var36_cur" as="node()" select="."/>
			<xsl:for-each select="@ind_oprav_sd">
				<xsl:variable name="var34_guid_teplota" as="node()?" select="$var36_cur/@guid_teplota"/>
				<xsl:variable name="var35_vguid_teplota" as="node()?" select="$var36_cur/@vguid_teplota"/>
				<entry xmlns="http://hl7.org/fhir">
					<xsl:for-each select="$var34_guid_teplota">
						<xsl:for-each select="$var35_vguid_teplota">
							<xsl:for-each select="$var34_guid_teplota">
								<xsl:variable name="var31_cur" as="node()" select="."/>
								<xsl:for-each select="$var35_vguid_teplota">
									<xsl:variable name="var30_resultof_Reference_Observation" as="xs:string?">
										<xsl:call-template name="provisio:Reference_Observation">
											<xsl:with-param name="GUID" select="fn:string($var31_cur)" as="xs:string"/>
											<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var30_resultof_Reference_Observation">
										<fullUrl>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
										</fullUrl>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
					<resource>
						<Observation>
							<xsl:for-each select="$var34_guid_teplota">
								<id>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</id>
							</xsl:for-each>
							<meta>
								<xsl:for-each select="$var35_vguid_teplota">
									<versionId>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</versionId>
								</xsl:for-each>
								<profile>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/bodytemp'))"/>
								</profile>
							</meta>
							<status>
								<xsl:attribute name="value" namespace="" select="'final'"/>
							</status>
							<category>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/observation-category'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'vital-signs'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Vital Signs'"/>
									</display>
								</coding>
							</category>
							<code>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://loinc.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'8310-5'"/>
									</code>
									<display>
										<xsl:attribute name="value" namespace="" select="'Body temperature'"/>
									</display>
								</coding>
							</code>
							<subject>
								<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
							</subject>
							<xsl:variable name="var33_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($dat_prov)">
										<xsl:for-each select="$dat_prov">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:when>
									<xsl:otherwise>
										<xsl:variable name="var32_dat_ab" as="node()?" select="$var36_cur/@dat_ab"/>
										<xsl:choose>
											<xsl:when test="fn:exists($var32_dat_ab)">
												<xsl:sequence select="xs:string(xs:dateTime(fn:string($var32_dat_ab)))"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:for-each select="$var36_cur/ns2:dat_vys">
													<xsl:sequence select="fn:string(.)"/>
												</xsl:for-each>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var33_test_resultof_exists">
								<effectiveDateTime>
									<xsl:attribute name="value" namespace="" select="."/>
								</effectiveDateTime>
							</xsl:for-each>
							<xsl:for-each select="$garant_datReference/ns0:display/@value">
								<performer>
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</performer>
							</xsl:for-each>
							<xsl:for-each select="$var36_cur/ns2:teplota">
								<valueQuantity>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
									<unit>
										<xsl:attribute name="value" namespace="" select="'C'"/>
									</unit>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://unitsofmeasure.org'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'Cel'"/>
									</code>
								</valueQuantity>
							</xsl:for-each>
						</Observation>
					</resource>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:fyznal_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ip_fyznal" select="()"/>
		<xsl:param name="patsumdat_fyznal" select="()"/>
		<xsl:param name="garant_datReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:variable name="var4_let" as="node()*" select="($garant_datReference/@node(), $garant_datReference/node())"/>
		<xsl:variable name="var5_let" as="node()*" select="($patientReference/@node(), $patientReference/node())"/>
		<xsl:variable name="var3_create_dat_prov_of_dat_prov" as="node()*">
			<xsl:for-each select="$dat_prov">
				<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
					<xsl:sequence select="(./@node(), ./node())"/>
				</dat_prov>
			</xsl:for-each>
		</xsl:variable>
		<xsl:variable name="var1_resultof_fyznal" as="node()*">
			<xsl:call-template name="provisio:fyznal">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var5_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="fyznalType" as="node()*">
					<xsl:for-each select="$ip_fyznal">
						<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</fyznalType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="garant_datReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var4_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var3_create_dat_prov_of_dat_prov" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var1_resultof_fyznal">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
		<xsl:variable name="var2_resultof_fyznal" as="node()*">
			<xsl:call-template name="provisio:fyznal">
				<xsl:with-param name="patientReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var5_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="fyznalType" as="node()*">
					<xsl:for-each select="$patsumdat_fyznal">
						<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</fyznalType>
					</xsl:for-each>
				</xsl:with-param>
				<xsl:with-param name="garant_datReference" as="node()">
					<Reference xmlns="http://hl7.org/fhir">
						<xsl:sequence select="$var4_let"/>
					</Reference>
				</xsl:with-param>
				<xsl:with-param name="dat_prov" select="$var3_create_dat_prov_of_dat_prov" as="node()*"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:for-each select="$var2_resultof_fyznal">
			<entry xmlns="http://hl7.org/fhir">
				<xsl:sequence select="(./@node(), ./node())"/>
			</entry>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_Immunization">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Immunization/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:oc">
		<xsl:param name="Reference" select="()"/>
		<xsl:param name="oczType" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var9_guid" as="node()?" select="$oczType/@guid"/>
		<xsl:variable name="var10_davka" as="node()*" select="$oczType/ns2:davka"/>
		<xsl:variable name="var11_vguid" as="node()?" select="$oczType/@vguid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var9_guid">
				<xsl:for-each select="$var11_vguid">
					<xsl:for-each select="$var9_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var11_vguid">
							<xsl:variable name="var1_resultof_Reference_Immunization" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Immunization">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Immunization">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Immunization>
					<xsl:for-each select="$var9_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var11_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-immunization-hdr'))"/>
						</profile>
					</meta>
					<xsl:for-each select="$oczType/@id_ockovani">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'ID okovn'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSALA.htm'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$oczType/@id_ockovani_isin">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'ID okovn dle ISIN'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.uzis.cz/'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var10_davka/@id_davka">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'ID dvky okovn'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSALA.htm'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var10_davka/@id_davka_isin">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'ID dvky dle ISIN'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.uzis.cz/'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<status>
						<xsl:attribute name="value" namespace="" select="'completed'"/>
					</status>
					<vaccineCode>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSAHW.htm'))"/>
							</system>
							<code>
								<xsl:for-each select="$oczType/@typ_oc_kod">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$oczType/@typ_oc_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</coding>
						<xsl:for-each select="$var10_davka">
							<xsl:variable name="var3_cur" as="node()" select="."/>
							<xsl:for-each select="@kod_ol">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://www.sukl.cz'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<display>
										<xsl:for-each select="$var3_cur/@nazev_ol">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
									<xsl:for-each select="$var3_cur/@gene_ol">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</xsl:for-each>
						</xsl:for-each>
						<xsl:for-each select="$oczType/ns2:agens">
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/DSAKM.htm'))"/>
								</system>
								<code>
									<xsl:for-each select="@agens_klic">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<xsl:for-each select="@agens_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
						</xsl:for-each>
						<xsl:for-each select="$var10_davka/@pozn">
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</xsl:for-each>
					</vaccineCode>
					<patient>
						<xsl:sequence select="($Reference/@node(), $Reference/node())"/>
					</patient>
					<xsl:variable name="var4_test_resultof_any" as="xs:string*">
						<xsl:choose>
							<xsl:when test="fn:exists(($var10_davka)[fn:exists(ns2:dat_du)])">
								<xsl:for-each select="$var10_davka/ns2:dat_du">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$dat_ab">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var4_test_resultof_any">
						<occurrenceDateTime>
							<xsl:attribute name="value" namespace="" select="."/>
						</occurrenceDateTime>
					</xsl:for-each>
					<xsl:for-each select="$var10_davka/@nazev_vyrobce">
						<manufacturer>
							<display>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</display>
						</manufacturer>
					</xsl:for-each>
					<xsl:for-each select="$var10_davka/@cis_sarze">
						<lotNumber>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</lotNumber>
					</xsl:for-each>
					<xsl:for-each select="$var10_davka/ns2:dat_expirace">
						<expirationDate>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</expirationDate>
					</xsl:for-each>
					<xsl:for-each select="$var10_davka">
						<xsl:variable name="var5_cur" as="node()" select="."/>
						<xsl:for-each select="@misto_apl_klic">
							<site>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUU.htm'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<xsl:for-each select="$var5_cur/@misto_apl_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</site>
						</xsl:for-each>
					</xsl:for-each>
					<xsl:for-each select="$var10_davka">
						<xsl:variable name="var6_cur" as="node()" select="."/>
						<xsl:for-each select="@apl_cesta_klic">
							<route>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUT.htm'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</code>
									<xsl:for-each select="$var6_cur/@apl_cesta_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</route>
						</xsl:for-each>
					</xsl:for-each>
					<xsl:for-each select="$dasta_garant_dat">
						<performer>
							<actor>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</actor>
						</performer>
					</xsl:for-each>
					<xsl:for-each select="$oczType/ns2:indikace">
						<reasonCode>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.uzis.cz/'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
								<xsl:for-each select="$oczType/@indikace_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
						</reasonCode>
					</xsl:for-each>
					<xsl:for-each select="$var10_davka/ns2:reakce">
						<xsl:variable name="var8_typ" as="node()?" select="@typ"/>
						<reaction>
							<date>
								<xsl:for-each select="ns2:dat_or">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</date>
							<detail>
								<type>
									<xsl:for-each select="$var8_typ">
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
									</xsl:for-each>
								</type>
								<display>
									<xsl:for-each select="$var8_typ">
										<xsl:variable name="var7_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf19_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var7_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</display>
							</detail>
						</reaction>
					</xsl:for-each>
					<xsl:for-each select="$var10_davka">
						<protocolApplied>
							<doseNumberPositiveInt>
								<xsl:for-each select="@cis_davky">
									<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
								</xsl:for-each>
							</doseNumberPositiveInt>
							<xsl:for-each select="@poc_davek">
								<seriesDosesString>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
								</seriesDosesString>
							</xsl:for-each>
						</protocolApplied>
					</xsl:for-each>
				</Immunization>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:oc_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:param name="ip_oc" select="()"/>
		<xsl:param name="anf_anam_oc" select="()"/>
		<xsl:param name="patsumdat_anf_anam_oc" select="()"/>
		<xsl:param name="patsumdat_oc" select="()"/>
		<xsl:param name="ds_ip415076" select="()"/>
		<xsl:param name="dsipdat_ab" select="()"/>
		<xsl:param name="ds_dasta40331" select="()"/>
		<xsl:for-each select="$ip_oc/ns2:ocz">
			<xsl:variable name="var1_create_dat_ab_of_dsipdat_ab" as="node()*">
				<xsl:for-each select="$dsipdat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="xs:string(.)"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var2_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var3_resultof_oc" as="node()?">
				<xsl:call-template name="provisio:oc">
					<xsl:with-param name="Reference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="oczType" as="node()">
						<oczType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</oczType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var1_create_dat_ab_of_dsipdat_ab)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var2_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var3_resultof_oc">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$anf_anam_oc/ns2:ocz">
			<xsl:variable name="var4_create_dat_ab_of_ds_ip______" as="node()*">
				<xsl:for-each select="$ds_ip415076">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var5_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var6_resultof_oc" as="node()?">
				<xsl:call-template name="provisio:oc">
					<xsl:with-param name="Reference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="oczType" as="node()">
						<oczType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</oczType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var4_create_dat_ab_of_ds_ip______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var5_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var6_resultof_oc">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf_anam_oc/ns2:ocz">
			<xsl:variable name="var7_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var8_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var9_resultof_oc" as="node()?">
				<xsl:call-template name="provisio:oc">
					<xsl:with-param name="Reference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="oczType" as="node()">
						<oczType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</oczType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var7_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var8_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var9_resultof_oc">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_oc/ns2:ocz">
			<xsl:variable name="var10_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var11_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var12_resultof_oc" as="node()?">
				<xsl:call-template name="provisio:oc">
					<xsl:with-param name="Reference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="oczType" as="node()">
						<oczType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</oczType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var10_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var11_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var12_resultof_oc">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:fs">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="fsType" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var5_guid" as="node()?" select="$fsType/@guid"/>
		<xsl:variable name="var6_dat_ab" as="node()?" select="$fsType/@dat_ab"/>
		<xsl:variable name="var7_typ" as="node()?" select="$fsType/@typ"/>
		<xsl:variable name="var8_vguid" as="node()?" select="$fsType/@vguid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var5_guid">
				<xsl:for-each select="$var8_vguid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var8_vguid">
							<xsl:variable name="var1_resultof_Reference_Condition" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Condition">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Condition">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Condition>
					<xsl:for-each select="$var5_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var8_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
					</meta>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/ValueSet/condition-category'))"/>
							</system>
							<code>
								<xsl:for-each select="$var7_typ">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$var7_typ">
									<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf20_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</display>
						</coding>
					</category>
					<xsl:for-each select="$fsType/ns2:text">
						<code>
							<text>
								<xsl:for-each select="ns2:ptext">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
						</code>
					</xsl:for-each>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:variable name="var4_test_resultof_exists" as="xs:string?">
						<xsl:choose>
							<xsl:when test="fn:exists($var6_dat_ab)">
								<xsl:sequence select="xs:string(xs:dateTime(fn:string($var6_dat_ab)))"/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$dat_ab">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var4_test_resultof_exists">
						<recordedDate>
							<xsl:attribute name="value" namespace="" select="."/>
						</recordedDate>
					</xsl:for-each>
					<xsl:for-each select="$dasta_garant_dat">
						<recorder>
							<display>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</display>
						</recorder>
					</xsl:for-each>
				</Condition>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:fs_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ds_dasta40331" select="()"/>
		<xsl:param name="ip_fs" select="()"/>
		<xsl:param name="patsumdat_fs" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:for-each select="$ip_fs">
			<xsl:variable name="var1_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var2_resultof_fs" as="node()?">
				<xsl:call-template name="provisio:fs">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="fsType" as="node()">
						<fsType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</fsType>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var1_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var2_resultof_fs">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_fs">
			<xsl:variable name="var3_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var4_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var5_resultof_fs" as="node()?">
				<xsl:call-template name="provisio:fs">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="fsType" as="node()">
						<fsType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</fsType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var3_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var4_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var5_resultof_fs">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_Condition">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Condition/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:dg">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="dgzType" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:variable name="var6_dat_vb" as="node()*" select="$dgzType/ns2:dat_vb"/>
		<xsl:variable name="var7_vguid" as="node()?" select="$dgzType/@vguid"/>
		<xsl:variable name="var8_guid" as="node()?" select="$dgzType/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var8_guid">
				<xsl:for-each select="$var7_vguid">
					<xsl:for-each select="$var8_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var7_vguid">
							<xsl:variable name="var1_resultof_Reference_Condition" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Condition">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Condition">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Condition>
					<xsl:for-each select="$var8_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var7_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-condition-hdr'))"/>
						</profile>
					</meta>
					<clinicalStatus>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-clinical'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'active'"/>
							</code>
						</coding>
					</clinicalStatus>
					<verificationStatus>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-ver-status'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'confirmed'"/>
							</code>
						</coding>
					</verificationStatus>
					<category>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/condition-category'))"/>
							</system>
							<code>
								<xsl:attribute name="value" namespace="" select="'encounter-diagnosis'"/>
							</code>
							<display>
								<xsl:attribute name="value" namespace="" select="'Encounter Diagnosis'"/>
							</display>
						</coding>
					</category>
					<xsl:for-each select="$dgzType/ns2:zavaz_dg">
						<xsl:variable name="var4_cur_as_string" as="xs:string" select="fn:string(.)"/>
						<severity>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="$var4_cur_as_string"/>
								</code>
								<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf21_inputtoresult">
										<xsl:with-param name="input" select="$var4_cur_as_string" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<display>
									<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</display>
							</coding>
						</severity>
					</xsl:for-each>
					<code>
						<xsl:for-each select="$dgzType/ns2:diag">
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/sid/icd-10'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
								<xsl:for-each select="@nazev">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
						</xsl:for-each>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:variable name="var5_test_resultof_exists" as="xs:string*">
						<xsl:choose>
							<xsl:when test="fn:exists($var6_dat_vb)">
								<xsl:for-each select="$var6_dat_vb">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$dat_ab">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var5_test_resultof_exists">
						<onsetDateTime>
							<xsl:attribute name="value" namespace="" select="."/>
						</onsetDateTime>
					</xsl:for-each>
					<xsl:for-each select="$dgzType/ns2:dat_du">
						<onsetPeriod>
							<start>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</start>
							<xsl:for-each select="$dgzType/ns2:dat_up">
								<end>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</end>
							</xsl:for-each>
						</onsetPeriod>
					</xsl:for-each>
					<xsl:for-each select="$dasta_garant_dat">
						<recorder>
							<display>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</display>
						</recorder>
					</xsl:for-each>
					<xsl:for-each select="$dgzType/ns2:pozn">
						<note>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</text>
						</note>
					</xsl:for-each>
				</Condition>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:dg_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ip_dg" select="()"/>
		<xsl:param name="patsumdat_dg" select="()"/>
		<xsl:param name="ds_dasta40331" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:for-each select="$ip_dg/ns2:dgz">
			<xsl:variable name="var1_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var2_map_of_ip_dg" as="node()*">
				<xsl:for-each select="$ip_dg/@dat_ab">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="xs:string(xs:dateTime(fn:string(.)))"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var3_resultof_dg" as="node()?">
				<xsl:call-template name="provisio:dg">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="dgzType" as="node()">
						<dgzType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</dgzType>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var1_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var2_map_of_ip_dg)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var3_resultof_dg">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_dg/ns2:dgz">
			<xsl:variable name="var4_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var5_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var6_resultof_dg" as="node()?">
				<xsl:call-template name="provisio:dg">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="dgzType" as="node()">
						<dgzType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</dgzType>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var4_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dat_ab" select="($var5_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var6_resultof_dg">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_Procedure">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Procedure/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:chv">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="chvType" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var8_guid" as="node()?" select="$chvType/@guid"/>
		<xsl:variable name="var9_dat_vyk" as="node()*" select="$chvType/ns2:dat_vyk"/>
		<xsl:variable name="var10_vguid" as="node()?" select="$chvType/@vguid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var8_guid">
				<xsl:for-each select="$var10_vguid">
					<xsl:for-each select="$var8_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var10_vguid">
							<xsl:variable name="var1_resultof_Reference_Procedure" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Procedure">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Procedure">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Procedure>
					<xsl:for-each select="$var8_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var10_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/hdr/StructureDefinition/cz-procedure-hdr'))"/>
						</profile>
					</meta>
					<status>
						<xsl:attribute name="value" namespace="" select="'completed'"/>
					</status>
					<code>
						<xsl:for-each select="$chvType/@chvps_klic">
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</code>
								<xsl:for-each select="$chvType/@chvps_text">
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</xsl:for-each>
							</coding>
						</xsl:for-each>
					</code>
					<subject>
						<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
					</subject>
					<xsl:variable name="var4_test_resultof_exists" as="xs:string*">
						<xsl:choose>
							<xsl:when test="fn:exists($var9_dat_vyk)">
								<xsl:for-each select="$var9_dat_vyk">
									<xsl:sequence select="fn:string(.)"/>
								</xsl:for-each>
							</xsl:when>
							<xsl:otherwise>
								<xsl:variable name="var3_dat_ab" as="node()?" select="$chvType/@dat_ab"/>
								<xsl:choose>
									<xsl:when test="fn:exists($var3_dat_ab)">
										<xsl:sequence select="xs:string(xs:dateTime(fn:string($var3_dat_ab)))"/>
									</xsl:when>
									<xsl:otherwise>
										<xsl:for-each select="$dat_ab">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:for-each select="$var4_test_resultof_exists">
						<performedDateTime>
							<xsl:attribute name="value" namespace="" select="."/>
						</performedDateTime>
					</xsl:for-each>
					<xsl:for-each select="$dasta_garant_dat">
						<performer>
							<actor>
								<display>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</display>
							</actor>
						</performer>
					</xsl:for-each>
					<xsl:for-each select="$chvType/ns2:duvod_kod">
						<reasonCode>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/sid/icd-10'))"/>
								</system>
								<code>
									<xsl:for-each select="ns2:kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="ns2:kod_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</reasonCode>
					</xsl:for-each>
					<xsl:for-each select="$chvType/ns2:alv_form">
						<bodySite>
							<xsl:for-each select="ns2:ptext">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
									</system>
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</coding>
							</xsl:for-each>
						</bodySite>
					</xsl:for-each>
					<xsl:for-each select="$chvType/ns2:vysledek">
						<xsl:variable name="var7_cur_as_string" as="xs:string" select="fn:string(.)"/>
						<outcome>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://snomed.info/sct'))"/>
								</system>
								<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf22_inputtoresult">
										<xsl:with-param name="input" select="$var7_cur_as_string" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<code>
									<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</code>
								<xsl:variable name="var6_resultof_vmf___inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf23_inputtoresult">
										<xsl:with-param name="input" select="$var7_cur_as_string" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<display>
									<xsl:for-each select="$var6_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</display>
							</coding>
						</outcome>
					</xsl:for-each>
					<xsl:for-each select="$chvType/ns2:komplikace">
						<complication>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/sid/icd-10'))"/>
								</system>
								<code>
									<xsl:for-each select="ns2:kod">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="ns2:kod_text">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
						</complication>
					</xsl:for-each>
				</Procedure>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:chv_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ip_chv" select="()"/>
		<xsl:param name="ip_anf_anam_vyk_chv" select="()"/>
		<xsl:param name="patsumdat_anf_anam_vyk_chv" select="()"/>
		<xsl:param name="patsudat_chv" select="()"/>
		<xsl:param name="garant_dat_dasta" select="()"/>
		<xsl:param name="ds_ip415079" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:for-each select="$ip_chv">
			<xsl:variable name="var1_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($garant_dat_dasta/@node(), $garant_dat_dasta/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var2_resultof_chv" as="node()?">
				<xsl:call-template name="provisio:chv">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="chvType" as="node()">
						<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</chvType>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var1_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var2_resultof_chv">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$ip_anf_anam_vyk_chv">
			<xsl:variable name="var3_create_dat_ab_of_ds_ip______" as="node()*">
				<xsl:for-each select="$ds_ip415079">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var4_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($garant_dat_dasta/@node(), $garant_dat_dasta/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var5_resultof_chv" as="node()?">
				<xsl:call-template name="provisio:chv">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="chvType" as="node()">
						<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</chvType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var3_create_dat_ab_of_ds_ip______)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var4_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var5_resultof_chv">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_anf_anam_vyk_chv">
			<xsl:variable name="var6_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var7_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($garant_dat_dasta/@node(), $garant_dat_dasta/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var8_resultof_chv" as="node()?">
				<xsl:call-template name="provisio:chv">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="chvType" as="node()">
						<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</chvType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var6_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var7_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var8_resultof_chv">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsudat_chv">
			<xsl:variable name="var9_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var10_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($garant_dat_dasta/@node(), $garant_dat_dasta/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var11_resultof_chv" as="node()?">
				<xsl:call-template name="provisio:chv">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="chvType" as="node()">
						<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</chvType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var9_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var10_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var11_resultof_chv">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_MedicationAdministration">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('MedicationAdministration/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:le">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="leType" select="()"/>
		<xsl:param name="dat_ab" select="()"/>
		<xsl:param name="dasta_garant_dat" select="()"/>
		<xsl:variable name="var14_guid" as="node()?" select="$leType/@guid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var14_guid">
				<xsl:variable name="var3_vguid" as="node()?" select="$leType/@vguid"/>
				<xsl:for-each select="$var3_vguid">
					<xsl:for-each select="$var14_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var3_vguid">
							<xsl:variable name="var1_resultof_Reference_MedicationAdministration" as="xs:string?">
								<xsl:call-template name="provisio:Reference_MedicationAdministration">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_MedicationAdministration">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<xsl:for-each select="$leType/ns2:lez">
					<xsl:variable name="var13_cur" as="node()" select="."/>
					<xsl:variable name="var11_kod_atc" as="node()?" select="@kod_atc"/>
					<xsl:variable name="var12_dat_ab" as="node()?" select="$leType/@dat_ab"/>
					<MedicationAdministration>
						<xsl:for-each select="$var14_guid">
							<id>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</id>
						</xsl:for-each>
						<meta>
							<xsl:for-each select="$leType/@vguid">
								<versionId>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</versionId>
							</xsl:for-each>
						</meta>
						<status>
							<xsl:for-each select="@ind_oprav_sd">
								<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf24_inputtoresult">
										<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</xsl:for-each>
						</status>
						<xsl:for-each select="ns2:zmena_m_kod">
							<statusReason>
								<coding>
									<xsl:variable name="var5_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf25_inputtoresult">
											<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var5_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="$var13_cur/ns2:zmena_m_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
							</statusReason>
						</xsl:for-each>
						<category>
							<xsl:for-each select="@typ_med">
								<xsl:variable name="var8_cur_as_string" as="xs:string" select="fn:string(.)"/>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/medication-admin-category'))"/>
									</system>
									<xsl:variable name="var6_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf26_inputtoresult">
											<xsl:with-param name="input" select="$var8_cur_as_string" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<code>
										<xsl:for-each select="$var6_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</code>
									<xsl:variable name="var7_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf27_inputtoresult">
											<xsl:with-param name="input" select="$var8_cur_as_string" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<display>
										<xsl:for-each select="$var7_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</display>
								</coding>
							</xsl:for-each>
						</category>
						<medicationCodeableConcept>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://www.snomed.org/'))"/>
								</system>
								<code>
									<xsl:for-each select="@kod_lek">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="@nazev_lek">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</coding>
							<xsl:variable name="var9_test_resultof_exists" as="xs:string*">
								<xsl:choose>
									<xsl:when test="fn:exists($var11_kod_atc)">
										<xsl:sequence select="fn:string($var11_kod_atc)"/>
									</xsl:when>
									<xsl:otherwise>
										<xsl:for-each select="ns2:aktivni_latka/@kod_atc">
											<xsl:sequence select="fn:string(.)"/>
										</xsl:for-each>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:variable>
							<xsl:for-each select="$var9_test_resultof_exists">
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://www.whocc.no/atc/'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="."/>
									</code>
									<xsl:for-each select="$var13_cur/ns2:aktivni_latka/@nazev">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
							</xsl:for-each>
							<xsl:for-each select="@gene_lek">
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</xsl:for-each>
						</medicationCodeableConcept>
						<subject>
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</subject>
						<xsl:variable name="var10_test_resultof_exists" as="xs:string?">
							<xsl:choose>
								<xsl:when test="fn:exists($var12_dat_ab)">
									<xsl:sequence select="xs:string(xs:dateTime(fn:string($var12_dat_ab)))"/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:for-each select="$dat_ab">
										<xsl:sequence select="fn:string(.)"/>
									</xsl:for-each>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>
						<xsl:for-each select="$var10_test_resultof_exists">
							<effectiveDateTime>
								<xsl:attribute name="value" namespace="" select="."/>
							</effectiveDateTime>
						</xsl:for-each>
						<xsl:for-each select="ns2:dat_od">
							<effectivePeriod>
								<start>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</start>
								<xsl:for-each select="$var13_cur/ns2:dat_do">
									<end>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</end>
								</xsl:for-each>
							</effectivePeriod>
						</xsl:for-each>
						<xsl:for-each select="$dasta_garant_dat">
							<performer>
								<actor>
									<display>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</display>
								</actor>
							</performer>
						</xsl:for-each>
						<xsl:for-each select="ns2:ind_m_kod">
							<reasonCode>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBWI.htm'))"/>
									</system>
									<version>
										<xsl:for-each select="ns2:kod_syst">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</version>
									<code>
										<xsl:for-each select="ns2:kod">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</code>
									<display>
										<xsl:for-each select="ns2:kod_text">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</display>
								</coding>
								<xsl:for-each select="$var13_cur/ns2:ind_m_text">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</reasonCode>
						</xsl:for-each>
						<xsl:for-each select="ns2:pozn">
							<note>
								<text>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</text>
							</note>
						</xsl:for-each>
						<xsl:for-each select="ns2:rozpis_v">
							<dosage>
								<xsl:for-each select="$var13_cur/@misto_apl_klic">
									<site>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUU.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<display>
												<xsl:for-each select="$var13_cur/@misto_apl_text">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</display>
										</coding>
									</site>
								</xsl:for-each>
								<xsl:for-each select="$var13_cur/@apl_cesta_klic">
									<route>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBUT.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<display>
												<xsl:for-each select="$var13_cur/@apl_cesta_text">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</display>
										</coding>
									</route>
								</xsl:for-each>
								<xsl:for-each select="$var13_cur/@forma_klic">
									<method>
										<coding>
											<system>
												<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBRW.htm'))"/>
											</system>
											<code>
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</code>
											<display>
												<xsl:for-each select="$var13_cur/@forma_text">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</display>
										</coding>
									</method>
								</xsl:for-each>
								<dose>
									<value>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</value>
								</dose>
							</dosage>
						</xsl:for-each>
					</MedicationAdministration>
				</xsl:for-each>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:le_-_all">
		<xsl:param name="patientReference" select="()"/>
		<xsl:param name="ds_dasta40331" select="()"/>
		<xsl:param name="ip_le" select="()"/>
		<xsl:param name="patsumdat_le" select="()"/>
		<xsl:param name="dat_prov" select="()"/>
		<xsl:for-each select="$ip_le">
			<xsl:variable name="var1_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var2_resultof_le" as="node()?">
				<xsl:call-template name="provisio:le">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="leType" as="node()">
						<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</leType>
					</xsl:with-param>
					<xsl:with-param name="dasta_garant_dat" select="($var1_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var2_resultof_le">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
		<xsl:for-each select="$patsumdat_le">
			<xsl:variable name="var3_create_dat_ab_of_dat_prov" as="node()*">
				<xsl:for-each select="$dat_prov">
					<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
						<xsl:sequence select="(./@node(), ./node())"/>
					</dat_ab>
				</xsl:for-each>
			</xsl:variable>
			<xsl:variable name="var4_create_garant_dat" as="node()">
				<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
					<xsl:sequence select="($ds_dasta40331/@node(), $ds_dasta40331/node())"/>
				</garant_dat>
			</xsl:variable>
			<xsl:variable name="var5_resultof_le" as="node()?">
				<xsl:call-template name="provisio:le">
					<xsl:with-param name="patientReference" as="node()">
						<Reference xmlns="http://hl7.org/fhir">
							<xsl:sequence select="($patientReference/@node(), $patientReference/node())"/>
						</Reference>
					</xsl:with-param>
					<xsl:with-param name="leType" as="node()">
						<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
							<xsl:sequence select="(./@node(), ./node())"/>
						</leType>
					</xsl:with-param>
					<xsl:with-param name="dat_ab" select="($var3_create_dat_ab_of_dat_prov)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
					<xsl:with-param name="dasta_garant_dat" select="($var4_create_garant_dat)[(fn:position() &lt;= xs:integer('1'))]" as="node()?"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:for-each select="$var5_resultof_le">
				<entry xmlns="http://hl7.org/fhir">
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</xsl:for-each>
	</xsl:template>
	<xsl:template name="provisio:Reference_Practitioner">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Practitioner/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:garant_dat">
		<xsl:param name="garant_dat" select="()"/>
		<xsl:variable name="var4_vguid" as="node()?" select="$garant_dat/@vguid"/>
		<xsl:variable name="var5_guid" as="node()?" select="$garant_dat/@guid"/>
		<xsl:variable name="var6_odbornost" as="node()?" select="$garant_dat/@odbornost"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var5_guid">
				<xsl:for-each select="$var4_vguid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var4_vguid">
							<xsl:variable name="var1_resultof_Reference_Practitioner" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Practitioner">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Practitioner">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Practitioner>
					<xsl:for-each select="$var5_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var4_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
					</meta>
					<xsl:for-each select="$garant_dat/@id_zp">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/krzp'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$garant_dat/@id_clk">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/clk'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<identifier>
						<use>
							<xsl:attribute name="value" namespace="" select="'official'"/>
						</use>
						<system>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/clek'))"/>
						</system>
					</identifier>
					<name>
						<text>
							<xsl:attribute name="value" namespace="" select="fn:string($garant_dat)"/>
						</text>
					</name>
					<qualification>
						<code>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/UZAGT.htm'))"/>
								</system>
								<code>
									<xsl:for-each select="$var6_odbornost">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</code>
								<display>
									<xsl:for-each select="$var6_odbornost">
										<xsl:variable name="var3_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf28_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var3_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</display>
							</coding>
						</code>
					</qualification>
				</Practitioner>
				<PractitionerRole>
					<code>
						<coding>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBSK.htm'))"/>
							</system>
							<code>
								<xsl:for-each select="$garant_dat/@role_klic">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</code>
							<display>
								<xsl:for-each select="$garant_dat/@role_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</display>
						</coding>
					</code>
				</PractitionerRole>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:Reference_Patient">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Patient/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:ip">
		<xsl:variable name="var19_ip" as="node()?" select="fn:doc($ds_ip-4_15_07133)/ns2:ip"/>
		<xsl:variable name="var20_http___terminology_hl__org_Cod_as_string" as="xs:string" select="xs:string(xs:anyURI('http://terminology.hl7.org/CodeSystem/v2-0203'))"/>
		<xsl:variable name="var18_map_of_ip" as="xs:string?">
			<xsl:for-each select="$var19_ip/@guid">
				<xsl:sequence select="fn:string(.)"/>
			</xsl:for-each>
		</xsl:variable>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var18_map_of_ip">
				<xsl:variable name="var3_map_of_ip" as="xs:string?">
					<xsl:for-each select="$var19_ip/@vguid">
						<xsl:sequence select="fn:string(.)"/>
					</xsl:for-each>
				</xsl:variable>
				<xsl:for-each select="$var3_map_of_ip">
					<xsl:for-each select="$var18_map_of_ip">
						<xsl:variable name="var2_cur" as="xs:string" select="."/>
						<xsl:for-each select="$var3_map_of_ip">
							<xsl:variable name="var1_resultof_Reference_Patient" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Patient">
									<xsl:with-param name="GUID" select="$var2_cur" as="xs:string"/>
									<xsl:with-param name="VGUID" select="." as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Patient">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Patient>
					<xsl:for-each select="$var19_ip/@guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var19_ip/@vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
						<profile>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://hl7.cz/fhir/core/StructureDefinition/cz-patient-core'))"/>
						</profile>
						<xsl:for-each select="$var19_ip/ns2:duvernost">
							<xsl:variable name="var5_cur_as_string" as="xs:string" select="fn:string(.)"/>
							<security>
								<code>
									<xsl:attribute name="value" namespace="" select="$var5_cur_as_string"/>
								</code>
								<xsl:variable name="var4_resultof_vmf___inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf29_inputtoresult">
										<xsl:with-param name="input" select="$var5_cur_as_string" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<display>
									<xsl:for-each select="$var4_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</display>
							</security>
						</xsl:for-each>
						<xsl:for-each select="$var19_ip/ns2:typ_sdel">
							<xsl:variable name="var7_cur_as_string" as="xs:string" select="fn:string(.)"/>
							<tag>
								<code>
									<xsl:attribute name="value" namespace="" select="$var7_cur_as_string"/>
								</code>
								<xsl:variable name="var6_resultof_vmf___inputtoresult" as="xs:string?">
									<xsl:call-template name="vmf:vmf30_inputtoresult">
										<xsl:with-param name="input" select="$var7_cur_as_string" as="xs:string"/>
									</xsl:call-template>
								</xsl:variable>
								<display>
									<xsl:for-each select="$var6_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</display>
							</tag>
						</xsl:for-each>
					</meta>
					<xsl:for-each select="$var19_ip/ns2:misto_nar">
						<extension>
							<xsl:attribute name="url" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/patient-birthPlace'))"/>
							<valueAddress>
								<city>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</city>
							</valueAddress>
						</extension>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:stat_pris">
						<extension>
							<xsl:attribute name="url" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/patient-nationality'))"/>
							<extension>
								<xsl:attribute name="url" namespace="" select="xs:string(xs:anyURI('code'))"/>
								<valueCodeableConcept>
									<coding>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('urn:iso:std:iso:3166'))"/>
										</system>
										<code>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</code>
									</coding>
								</valueCodeableConcept>
							</extension>
						</extension>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:povolani">
						<xsl:variable name="var8_cur" as="node()" select="."/>
						<extension>
							<xsl:attribute name="url" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/StructureDefinition/patient-occupation'))"/>
							<valueString>
								<xsl:for-each select="ns2:povolani_text">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</valueString>
							<xsl:for-each select="ns2:dat_od">
								<valuePeriod>
									<start>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</start>
									<end>
										<xsl:for-each select="$var8_cur/ns2:dat_do">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</end>
								</valuePeriod>
							</xsl:for-each>
							<xsl:for-each select="@dat_ab">
								<valueMeta>
									<lastUpdated>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:dateTime(fn:string(.)))"/>
									</lastUpdated>
								</valueMeta>
							</xsl:for-each>
						</extension>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(@id_pac)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:rodcis">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/rcis'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<identifier>
						<use>
							<xsl:attribute name="value" namespace="" select="'official'"/>
						</use>
						<type>
							<coding>
								<system>
									<xsl:attribute name="value" namespace="" select="$var20_http___terminology_hl__org_Cod_as_string"/>
								</system>
								<code>
									<xsl:attribute name="value" namespace="" select="'NIIP'"/>
								</code>
								<display>
									<xsl:attribute name="value" namespace="" select="'National Insurance Payor Identifier (Payor)'"/>
								</display>
							</coding>
						</type>
						<assigner>
							<identifier>
								<system>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://www.vzp.cz/poskytovatele/ciselniky/zdravotni-pojistovny'))"/>
								</system>
								<value>
									<xsl:for-each select="$var19_ip/ns2:pv_pac/ns2:pv_zp">
										<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(ns2:kodpoj)))"/>
									</xsl:for-each>
								</value>
							</identifier>
							<display>
								<xsl:for-each select="$var19_ip/ns2:pv_pac/ns2:pv_zp">
									<xsl:variable name="var9_resultof_vmf___inputtoresult" as="xs:string?">
										<xsl:call-template name="vmf:vmf31_inputtoresult">
											<xsl:with-param name="input" select="xs:string(xs:integer(fn:string(ns2:kodpoj)))" as="xs:string"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:for-each select="$var9_resultof_vmf___inputtoresult">
										<xsl:attribute name="value" namespace="" select="."/>
									</xsl:for-each>
								</xsl:for-each>
							</display>
						</assigner>
					</identifier>
					<identifier>
						<use>
							<xsl:attribute name="value" namespace="" select="'official'"/>
						</use>
						<system>
							<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/rid'))"/>
						</system>
						<value>
							<xsl:for-each select="$var19_ip/ns2:rip">
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</xsl:for-each>
						</value>
					</identifier>
					<xsl:for-each select="$var19_ip/ns2:id_card">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/op'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(ns2:id_number)"/>
							</value>
							<period>
								<end>
									<xsl:for-each select="ns2:dat_pl">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</end>
							</period>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:passport">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<type>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="$var20_http___terminology_hl__org_Cod_as_string"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="'PPN'"/>
									</code>
								</coding>
							</type>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('http://hl7.org/fhir/sid/passport-CZE'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(ns2:id_number)"/>
							</value>
							<period>
								<end>
									<xsl:for-each select="ns2:dat_pl">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</end>
							</period>
							<assigner>
								<display>
									<xsl:for-each select="ns2:stat">
										<xsl:variable name="var10_resultof_vmf___inputtoresult" as="xs:string?">
											<xsl:call-template name="vmf:vmf32_inputtoresult">
												<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var10_resultof_vmf___inputtoresult">
											<xsl:attribute name="value" namespace="" select="."/>
										</xsl:for-each>
									</xsl:for-each>
								</display>
							</assigner>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:ipi_o/@nem_cis">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<type>
								<text>
									<xsl:attribute name="value" namespace="" select="'LR'"/>
								</text>
							</type>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('urn:ietf:rfc:3986:http://domnanemocnice.cz/sid/nem_cis'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:ipi_o/@kat_pac">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<type>
								<text>
									<xsl:attribute name="value" namespace="" select="'PI'"/>
								</text>
							</type>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('urn:ietf:rfc:3986:http://domnanemocnice.cz/sid/kat_pac'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:ipi_o/@cis_chor">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<type>
								<text>
									<xsl:attribute name="value" namespace="" select="'SNO'"/>
								</text>
							</type>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('urn:ietf:rfc:3986:http://domnanemocnice.cz/sid/cis_chor'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:ipi_o/@cis_is">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<type>
								<text>
									<xsl:attribute name="value" namespace="" select="'MR'"/>
								</text>
							</type>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('urn:ietf:rfc:3986:http://domnanemocnice.cz/sid/cis_is'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:ipi_v/@nem_cis">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<type>
								<text>
									<xsl:attribute name="value" namespace="" select="'LR'"/>
								</text>
							</type>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('urn:ietf:rfc:3986:http://domnanemocnice.cz/sid/nem_cis'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:ipi_v/@kat_pac">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<type>
								<text>
									<xsl:attribute name="value" namespace="" select="'PI'"/>
								</text>
							</type>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('urn:ietf:rfc:3986:http://domnanemocnice.cz/sid/kat_pac'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:ipi_v/@cis_chor">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<type>
								<text>
									<xsl:attribute name="value" namespace="" select="'SNO'"/>
								</text>
							</type>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('urn:ietf:rfc:3986:http://domnanemocnice.cz/sid/cis_chor'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:ipi_v/@cis_is">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'MR'"/>
							</use>
							<type>
								<text>
									<xsl:attribute name="value" namespace="" select="'urn:ietf:rfc:3986:http://domnanemocnice.cz/sid/cis_is'"/>
								</text>
							</type>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<active>
						<xsl:attribute name="value" namespace="" select="xs:string(fn:true())"/>
					</active>
					<name>
						<use>
							<xsl:attribute name="value" namespace="" select="'official'"/>
						</use>
						<family>
							<xsl:for-each select="$var19_ip">
								<xsl:attribute name="value" namespace="" select="fn:string(ns2:prijmeni)"/>
							</xsl:for-each>
						</family>
						<xsl:for-each select="$var19_ip/ns2:jmeno">
							<given>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</given>
						</xsl:for-each>
						<xsl:for-each select="$var19_ip/ns2:titul_pred">
							<prefix>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</prefix>
						</xsl:for-each>
						<xsl:for-each select="$var19_ip/ns2:titul_za">
							<suffix>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</suffix>
						</xsl:for-each>
					</name>
					<xsl:for-each select="$var19_ip/ns2:rod_prijm">
						<name>
							<use>
								<xsl:attribute name="value" namespace="" select="'maiden'"/>
							</use>
							<family>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</family>
						</name>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns1:a/ns1:as">
						<xsl:variable name="var13_typ_as_string" as="xs:string" select="fn:string(@typ)"/>
						<telecom>
							<xsl:variable name="var11_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf33_inputtoresult">
									<xsl:with-param name="input" select="$var13_typ_as_string" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<system>
								<xsl:for-each select="$var11_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</system>
							<xsl:for-each select="ns1:obsah">
								<value>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</value>
							</xsl:for-each>
							<xsl:variable name="var12_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf34_inputtoresult">
									<xsl:with-param name="input" select="$var13_typ_as_string" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<use>
								<xsl:for-each select="$var12_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</use>
						</telecom>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:sex">
						<xsl:variable name="var14_resultof_vmf___inputtoresult" as="xs:string?">
							<xsl:call-template name="vmf:vmf35_inputtoresult">
								<xsl:with-param name="input" select="fn:string(.)" as="xs:string"/>
							</xsl:call-template>
						</xsl:variable>
						<gender>
							<xsl:for-each select="$var14_resultof_vmf___inputtoresult">
								<xsl:attribute name="value" namespace="" select="."/>
							</xsl:for-each>
						</gender>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:dat_dn">
						<birthDate>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</birthDate>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:dat_de">
						<deceasedDateTime>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</deceasedDateTime>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns1:a">
						<xsl:variable name="var16_cur" as="node()" select="."/>
						<address>
							<xsl:variable name="var15_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf36_inputtoresult">
									<xsl:with-param name="input" select="fn:string(@typ)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<use>
								<xsl:for-each select="$var15_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="."/>
								</xsl:for-each>
							</use>
							<text>
								<xsl:attribute name="value" namespace="" select="fn:string(ns1:jmeno)"/>
							</text>
							<xsl:for-each select="ns1:adr">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:dop1">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:dop2">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:mesto">
								<city>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</city>
							</xsl:for-each>
							<xsl:for-each select="ns1:psc">
								<postalCode>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
								</postalCode>
							</xsl:for-each>
							<xsl:for-each select="ns1:stat">
								<country>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</country>
							</xsl:for-each>
							<xsl:for-each select="ns1:dat_od">
								<period>
									<start>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</start>
									<xsl:for-each select="$var16_cur/ns1:dat_do">
										<end>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</end>
									</xsl:for-each>
								</period>
							</xsl:for-each>
						</address>
					</xsl:for-each>
					<xsl:for-each select="$var19_ip/ns2:jazyk">
						<communication>
							<language>
								<coding>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://dastacr.cz/dasta/hypertext/WWBRX.htm'))"/>
									</system>
									<code>
										<xsl:attribute name="value" namespace="" select="fn:string(@jazyk_klic)"/>
									</code>
									<xsl:for-each select="@jazyk_text">
										<display>
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</display>
									</xsl:for-each>
								</coding>
								<xsl:for-each select="@pozn">
									<text>
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</text>
								</xsl:for-each>
							</language>
							<xsl:variable name="var17_resultof_vmf___inputtoresult" as="xs:string?">
								<xsl:call-template name="vmf:vmf37_inputtoresult">
									<xsl:with-param name="input" select="fn:string(@pref)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<preferred>
								<xsl:for-each select="$var17_resultof_vmf___inputtoresult">
									<xsl:attribute name="value" namespace="" select="xs:string(xs:boolean(.))"/>
								</xsl:for-each>
							</preferred>
						</communication>
					</xsl:for-each>
				</Patient>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="provisio:Reference_Organization">
		<xsl:param name="GUID" select="()"/>
		<xsl:param name="VGUID" select="()"/>
		<xsl:sequence select="fn:concat(fn:concat(fn:concat('Organization/', $GUID), '/_history/'), $VGUID)"/>
	</xsl:template>
	<xsl:template name="provisio:is">
		<xsl:param name="is" select="()"/>
		<xsl:variable name="var5_guid" as="node()?" select="$is/@guid"/>
		<xsl:variable name="var6_vguid" as="node()?" select="$is/@vguid"/>
		<entry xmlns="http://hl7.org/fhir">
			<xsl:for-each select="$var5_guid">
				<xsl:for-each select="$var6_vguid">
					<xsl:for-each select="$var5_guid">
						<xsl:variable name="var2_cur" as="node()" select="."/>
						<xsl:for-each select="$var6_vguid">
							<xsl:variable name="var1_resultof_Reference_Organization" as="xs:string?">
								<xsl:call-template name="provisio:Reference_Organization">
									<xsl:with-param name="GUID" select="fn:string($var2_cur)" as="xs:string"/>
									<xsl:with-param name="VGUID" select="fn:string(.)" as="xs:string"/>
								</xsl:call-template>
							</xsl:variable>
							<xsl:for-each select="$var1_resultof_Reference_Organization">
								<fullUrl>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(.))"/>
								</fullUrl>
							</xsl:for-each>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<resource>
				<Organization>
					<xsl:for-each select="$var5_guid">
						<id>
							<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
						</id>
					</xsl:for-each>
					<meta>
						<xsl:for-each select="$var6_vguid">
							<versionId>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</versionId>
						</xsl:for-each>
					</meta>
					<xsl:for-each select="$is/@ico">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/ico'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@icz">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/icz'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@icp">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/icp'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@icl">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/icl'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@pcz">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/pcz'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@oddel">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/oddel'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<xsl:for-each select="$is/@oavl">
						<identifier>
							<use>
								<xsl:attribute name="value" namespace="" select="'official'"/>
							</use>
							<system>
								<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/oavl'))"/>
							</system>
							<value>
								<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
							</value>
						</identifier>
					</xsl:for-each>
					<active>
						<xsl:attribute name="value" namespace="" select="xs:string(fn:true())"/>
					</active>
					<xsl:for-each select="$is/ns1:a">
						<xsl:variable name="var4_cur" as="node()" select="."/>
						<address>
							<use>
								<xsl:attribute name="value" namespace="" select="'work'"/>
							</use>
							<text>
								<xsl:for-each select="ns1:jmeno">
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</xsl:for-each>
							</text>
							<xsl:for-each select="ns1:adr">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:dop1">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:dop2">
								<line>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</line>
							</xsl:for-each>
							<xsl:for-each select="ns1:mesto">
								<city>
									<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
								</city>
							</xsl:for-each>
							<xsl:for-each select="ns1:psc">
								<postalCode>
									<xsl:attribute name="value" namespace="" select="xs:string(xs:integer(fn:string(.)))"/>
								</postalCode>
							</xsl:for-each>
							<xsl:for-each select="ns1:stat">
								<xsl:variable name="var3_cur" as="node()" select="."/>
								<xsl:for-each select="$var4_cur/ns1:stat_text">
									<country>
										<xsl:attribute name="value" namespace="" select="fn:concat(fn:concat(fn:string($var3_cur), ' - '), fn:string(.))"/>
									</country>
								</xsl:for-each>
							</xsl:for-each>
						</address>
					</xsl:for-each>
				</Organization>
			</resource>
		</entry>
	</xsl:template>
	<xsl:template name="vmf:vmf1_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'inactive'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf2_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='HNMD'">
				<xsl:copy-of select="'228368007'"/>
			</xsl:when>
			<xsl:when test="$input='DNMD'">
				<xsl:copy-of select="'228367002'"/>
			</xsl:when>
			<xsl:when test="$input='MDIP'">
				<xsl:copy-of select="'44870007'"/>
			</xsl:when>
			<xsl:when test="$input='CDUS'">
				<xsl:copy-of select="'417284009'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf3_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='AMFETAM'">
				<xsl:copy-of select="'703842006'"/>
			</xsl:when>
			<xsl:when test="$input='ANABST'">
				<xsl:copy-of select="'111151007'"/>
			</xsl:when>
			<xsl:when test="$input='BARBIT'">
				<xsl:copy-of select="'372798009'"/>
			</xsl:when>
			<xsl:when test="$input='BENZOD'">
				<xsl:copy-of select="'372664007'"/>
			</xsl:when>
			<xsl:when test="$input='BUP'">
				<xsl:copy-of select="'387173000'"/>
			</xsl:when>
			<xsl:when test="$input='PHENC'">
				<xsl:copy-of select="'9721008'"/>
			</xsl:when>
			<xsl:when test="$input='FENTAN'">
				<xsl:copy-of select="'373492002'"/>
			</xsl:when>
			<xsl:when test="$input='HALLMUSH'">
				<xsl:copy-of select="'229006007'"/>
			</xsl:when>
			<xsl:when test="$input='HEROIN'">
				<xsl:copy-of select="'387341002'"/>
			</xsl:when>
			<xsl:when test="$input='3OHBUTYR'">
				<xsl:copy-of select="'62821004'"/>
			</xsl:when>
			<xsl:when test="$input='KETAM'">
				<xsl:copy-of select="'373464007'"/>
			</xsl:when>
			<xsl:when test="$input='COCAINE'">
				<xsl:copy-of select="'387085005'"/>
			</xsl:when>
			<xsl:when test="$input='COCFB'">
				<xsl:copy-of select="'229003004'"/>
			</xsl:when>
			<xsl:when test="$input='CANAB'">
				<xsl:copy-of select="'398705004'"/>
			</xsl:when>
			<xsl:when test="$input='LAXAT'">
				<xsl:copy-of select="'372800002'"/>
			</xsl:when>
			<xsl:when test="$input='LSD'">
				<xsl:copy-of select="'15698006'"/>
			</xsl:when>
			<xsl:when test="$input='MDMA'">
				<xsl:copy-of select="'288459003'"/>
			</xsl:when>
			<xsl:when test="$input='METHAD'">
				<xsl:copy-of select="'387286002'"/>
			</xsl:when>
			<xsl:when test="$input='METAMF'">
				<xsl:copy-of select="'387499002'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf4_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='ASSOC'">
				<xsl:copy-of select="&quot;Associate's or technical degree complete&quot;"/>
			</xsl:when>
			<xsl:when test="$input='BD'">
				<xsl:copy-of select="'College or baccalaureate degree complete'"/>
			</xsl:when>
			<xsl:when test="$input='ELEN'">
				<xsl:copy-of select="'Elementary School'"/>
			</xsl:when>
			<xsl:when test="$input='GD'">
				<xsl:copy-of select="'Graduate or professional Degree complete'"/>
			</xsl:when>
			<xsl:when test="$input='HS'">
				<xsl:copy-of select="'High School or secondary school degree complete'"/>
			</xsl:when>
			<xsl:when test="$input='PB'">
				<xsl:copy-of select="'Some post-baccalaureate education'"/>
			</xsl:when>
			<xsl:when test="$input='POSTG'">
				<xsl:copy-of select="'Doctoral or post graduate education'"/>
			</xsl:when>
			<xsl:when test="$input='SCOL'">
				<xsl:copy-of select="'Some College education'"/>
			</xsl:when>
			<xsl:when test="$input='SEC'">
				<xsl:copy-of select="'Some secondary or high school education'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf5_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='365508006'">
				<xsl:copy-of select="'Residence and accommodation circumstances'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf6_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='BSCH'">
				<xsl:copy-of select="'Vana / sprchov keslo'"/>
			</xsl:when>
			<xsl:when test="$input='SLCH'">
				<xsl:copy-of select="'Schodiov vtah, idle'"/>
			</xsl:when>
			<xsl:when test="$input='ASTO'">
				<xsl:copy-of select="'Pomocn toaleta'"/>
			</xsl:when>
			<xsl:when test="$input='ASBE'">
				<xsl:copy-of select="'Pomocn lko'"/>
			</xsl:when>
			<xsl:when test="$input='HPAF'">
				<xsl:copy-of select="'Pomocn vybaven / adaptace domu a prostor'"/>
			</xsl:when>
			<xsl:when test="$input='HARA'">
				<xsl:copy-of select="'Zbradl, dradla'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf7_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='STHO'">
				<xsl:copy-of select="'Schody v dom'"/>
			</xsl:when>
			<xsl:when test="$input='LAWE'">
				<xsl:copy-of select="'Bydl v byt s vtahem'"/>
			</xsl:when>
			<xsl:when test="$input='ARBS'">
				<xsl:copy-of select="'Pstup do domu po schodech'"/>
			</xsl:when>
			<xsl:when test="$input='OMRE'">
				<xsl:copy-of select="'Blokovan vstup do bytu'"/>
			</xsl:when>
			<xsl:when test="$input='HCSB'">
				<xsl:copy-of select="'Bydlen obsahuje strukturln pekky pohybu'"/>
			</xsl:when>
			<xsl:when test="$input='CLSP'">
				<xsl:copy-of select="'Zanedn ivotn prostor'"/>
			</xsl:when>
			<xsl:when test="$input='DLCO'">
				<xsl:copy-of select="'pinav ivotn prosted'"/>
			</xsl:when>
			<xsl:when test="$input='KEPE'">
				<xsl:copy-of select="'Chov domc mazlky'"/>
			</xsl:when>
			<xsl:when test="$input='UFCO'">
				<xsl:copy-of select="'Nebezpen podlahov krytina'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf8_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='SP'">
				<xsl:copy-of select="'resolved'"/>
			</xsl:when>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'inactive'"/>
			</xsl:when>
			<xsl:when test="$input='Z'">
				<xsl:copy-of select="'suspended'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf9_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'unconfirmed'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'refuted'"/>
			</xsl:when>
			<xsl:when test="$input='AF'">
				<xsl:copy-of select="'confirmed'"/>
			</xsl:when>
			<xsl:when test="$input='AN'">
				<xsl:copy-of select="'confirmed'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf10_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'allergy'"/>
			</xsl:when>
			<xsl:when test="$input='I'">
				<xsl:copy-of select="'intolerance'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf11_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='L'">
				<xsl:copy-of select="'medication'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'food'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'environment'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf12_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='255604002'">
				<xsl:copy-of select="'low'"/>
			</xsl:when>
			<xsl:when test="$input='371923003'">
				<xsl:copy-of select="'low'"/>
			</xsl:when>
			<xsl:when test="$input='6736007'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
			<xsl:when test="$input='371924009'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
			<xsl:when test="$input='24484000'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
			<xsl:when test="$input='442452003'">
				<xsl:copy-of select="'high'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf13_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='A+'">
				<xsl:copy-of select="'A RhD pozitivn'"/>
			</xsl:when>
			<xsl:when test="$input='A1+'">
				<xsl:copy-of select="'A1 RhD pozitivn'"/>
			</xsl:when>
			<xsl:when test="$input='A2+'">
				<xsl:copy-of select="'A2 RhD pozitivn'"/>
			</xsl:when>
			<xsl:when test="$input='A-'">
				<xsl:copy-of select="'A RhD negativn'"/>
			</xsl:when>
			<xsl:when test="$input='A1-'">
				<xsl:copy-of select="'A1 RhD negativn'"/>
			</xsl:when>
			<xsl:when test="$input='A2-'">
				<xsl:copy-of select="'A2 RhD negativn'"/>
			</xsl:when>
			<xsl:when test="$input='B+'">
				<xsl:copy-of select="'B RhD pozitivn'"/>
			</xsl:when>
			<xsl:when test="$input='B-'">
				<xsl:copy-of select="'B RhD negativn'"/>
			</xsl:when>
			<xsl:when test="$input='AB+'">
				<xsl:copy-of select="'AB RhD pozitivn'"/>
			</xsl:when>
			<xsl:when test="$input='A1B+'">
				<xsl:copy-of select="'A1B RhD pozitivn'"/>
			</xsl:when>
			<xsl:when test="$input='A2B+'">
				<xsl:copy-of select="'A2B RhD pozitivn'"/>
			</xsl:when>
			<xsl:when test="$input='AB-'">
				<xsl:copy-of select="'AB RhD negativn'"/>
			</xsl:when>
			<xsl:when test="$input='A1B-'">
				<xsl:copy-of select="'A1B RhD negativn'"/>
			</xsl:when>
			<xsl:when test="$input='A2B-'">
				<xsl:copy-of select="'A2B RhD negativn'"/>
			</xsl:when>
			<xsl:when test="$input='0+'">
				<xsl:copy-of select="'0 RhD pozitivn'"/>
			</xsl:when>
			<xsl:when test="$input='0-'">
				<xsl:copy-of select="'0 RhD negativn'"/>
			</xsl:when>
			<xsl:when test="$input='ARHDWV'">
				<xsl:copy-of select="'A RhD weak/variant'"/>
			</xsl:when>
			<xsl:when test="$input='A1RHDWV'">
				<xsl:copy-of select="'A1 RhD weak/variant'"/>
			</xsl:when>
			<xsl:when test="$input='A2RHDWV'">
				<xsl:copy-of select="'A2 RhD weak/variant'"/>
			</xsl:when>
			<xsl:when test="$input='BRHDWV'">
				<xsl:copy-of select="'B RhD weak/variant'"/>
			</xsl:when>
			<xsl:when test="$input='ABRHDWV'">
				<xsl:copy-of select="'AB RhD weak/variant'"/>
			</xsl:when>
			<xsl:when test="$input='A1BRHWV'">
				<xsl:copy-of select="'A1B RhD weak/variant'"/>
			</xsl:when>
			<xsl:when test="$input='A2BRHWV'">
				<xsl:copy-of select="'A2B RhD weak/variant'"/>
			</xsl:when>
			<xsl:when test="$input='0RHDWV'">
				<xsl:copy-of select="'0 RhD weak/variant'"/>
			</xsl:when>
			<xsl:when test="$input='MF'">
				<xsl:copy-of select="'Neuzaven vyeten KS'"/>
			</xsl:when>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'A RhD nespecifikovno'"/>
			</xsl:when>
			<xsl:when test="$input='A1'">
				<xsl:copy-of select="'A1 RhD nespecifikovno'"/>
			</xsl:when>
			<xsl:when test="$input='A2'">
				<xsl:copy-of select="'A2 RhD nespecifikovno'"/>
			</xsl:when>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'B RhD nespecifikovno'"/>
			</xsl:when>
			<xsl:when test="$input='AB'">
				<xsl:copy-of select="'AB RhD nespecifikovno'"/>
			</xsl:when>
			<xsl:when test="$input='A1B'">
				<xsl:copy-of select="'A1B RhD nespecifikovno'"/>
			</xsl:when>
			<xsl:when test="$input='A2B'">
				<xsl:copy-of select="'A2B RhD nespecifikovno'"/>
			</xsl:when>
			<xsl:when test="$input='00'">
				<xsl:copy-of select="'0 RhD nespecifikovno'"/>
			</xsl:when>
			<xsl:when test="$input='A1-,DU+'">
				<xsl:copy-of select="'A1 Rh(D)neg se slabou variantou D antigenu'"/>
			</xsl:when>
			<xsl:when test="$input='A2-,DU+'">
				<xsl:copy-of select="'A2 Rh(D)neg se slabou variantou D antigenu'"/>
			</xsl:when>
			<xsl:when test="$input='A-,DU+'">
				<xsl:copy-of select="'A Rh(D)neg se slabou variantou D antigenu'"/>
			</xsl:when>
			<xsl:when test="$input='B-,DU+'">
				<xsl:copy-of select="'B Rh(D)neg se slabou variantou D antigenu'"/>
			</xsl:when>
			<xsl:when test="$input='AB-,DU+'">
				<xsl:copy-of select="'AB Rh(D)neg se slabou variantou D antigenu'"/>
			</xsl:when>
			<xsl:when test="$input='A1B-,DU+'">
				<xsl:copy-of select="'A1B Rh(D)neg se slabou variantou D antigenu'"/>
			</xsl:when>
			<xsl:when test="$input='A2B-,DU+'">
				<xsl:copy-of select="'A2B Rh(D)neg se slabou variantou D antigenu'"/>
			</xsl:when>
			<xsl:when test="$input='0-,DU+'">
				<xsl:copy-of select="'0 Rh(D)neg se slabou variantou D antigenu'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf14_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'completed'"/>
			</xsl:when>
			<xsl:when test="$input='SF'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='SN'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf15_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'inactive'"/>
			</xsl:when>
			<xsl:when test="$input='RF'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='RN'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
			<xsl:when test="$input='RS'">
				<xsl:copy-of select="'active'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf16_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'152231000119106'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'60001007'"/>
			</xsl:when>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'146799005'"/>
			</xsl:when>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'77386006'"/>
			</xsl:when>
			<xsl:when test="$input='G'">
				<xsl:copy-of select="'77386006'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf17_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='77386006'">
				<xsl:copy-of select="'Pregnant'"/>
			</xsl:when>
			<xsl:when test="$input='60001007'">
				<xsl:copy-of select="'Not pregnant'"/>
			</xsl:when>
			<xsl:when test="$input='146799005'">
				<xsl:copy-of select="'Possible pregnancy'"/>
			</xsl:when>
			<xsl:when test="$input='152231000119106'">
				<xsl:copy-of select="'Pregnancy not yet confirmed'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf18_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='11778-8'">
				<xsl:copy-of select="'Delivery date Estimated'"/>
			</xsl:when>
			<xsl:when test="$input='11780-4'">
				<xsl:copy-of select="'Delivery date Estimated from ovulation date'"/>
			</xsl:when>
			<xsl:when test="$input='11779-6'">
				<xsl:copy-of select="'Delivery date Estimated from last menstrual period'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf19_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'fyziologick reakce'"/>
			</xsl:when>
			<xsl:when test="$input='H'">
				<xsl:copy-of select="'hyperreakce'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'neurologick reakce'"/>
			</xsl:when>
			<xsl:when test="$input='J'">
				<xsl:copy-of select="'jin reakce'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf20_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'neznm informace'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'nebyla dosud dn zaznamenan informace o funknm stavu pacienta'"/>
			</xsl:when>
			<xsl:when test="$input='A'">
				<xsl:copy-of select="'sdlovan funkn stav pacienta'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf21_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='255604002'">
				<xsl:copy-of select="'Mild'"/>
			</xsl:when>
			<xsl:when test="$input='6736007'">
				<xsl:copy-of select="'Moderate'"/>
			</xsl:when>
			<xsl:when test="$input='24484000'">
				<xsl:copy-of select="'Severe'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf22_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'385669000'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'385671000'"/>
			</xsl:when>
			<xsl:when test="$input='C'">
				<xsl:copy-of select="'385670004'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf23_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'spn'"/>
			</xsl:when>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'Nespn'"/>
			</xsl:when>
			<xsl:when test="$input='C'">
				<xsl:copy-of select="'sten spn'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf24_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='N'">
				<xsl:copy-of select="'completed'"/>
			</xsl:when>
			<xsl:when test="$input='E'">
				<xsl:copy-of select="'correction'"/>
			</xsl:when>
			<xsl:when test="$input='S'">
				<xsl:copy-of select="'entered-in-error'"/>
			</xsl:when>
			<xsl:when test="$input='U'">
				<xsl:copy-of select="'stopped'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'on-hold'"/>
			</xsl:when>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'stopped'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf25_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='ND'">
				<xsl:copy-of select="'nevhodn dvkovn'"/>
			</xsl:when>
			<xsl:when test="$input='PD'">
				<xsl:copy-of select="'nedostaten dvkovn'"/>
			</xsl:when>
			<xsl:when test="$input='IL'">
				<xsl:copy-of select="'interakce lku'"/>
			</xsl:when>
			<xsl:when test="$input='J'">
				<xsl:copy-of select="'jin'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf26_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'chronic'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'acute'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf27_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'Chronick (trval) medikace'"/>
			</xsl:when>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'Akutn (pechodn) medikace'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf28_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='001'">
				<xsl:copy-of select="'veobecn praktick lkastv'"/>
			</xsl:when>
			<xsl:when test="$input='002'">
				<xsl:copy-of select="'praktick lkastv pro dti a dorost a pediatrie'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf29_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="'standardn'"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="'dvrn'"/>
			</xsl:when>
			<xsl:when test="$input='3'">
				<xsl:copy-of select="'velmi dvrn'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf30_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='ALL'">
				<xsl:copy-of select="'sdlovna vechna dostupn data z IS odeslatele pro tohoto pacienta'"/>
			</xsl:when>
			<xsl:when test="$input='PS'">
				<xsl:copy-of select="'sdlovna data v rozsahu mnoiny Patient Summary'"/>
			</xsl:when>
			<xsl:when test="$input='KU'">
				<xsl:copy-of select="'obsahuje pouze data v rozsahu potebnm pro een pslun klinick udlosti'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf31_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='111'">
				<xsl:copy-of select="'Veobecn zdravotn pojiovna esk republiky'"/>
			</xsl:when>
			<xsl:when test="$input='201'">
				<xsl:copy-of select="'Vojensk zdravotn pojiovna esk republiky'"/>
			</xsl:when>
			<xsl:when test="$input='205'">
				<xsl:copy-of select="'esk prmyslov zdravotn pojiovna'"/>
			</xsl:when>
			<xsl:when test="$input='207'">
				<xsl:copy-of select="'Oborov zdravotn pojiovna zamstnanc bank, pojioven a stavebnictv'"/>
			</xsl:when>
			<xsl:when test="$input='209'">
				<xsl:copy-of select="'Zamstnaneck pojiovna koda'"/>
			</xsl:when>
			<xsl:when test="$input='211'">
				<xsl:copy-of select="'Zdravotn pojiovna ministerstva vnitra esk republiky'"/>
			</xsl:when>
			<xsl:when test="$input='213'">
				<xsl:copy-of select="'RBP, zdravotn pojiovna'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf32_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='CZE'">
				<xsl:copy-of select="'Czech Republic (CZE)'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf33_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'phone'"/>
			</xsl:when>
			<xsl:when test="$input='E'">
				<xsl:copy-of select="'email'"/>
			</xsl:when>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'phone'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf34_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='B'">
				<xsl:copy-of select="'mobile'"/>
			</xsl:when>
			<xsl:when test="$input='E'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='T'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf35_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'male'"/>
			</xsl:when>
			<xsl:when test="$input='F'">
				<xsl:copy-of select="'female'"/>
			</xsl:when>
			<xsl:when test="$input='X'">
				<xsl:copy-of select="'unknown'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf36_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='1'">
				<xsl:copy-of select="'home'"/>
			</xsl:when>
			<xsl:when test="$input='2'">
				<xsl:copy-of select="'temp'"/>
			</xsl:when>
			<xsl:when test="$input='5'">
				<xsl:copy-of select="'work'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="vmf:vmf37_inputtoresult">
		<xsl:param name="input" select="()"/>
		<xsl:choose>
			<xsl:when test="$input='P'">
				<xsl:copy-of select="'true'"/>
			</xsl:when>
			<xsl:when test="$input='M'">
				<xsl:copy-of select="'false'"/>
			</xsl:when>
		</xsl:choose>
	</xsl:template>
	<xsl:output method="xml" encoding="UTF-8" byte-order-mark="no" indent="yes"/>
	<xsl:param name="ds_dasta-4_03_312" select="'../samples/dasta.xml'"/>
	<xsl:template match="/">
		<xsl:variable name="var53_dasta" as="node()?" select="fn:doc($ds_dasta-4_03_312)/ns1:dasta"/>
		<xsl:variable name="var54_ip" as="node()*" select="ns2:ip"/>
		<Bundle xmlns="http://hl7.org/fhir" xmlns:xhtml="http://www.w3.org/1999/xhtml">
			<xsl:attribute name="xsi:schemaLocation" namespace="http://www.w3.org/2001/XMLSchema-instance" select="'http://hl7.org/fhir file:///C:/PROVISIO/Mapping/schemas/hl7-fhir/bundle.xsd'"/>
			<type>
				<xsl:attribute name="value" namespace="" select="'document'"/>
			</type>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var30_cur" as="node()" select="."/>
				<xsl:for-each select="$var53_dasta">
					<xsl:variable name="var29_cur" as="node()" select="."/>
					<xsl:for-each select="ns1:is">
						<xsl:variable name="var28_dat_vb" as="node()" select="$var29_cur/@dat_vb"/>
						<xsl:variable name="var27_https___ncez_mzcr_cz_fhir_sid__as_string" as="xs:string" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
						<xsl:variable name="var8_resultof_is" as="node()*">
							<xsl:call-template name="provisio:is">
								<xsl:with-param name="is" as="node()">
									<is xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
										<xsl:sequence select="(./@node(), ./node())"/>
									</is>
								</xsl:with-param>
							</xsl:call-template>
						</xsl:variable>
						<xsl:variable name="var26_resultof_Composition_EU_PS" as="node()?">
							<xsl:call-template name="provisio:Composition_EU_PS">
								<xsl:with-param name="HDRdate" select="xs:string(xs:dateTime(fn:string($var28_dat_vb)))" as="xs:string"/>
								<xsl:with-param name="patientReference" as="node()">
									<Reference>
										<identifier>
											<use>
												<xsl:attribute name="value" namespace="" select="'official'"/>
											</use>
											<system>
												<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
											</system>
											<value>
												<xsl:for-each select="$var30_cur/@id_pac">
													<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
												</xsl:for-each>
											</value>
										</identifier>
									</Reference>
								</xsl:with-param>
								<xsl:with-param name="sectionMedications_le" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var2_cur" as="node()" select="."/>
										<xsl:for-each select="$var53_dasta/ns1:garant_dat">
											<xsl:variable name="var1_resultof_le___all" as="node()*">
												<xsl:call-template name="provisio:le_-_all">
													<xsl:with-param name="patientReference" as="node()">
														<Reference>
															<identifier>
																<use>
																	<xsl:attribute name="value" namespace="" select="'official'"/>
																</use>
																<system>
																	<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
																</system>
																<value>
																	<xsl:for-each select="$var2_cur/@id_pac">
																		<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																	</xsl:for-each>
																</value>
															</identifier>
														</Reference>
													</xsl:with-param>
													<xsl:with-param name="ds_dasta40331" as="node()">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:with-param>
													<xsl:with-param name="ip_le" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:le">
															<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</leType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="patsumdat_le" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:le">
															<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</leType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="dat_prov" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
															<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dat_prov>
														</xsl:for-each>
													</xsl:with-param>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var1_resultof_le___all/ns0:fullUrl/@value">
												<entry>
													<reference>
														<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
													</reference>
												</entry>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionAllergies_ua" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var3_resultof_u___all" as="node()*">
											<xsl:call-template name="provisio:u_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ip_u" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:u">
														<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</uType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="garant_dat_dasta" as="node()?">
													<xsl:for-each select="$var53_dasta/ns1:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="dat_prov" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
														<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</dat_prov>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_u" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:u">
														<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</uType>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="($var3_resultof_u___all/ns0:fullUrl/@value)[fn:starts-with(xs:string(xs:anyURI(fn:string(.))), 'AllergyIntolerance')]">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionFunctionalStatus_fs" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var5_cur" as="node()" select="."/>
										<xsl:for-each select="$var53_dasta/ns1:garant_dat">
											<xsl:variable name="var4_resultof_fs___all" as="node()*">
												<xsl:call-template name="provisio:fs_-_all">
													<xsl:with-param name="patientReference" as="node()">
														<Reference>
															<identifier>
																<use>
																	<xsl:attribute name="value" namespace="" select="'official'"/>
																</use>
																<system>
																	<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
																</system>
																<value>
																	<xsl:for-each select="$var5_cur/@id_pac">
																		<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																	</xsl:for-each>
																</value>
															</identifier>
														</Reference>
													</xsl:with-param>
													<xsl:with-param name="ds_dasta40331" as="node()">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:with-param>
													<xsl:with-param name="ip_fs" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:fs">
															<fsType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</fsType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="patsumdat_fs" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:fs">
															<fsType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</fsType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="dat_prov" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
															<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dat_prov>
														</xsl:for-each>
													</xsl:with-param>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var4_resultof_fs___all/ns0:fullUrl/@value">
												<entry>
													<reference>
														<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
													</reference>
												</entry>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionPlanOfCare_ld" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var7_cur" as="node()" select="."/>
										<xsl:for-each select="$var53_dasta/ns1:garant_dat">
											<xsl:variable name="var6_resultof_ld___all" as="node()*">
												<xsl:call-template name="provisio:ld_-_all">
													<xsl:with-param name="patientReference" as="node()">
														<Reference>
															<identifier>
																<use>
																	<xsl:attribute name="value" namespace="" select="'official'"/>
																</use>
																<system>
																	<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
																</system>
																<value>
																	<xsl:for-each select="$var7_cur/@id_pac">
																		<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																	</xsl:for-each>
																</value>
															</identifier>
														</Reference>
													</xsl:with-param>
													<xsl:with-param name="ip_ld" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ld">
															<ldType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</ldType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="patsumdat_ld" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:ld">
															<ldType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</ldType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="ds_dasta40331" as="node()">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:with-param>
													<xsl:with-param name="dat_prov" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
															<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dat_prov>
														</xsl:for-each>
													</xsl:with-param>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var6_resultof_ld___all/ns0:fullUrl/@value">
												<entry>
													<reference>
														<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
													</reference>
												</entry>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="authorReference" as="node()">
									<Reference>
										<reference>
											<xsl:for-each select="$var8_resultof_is/ns0:fullUrl/@value">
												<xsl:attribute name="value" namespace="" select="fn:concat('Organization/', xs:string(xs:anyURI(fn:string(.))))"/>
											</xsl:for-each>
										</reference>
									</Reference>
								</xsl:with-param>
								<xsl:with-param name="sectionProceduresHx_chv" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var10_cur" as="node()" select="."/>
										<xsl:for-each select="$var53_dasta/ns1:garant_dat">
											<xsl:variable name="var9_resultof_chv___all" as="node()*">
												<xsl:call-template name="provisio:chv_-_all">
													<xsl:with-param name="patientReference" as="node()">
														<Reference>
															<identifier>
																<use>
																	<xsl:attribute name="value" namespace="" select="'official'"/>
																</use>
																<system>
																	<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
																</system>
																<value>
																	<xsl:for-each select="$var10_cur/@id_pac">
																		<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																	</xsl:for-each>
																</value>
															</identifier>
														</Reference>
													</xsl:with-param>
													<xsl:with-param name="ip_chv" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:chv">
															<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</chvType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="ip_anf_anam_vyk_chv" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:anf/ns2:anam_vyk/ns2:chv">
															<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</chvType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="patsumdat_anf_anam_vyk_chv" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf/ns2:anam_vyk/ns2:chv">
															<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</chvType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="patsudat_chv" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:chv">
															<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</chvType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="garant_dat_dasta" as="node()">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:with-param>
													<xsl:with-param name="ds_ip415079" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:anf/ns2:dat_ab">
															<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dat_ab>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="dat_prov" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
															<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dat_prov>
														</xsl:for-each>
													</xsl:with-param>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var9_resultof_chv___all/ns0:fullUrl/@value">
												<entry>
													<reference>
														<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
													</reference>
												</entry>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionImmunizations_oc" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var12_cur" as="node()" select="."/>
										<xsl:for-each select="$var53_dasta/ns1:garant_dat">
											<xsl:variable name="var11_resultof_oc___all" as="node()*">
												<xsl:call-template name="provisio:oc_-_all">
													<xsl:with-param name="patientReference" as="node()">
														<Reference>
															<identifier>
																<use>
																	<xsl:attribute name="value" namespace="" select="'official'"/>
																</use>
																<system>
																	<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
																</system>
																<value>
																	<xsl:for-each select="$var12_cur/@id_pac">
																		<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																	</xsl:for-each>
																</value>
															</identifier>
														</Reference>
													</xsl:with-param>
													<xsl:with-param name="dat_prov" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
															<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dat_prov>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="ip_oc" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:oc">
															<ocType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</ocType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="anf_anam_oc" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:anf/ns2:anam_oc">
															<ocType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:for-each select="@guid">
																	<xsl:attribute name="guid" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
																<xsl:for-each select="@vguid">
																	<xsl:attribute name="vguid" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
																<xsl:for-each select="ns2:ocz">
																	<ocz>
																		<xsl:sequence select="(./@node(), ./node())"/>
																	</ocz>
																</xsl:for-each>
															</ocType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="patsumdat_anf_anam_oc" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf/ns2:anam_oc">
															<ocType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:for-each select="@guid">
																	<xsl:attribute name="guid" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
																<xsl:for-each select="@vguid">
																	<xsl:attribute name="vguid" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
																<xsl:for-each select="ns2:ocz">
																	<ocz>
																		<xsl:sequence select="(./@node(), ./node())"/>
																	</ocz>
																</xsl:for-each>
															</ocType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="patsumdat_oc" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:oc">
															<ocType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</ocType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="ds_ip415076" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:anf/ns2:dat_ab">
															<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dat_ab>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="dsipdat_ab" as="xs:dateTime*">
														<xsl:for-each select="$var54_ip/ns2:oc/@dat_ab">
															<xsl:sequence select="xs:dateTime(fn:string(.))"/>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="ds_dasta40331" as="node()">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:with-param>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var11_resultof_oc___all/ns0:fullUrl/@value">
												<entry>
													<reference>
														<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
													</reference>
												</entry>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionVitalSigns_h" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var13_resultof_h___all" as="node()*">
											<xsl:call-template name="provisio:h_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ip_h" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:h">
														<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</hType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_h" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:h">
														<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</hType>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var13_resultof_h___all/ns0:fullUrl/@value">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionVitalSigns_fyznal" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var14_resultof_fyznal___all" as="node()*">
											<xsl:call-template name="provisio:fyznal_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ip_fyznal" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:fyznal">
														<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</fyznalType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_fyznal" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:fyznal">
														<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</fyznalType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="garant_datReference" as="node()">
													<Reference>
														<display>
															<xsl:for-each select="$var53_dasta/ns1:garant_dat">
																<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
															</xsl:for-each>
														</display>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="dat_prov" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
														<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</dat_prov>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var14_resultof_fyznal___all/ns0:fullUrl/@value">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionResults_uks" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var15_resultof_u___all" as="node()*">
											<xsl:call-template name="provisio:u_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ip_u" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:u">
														<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</uType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="garant_dat_dasta" as="node()?">
													<xsl:for-each select="$var53_dasta/ns1:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="dat_prov" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
														<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</dat_prov>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_u" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:u">
														<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</uType>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="($var15_resultof_u___all/ns0:fullUrl/@value)[fn:starts-with(xs:string(xs:anyURI(fn:string(.))), 'Observation')]">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionResults_an" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var17_cur" as="node()" select="."/>
										<xsl:for-each select="$var53_dasta/ns1:garant_dat">
											<xsl:variable name="var16_resultof_an___all" as="node()*">
												<xsl:call-template name="provisio:an_-_all">
													<xsl:with-param name="patientReference" as="node()">
														<Reference>
															<identifier>
																<use>
																	<xsl:attribute name="value" namespace="" select="'official'"/>
																</use>
																<system>
																	<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
																</system>
																<value>
																	<xsl:for-each select="$var17_cur/@id_pac">
																		<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																	</xsl:for-each>
																</value>
															</identifier>
														</Reference>
													</xsl:with-param>
													<xsl:with-param name="dat_prov" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
															<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dat_prov>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="ds_dasta40331" as="node()">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:with-param>
													<xsl:with-param name="ip_an" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:an">
															<anType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</anType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="patsumdat_an" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:an">
															<anType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</anType>
														</xsl:for-each>
													</xsl:with-param>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var16_resultof_an___all/ns0:fullUrl/@value">
												<entry>
													<reference>
														<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
													</reference>
												</entry>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionPregnancyHx_grav" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var18_resultof_grav___all" as="node()*">
											<xsl:call-template name="provisio:grav_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="garant_datReference" as="node()">
													<Reference>
														<display>
															<xsl:for-each select="$var53_dasta/ns1:garant_dat">
																<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
															</xsl:for-each>
														</display>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ip_grav" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:grav">
														<gravType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</gravType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_grav" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:grav">
														<gravType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</gravType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="dat_prov" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
														<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</dat_prov>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="$var18_resultof_grav___all/ns0:fullUrl/@value">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionMedicalDevices_uniz" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var19_resultof_u___all" as="node()*">
											<xsl:call-template name="provisio:u_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ip_u" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:u">
														<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</uType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="garant_dat_dasta" as="node()?">
													<xsl:for-each select="$var53_dasta/ns1:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="dat_prov" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
														<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</dat_prov>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_u" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:u">
														<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</uType>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="($var19_resultof_u___all/ns0:fullUrl/@value)[fn:starts-with(xs:string(xs:anyURI(fn:string(.))), 'DeviceUseStatement')]">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionAlert_urf_utm_uot" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var20_resultof_u___all" as="node()*">
											<xsl:call-template name="provisio:u_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ip_u" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:u">
														<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</uType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="garant_dat_dasta" as="node()?">
													<xsl:for-each select="$var53_dasta/ns1:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="dat_prov" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
														<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</dat_prov>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_u" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:u">
														<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</uType>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="($var20_resultof_u___all/ns0:fullUrl/@value)[fn:starts-with(xs:string(xs:anyURI(fn:string(.))), 'Flag')]">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionProblems_anf_anam_prob" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var21_resultof_anf___all" as="node()*">
											<xsl:call-template name="provisio:anf_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ds_ip4150719" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf/ns2:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="ip_anf" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:anf">
														<anfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</anfType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="ds_ip4150729" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:anf/ns2:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_anf" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf">
														<anfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</anfType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="ds_dasta40331" as="node()?">
													<xsl:for-each select="$var53_dasta/ns1:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="dat_prov" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
														<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</dat_prov>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="($var21_resultof_anf___all/ns0:fullUrl/@value)[fn:starts-with(xs:string(xs:anyURI(fn:string(.))), 'Condition')]">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionSocialHistory_anf_rao" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var22_resultof_anf___all" as="node()*">
											<xsl:call-template name="provisio:anf_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ds_ip4150719" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf/ns2:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="ip_anf" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:anf">
														<anfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</anfType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="ds_ip4150729" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:anf/ns2:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_anf" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf">
														<anfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</anfType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="ds_dasta40331" as="node()?">
													<xsl:for-each select="$var53_dasta/ns1:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="dat_prov" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
														<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</dat_prov>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="($var22_resultof_anf___all/ns0:fullUrl/@value)[fn:starts-with(xs:string(xs:anyURI(fn:string(.))), 'FamilyMemberHistory')]">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionSocialHistory_anf_inf_infc_sa" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var23_resultof_anf___all" as="node()*">
											<xsl:call-template name="provisio:anf_-_all">
												<xsl:with-param name="patientReference" as="node()">
													<Reference>
														<identifier>
															<use>
																<xsl:attribute name="value" namespace="" select="'official'"/>
															</use>
															<system>
																<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
															</system>
															<value>
																<xsl:for-each select="@id_pac">
																	<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																</xsl:for-each>
															</value>
														</identifier>
													</Reference>
												</xsl:with-param>
												<xsl:with-param name="ds_ip4150719" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf/ns2:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="ip_anf" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:anf">
														<anfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</anfType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="ds_ip4150729" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:anf/ns2:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="patsumdat_anf" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf">
														<anfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</anfType>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="ds_dasta40331" as="node()?">
													<xsl:for-each select="$var53_dasta/ns1:garant_dat">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:for-each>
												</xsl:with-param>
												<xsl:with-param name="dat_prov" as="node()*">
													<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
														<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
															<xsl:sequence select="(./@node(), ./node())"/>
														</dat_prov>
													</xsl:for-each>
												</xsl:with-param>
											</xsl:call-template>
										</xsl:variable>
										<xsl:for-each select="($var23_resultof_anf___all/ns0:fullUrl/@value)[fn:starts-with(xs:string(xs:anyURI(fn:string(.))), 'Observation')]">
											<entry>
												<reference>
													<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
												</reference>
											</entry>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
								<xsl:with-param name="sectionProblems_dg" as="node()*">
									<xsl:for-each select="$var54_ip">
										<xsl:variable name="var25_cur" as="node()" select="."/>
										<xsl:for-each select="$var53_dasta/ns1:garant_dat">
											<xsl:variable name="var24_resultof_dg___all" as="node()*">
												<xsl:call-template name="provisio:dg_-_all">
													<xsl:with-param name="patientReference" as="node()">
														<Reference>
															<identifier>
																<use>
																	<xsl:attribute name="value" namespace="" select="'official'"/>
																</use>
																<system>
																	<xsl:attribute name="value" namespace="" select="$var27_https___ncez_mzcr_cz_fhir_sid__as_string"/>
																</system>
																<value>
																	<xsl:for-each select="$var25_cur/@id_pac">
																		<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
																	</xsl:for-each>
																</value>
															</identifier>
														</Reference>
													</xsl:with-param>
													<xsl:with-param name="ip_dg" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:dg">
															<dgType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dgType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="patsumdat_dg" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:dg">
															<dgType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dgType>
														</xsl:for-each>
													</xsl:with-param>
													<xsl:with-param name="ds_dasta40331" as="node()">
														<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
															<xsl:sequence select="(./@node(), ./node())"/>
														</garant_dat>
													</xsl:with-param>
													<xsl:with-param name="dat_prov" as="node()*">
														<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
															<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
																<xsl:sequence select="(./@node(), ./node())"/>
															</dat_prov>
														</xsl:for-each>
													</xsl:with-param>
												</xsl:call-template>
											</xsl:variable>
											<xsl:for-each select="$var24_resultof_dg___all/ns0:fullUrl/@value">
												<entry>
													<reference>
														<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI(fn:string(.)))"/>
													</reference>
												</entry>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:with-param>
							</xsl:call-template>
						</xsl:variable>
						<xsl:for-each select="$var26_resultof_Composition_EU_PS">
							<entry>
								<xsl:sequence select="(./@node(), ./node())"/>
							</entry>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var31_resultof_h___all" as="node()*">
					<xsl:call-template name="provisio:h_-_all">
						<xsl:with-param name="patientReference" as="node()">
							<Reference>
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'official'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
									</system>
									<value>
										<xsl:for-each select="@id_pac">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</value>
								</identifier>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="ip_h" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:h">
								<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</hType>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="patsumdat_h" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:h">
								<hType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</hType>
							</xsl:for-each>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var31_resultof_h___all">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var32_resultof_fyznal___all" as="node()*">
					<xsl:call-template name="provisio:fyznal_-_all">
						<xsl:with-param name="patientReference" as="node()">
							<Reference>
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'official'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
									</system>
									<value>
										<xsl:for-each select="@id_pac">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</value>
								</identifier>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="ip_fyznal" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:fyznal">
								<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</fyznalType>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="patsumdat_fyznal" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:fyznal">
								<fyznalType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</fyznalType>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="garant_datReference" as="node()">
							<Reference>
								<display>
									<xsl:for-each select="$var53_dasta/ns1:garant_dat">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="dat_prov" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
								<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</dat_prov>
							</xsl:for-each>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var32_resultof_fyznal___all">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var33_resultof_grav___all" as="node()*">
					<xsl:call-template name="provisio:grav_-_all">
						<xsl:with-param name="patientReference" as="node()">
							<Reference>
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'official'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
									</system>
									<value>
										<xsl:for-each select="@id_pac">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</value>
								</identifier>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="garant_datReference" as="node()">
							<Reference>
								<display>
									<xsl:for-each select="$var53_dasta/ns1:garant_dat">
										<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
									</xsl:for-each>
								</display>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="ip_grav" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:grav">
								<gravType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</gravType>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="patsumdat_grav" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:grav">
								<gravType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</gravType>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="dat_prov" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
								<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</dat_prov>
							</xsl:for-each>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var33_resultof_grav___all">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var34_resultof_u___all" as="node()*">
					<xsl:call-template name="provisio:u_-_all">
						<xsl:with-param name="patientReference" as="node()">
							<Reference>
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'official'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
									</system>
									<value>
										<xsl:for-each select="@id_pac">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</value>
								</identifier>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="ip_u" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:u">
								<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</uType>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="garant_dat_dasta" as="node()?">
							<xsl:for-each select="$var53_dasta/ns1:garant_dat">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="dat_prov" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
								<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</dat_prov>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="patsumdat_u" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:u">
								<uType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</uType>
							</xsl:for-each>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var34_resultof_u___all">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var36_cur" as="node()" select="."/>
				<xsl:for-each select="$var53_dasta/ns1:garant_dat">
					<xsl:variable name="var35_resultof_an___all" as="node()*">
						<xsl:call-template name="provisio:an_-_all">
							<xsl:with-param name="patientReference" as="node()">
								<Reference>
									<identifier>
										<use>
											<xsl:attribute name="value" namespace="" select="'official'"/>
										</use>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
										</system>
										<value>
											<xsl:for-each select="$var36_cur/@id_pac">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</value>
									</identifier>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="dat_prov" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
									<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_prov>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="ds_dasta40331" as="node()">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:with-param>
							<xsl:with-param name="ip_an" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:an">
									<anType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</anType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="patsumdat_an" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:an">
									<anType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</anType>
								</xsl:for-each>
							</xsl:with-param>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var35_resultof_an___all">
						<entry>
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var37_resultof_anf___all" as="node()*">
					<xsl:call-template name="provisio:anf_-_all">
						<xsl:with-param name="patientReference" as="node()">
							<Reference>
								<identifier>
									<use>
										<xsl:attribute name="value" namespace="" select="'official'"/>
									</use>
									<system>
										<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
									</system>
									<value>
										<xsl:for-each select="@id_pac">
											<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
									</value>
								</identifier>
							</Reference>
						</xsl:with-param>
						<xsl:with-param name="ds_ip4150719" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf/ns2:garant_dat">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="ip_anf" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:anf">
								<anfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</anfType>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="ds_ip4150729" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:anf/ns2:garant_dat">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="patsumdat_anf" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf">
								<anfType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</anfType>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="ds_dasta40331" as="node()?">
							<xsl:for-each select="$var53_dasta/ns1:garant_dat">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:for-each>
						</xsl:with-param>
						<xsl:with-param name="dat_prov" as="node()*">
							<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
								<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
									<xsl:sequence select="(./@node(), ./node())"/>
								</dat_prov>
							</xsl:for-each>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var37_resultof_anf___all">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var39_cur" as="node()" select="."/>
				<xsl:for-each select="$var53_dasta/ns1:garant_dat">
					<xsl:variable name="var38_resultof_oc___all" as="node()*">
						<xsl:call-template name="provisio:oc_-_all">
							<xsl:with-param name="patientReference" as="node()">
								<Reference>
									<identifier>
										<use>
											<xsl:attribute name="value" namespace="" select="'official'"/>
										</use>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
										</system>
										<value>
											<xsl:for-each select="$var39_cur/@id_pac">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</value>
									</identifier>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="dat_prov" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
									<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_prov>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="ip_oc" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:oc">
									<ocType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</ocType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="anf_anam_oc" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:anf/ns2:anam_oc">
									<ocType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:for-each select="@guid">
											<xsl:attribute name="guid" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
										<xsl:for-each select="@vguid">
											<xsl:attribute name="vguid" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
										<xsl:for-each select="ns2:ocz">
											<ocz>
												<xsl:sequence select="(./@node(), ./node())"/>
											</ocz>
										</xsl:for-each>
									</ocType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="patsumdat_anf_anam_oc" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf/ns2:anam_oc">
									<ocType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:for-each select="@guid">
											<xsl:attribute name="guid" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
										<xsl:for-each select="@vguid">
											<xsl:attribute name="vguid" namespace="" select="fn:string(.)"/>
										</xsl:for-each>
										<xsl:for-each select="ns2:ocz">
											<ocz>
												<xsl:sequence select="(./@node(), ./node())"/>
											</ocz>
										</xsl:for-each>
									</ocType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="patsumdat_oc" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:oc">
									<ocType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</ocType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="ds_ip415076" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:anf/ns2:dat_ab">
									<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_ab>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="dsipdat_ab" as="xs:dateTime*">
								<xsl:for-each select="$var54_ip/ns2:oc/@dat_ab">
									<xsl:sequence select="xs:dateTime(fn:string(.))"/>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="ds_dasta40331" as="node()">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:with-param>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var38_resultof_oc___all">
						<entry>
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var41_cur" as="node()" select="."/>
				<xsl:for-each select="$var53_dasta/ns1:garant_dat">
					<xsl:variable name="var40_resultof_dg___all" as="node()*">
						<xsl:call-template name="provisio:dg_-_all">
							<xsl:with-param name="patientReference" as="node()">
								<Reference>
									<identifier>
										<use>
											<xsl:attribute name="value" namespace="" select="'official'"/>
										</use>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
										</system>
										<value>
											<xsl:for-each select="$var41_cur/@id_pac">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</value>
									</identifier>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="ip_dg" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:dg">
									<dgType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dgType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="patsumdat_dg" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:dg">
									<dgType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dgType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="ds_dasta40331" as="node()">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:with-param>
							<xsl:with-param name="dat_prov" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
									<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_prov>
								</xsl:for-each>
							</xsl:with-param>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var40_resultof_dg___all">
						<entry>
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var43_cur" as="node()" select="."/>
				<xsl:for-each select="$var53_dasta/ns1:garant_dat">
					<xsl:variable name="var42_resultof_le___all" as="node()*">
						<xsl:call-template name="provisio:le_-_all">
							<xsl:with-param name="patientReference" as="node()">
								<Reference>
									<identifier>
										<use>
											<xsl:attribute name="value" namespace="" select="'official'"/>
										</use>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
										</system>
										<value>
											<xsl:for-each select="$var43_cur/@id_pac">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</value>
									</identifier>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="ds_dasta40331" as="node()">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:with-param>
							<xsl:with-param name="ip_le" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:le">
									<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</leType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="patsumdat_le" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:le">
									<leType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</leType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="dat_prov" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
									<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_prov>
								</xsl:for-each>
							</xsl:with-param>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var42_resultof_le___all">
						<entry>
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var45_cur" as="node()" select="."/>
				<xsl:for-each select="$var53_dasta/ns1:garant_dat">
					<xsl:variable name="var44_resultof_chv___all" as="node()*">
						<xsl:call-template name="provisio:chv_-_all">
							<xsl:with-param name="patientReference" as="node()">
								<Reference>
									<identifier>
										<use>
											<xsl:attribute name="value" namespace="" select="'official'"/>
										</use>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
										</system>
										<value>
											<xsl:for-each select="$var45_cur/@id_pac">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</value>
									</identifier>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="ip_chv" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:chv">
									<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</chvType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="ip_anf_anam_vyk_chv" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:anf/ns2:anam_vyk/ns2:chv">
									<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</chvType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="patsumdat_anf_anam_vyk_chv" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:anf/ns2:anam_vyk/ns2:chv">
									<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</chvType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="patsudat_chv" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:chv">
									<chvType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</chvType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="garant_dat_dasta" as="node()">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:with-param>
							<xsl:with-param name="ds_ip415079" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:anf/ns2:dat_ab">
									<dat_ab xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_ab>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="dat_prov" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
									<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_prov>
								</xsl:for-each>
							</xsl:with-param>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var44_resultof_chv___all">
						<entry>
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var47_cur" as="node()" select="."/>
				<xsl:for-each select="$var53_dasta/ns1:garant_dat">
					<xsl:variable name="var46_resultof_ld___all" as="node()*">
						<xsl:call-template name="provisio:ld_-_all">
							<xsl:with-param name="patientReference" as="node()">
								<Reference>
									<identifier>
										<use>
											<xsl:attribute name="value" namespace="" select="'official'"/>
										</use>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
										</system>
										<value>
											<xsl:for-each select="$var47_cur/@id_pac">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</value>
									</identifier>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="ip_ld" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ld">
									<ldType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</ldType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="patsumdat_ld" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:ld">
									<ldType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</ldType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="ds_dasta40331" as="node()">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:with-param>
							<xsl:with-param name="dat_prov" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
									<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_prov>
								</xsl:for-each>
							</xsl:with-param>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var46_resultof_ld___all">
						<entry>
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var54_ip">
				<xsl:variable name="var49_cur" as="node()" select="."/>
				<xsl:for-each select="$var53_dasta/ns1:garant_dat">
					<xsl:variable name="var48_resultof_fs___all" as="node()*">
						<xsl:call-template name="provisio:fs_-_all">
							<xsl:with-param name="patientReference" as="node()">
								<Reference>
									<identifier>
										<use>
											<xsl:attribute name="value" namespace="" select="'official'"/>
										</use>
										<system>
											<xsl:attribute name="value" namespace="" select="xs:string(xs:anyURI('https://ncez.mzcr.cz/fhir/sid/cpoj'))"/>
										</system>
										<value>
											<xsl:for-each select="$var49_cur/@id_pac">
												<xsl:attribute name="value" namespace="" select="fn:string(.)"/>
											</xsl:for-each>
										</value>
									</identifier>
								</Reference>
							</xsl:with-param>
							<xsl:with-param name="ds_dasta40331" as="node()">
								<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
									<xsl:sequence select="(./@node(), ./node())"/>
								</garant_dat>
							</xsl:with-param>
							<xsl:with-param name="ip_fs" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:fs">
									<fsType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</fsType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="patsumdat_fs" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:ku_z_patsumdat/ns2:fs">
									<fsType xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</fsType>
								</xsl:for-each>
							</xsl:with-param>
							<xsl:with-param name="dat_prov" as="node()*">
								<xsl:for-each select="$var54_ip/ns2:ku/ns2:ku_z/ns2:dat_prov">
									<dat_prov xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_ip">
										<xsl:sequence select="(./@node(), ./node())"/>
									</dat_prov>
								</xsl:for-each>
							</xsl:with-param>
						</xsl:call-template>
					</xsl:variable>
					<xsl:for-each select="$var48_resultof_fs___all">
						<entry>
							<xsl:sequence select="(./@node(), ./node())"/>
						</entry>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var53_dasta/ns1:is">
				<xsl:variable name="var50_resultof_is" as="node()*">
					<xsl:call-template name="provisio:is">
						<xsl:with-param name="is" as="node()">
							<is xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
								<xsl:sequence select="(./@node(), ./node())"/>
							</is>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var50_resultof_is">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:for-each select="$var53_dasta/ns1:garant_dat">
				<xsl:variable name="var51_resultof_garant_dat" as="node()?">
					<xsl:call-template name="provisio:garant_dat">
						<xsl:with-param name="garant_dat" as="node()">
							<garant_dat xmlns="urn:cz-mzcr:ns:dasta:ds4:ds_dasta">
								<xsl:sequence select="(./@node(), ./node())"/>
							</garant_dat>
						</xsl:with-param>
					</xsl:call-template>
				</xsl:variable>
				<xsl:for-each select="$var51_resultof_garant_dat">
					<entry>
						<xsl:sequence select="(./@node(), ./node())"/>
					</entry>
				</xsl:for-each>
			</xsl:for-each>
			<xsl:variable name="var52_resultof_ip" as="node()?">
				<xsl:call-template name="provisio:ip"/>
			</xsl:variable>
			<xsl:for-each select="$var52_resultof_ip">
				<entry>
					<xsl:sequence select="(./@node(), ./node())"/>
				</entry>
			</xsl:for-each>
		</Bundle>
	</xsl:template>
</xsl:stylesheet>
